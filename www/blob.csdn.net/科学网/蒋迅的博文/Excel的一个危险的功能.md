# 科学网—Excel的一个危险的功能 - 蒋迅的博文




# Excel的一个危险的功能                           

已有 5540 次阅读2012-5-11 09:16|个人分类:[科技](http://blog.sciencenet.cn/home.php?mod=space&uid=420554&do=blog&classid=136794&view=me)|系统分类:[教学心得](http://blog.sciencenet.cn/home.php?mod=space&do=blog&view=all&uid=420554&catid=9)|关键词:Excel|[EXCEL](misc.php?mod=tag&id=1827)



作者：蒋迅

我在熊荣川老师的[博客](http://blog.sciencenet.cn/home.php?mod=space&uid=508298&do=blog&id=566719)上留言说：“Excel是又方便又容易造成错误的软件。小心为妙。”现在举一个例子说明。

![](http://image.sciencenet.cn/album/201205/10/17104988dfwbd8n2kn2hbd.png)
图1
这里第一列是用户的一组数据。假定第二列将是第一列的两倍。我们可以在第二列第一行里输入“=A1*2”(如图1)，得到“4”(如图2)。

![](http://image.sciencenet.cn/album/201205/10/171050pzog3no73jj9sddp.png)
图2
![](http://image.sciencenet.cn/album/201205/10/171051xk47mu4qqxs8u0qg.png)
图3
![](http://image.sciencenet.cn/album/201205/10/171052ot28trlr699l2ltr.png)
图4
现在我们可以把第二列第一行里的公式复制到以下几个单元格，如图3-4所示。

![](http://image.sciencenet.cn/album/201205/10/171052h9yggmoco5u31zj5.png)
图5
但是我最近突然发现，这个特色没有了。我现在得到的是图5的结果。

![](http://image.sciencenet.cn/album/201205/10/171056cfg3sk7ft76wokfv.png)
图6
仔细一看在相应单元格里的公式还是正确的，但Excel并不执行计算（如图6）。

![](http://image.sciencenet.cn/album/201205/10/171059a3qnarrnnisk3n9s.png)
图7
现在我们尝试在第二列第二行里输入同样的公式，我们发现还是可以得到预期的结果“6”，如图7-8。

![](http://image.sciencenet.cn/album/201205/10/17110136p4a4pegl4e2hic.png)
图8
那是出了什么问题了呢？原来，Excel的这个功能是可以关闭的。我工作的单位为了防病毒，
把Excel的这一功能给关闭了，但是又没有告诉我们这些使用Excel的人，于是就出现了上面的这个结果。如果不是我们观察数据时足够仔细，完全可能被
Excel的这个功能给坑了。

写出这件事就是为了告诉大家，使用Excel时一定要小心。被Excel坑了的人已经不少，希望你不是下一个。


**补充：**以下是网友评论中的内容。


与“绝对引用和相对引用”、“宏”[注3]无关。


4楼已给了正解，也不是发论文换钱，大家分别发帖子来谈没必要，集中在第一个发出的帖子里充分说明是有意义的，可以便利需要的人在网络检索的时候集中获得答案。这里再画蛇添足地详细一下。



使用有些单位或其他人的电脑，的确会遭遇这样的问题，弄的不好会肯定出问题，相关例子不列举了。


这个问题如果不知道的话，后果可大可小，具体看正好是什么场合。



把4楼的回复“翻译”如下：



依次点击：Excel工具/选项（出来一个多项“选项卡”）



点击“重新计算”选项卡，里面有多个单选项：

如果“自动重算”被选中，那么就是图4的情况 ── 复制[注1]后，Excel遇到所有公式会自动执行计算，并将结果显示出来；

如果“人工重算”被选中，那么就是图5的情况 ── 复制后对所有公式不自动执行计算，但是在编辑情况下（鼠标插入该单元格字符中的任意位置），键盘回车后，Excel执行计算；


（在“人工重算”被选中的情况下）按F9，等于是自动执行一次所有公式的计算并输出结果。



（完）



附解释：



[注1]

从图2、图3的B2单元格显示的“虚框”看，有必要说说下面的内容。

（这不证明蒋老师不知道下面的内容，蒋老师分步说明的办法可以让读者知道实际操作的意义。从回复看，不熟悉的人还比较多。）


Excel中，连续复制单元格，最简单的办法是：左键选中被复制的单元格（鼠标放在单元格右下角出现的实心小十字上），按住不放，一直拖拉[注2]到所有需要复制的单元格位置，放开左键即可实现复制。


但是，在复制时间、日期、带数字的文本等格式的单元格时，Excel会自动执行“□1”计算，这个时候的复制，用右键拖拉到所有需要复制的单元格，放开右键，选择“复制单元格”即可。



[注2]

拖拉的方向有：“上、下、左、右”4个方向；

对含有时间、日期、带数字的文本等格式的单元格往上、往左拖拉时，Excel会自动执行“-1”计算；往下、往右拖拉时，Excel会自动执行“+1”计算；

Excel中，可以对连续选中的单元格（行、列或块）执行拖拉操作（“复制”或“以序列方式填充”），扩展行列矩阵的边界；


[注3]

宏：在使用Excel时，由用户自己录制的“一段所有连续操作动作”。


点击“工具/宏”可以录制或运行宏。


使用宏的好处是：可以让Excel重复执行相同的指令，完成大量枯燥且复杂的工作。
宏被录制后，Excel程序自动转换为可执行的指令文件。


宏可以作为“子程序”一样随该文档一起保存、转移和调用。调用的时候，会完全重复原有的所有操作和步骤，包括删除、修改其它文件和往外发送数据（几乎和间
谍程序一样），这样做的时候，初级的杀毒软件一般是不动作的。即使没有间谍程序的功能，仅仅是自动执行本身就可能毁坏收集的数据，所以，非常危险，不使用
为好。下载到Excel类的文件后，首先扫描杀毒，安全的话，马上检查是否带宏，除非是信任的人的文件，建议没有编程能力的使用者一律删除带宏的
Excel文件。



转载本文请联系原作者获取授权，同时请注明本文来自蒋迅科学网博客。
链接地址：[http://blog.sciencenet.cn/blog-420554-569554.html](http://blog.sciencenet.cn/blog-420554-569554.html)

上一篇：[微博更新 (2012年5月10日)](blog-420554-569196.html)
下一篇：[这些墙纸够数学的](blog-420554-571058.html)















