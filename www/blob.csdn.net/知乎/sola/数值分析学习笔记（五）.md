# 数值分析学习笔记（五） - 知乎
# 

在本章中，我们介绍一些回归与估计的方法。回归与估计方法的本质是数理统计中的参数估计问题：**我们确定目标函数的形式，在其中设定各种参数。在得到了样本点后，我们确定一个代价函数（衡量拟合程度的好坏的函数，也可以称为误差函数），使得代价函数的取值最小化，从而根据样本点反推出最优的参数估计值。**



首先，我们要介绍的是离散形式的最小二乘估计。

**离散形式的最小二乘估计**

在离散形式的最小二乘（即线性回归）中，我们有样本点 ![(x_1,y_1),...,(x_m,y_m)](https://www.zhihu.com/equation?tex=%28x_1%2Cy_1%29%2C...%2C%28x_m%2Cy_m%29) ，我们确定的**目标函数形式是 ![y=a_1x+a_0](https://www.zhihu.com/equation?tex=y%3Da_1x%2Ba_0)** 。

问题在于要如何确定代价函数的形式呢？

从直觉上看，我们可以利用每个样本点的真实值 ![y_i](https://www.zhihu.com/equation?tex=y_i) 与估计值 ![\hat{y_i}=a_1x_i+a_0](https://www.zhihu.com/equation?tex=%5Chat%7By_i%7D%3Da_1x_i%2Ba_0) 之差的绝对值之和来作为代价函数。

由此，我们得到绝对偏差 ![E_1(a_0,a_1)=\sum_{i=1}^m|y_i-a_1x_i-a_0|](https://www.zhihu.com/equation?tex=E_1%28a_0%2Ca_1%29%3D%5Csum_%7Bi%3D1%7D%5Em%7Cy_i-a_1x_i-a_0%7C) 。但是这个误差函数有一个问题：**不可微**。如我们后文所见的，不可微的误差函数会为我们的误差最小化带来一些困难。

另一个常用的误差函数是 ![E_{\infty}(a_0,a_1)=max(|y_i-a_1x_i-a_0|)](https://www.zhihu.com/equation?tex=E_%7B%5Cinfty%7D%28a_0%2Ca_1%29%3Dmax%28%7Cy_i-a_1x_i-a_0%7C%29) ，其关注所有样本点处绝对误差的最大值，并将这个绝对误差的最大值最小化。然而，这样的最小化问题没有初等方法可以解决。

所以，我们取定了**最小二乘标准的误差函数 ![E_2(a_0,a_1)=\sum_{i=1}^m(y_i-a_1x_i-a_0)^2](https://www.zhihu.com/equation?tex=E_2%28a_0%2Ca_1%29%3D%5Csum_%7Bi%3D1%7D%5Em%28y_i-a_1x_i-a_0%29%5E2) ，**因为其可以用初等方法解决，且可微性为后续误差最小化的处理提供了许多便利。

确定了误差函数后，我们非常自然地进行**误差最小化（注意我们要解出**![a_0,a_1](https://www.zhihu.com/equation?tex=a_0%2Ca_1)**）**。

![\begin{cases} \frac{\partial E}{\partial a_1}=0\\ \frac{\partial E}{\partial a_0}=0  \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+%5Cfrac%7B%5Cpartial+E%7D%7B%5Cpartial+a_1%7D%3D0%5C%5C+%5Cfrac%7B%5Cpartial+E%7D%7B%5Cpartial+a_0%7D%3D0++%5Cend%7Bcases%7D)

由此我们解得**最小二乘解 ![\begin{cases} a_1=\frac{S_{xy}}{S_{xx}}  \\ a_0=\overline{y}-a_1\overline{x} \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+a_1%3D%5Cfrac%7BS_%7Bxy%7D%7D%7BS_%7Bxx%7D%7D++%5C%5C+a_0%3D%5Coverline%7By%7D-a_1%5Coverline%7Bx%7D+%5Cend%7Bcases%7D)**

**其中 ![\overline{y}=\frac{\sum_{i=1}^my_i}{m},\overline{x}=\frac{\sum_{i=1}^mx_i}{m}](https://www.zhihu.com/equation?tex=%5Coverline%7By%7D%3D%5Cfrac%7B%5Csum_%7Bi%3D1%7D%5Emy_i%7D%7Bm%7D%2C%5Coverline%7Bx%7D%3D%5Cfrac%7B%5Csum_%7Bi%3D1%7D%5Emx_i%7D%7Bm%7D) ， **![S_{xx}=\sum_{i=1}^m(x_i-\overline{x})^2,S_{xy}=\sum_{i=1}^m(x_i-\overline{x})(y_i-\overline{y})](https://www.zhihu.com/equation?tex=S_%7Bxx%7D%3D%5Csum_%7Bi%3D1%7D%5Em%28x_i-%5Coverline%7Bx%7D%29%5E2%2CS_%7Bxy%7D%3D%5Csum_%7Bi%3D1%7D%5Em%28x_i-%5Coverline%7Bx%7D%29%28y_i-%5Coverline%7By%7D%29)


作为推广地，我们可以将**目标函数的形式修改为任意 ![n](https://www.zhihu.com/equation?tex=n) 次多项式 **![a_nx^n+a_{n-1}x^{n-1}+...+a_0(n<m-1)](https://www.zhihu.com/equation?tex=a_nx%5En%2Ba_%7Bn-1%7Dx%5E%7Bn-1%7D%2B...%2Ba_0%28n%3Cm-1%29)

则我们要最小化误差函数 ![E_2=\sum_{i=1}^m(y_i-a_nx_i^n-a_{n-1}x_i^{n-1}-...-a_0)^2](https://www.zhihu.com/equation?tex=E_2%3D%5Csum_%7Bi%3D1%7D%5Em%28y_i-a_nx_i%5En-a_%7Bn-1%7Dx_i%5E%7Bn-1%7D-...-a_0%29%5E2)

与上述过程几乎相同地，我们令误差函数对于所有参数的偏导数等于 ![0](https://www.zhihu.com/equation?tex=0) ，由此我们**得到线性方程组，即目标函数为多项式函数时的最小二乘解。**

**![\forall j=0,1,...,n,\ \sum_{k=0}^n(a_k\sum_{i=1}^mx_i^{j+k})=\sum_{i=1}^my_ix_i^j](https://www.zhihu.com/equation?tex=%5Cforall+j%3D0%2C1%2C...%2Cn%2C%5C+%5Csum_%7Bk%3D0%7D%5En%28a_k%5Csum_%7Bi%3D1%7D%5Emx_i%5E%7Bj%2Bk%7D%29%3D%5Csum_%7Bi%3D1%7D%5Emy_ix_i%5Ej) （具体求解过程此处不给出）**

下面我们试举一例。

例：有样本点 ![(0,1),(0.25,1.284),(0.5,1.6487),(0.75,2.117),(1,2.7183)](https://www.zhihu.com/equation?tex=%280%2C1%29%2C%280.25%2C1.284%29%2C%280.5%2C1.6487%29%2C%280.75%2C2.117%29%2C%281%2C2.7183%29) ，现要求用二次的目标函数进行回归估计。

解：

目标函数 ![y=a_2x^2+a_1x+a_0](https://www.zhihu.com/equation?tex=y%3Da_2x%5E2%2Ba_1x%2Ba_0)

由上述对于多项式目标函数的最小二乘解

有方程组 ![\begin{cases} 5a_0+2.5a_1+1.875a_2=8.768\\ 2.5a_0+1.875a_1+1.5625a_2=5.4514\\ 1.875a_0+1.5625a_1+1.3828a_2=4.4015 \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+5a_0%2B2.5a_1%2B1.875a_2%3D8.768%5C%5C+2.5a_0%2B1.875a_1%2B1.5625a_2%3D5.4514%5C%5C+1.875a_0%2B1.5625a_1%2B1.3828a_2%3D4.4015+%5Cend%7Bcases%7D)

我们解得
![](https://pic2.zhimg.com/v2-df85d80dbd098fa73a9603491f6b1d19_b.jpg)

在此处我们需要注意的是：对于指数形式的目标函数，即 ![y=be^{ax}](https://www.zhihu.com/equation?tex=y%3Dbe%5E%7Bax%7D) 以及 ![y=bx^a](https://www.zhihu.com/equation?tex=y%3Dbx%5Ea) ，我们求解误差函数最小化问题时是不能够得到解析解的。

所以我们可以采取的一种方法是：**对目标函数两边取对数。**如：对![y=be^{ax}](https://www.zhihu.com/equation?tex=y%3Dbe%5E%7Bax%7D)两边取对数得到 ![lny=lnb+ax](https://www.zhihu.com/equation?tex=lny%3Dlnb%2Bax) ，然后将 ![lny,x](https://www.zhihu.com/equation?tex=lny%2Cx) 看作样本点，将 ![a,lnb](https://www.zhihu.com/equation?tex=a%2Clnb) 看作参数进行线性的最小二乘拟合。

但是我们显然能够注意到：**经过变换后利用线性最小二乘解求得的拟合函数与直接最小化 ![\sum_{i=1}^m(y_i-be^{ax_i})^2](https://www.zhihu.com/equation?tex=%5Csum_%7Bi%3D1%7D%5Em%28y_i-be%5E%7Bax_i%7D%29%5E2) 所得到拟合函数是不同的**。



接下来，我们介绍连续形式的最小二乘估计

**连续形式的最小二乘估计**

由于连续型与离散型最根本的思想并没有差别，我们一笔带过地进行介绍。

**在连续形式下，我们有样本函数 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 给定。我们要做的是在区间 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 中对于一个确定形式的目标函数（通常而言是多项式） ![P(x)](https://www.zhihu.com/equation?tex=P%28x%29) ，我们要使得误差函数取值最小**。我们很自然地将离散形式中误差函数中的求和号推广为在连续形式中的定积分。

即，**连续形式的最小二乘意义下的误差函数为 **![E_2=\int_a^b[f(x)-P(x)]^2dx](https://www.zhihu.com/equation?tex=E_2%3D%5Cint_a%5Eb%5Bf%28x%29-P%28x%29%5D%5E2dx) 。

同样地，我们在此考虑目标函数为多项式函数的情形，即 ![P(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0](https://www.zhihu.com/equation?tex=P%28x%29%3Da_nx%5En%2Ba_%7Bn-1%7Dx%5E%7Bn-1%7D%2B...%2Ba_0) 。

则我们有 ![E_2=\int_a^b[f(x)-\sum_{k=0}^na_kx^k]^2dx](https://www.zhihu.com/equation?tex=E_2%3D%5Cint_a%5Eb%5Bf%28x%29-%5Csum_%7Bk%3D0%7D%5Ena_kx%5Ek%5D%5E2dx)

由分析学知识容易知道含参变量定积分与求导可交换。

故我们故技重施，使误差函数对所有参数 ![a_i](https://www.zhihu.com/equation?tex=a_i) 的偏导数都为 ![0](https://www.zhihu.com/equation?tex=0) 即可。

化为线性方程组，得到**连续形式的多项式拟合最小二乘解：**

![\forall j=0,1,...,n,\ \sum_{k=0}^na_k\int_a^bx^{j+k}dx=\int_a^bx^jf(x)dx](https://www.zhihu.com/equation?tex=%5Cforall+j%3D0%2C1%2C...%2Cn%2C%5C+%5Csum_%7Bk%3D0%7D%5Ena_k%5Cint_a%5Ebx%5E%7Bj%2Bk%7Ddx%3D%5Cint_a%5Ebx%5Ejf%28x%29dx)

但是，与离散形式不同地，连续形式在数值求解上会遇到问题。

我们仔细观察可以发现方程组中 ![a_k](https://www.zhihu.com/equation?tex=a_k) 的系数为![\int_a^bx^{j+k}dx=\frac{b^{j+k-1}-a^{j+k-1}}{j+k-1}](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebx%5E%7Bj%2Bk%7Ddx%3D%5Cfrac%7Bb%5E%7Bj%2Bk-1%7D-a%5E%7Bj%2Bk-1%7D%7D%7Bj%2Bk-1%7D) 。

这恰恰与**Hilbert矩阵**的形式统一！这意味着：这个线性方程组的系数矩阵是**病态**的，在数值方法上是难解的。

除此之外，另一个缺点就是计算量过大，**之前的计算结果无法被之后的计算有效利用到**。

这引发了我们的思考：究竟是什么引起了这个问题？

我们发现：可能与**对于多项式构成的线性空间的基的选取**有关。

我们现在利用的基： ![1,x,x^2,...](https://www.zhihu.com/equation?tex=1%2Cx%2Cx%5E2%2C...) 不具有足够好的性质。

一个很自然地想法，模仿我们在高等代数中学习过的知识，就是对基进行**正交化处理**。


问题是：我们以什么作为连续函数的内积定义呢？

一个很自然的想法便是：定积分。

**定义 ![\int_a^bf(x)g(x)dx](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebf%28x%29g%28x%29dx) 为 ![f,g](https://www.zhihu.com/equation?tex=f%2Cg) 在 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上的内积。**

定积分具有正定性、对称性、以及双线性性，不难验证满足内积需要的性质。

然而，上述定义蕴含了一个前提：两个函数在 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 中每个点处的重要性是相同的。即由于定积分在区间中均匀地选取分割结点，导致了我们难以表示出部分点更加重要而其它点处不那么重要的效果。

故我们进行一些小的推广。

我们引入权函数的概念来对区间上每一点的**重要性（权重）进行区分**。

**定义：**

**![w(x)\in R[a,b]](https://www.zhihu.com/equation?tex=w%28x%29%5Cin+R%5Ba%2Cb%5D) ，若满足 ![\forall x\in[a,b],w(x)\geq 0](https://www.zhihu.com/equation?tex=%5Cforall+x%5Cin%5Ba%2Cb%5D%2Cw%28x%29%5Cgeq+0) 且在该区间中的任意子区间上不恒为 ![0](https://www.zhihu.com/equation?tex=0) ，则 ![w(x)](https://www.zhihu.com/equation?tex=w%28x%29) 为一个 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上的权函数。**

权函数实质上作为一种测度而存在。权函数的引入使得我们得以**将 ![f,g](https://www.zhihu.com/equation?tex=f%2Cg) 在 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上的内积推广为形式 ![\int_a^bw(x)f(x)g(x)dx](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebw%28x%29f%28x%29g%28x%29dx) 。**读者容易验证其仍旧满足内积的性质。

**我们今后对于函数、多项式的讨论均限定在区间 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上，后文不再重复。**

一些常用的权函数的例子，比如：

![w(x)=1](https://www.zhihu.com/equation?tex=w%28x%29%3D1) 意味着所有区间中的点具有同等重要性。

![w(x)=\frac{1}{\sqrt{1-x^2}}](https://www.zhihu.com/equation?tex=w%28x%29%3D%5Cfrac%7B1%7D%7B%5Csqrt%7B1-x%5E2%7D%7D) 则意味着靠近区间端点处的点更加重要而区间中点处的点最不重要。

在后续的介绍中，我们会看到这些权函数带来的优美性质。


我们现在既然有了内积的概念，再回过头来看我们的目标：**我们希望找到一组 ![n](https://www.zhihu.com/equation?tex=n) 次多项式的正交基 ![\phi_0,...,\phi_n](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_n) ，使得最小二乘解在这组基下具有比较简单的形式。**


我们不妨先来看一下正交基究竟会给最小二乘的求解带来如何的便利，来显示出其优越性。

根据我们的上述定义，如果 ![\phi_0,...,\phi_n](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_n) 为一组正交基，这意味着 ![\int_a^bw(x)\phi_i(x)\phi_j(x)dx=0\ (i\neq j)](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebw%28x%29%5Cphi_i%28x%29%5Cphi_j%28x%29dx%3D0%5C+%28i%5Cneq+j%29) ，而由内积的正定性，我们有 ![\int_a^bw(x)\phi_i^2(x)dx=\alpha_i>0](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebw%28x%29%5Cphi_i%5E2%28x%29dx%3D%5Calpha_i%3E0) 。

而又由基的性质， ![\forall P(x),degP\leq n,P(x)=\sum_{i=0}^na_i\phi_i(x)](https://www.zhihu.com/equation?tex=%5Cforall+P%28x%29%2CdegP%5Cleq+n%2CP%28x%29%3D%5Csum_%7Bi%3D0%7D%5Ena_i%5Cphi_i%28x%29) ，且线性表出方式唯一。

故我们的误差函数 ![E(a_0,...,a_n)=\int_a^bw(x)[f(x)-\sum_{i=0}^na_i\phi_i(x)]^2dx](https://www.zhihu.com/equation?tex=E%28a_0%2C...%2Ca_n%29%3D%5Cint_a%5Ebw%28x%29%5Bf%28x%29-%5Csum_%7Bi%3D0%7D%5Ena_i%5Cphi_i%28x%29%5D%5E2dx)

同样地，我们最小化误差，令 ![\frac{\partial E}{\partial a_i}=0](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+E%7D%7B%5Cpartial+a_i%7D%3D0)

得到 ![\int_a^bw(x)f(x)\phi_i(x)dx=a_i\alpha_i](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebw%28x%29f%28x%29%5Cphi_i%28x%29dx%3Da_i%5Calpha_i)

**解得**![a_i=\frac{\int_a^bw(x)f(x)\phi_i(x)dx}{\alpha_i}=\frac{\int_a^bw(x)f(x)\phi_i(x)dx}{\int_a^bw(x)\phi_i^2(x)dx}](https://www.zhihu.com/equation?tex=a_i%3D%5Cfrac%7B%5Cint_a%5Ebw%28x%29f%28x%29%5Cphi_i%28x%29dx%7D%7B%5Calpha_i%7D%3D%5Cfrac%7B%5Cint_a%5Ebw%28x%29f%28x%29%5Cphi_i%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_i%5E2%28x%29dx%7D)**（最小二乘解）**

我们发现：不同的 ![a_i](https://www.zhihu.com/equation?tex=a_i) 之间不再具有联系，方程的求解变得异常简单。

**基的正交性使得不同 ![a_i](https://www.zhihu.com/equation?tex=a_i) 之间的关联性消失了，大大简化了最小二乘解的求解。**


通过上述说明，我们发现：正交基确实为我们带来了极大的便利。

下面我们来考虑如何求解正交基的问题。

回忆我们在高代中学习过的向量正交化方法：我们有一组线性无关的向量，我们通过Schimidt正交化来得到相互正交的向量组。

那么我们是具体如何实现的呢？

我们**将第 ![i](https://www.zhihu.com/equation?tex=i) 个向量分别减去其在第一个、第二个直到第 ![i-1](https://www.zhihu.com/equation?tex=i-1) 个向量上的正交投影**来实现正交化操作。

回忆正交投影公式： ![\alpha](https://www.zhihu.com/equation?tex=%5Calpha) 在 ![\beta](https://www.zhihu.com/equation?tex=%5Cbeta) 上的正交投影为 ![\frac{(\alpha,\beta)}{(\beta,\beta)}\beta](https://www.zhihu.com/equation?tex=%5Cfrac%7B%28%5Calpha%2C%5Cbeta%29%7D%7B%28%5Cbeta%2C%5Cbeta%29%7D%5Cbeta) 。

那么相似地，我们将这样的方法推广到函数上。

现在我们的内积是 ![w(x)](https://www.zhihu.com/equation?tex=w%28x%29) 测度意义下的定积分。

我们**不妨取 ![\phi_0(x)=1](https://www.zhihu.com/equation?tex=%5Cphi_0%28x%29%3D1) ，并且假设 ![deg\ \phi_i=i](https://www.zhihu.com/equation?tex=deg%5C+%5Cphi_i%3Di) 。**

我们现在考虑如下问题：**给定我们已经求出了 ![\phi_0,\phi_1,...,\phi_k](https://www.zhihu.com/equation?tex=%5Cphi_0%2C%5Cphi_1%2C...%2C%5Cphi_k) 为 ![k](https://www.zhihu.com/equation?tex=k) 次多项式的正交基，我们要如何生成出 ![\phi_{k+1}](https://www.zhihu.com/equation?tex=%5Cphi_%7Bk%2B1%7D) ，使得其仍旧保持正交性呢？**

注意到 ![deg\ \phi_k=k,deg\ x\phi_k=k+1](https://www.zhihu.com/equation?tex=deg%5C+%5Cphi_k%3Dk%2Cdeg%5C+x%5Cphi_k%3Dk%2B1) ，很自然地，我们可以对 ![\phi_0,...,\phi_k,x\phi_k](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_k%2Cx%5Cphi_k) 进行正交化处理。

**模仿向量的正交化（减去正交投影）**，我们有：

![\phi_{k+1}=x\phi_k-\frac{\int_a^bw(x)x\phi_k(x)\phi_k(x)dx}{\int_a^bw(x)\phi_k^2(x)dx}\phi_k-\frac{\int_a^bw(x)x\phi_k(x)\phi_{k-1}(x)dx}{\int_a^bw(x)\phi_{k-1}^2(x)dx}\phi_{k-1}-...-\frac{\int_a^bw(x)x\phi_k(x)\phi_0(x)dx}{\int_a^bw(x)\phi_0^2(x)dx}\phi_0](https://www.zhihu.com/equation?tex=%5Cphi_%7Bk%2B1%7D%3Dx%5Cphi_k-%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_k%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_k%5E2%28x%29dx%7D%5Cphi_k-%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_%7Bk-1%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-1%7D%5E2%28x%29dx%7D%5Cphi_%7Bk-1%7D-...-%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_0%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_0%5E2%28x%29dx%7D%5Cphi_0)

然而，细心的读者会注意到等号右边从第四项起后面全部都是 ![0](https://www.zhihu.com/equation?tex=0) 。

我们下面以 ![\frac{\int_a^bw(x)x\phi_k(x)\phi_{k-2}(x)dx}{\int_a^bw(x)\phi_{k-2}^2(x)dx}](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_%7Bk-2%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-2%7D%5E2%28x%29dx%7D) 为例子证明这一点。

注意到 ![\int_a^bw(x)x\phi_k(x)\phi_{k-2}(x)dx](https://www.zhihu.com/equation?tex=%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_%7Bk-2%7D%28x%29dx)**表示 ![x\phi_k,\phi_{k-2}](https://www.zhihu.com/equation?tex=x%5Cphi_k%2C%5Cphi_%7Bk-2%7D) 之间的内积**。

然而，换个角度看，我们惊奇地发现**其还是 ![\phi_k,x\phi_{k-2}](https://www.zhihu.com/equation?tex=%5Cphi_k%2Cx%5Cphi_%7Bk-2%7D) 之间的内积**。

而 ![deg \ x\phi_{k-2}\leq k-1](https://www.zhihu.com/equation?tex=deg+%5C+x%5Cphi_%7Bk-2%7D%5Cleq+k-1) ，由 ![\phi_0,...,\phi_k](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_k) 的正交性，且 ![x\phi_{k-2}](https://www.zhihu.com/equation?tex=x%5Cphi_%7Bk-2%7D) 必定能由 ![\phi_0,...,\phi_{k-1}](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_%7Bk-1%7D)唯一地线性表出。我们容易知道 ![\phi_k,x\phi_{k-2}](https://www.zhihu.com/equation?tex=%5Cphi_k%2Cx%5Cphi_%7Bk-2%7D) 的内积为 ![0](https://www.zhihu.com/equation?tex=0) 。

故 ![\frac{\int_a^bw(x)x\phi_k(x)\phi_{k-2}(x)dx}{\int_a^bw(x)\phi_{k-2}^2(x)dx}=0](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_%7Bk-2%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-2%7D%5E2%28x%29dx%7D%3D0)

以此类推地，我们容易证明：等式右边从第四项以后的所有项都是 ![0](https://www.zhihu.com/equation?tex=0) 。

**即 **![\phi_{k+1}=x\phi_k-\frac{\int_a^bw(x)x\phi_k(x)\phi_k(x)dx}{\int_a^bw(x)\phi_k^2(x)dx}\phi_k-\frac{\int_a^bw(x)x\phi_k(x)\phi_{k-1}(x)dx}{\int_a^bw(x)\phi_{k-1}^2(x)dx}\phi_{k-1}](https://www.zhihu.com/equation?tex=%5Cphi_%7Bk%2B1%7D%3Dx%5Cphi_k-%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_k%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_k%5E2%28x%29dx%7D%5Cphi_k-%5Cfrac%7B%5Cint_a%5Ebw%28x%29x%5Cphi_k%28x%29%5Cphi_%7Bk-1%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-1%7D%5E2%28x%29dx%7D%5Cphi_%7Bk-1%7D)

我们由此便得到了**多项式正交化的Gram-Schimidt方法**。

下面我们给出此方法的完整表述。


**定理（Gram-Schimidt）**

**![\phi_0,...,\phi_n](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_n) 为 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上关于权函数 ![w(x)](https://www.zhihu.com/equation?tex=w%28x%29) 正交的多项式基。可以由以下方式求得：**

**![\phi_0(x)=1,\phi_1(x)=x-B_1](https://www.zhihu.com/equation?tex=%5Cphi_0%28x%29%3D1%2C%5Cphi_1%28x%29%3Dx-B_1) ，而 ![B_1=\frac{\int_a^bxw(x)\phi_0^2(x)dx}{\int_a^bw(x)\phi_0^2(x)dx}](https://www.zhihu.com/equation?tex=B_1%3D%5Cfrac%7B%5Cint_a%5Ebxw%28x%29%5Cphi_0%5E2%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_0%5E2%28x%29dx%7D) 。**

**而当 ![k\geq 2](https://www.zhihu.com/equation?tex=k%5Cgeq+2) 时，我们有统一形式 ![\phi_k(x)=x\phi_{k-1}(x)-B_k\phi_{k-1}(x)-C_k\phi_{k-2}(x)](https://www.zhihu.com/equation?tex=%5Cphi_k%28x%29%3Dx%5Cphi_%7Bk-1%7D%28x%29-B_k%5Cphi_%7Bk-1%7D%28x%29-C_k%5Cphi_%7Bk-2%7D%28x%29) 。**

**其中， ![B_k=\frac{\int_a^bxw(x)\phi^2_{k-1}(x)dx}{\int_a^bw(x)\phi_{k-1}^2(x)dx}](https://www.zhihu.com/equation?tex=B_k%3D%5Cfrac%7B%5Cint_a%5Ebxw%28x%29%5Cphi%5E2_%7Bk-1%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-1%7D%5E2%28x%29dx%7D) ， ![C_k=\frac{\int_a^bxw(x)\phi_{k-1}(x)\phi_{k-2}(x)dx}{\int_a^bw(x)\phi_{k-2}^2(x)dx}](https://www.zhihu.com/equation?tex=C_k%3D%5Cfrac%7B%5Cint_a%5Ebxw%28x%29%5Cphi_%7Bk-1%7D%28x%29%5Cphi_%7Bk-2%7D%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_%7Bk-2%7D%5E2%28x%29dx%7D) 。**

Gram-Schimidt方法看似繁琐，实则十分简单。它就是**向量的Schimidt正交化方法在多项式正交化方面的推广**罢了。根本的想法都是完全一致的，仅仅在细节上略有差别。


事实上，我们现在可以从**线性空间的角度来理解正交多项式基的最小二乘解**。

在上文我们提到过，若 ![\forall P(x),degP\leq n,P(x)=\sum_{i=0}^na_i\phi_i(x)](https://www.zhihu.com/equation?tex=%5Cforall+P%28x%29%2CdegP%5Cleq+n%2CP%28x%29%3D%5Csum_%7Bi%3D0%7D%5Ena_i%5Cphi_i%28x%29) 。

那么我们的最小二乘解为 ![a_i=\frac{\int_a^bw(x)f(x)\phi_i(x)dx}{\int_a^bw(x)\phi_i^2(x)dx}](https://www.zhihu.com/equation?tex=a_i%3D%5Cfrac%7B%5Cint_a%5Ebw%28x%29f%28x%29%5Cphi_i%28x%29dx%7D%7B%5Cint_a%5Ebw%28x%29%5Cphi_i%5E2%28x%29dx%7D) 。

有没有发现十分的眼熟？

**表出系数 ![a_i](https://www.zhihu.com/equation?tex=a_i) 就是 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 在 ![\phi_i(x)](https://www.zhihu.com/equation?tex=%5Cphi_i%28x%29) 上的正交投影！**

**也就是说，在 ![\phi_0,...,\phi_n](https://www.zhihu.com/equation?tex=%5Cphi_0%2C...%2C%5Cphi_n) 组成的线性空间中， ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 的坐标就是 ![(a_0,a_1,...,a_n)](https://www.zhihu.com/equation?tex=%28a_0%2Ca_1%2C...%2Ca_n%29) ，就是其最小二乘解！**



**到此为止，我们完全地建立了正交多项式的理论。**

**我们介绍了为何要引入多项式的正交性，其在最小二乘求解中有何优势，我们应如何求得正交多项式。**


下面，我们举一例过去曾提到过的正交多项式。这次我们能够更深入地理解其含义。

回忆数值积分中的Gauss方法，我们在 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 区间上选取Legendre多项式的根作为积分估计结点。

读者可以验证的是：**当权函数 ![w(x)=1](https://www.zhihu.com/equation?tex=w%28x%29%3D1) 且 ![[a,b]=[-1,1]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D%3D%5B-1%2C1%5D) 时， ![\phi_k(x)](https://www.zhihu.com/equation?tex=%5Cphi_k%28x%29) 即为 ![k](https://www.zhihu.com/equation?tex=k) 次Legendre多项式**。

这告诉我们：**Gauss方法能产生出如此高代数精度的根本原因是结点选取的正交性。**

由此，我们可以想到一个有趣的推广：任意区间 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上的Gauss方法在过去我们是利用其到 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 上的线性变换来进行转化从而完成估计。

事实上，我们完全可以令权函数 ![w(x)=1](https://www.zhihu.com/equation?tex=w%28x%29%3D1) 取区间![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 进行正交多项式的求解，解出 ![\phi_k](https://www.zhihu.com/equation?tex=%5Cphi_k) 后求出其零点作为积分估计结点。这两种处理方法从本质上而言是一致的。


**Chebyshev多项式**

下面，作为正交多项式理论的重要成果之一，我们着重介绍Chebyshev多项式并且用它的独特性质来对之前提出的**插值理论**进行完善。

我们先介绍其定义再验证其满足正交性。

**定义：**

**![n](https://www.zhihu.com/equation?tex=n) 次Chebyshev多项式为 ![T_n(x)=cos(narccosx),\ x\in[-1,1]](https://www.zhihu.com/equation?tex=T_n%28x%29%3Dcos%28narccosx%29%2C%5C+x%5Cin%5B-1%2C1%5D) 。**

我们容易由定义得到： ![T_0(x)=1,T_1(x)=x,T_2(x)=2x^2-1...](https://www.zhihu.com/equation?tex=T_0%28x%29%3D1%2CT_1%28x%29%3Dx%2CT_2%28x%29%3D2x%5E2-1...)

然而，要写出Chebyshev多项式的通项公式是困难的。

那我们要如何生成出任意次的Chebyshev多项式呢？

注意到我们可以令 ![\theta=arccosx](https://www.zhihu.com/equation?tex=%5Ctheta%3Darccosx) 来对多项式进行一些化简。

我们发现： ![T_n(cos\theta)=cos(n\theta)](https://www.zhihu.com/equation?tex=T_n%28cos%5Ctheta%29%3Dcos%28n%5Ctheta%29) ，即 ![n](https://www.zhihu.com/equation?tex=n) 次Chebyshev多项式与 ![n](https://www.zhihu.com/equation?tex=n) 倍角公式其实是统一的。

我们考虑 ![T_{n+1}(cos\theta)=cos(n\theta+\theta)=cosn\theta cos\theta-sinn\theta sin\theta](https://www.zhihu.com/equation?tex=T_%7Bn%2B1%7D%28cos%5Ctheta%29%3Dcos%28n%5Ctheta%2B%5Ctheta%29%3Dcosn%5Ctheta+cos%5Ctheta-sinn%5Ctheta+sin%5Ctheta)

然而式子中的 ![sin](https://www.zhihu.com/equation?tex=sin) 项十分难以处理。

我们想到：不妨探究 ![T_{n-1}](https://www.zhihu.com/equation?tex=T_%7Bn-1%7D) 的形式，其中也会有相同的项可以通过运算来消去。

![T_{n-1}(cos\theta)=cos(n\theta-\theta)=cosn\theta cos\theta+sinn\theta sin\theta](https://www.zhihu.com/equation?tex=T_%7Bn-1%7D%28cos%5Ctheta%29%3Dcos%28n%5Ctheta-%5Ctheta%29%3Dcosn%5Ctheta+cos%5Ctheta%2Bsinn%5Ctheta+sin%5Ctheta)

我们发现： ![T_{n-1}(cos\theta)+T_{n+1}(cos\theta)=2T_n(cos\theta) cos\theta](https://www.zhihu.com/equation?tex=T_%7Bn-1%7D%28cos%5Ctheta%29%2BT_%7Bn%2B1%7D%28cos%5Ctheta%29%3D2T_n%28cos%5Ctheta%29+cos%5Ctheta)

由此我们得到**Chebyshev多项式的递推公式：**

![T_{n+1}(x)=2xT_n(x)-T_{n-1}(x)](https://www.zhihu.com/equation?tex=T_%7Bn%2B1%7D%28x%29%3D2xT_n%28x%29-T_%7Bn-1%7D%28x%29)

我们现在得以很轻松地求得任意次的Chebyshev多项式。

接下来我们再来验证其正交性。

我们将会证明：**取区间 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) ，权函数 ![w(x)=\frac{1}{\sqrt{1-x^2}}](https://www.zhihu.com/equation?tex=w%28x%29%3D%5Cfrac%7B1%7D%7B%5Csqrt%7B1-x%5E2%7D%7D) ，则由Gram-Schimidt方法生成的正交多项式就是Chebyshev多项式。**

考虑 ![i\neq j,\ \int_{-1}^1\frac{T_i(x)T_j(x)}{\sqrt{1-x^2}}dx](https://www.zhihu.com/equation?tex=i%5Cneq+j%2C%5C+%5Cint_%7B-1%7D%5E1%5Cfrac%7BT_i%28x%29T_j%28x%29%7D%7B%5Csqrt%7B1-x%5E2%7D%7Ddx)

容易联想到进行积分换元的操作，令 ![x=cost,\ t\in [0,\pi]](https://www.zhihu.com/equation?tex=x%3Dcost%2C%5C+t%5Cin+%5B0%2C%5Cpi%5D)

则原式即为 ![\int_0^\pi cosit\ cosjt\ dt](https://www.zhihu.com/equation?tex=%5Cint_0%5E%5Cpi+cosit%5C+cosjt%5C+dt) ，显然为 ![0](https://www.zhihu.com/equation?tex=0) 。

而再考虑 ![\int_{-1}^1\frac{T_i^2(x)}{\sqrt{1-x^2}}dx](https://www.zhihu.com/equation?tex=%5Cint_%7B-1%7D%5E1%5Cfrac%7BT_i%5E2%28x%29%7D%7B%5Csqrt%7B1-x%5E2%7D%7Ddx)

同样地进行积分换元操作，令 ![x=cost,\ t\in [0,\pi]](https://www.zhihu.com/equation?tex=x%3Dcost%2C%5C+t%5Cin+%5B0%2C%5Cpi%5D)

原式即为 ![\int_0^\pi cos^2itdt=\frac{\pi}{2}](https://www.zhihu.com/equation?tex=%5Cint_0%5E%5Cpi+cos%5E2itdt%3D%5Cfrac%7B%5Cpi%7D%7B2%7D) 。

故我们成功地验证了Chebyshev多项式的正交性。


下面，我们简要地介绍Chebyshev多项式的一些性质，读者通过自行计算容易验证。

**定理（Chebyshev多项式的零点）**

**![T_n(x)](https://www.zhihu.com/equation?tex=T_n%28x%29) 在 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 中有 ![n](https://www.zhihu.com/equation?tex=n) 个单根，分别为 ![x_k=cos(\frac{2k-1}{2n}\pi),\ k=1,2,...,n](https://www.zhihu.com/equation?tex=x_k%3Dcos%28%5Cfrac%7B2k-1%7D%7B2n%7D%5Cpi%29%2C%5C+k%3D1%2C2%2C...%2Cn) 。**

**定理（Chebyshev多项式的极值点）**

**![T_n(x)](https://www.zhihu.com/equation?tex=T_n%28x%29) 在 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 中有 ![n+1](https://www.zhihu.com/equation?tex=n%2B1) 个极值点，为 ![x_k=cos(\frac{k}{n}\pi),\ k=0,1,...,n](https://www.zhihu.com/equation?tex=x_k%3Dcos%28%5Cfrac%7Bk%7D%7Bn%7D%5Cpi%29%2C%5C+k%3D0%2C1%2C...%2Cn) ，且对于每个极值点，其极值为 ![T_n(x_k)=(-1)^k](https://www.zhihu.com/equation?tex=T_n%28x_k%29%3D%28-1%29%5Ek)**

为了给出Chebyshev多项式的关键性质，我们定义 ![\hat{T}_n(x)](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_n%28x%29) 为将 ![T_n(x)](https://www.zhihu.com/equation?tex=T_n%28x%29) 首项系数化为 ![1](https://www.zhihu.com/equation?tex=1) 后得到的 ![n](https://www.zhihu.com/equation?tex=n) 次首一的Chebyshev多项式。

由递推公式，容易发现 ![T_n(x)](https://www.zhihu.com/equation?tex=T_n%28x%29) 的首项系数为 ![2^n](https://www.zhihu.com/equation?tex=2%5En) 。实质上 ![\hat{T}_n(x)=\frac{T_n(x)}{2^{n-1}}(n\geq 1)](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_n%28x%29%3D%5Cfrac%7BT_n%28x%29%7D%7B2%5E%7Bn-1%7D%7D%28n%5Cgeq+1%29) 。

下面我们给出Chebyshev多项式最重要的性质，我称其为min-max性。

**定理（Chebyshev多项式的min-max性）**

**![\hat{T}_n(x)](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_n%28x%29) 为![n](https://www.zhihu.com/equation?tex=n) 次首一的Chebyshev多项式。则任取 ![n](https://www.zhihu.com/equation?tex=n) 次首一多项式 ![P_n(x)](https://www.zhihu.com/equation?tex=P_n%28x%29) ， ![\frac{1}{2^{n-1}}=max|\hat{T}_n(x)|\leq max|P_n(x)| ,\ x\in[-1,1]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%5E%7Bn-1%7D%7D%3Dmax%7C%5Chat%7BT%7D_n%28x%29%7C%5Cleq+max%7CP_n%28x%29%7C+%2C%5C+x%5Cin%5B-1%2C1%5D) ，等号当且仅当**![P_n(x)=\hat{T}_n(x)](https://www.zhihu.com/equation?tex=P_n%28x%29%3D%5Chat%7BT%7D_n%28x%29)**成立。**

证明：

反证，假设存在 ![P_n(x),maxP_n(x)\leq max\hat{T}_n(x)](https://www.zhihu.com/equation?tex=P_n%28x%29%2CmaxP_n%28x%29%5Cleq+max%5Chat%7BT%7D_n%28x%29)

考虑 ![Q(x)=\hat{T}_n(x)-P_n(x)](https://www.zhihu.com/equation?tex=Q%28x%29%3D%5Chat%7BT%7D_n%28x%29-P_n%28x%29) ， ![deg \ Q\leq n-1](https://www.zhihu.com/equation?tex=deg+%5C+Q%5Cleq+n-1) 。

而注意到 ![\hat{T}_n](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_n) 有 ![n+1](https://www.zhihu.com/equation?tex=n%2B1) 个极值点 ![x_k=cos(\frac{k}{n}\pi),\ k=0,1,...,n](https://www.zhihu.com/equation?tex=x_k%3Dcos%28%5Cfrac%7Bk%7D%7Bn%7D%5Cpi%29%2C%5C+k%3D0%2C1%2C...%2Cn) 。

故考虑 ![Q(x_k)](https://www.zhihu.com/equation?tex=Q%28x_k%29) ，容易发现当 ![k](https://www.zhihu.com/equation?tex=k) 为奇数时， ![Q(x_k)\leq 0](https://www.zhihu.com/equation?tex=Q%28x_k%29%5Cleq+0) ；而当 ![k](https://www.zhihu.com/equation?tex=k) 为偶数时， ![Q(x_k)\geq 0](https://www.zhihu.com/equation?tex=Q%28x_k%29%5Cgeq+0)

由连续函数的介值定理， ![Q](https://www.zhihu.com/equation?tex=Q) 在 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 中至少有 ![n](https://www.zhihu.com/equation?tex=n) 个不同零点。而 ![deg \ Q\leq n-1](https://www.zhihu.com/equation?tex=deg+%5C+Q%5Cleq+n-1) ，故当且仅当 ![Q=0](https://www.zhihu.com/equation?tex=Q%3D0) 时成立。

故定理得证。


这个定理告诉我们首一Chebyshev不等式具有独特的性质：**在 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 上在所有首一多项式中使得绝对值的最大值最小的多项式，即其上下界是所有首一多项式中最紧的。**

这个性质乍看之下很绕，但是下面我们将基于此性质给出其应用，读者可以更好地理解。


**Chebyshev多项式的第一项应用是改进Lagrange插值方法中的结点选取方法。**

读者应该还记得取定插值结点 ![x_0,...,x_n](https://www.zhihu.com/equation?tex=x_0%2C...%2Cx_n)** ，![n](https://www.zhihu.com/equation?tex=n) 阶Lagrange插值多项式的余项**为 ![\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)...(x-x_n)](https://www.zhihu.com/equation?tex=%5Cfrac%7Bf%5E%7B%28n%2B1%29%7D%28%5Cxi%29%7D%7B%28n%2B1%29%21%7D%28x-x_0%29...%28x-x_n%29)。

我们现在的问题是：**在区间 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 上有函数 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) ，我们要如何取插值结点构造Lagrange插值多项式才能使其最优呢？**

我们要最优化Lagrange多项式，一个很自然的想法就是去使得余项最小化。然而余项最小化的计算很复杂。我们退而求其次，不如**最小化余项的最大值（即余项的界）**。即我们要最小化 ![max|(x-x_0)(x-x_1)...(x-x_n)|\ \ ,x\in[-1,1]](https://www.zhihu.com/equation?tex=max%7C%28x-x_0%29%28x-x_1%29...%28x-x_n%29%7C%5C+%5C+%2Cx%5Cin%5B-1%2C1%5D)

我们惊奇地发现：这**与Chebyshev多项式具有的min-max性质完全吻合**。

我们的做法很简单：令 ![(x-x_0)(x-x_1)...(x-x_n)=\hat{T}_{n+1}(x)](https://www.zhihu.com/equation?tex=%28x-x_0%29%28x-x_1%29...%28x-x_n%29%3D%5Chat%7BT%7D_%7Bn%2B1%7D%28x%29) 即可。

那么我们**选取的插值结点 ![x_0,...,x_n](https://www.zhihu.com/equation?tex=x_0%2C...%2Cx_n) 就应该是 ![\hat{T}_{n+1}(x)](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_%7Bn%2B1%7D%28x%29) 的所有零点**。

故我们选取![\hat{T}_{n+1}(x)](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_%7Bn%2B1%7D%28x%29) 的所有零点![x_0,...,x_n](https://www.zhihu.com/equation?tex=x_0%2C...%2Cx_n)作为插值结点得到Lagrange插值多项式 ![P(x)](https://www.zhihu.com/equation?tex=P%28x%29) ，则我们不难得到： ![max|f(x)-P(x)|\leq \frac{max|f^{(n+1)}(x)|}{2^n(n+1)!},\ \ x\in[-1,1]](https://www.zhihu.com/equation?tex=max%7Cf%28x%29-P%28x%29%7C%5Cleq+%5Cfrac%7Bmax%7Cf%5E%7B%28n%2B1%29%7D%28x%29%7C%7D%7B2%5En%28n%2B1%29%21%7D%2C%5C+%5C+x%5Cin%5B-1%2C1%5D) 。

故**由Chebyshev多项式的根进行Lagrange插值的插值结点选取所得到的插值多项式在误差上界的意义下是最优的**。

读者容易进行推广：在任意区间 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 上，我们仅仅需要将其线性变换到 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 上选取完结点后再变换回 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 即可。Chebyshev插值方法事实上对任意区间都能够进行。

另外值得一提的是：**Chebyshev插值方法对于改善一般Lagrange插值方法所具有的Runge现象**（回忆形如 ![\frac{1}{1+(kx)^2}](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B1%2B%28kx%29%5E2%7D) 的Cauchy-Lorenz函数。由于其在区间 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 端点处高阶导数太大，Lagrange插值方法会造成阶数越高则误差反而越大的现象）**在估计区间内有着很好的效果。**


我们举一例进行解释说明。

例： ![f(x)=xe^x,\ x\in[0,1.5]](https://www.zhihu.com/equation?tex=f%28x%29%3Dxe%5Ex%2C%5C+x%5Cin%5B0%2C1.5%5D) ，利用三阶Chebyshev插值进行插值多项式构造。

解：

**时刻牢记Chebyshev多项式的正交性仅限于 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 区间**。

故我们首先应做的事是进行区间变换。

容易构造出 ![\frac{4}{3}x-1](https://www.zhihu.com/equation?tex=%5Cfrac%7B4%7D%7B3%7Dx-1) 为 ![[0,1.5]\rightarrow[-1,1]](https://www.zhihu.com/equation?tex=%5B0%2C1.5%5D%5Crightarrow%5B-1%2C1%5D) 的线性变换。

由于插值为三阶的，我们应取 ![T_4(x)](https://www.zhihu.com/equation?tex=T_4%28x%29) 的四个零点： ![cos\frac{\pi}{8},cos\frac{3\pi}{8},cos\frac{5\pi}{8},cos\frac{7\pi}{8}](https://www.zhihu.com/equation?tex=cos%5Cfrac%7B%5Cpi%7D%7B8%7D%2Ccos%5Cfrac%7B3%5Cpi%7D%7B8%7D%2Ccos%5Cfrac%7B5%5Cpi%7D%7B8%7D%2Ccos%5Cfrac%7B7%5Cpi%7D%7B8%7D)

我们将这些结点利用上述线性变换的逆变换变换回 ![[0,1.5]](https://www.zhihu.com/equation?tex=%5B0%2C1.5%5D) 中。

得到 ![x_0=1.443,x_1=1.037,x_2=0.463,x_3=0.057](https://www.zhihu.com/equation?tex=x_0%3D1.443%2Cx_1%3D1.037%2Cx_2%3D0.463%2Cx_3%3D0.057)

至此为止我们便求出了Lagrange插值所需的结点，接下来的步骤同Lagrange插值，此处不再赘述。完成插值即得到Chebyshev插值的结果。

读者可以自行验证：Chebyshev插值比起在区间中均匀地选取 ![4](https://www.zhihu.com/equation?tex=4) 个结点的Lagrange插值，误差要小得多。



**Chebyshev多项式的第二个应用则是在允许的误差范围内尽量减少多项式估计的次数，使得新估计与原估计相差尽可能小**。

事实上，我们利用的仍旧是Chebyshev多项式的min-max性。

我们的**问题是：我们现在有 ![P_n(x),degP_n=n](https://www.zhihu.com/equation?tex=P_n%28x%29%2CdegP_n%3Dn) ，我们希望找到 ![P_{n-1},degP_{n-1}=n-1](https://www.zhihu.com/equation?tex=P_%7Bn-1%7D%2CdegP_%7Bn-1%7D%3Dn-1) ，使得 ![max|P_n(x)-P_{n-1}(x)|,\ x\in[-1,1]](https://www.zhihu.com/equation?tex=max%7CP_n%28x%29-P_%7Bn-1%7D%28x%29%7C%2C%5C+x%5Cin%5B-1%2C1%5D) 尽可能地小。**

我们假设 ![P_n(x)=a_nx^n+...+a_0](https://www.zhihu.com/equation?tex=P_n%28x%29%3Da_nx%5En%2B...%2Ba_0) 。

同样地，我们只需要令 ![\frac{P_n(x)-P_{n-1}(x)}{a_n}=\hat{T}_n(x)](https://www.zhihu.com/equation?tex=%5Cfrac%7BP_n%28x%29-P_%7Bn-1%7D%28x%29%7D%7Ba_n%7D%3D%5Chat%7BT%7D_n%28x%29) 即可利用到Chebyshev多项式的性质，最小化误差上界。

那么 ![P_{n-1}=P_n-a_n\hat{T}_n](https://www.zhihu.com/equation?tex=P_%7Bn-1%7D%3DP_n-a_n%5Chat%7BT%7D_n)** 即为所求的低次多项式估计，且在误差上界的意义下是最优的**。

而且， ![max|P_n(x)-P_{n-1}(x)|=\frac{|a_n|}{2^{n-1}},\ x\in[-1,1]](https://www.zhihu.com/equation?tex=max%7CP_n%28x%29-P_%7Bn-1%7D%28x%29%7C%3D%5Cfrac%7B%7Ca_n%7C%7D%7B2%5E%7Bn-1%7D%7D%2C%5C+x%5Cin%5B-1%2C1%5D) 。

我么下举一例进一步说明。

例：

对于 ![f(x)=e^x,P_4(x)=1+x+\frac{x^2}{2}+\frac{x^3}{6}+\frac{x^4}{24}](https://www.zhihu.com/equation?tex=f%28x%29%3De%5Ex%2CP_4%28x%29%3D1%2Bx%2B%5Cfrac%7Bx%5E2%7D%7B2%7D%2B%5Cfrac%7Bx%5E3%7D%7B6%7D%2B%5Cfrac%7Bx%5E4%7D%7B24%7D) ，在区间 ![[-1,1]](https://www.zhihu.com/equation?tex=%5B-1%2C1%5D) 上估计。已知目前误差上界为 ![0.023](https://www.zhihu.com/equation?tex=0.023) 。现在想在保持误差上界小于 ![0.05](https://www.zhihu.com/equation?tex=0.05) 的条件下尽量降低多项式估计的次数。

解：

现在要求 ![3](https://www.zhihu.com/equation?tex=3) 次多项式估计 ![P_3](https://www.zhihu.com/equation?tex=P_3) 。

那么为了使得误差上界最小， ![24(P_4-P_3)=\hat{T}_4](https://www.zhihu.com/equation?tex=24%28P_4-P_3%29%3D%5Chat%7BT%7D_4) 。

即 ![P_3=P_4-\frac{1}{24}\hat{T}_4](https://www.zhihu.com/equation?tex=P_3%3DP_4-%5Cfrac%7B1%7D%7B24%7D%5Chat%7BT%7D_4) 。

根据Chebyshev多项式的递推公式，容易求得 ![T_4=8x^4-8x^2+1](https://www.zhihu.com/equation?tex=T_4%3D8x%5E4-8x%5E2%2B1)

则 ![\hat{T}_4=x^4-x^2+\frac{1}{8}](https://www.zhihu.com/equation?tex=%5Chat%7BT%7D_4%3Dx%5E4-x%5E2%2B%5Cfrac%7B1%7D%7B8%7D)

求得 ![P_3=\frac{191}{192}+x+\frac{13}{24}x^2+\frac{1}{6}x^3](https://www.zhihu.com/equation?tex=P_3%3D%5Cfrac%7B191%7D%7B192%7D%2Bx%2B%5Cfrac%7B13%7D%7B24%7Dx%5E2%2B%5Cfrac%7B1%7D%7B6%7Dx%5E3)

此时的误差上界为 ![0.023+\frac{1}{192}<0.05](https://www.zhihu.com/equation?tex=0.023%2B%5Cfrac%7B1%7D%7B192%7D%3C0.05) 。

若我们将次数降低为 ![2](https://www.zhihu.com/equation?tex=2) 次，则误差上界将变为 ![0.023+\frac{1}{192}+\frac{1}{24}>0.05](https://www.zhihu.com/equation?tex=0.023%2B%5Cfrac%7B1%7D%7B192%7D%2B%5Cfrac%7B1%7D%7B24%7D%3E0.05) ，不符合要求。故最终结果为 ![P_3](https://www.zhihu.com/equation?tex=P_3) 。

关于Chebyshev多项式的初步介绍就到此为止。**我们介绍了Chebyshev多项式的定义，验证了其正交性，给出了其零点与极值点的情况。最重要地，我们介绍了其min-max性，并在此基础上衍生出Chebyshev插值方法以及对多项式估计尽可能维持精度地降次的方法**。



**Fourier展开及估计**

最后，我们简略地介绍Fourier展开以及其在估计中的应用。

基于大家在数学分析中的学习，一定对于Fourier展开以及Fourier级数的敛散性有着很好的把握。

故对于**连续函数的Fourier展开**，在此不再赘述，而是一笔带过。

对于 ![[-\pi,\pi]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C%5Cpi%5D) 上的连续函数 ![f](https://www.zhihu.com/equation?tex=f) ，其Fourier展开就是其最小二乘估计。

具有形式 ![S_n(x)=\frac{a_0}{2}+a_ncosnx+\sum_{k=1}^{n-1}(a_kcoskx+b_ksinkx)](https://www.zhihu.com/equation?tex=S_n%28x%29%3D%5Cfrac%7Ba_0%7D%7B2%7D%2Ba_ncosnx%2B%5Csum_%7Bk%3D1%7D%5E%7Bn-1%7D%28a_kcoskx%2Bb_ksinkx%29)

由于 ![1,sinx,cosx,...,sin(n-1)x,cos(n-1)x,cosnx](https://www.zhihu.com/equation?tex=1%2Csinx%2Ccosx%2C...%2Csin%28n-1%29x%2Ccos%28n-1%29x%2Ccosnx) 作为一组**基的正交性**。

回忆我们在上文提及过的，其最小二乘解就是 ![a_k=\frac{1}{\pi}\int_{-\pi}^\pi f(x)coskxdx](https://www.zhihu.com/equation?tex=a_k%3D%5Cfrac%7B1%7D%7B%5Cpi%7D%5Cint_%7B-%5Cpi%7D%5E%5Cpi+f%28x%29coskxdx) ， ![b_k=\frac{1}{\pi}\int_{-\pi}^\pi f(x)sinkxdx](https://www.zhihu.com/equation?tex=b_k%3D%5Cfrac%7B1%7D%7B%5Cpi%7D%5Cint_%7B-%5Cpi%7D%5E%5Cpi+f%28x%29sinkxdx) 。


我们主要关注的是Fourier级数在处理**离散的样本点的估计**拟合时所得到的最小二乘解。

事实上，这与连续形式的Fourier展开的本质是相同的。

我们同样地，先探讨在 ![[-\pi,\pi]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C%5Cpi%5D) 上拟合的情况。

不妨**假设现在有 ![2m](https://www.zhihu.com/equation?tex=2m) 个样本点 ![(x_i,y_i),\ (i=0,...,2m-1)](https://www.zhihu.com/equation?tex=%28x_i%2Cy_i%29%2C%5C+%28i%3D0%2C...%2C2m-1%29) ，并且假设区间 ![[-\pi,\pi]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C%5Cpi%5D) 被![2m](https://www.zhihu.com/equation?tex=2m)等分，即 ![x_j=-\pi+\frac{j}{m}\pi,\ (j=0,...,2m-1)](https://www.zhihu.com/equation?tex=x_j%3D-%5Cpi%2B%5Cfrac%7Bj%7D%7Bm%7D%5Cpi%2C%5C+%28j%3D0%2C...%2C2m-1%29) 。**

我们的**目标是：求得三角估计式 ![S_n(x)](https://www.zhihu.com/equation?tex=S_n%28x%29) ，最小化误差函数 ![E=\sum_{j=0}^{2m-1}[y_j-S_n(x_j)]^2](https://www.zhihu.com/equation?tex=E%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7D%5By_j-S_n%28x_j%29%5D%5E2) 。**

当然 ![S_n(x)](https://www.zhihu.com/equation?tex=S_n%28x%29) 仍旧具有Fourier展开的形式： ![\frac{a_0}{2}+a_ncosnx+\sum_{k=1}^{n-1}(a_kcoskx+b_ksinkx)](https://www.zhihu.com/equation?tex=%5Cfrac%7Ba_0%7D%7B2%7D%2Ba_ncosnx%2B%5Csum_%7Bk%3D1%7D%5E%7Bn-1%7D%28a_kcoskx%2Bb_ksinkx%29) 。

注意到：在之前关于连续形式情况的讨论中，我们利用到了三角函数作为空间基的正交性，大大简化了表出系数 ![a_k,b_k](https://www.zhihu.com/equation?tex=a_k%2Cb_k) 的计算。我们很自然地要问：在离散形式情况下，三角函数作为空间的基还具备正交性吗？

为了产生正交性这个概念，我们需要先定义内积。

在连续形式中，我们将 ![f(x),g(x)](https://www.zhihu.com/equation?tex=f%28x%29%2Cg%28x%29) 内积推广定义为 ![\int_{-1}^1w(x)f(x)g(x)dx](https://www.zhihu.com/equation?tex=%5Cint_%7B-1%7D%5E1w%28x%29f%28x%29g%28x%29dx) 。

那么在离散形式中，我们容易**对内积进行定义上的推广：我们将 ![f(x),g(x)](https://www.zhihu.com/equation?tex=f%28x%29%2Cg%28x%29) 的内积定义为 ![\sum_{j=0}^{2m-1}f(x_j)g(x_j)](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Df%28x_j%29g%28x_j%29) 。**

这个定义满足内积所必须具备的三条性质，具体验证交给读者完成。

有了内积的推广定义，我们可以利用下面的定理来给出答案。

**定理（离散形式Fourier展开中三角基的正交性）**

**若 ![r](https://www.zhihu.com/equation?tex=r) 不为 ![2m](https://www.zhihu.com/equation?tex=2m) 的倍数，则 ![\sum_{j=0}^{2m-1}cosrx_j=\sum_{j=0}^{2m-1}sinrx_j=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcosrx_j%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsinrx_j%3D0) 。**

**进一步地，若![r](https://www.zhihu.com/equation?tex=r) 不为 ![m](https://www.zhihu.com/equation?tex=m) 的倍数，则 ![\sum_{j=0}^{2m-1}cos^2rx_j=\sum_{j=0}^{2m-1}sin^2rx_j=m](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcos%5E2rx_j%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsin%5E2rx_j%3Dm) 。**

**故我们有：**![\sum_{j=0}^{2m-1}coskx_jsinlx_j=0\ (k,l=0,1,...,2m-1,\ k\neq l)](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcoskx_jsinlx_j%3D0%5C+%28k%2Cl%3D0%2C1%2C...%2C2m-1%2C%5C+k%5Cneq+l%29) 。

证明：

在此我们介绍一个常用的技巧：

**处理三角函数各种等间距结点求和问题时利用Euler公式进行变形后计算。**

此处考虑 ![\sum_{j=0}^{2m-1}cosrx_j+i\sum_{j=0}^{2m-1}sinrx_j=\sum_{j=0}^{2m-1}e^{\frac{irj\pi}{m}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcosrx_j%2Bi%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsinrx_j%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7De%5E%7B%5Cfrac%7Birj%5Cpi%7D%7Bm%7D%7D)

我们发现这就是一个等比数列求和问题，问题变得十分简单。

由于![r](https://www.zhihu.com/equation?tex=r) 不为 ![2m](https://www.zhihu.com/equation?tex=2m) 的倍数（公比不为 ![1](https://www.zhihu.com/equation?tex=1) ），容易得到： ![\sum_{j=0}^{2m-1}e^{\frac{irj\pi}{m}}=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7De%5E%7B%5Cfrac%7Birj%5Cpi%7D%7Bm%7D%7D%3D0)

故实部虚部均为 ![0](https://www.zhihu.com/equation?tex=0) ， ![\sum_{j=0}^{2m-1}cosrx_j=\sum_{j=0}^{2m-1}sinrx_j=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcosrx_j%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsinrx_j%3D0) 。

故对于 ![\sum_{j=0}^{2m-1}coskx_jsinlx_j\ (k,l=0,1,...,2m-1,\ k\neq l)](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcoskx_jsinlx_j%5C+%28k%2Cl%3D0%2C1%2C...%2C2m-1%2C%5C+k%5Cneq+l%29)

利用积化和差，我们有原式为 ![\sum_{j=0}^{2m-1}coskx_jsinlx_j=\frac{1}{2}(\sum_{j=0}^{2m-1}sin(l+k)x_j+\sum_{j=0}^{2m-1}sin(l-k)x_j)](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcoskx_jsinlx_j%3D%5Cfrac%7B1%7D%7B2%7D%28%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsin%28l%2Bk%29x_j%2B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsin%28l-k%29x_j%29)

由于 ![l+k,l-k](https://www.zhihu.com/equation?tex=l%2Bk%2Cl-k) 均不为 ![2m](https://www.zhihu.com/equation?tex=2m) 的倍数，容易知道 ![\sum_{j=0}^{2m-1}coskx_jsinlx_j=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcoskx_jsinlx_j%3D0) 。

对于 ![\sum_{j=0}^{2m-1}cos^2rx_j=\sum_{j=0}^{2m-1}sin^2rx_j=m](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcos%5E2rx_j%3D%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsin%5E2rx_j%3Dm) 的证明，我们只需要利用二倍角公式进行化简后即可同上所述利用Euler公式处理，留给读者自证。


上述定理无疑是重要的。由于三角函数基在离散Fourier展开的形式下仍旧具有正交性，我们对于表出系数 ![a_k,b_k](https://www.zhihu.com/equation?tex=a_k%2Cb_k) 的计算再次被大大简化了。

回忆我们在前文有关于正交基下最小二乘解表出系数的结论，我们容易对其进行推广。

回忆**最小二乘解的本质就是 ![y_j](https://www.zhihu.com/equation?tex=y_j) 在三角函数正交基下的坐标**。

故我们有： ![a_k=\frac{\sum_{j=0}^{2m-1}y_jcoskx_j}{\sum_{j=0}^{2m-1}cos^2kx_j}=\frac{\sum_{j=0}^{2m-1}y_jcoskx_j}{m}](https://www.zhihu.com/equation?tex=a_k%3D%5Cfrac%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dy_jcoskx_j%7D%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dcos%5E2kx_j%7D%3D%5Cfrac%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dy_jcoskx_j%7D%7Bm%7D)

类似地， ![b_k=\frac{\sum_{j=0}^{2m-1}y_jsinkx_j}{\sum_{j=0}^{2m-1}sin^2kx_j}=\frac{\sum_{j=0}^{2m-1}y_jsinkx_j}{m}](https://www.zhihu.com/equation?tex=b_k%3D%5Cfrac%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dy_jsinkx_j%7D%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dsin%5E2kx_j%7D%3D%5Cfrac%7B%5Csum_%7Bj%3D0%7D%5E%7B2m-1%7Dy_jsinkx_j%7D%7Bm%7D)

而![S_n(x)=\frac{a_0}{2}+a_ncosnx+\sum_{k=1}^{n-1}(a_kcoskx+b_ksinkx)](https://www.zhihu.com/equation?tex=S_n%28x%29%3D%5Cfrac%7Ba_0%7D%7B2%7D%2Ba_ncosnx%2B%5Csum_%7Bk%3D1%7D%5E%7Bn-1%7D%28a_kcoskx%2Bb_ksinkx%29)

这就是**离散形式的Fourier最小二乘估计**。

最后，不得不提的是我们上述关于Fourier估计的讨论均局限于 ![[-\pi,\pi]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C%5Cpi%5D) 。但是，对任意有限区间 ![[a,b]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D) 我们事实上都可以利用线性变换映射到 ![[-\pi,\pi]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C%5Cpi%5D)上处理完后再利用逆映射转换回去。（这是老生常谈了，参照前面的做法即可）


关于最小二乘估计及其一些有趣的推广与研究我们就介绍到这里。读者主要要对空间**正交基**的性质具有清晰的了解与把握，同时能够意识到其优势，并且结合线性代数的知识巧妙地对最小二乘解的求解进行转化。关于有理函数估计，我觉得意义不大故没有涉及，有兴趣的读者可以进一步了解Pade估计，Chebyshev有理估计等方法。

谢谢各位的阅读！

