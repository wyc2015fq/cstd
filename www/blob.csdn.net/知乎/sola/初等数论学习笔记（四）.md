# 初等数论学习笔记（四） - 知乎
# 

第四部分主要讨论单变元同余方程（后面的内容可能会更难一些，但是会越来越有趣。随着手中工具的升级，能够得到更多新的结果）

**单变元同余方程**

**一、基本问题与概念**

在这个部分中，我们主要会考虑形如 ![f(x)=a_0x^n+a_1x^{n-1}+...+a_n\ (a_0,a_1,...,a_n\in \mathbb{Z})](https://www.zhihu.com/equation?tex=f%28x%29%3Da_0x%5En%2Ba_1x%5E%7Bn-1%7D%2B...%2Ba_n%5C+%28a_0%2Ca_1%2C...%2Ca_n%5Cin+%5Cmathbb%7BZ%7D%29) 的多项式。对于给定的 ![m\in\mathbb{N}](https://www.zhihu.com/equation?tex=m%5Cin%5Cmathbb%7BN%7D) ，我们想要研究的问题是：如何求出所有 ![x\in \mathbb{Z},\ s.t.\ f(x)\equiv 0(mod\ m)](https://www.zhihu.com/equation?tex=x%5Cin+%5Cmathbb%7BZ%7D%2C%5C+s.t.%5C+f%28x%29%5Cequiv+0%28mod%5C+m%29) 。

想要立马直接地给出这样一个问题的回答是困难的，但是我们可以一步步地从解决一些更简单的情况入手。

既然不能给出这样一个同余方程所有的解，我们自然地想到：所有的解之间是否存在联系呢？（同余的条件比等于弱得多）我们发现：**解的结构**可能是有规律可循的。

**命题：（同余方程解的结构）**

**若 ![x_0](https://www.zhihu.com/equation?tex=x_0) 为上述同余方程的一个解，则 ![\forall t\in \mathbb{Z},\ x=x_0+mt](https://www.zhihu.com/equation?tex=%5Cforall+t%5Cin+%5Cmathbb%7BZ%7D%2C%5C+x%3Dx_0%2Bmt) 都是该方程的解。**

要证明该命题，我们只需代入 ![x](https://www.zhihu.com/equation?tex=x) ，用二项式定理展开即可得证（除了 ![x_0^k](https://www.zhihu.com/equation?tex=x_0%5Ek)外均为 ![m](https://www.zhihu.com/equation?tex=m) 的倍数）。

此命题告诉我们：我们事实上只需要考虑 ![x=0,1,2,...,m-1](https://www.zhihu.com/equation?tex=x%3D0%2C1%2C2%2C...%2Cm-1) 的情况即可，解必定落在这 ![m](https://www.zhihu.com/equation?tex=m) 个值之间。



**二、线性方程**

我们先考虑最简单的次数为1的同余方程

**![ax\equiv b(mod\ m)](https://www.zhihu.com/equation?tex=ax%5Cequiv+b%28mod%5C+m%29) ，其中 ![m](https://www.zhihu.com/equation?tex=m) 不整除 ![a](https://www.zhihu.com/equation?tex=a) 。**（否则就是平凡情况）

我们要得到的解的形式为 ![x\equiv x_0](https://www.zhihu.com/equation?tex=x%5Cequiv+x_0) 。

这里初步的想法（抽象代数意义上）是：如果 ![a](https://www.zhihu.com/equation?tex=a) 在这里是可逆的，我们就能进行在左右端都乘上 ![a](https://www.zhihu.com/equation?tex=a) 的逆元，便能得到方程的解。

接着，回忆我们在完全剩余系中提及的内容： ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS) 作为交换幺环，其中元素可逆当且仅当它与 ![m](https://www.zhihu.com/equation?tex=m) 互素。所以很自然地，我们进行分类讨论。我们先考虑 ![(a,m)=1](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D1) 的情况，再考虑其他情况。

情况1： ![(a,m)=1](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D1)

回忆在笔记（一）的习题中提及的互素的性质， ![\exists k,l,\ s.t.\ ka+lm=1\Rightarrow\ \exists k,s.t.\ ka\equiv 1(mod\ m)](https://www.zhihu.com/equation?tex=%5Cexists+k%2Cl%2C%5C+s.t.%5C+ka%2Blm%3D1%5CRightarrow%5C+%5Cexists+k%2Cs.t.%5C+ka%5Cequiv+1%28mod%5C+m%29) （ ![k](https://www.zhihu.com/equation?tex=k) 即为 ![a](https://www.zhihu.com/equation?tex=a) 的逆元）

在方程两边同乘 ![k](https://www.zhihu.com/equation?tex=k) 得： ![x\equiv kb(mod\ m)](https://www.zhihu.com/equation?tex=x%5Cequiv+kb%28mod%5C+m%29) 为方程的唯一解。

（至于 ![k](https://www.zhihu.com/equation?tex=k) 如何方便地求出，我们在此暂时不关心，此处只利用 ![k](https://www.zhihu.com/equation?tex=k) 的存在性，在后文可能会给出 ![k](https://www.zhihu.com/equation?tex=k) 的求法）

情况2： ![(a,m)=d>1](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3Dd%3E1)

容易发现的是，若 ![d](https://www.zhihu.com/equation?tex=d) 不整除 ![b](https://www.zhihu.com/equation?tex=b) ，方程无解。

下设 ![d|b](https://www.zhihu.com/equation?tex=d%7Cb) 。

方程可写为 ![\exists t \in \mathbb{Z},ax-b=mt\Rightarrow \frac{a}{d}x-\frac{b}{d}=\frac{m}{d}t\Rightarrow \frac{a}{d}x\equiv \frac{b} {d} (mod\ \frac{m}{d})](https://www.zhihu.com/equation?tex=%5Cexists+t+%5Cin+%5Cmathbb%7BZ%7D%2Cax-b%3Dmt%5CRightarrow+%5Cfrac%7Ba%7D%7Bd%7Dx-%5Cfrac%7Bb%7D%7Bd%7D%3D%5Cfrac%7Bm%7D%7Bd%7Dt%5CRightarrow+%5Cfrac%7Ba%7D%7Bd%7Dx%5Cequiv+%5Cfrac%7Bb%7D+%7Bd%7D+%28mod%5C+%5Cfrac%7Bm%7D%7Bd%7D%29)

而 ![(\frac{a}{d},\frac{m}{d})=1](https://www.zhihu.com/equation?tex=%28%5Cfrac%7Ba%7D%7Bd%7D%2C%5Cfrac%7Bm%7D%7Bd%7D%29%3D1) ，故可应用情况1的结论， ![\exists x_0,x\equiv x_0(mod\ \frac{m}{d})](https://www.zhihu.com/equation?tex=%5Cexists+x_0%2Cx%5Cequiv+x_0%28mod%5C+%5Cfrac%7Bm%7D%7Bd%7D%29) 为唯一解。

下面要做的就是将 ![mod\ \frac{m}{d}](https://www.zhihu.com/equation?tex=mod%5C+%5Cfrac%7Bm%7D%7Bd%7D) 变为 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 。

![\exists t\in \mathbb{Z},s.t.\ x=x_0+\frac{m}{d}t](https://www.zhihu.com/equation?tex=%5Cexists+t%5Cin+%5Cmathbb%7BZ%7D%2Cs.t.%5C+x%3Dx_0%2B%5Cfrac%7Bm%7D%7Bd%7Dt) 要想消去分母上的 ![d](https://www.zhihu.com/equation?tex=d) ，我们只能对 ![t](https://www.zhihu.com/equation?tex=t) 进行一些变换，最容易想到的便是做 ![t](https://www.zhihu.com/equation?tex=t) 除以 ![d](https://www.zhihu.com/equation?tex=d) 的带余除法。即有 ![t=dt_1+b(0\leq b\leq d-1)](https://www.zhihu.com/equation?tex=t%3Ddt_1%2Bb%280%5Cleq+b%5Cleq+d-1%29)

则原式为 ![x=x_0+m_1b+mt\Rightarrow x\equiv x_0+m_1b(mod\ m),\ \ (b=0,1,...,d-1)](https://www.zhihu.com/equation?tex=x%3Dx_0%2Bm_1b%2Bmt%5CRightarrow+x%5Cequiv+x_0%2Bm_1b%28mod%5C+m%29%2C%5C+%5C+%28b%3D0%2C1%2C...%2Cd-1%29)

共有 ![d](https://www.zhihu.com/equation?tex=d) 个解。

对线性方程的解的情况进行一个总结：

![(a,m)=d,for\ \ ax\equiv b(mod\ m), \begin{cases} d \ solutions\ \ \ \ if\ d|b\\ no\ solution\ \ \ else \end{cases}](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3Dd%2Cfor%5C+%5C+ax%5Cequiv+b%28mod%5C+m%29%2C+%5Cbegin%7Bcases%7D+d+%5C+solutions%5C+%5C+%5C+%5C+if%5C+d%7Cb%5C%5C+no%5C+solution%5C+%5C+%5C+else+%5Cend%7Bcases%7D)



**三、一元同余方程组与中国剩余定理**

在这里，我们考虑较简单形式的一元同余方程组

![\begin{cases} x\equiv b_1(mod\ m_1)\\ x\equiv b_2(mod\ m_2)\\ ...\\ x\equiv b_k(mod\ m_k) \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+x%5Cequiv+b_1%28mod%5C+m_1%29%5C%5C+x%5Cequiv+b_2%28mod%5C+m_2%29%5C%5C+...%5C%5C+x%5Cequiv+b_k%28mod%5C+m_k%29+%5Cend%7Bcases%7D) 其中 ![m_1,m_2,...,m_k](https://www.zhihu.com/equation?tex=m_1%2Cm_2%2C...%2Cm_k) 两两互素。

同样地，对于较难直接求解的方程，我们先从解的结构入手进行研究：

**命题（一元同余方程组的解的结构）：（证略）**

**![若x_1,x_2均为解](https://www.zhihu.com/equation?tex=%E8%8B%A5x_1%2Cx_2%E5%9D%87%E4%B8%BA%E8%A7%A3) ，则 ![x_1-x_2](https://www.zhihu.com/equation?tex=x_1-x_2) 必为对应的齐次方程组的解 ![\Rightarrow x_1\equiv x_2(mod\ m_1m_2...m_k)](https://www.zhihu.com/equation?tex=%5CRightarrow+x_1%5Cequiv+x_2%28mod%5C+m_1m_2...m_k%29) ，且方程组的解在 ![mod\ m_1m_2...m_k](https://www.zhihu.com/equation?tex=mod%5C+m_1m_2...m_k) 的意义下唯一。**

在这里讨论的一元同余方程组中，我们假定了每个方程的模两两互素，即不存在非平凡的公共因子。正是由于这样的简化，使得我们得以“凑”出方程组的解。基本的思路是：求出第一个方程的解，并同时保证这个解为 ![m_2m_3...m_k](https://www.zhihu.com/equation?tex=m_2m_3...m_k) 的倍数，再求出第二个方程的解，并同时保证这个解为 ![m_1m_3m_4...m_k](https://www.zhihu.com/equation?tex=m_1m_3m_4...m_k) 的倍数。以此类推地，将这些解全都相加，即可得到方程组在 ![mod\ m_1m_2...m_k](https://www.zhihu.com/equation?tex=mod%5C+m_1m_2...m_k) 下的唯一解。

我们接下来给出求解次方程的步骤：

定义 ![M_i=\frac{m_1m_2...m_k}{m_i}(i=1,2,...k)](https://www.zhihu.com/equation?tex=M_i%3D%5Cfrac%7Bm_1m_2...m_k%7D%7Bm_i%7D%28i%3D1%2C2%2C...k%29) 。

由 ![m_1,...,m_k](https://www.zhihu.com/equation?tex=m_1%2C...%2Cm_k) 两两互素，得知 ![\forall i,\ (M_i,m_i)=1](https://www.zhihu.com/equation?tex=%5Cforall+i%2C%5C+%28M_i%2Cm_i%29%3D1)

回忆我们经常用到的互素的等价条件： ![\exists N_s,U_s,\ s.t.\ M_sN_s+U_sm_s=1](https://www.zhihu.com/equation?tex=%5Cexists+N_s%2CU_s%2C%5C+s.t.%5C+M_sN_s%2BU_sm_s%3D1)

故 ![M_sN_s\equiv 1(mod\ m_s)](https://www.zhihu.com/equation?tex=M_sN_s%5Cequiv+1%28mod%5C+m_s%29) （此时 ![N_s](https://www.zhihu.com/equation?tex=N_s) 为 ![M_s](https://www.zhihu.com/equation?tex=M_s) 在 ![mod\ m_s](https://www.zhihu.com/equation?tex=mod%5C+m_s) 意义下的乘法逆元）

则 ![M_1N_1b_1](https://www.zhihu.com/equation?tex=M_1N_1b_1) 就为满足我们要求的对于第一个方程的解，同理地， ![M_iN_ib_i](https://www.zhihu.com/equation?tex=M_iN_ib_i) 均为满足我们要求的对于第 ![i](https://www.zhihu.com/equation?tex=i) 个方程的解。

所以 **![x=M_1N_1b_1+M_2N_2b_2+...+M_kN_kb_k](https://www.zhihu.com/equation?tex=x%3DM_1N_1b_1%2BM_2N_2b_2%2B...%2BM_kN_kb_k) 为我们所求的 ![mod\ m_1m_2...m_k](https://www.zhihu.com/equation?tex=mod%5C+m_1m_2...m_k) 意义下的唯一解。**

上述一元同余方程组的求解过程便被称为**中国剩余定理。**

我们来看一个例子以进一步理解中国剩余定理的实际应用：


例：求最小的相邻的四个正整数，使得他们依次可以被 ![4,9,25,49](https://www.zhihu.com/equation?tex=4%2C9%2C25%2C49) 整除。

解：

设相邻整数为 ![x-1,x,x+1,x+2](https://www.zhihu.com/equation?tex=x-1%2Cx%2Cx%2B1%2Cx%2B2)

则求同余方程组 ![\begin{cases} x\equiv 1(mod\ 4)\\ x\equiv 0(mod\ 9)\\ x\equiv -1(mod\ 25)\\ x\equiv-2(mod\ 49) \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+x%5Cequiv+1%28mod%5C+4%29%5C%5C+x%5Cequiv+0%28mod%5C+9%29%5C%5C+x%5Cequiv+-1%28mod%5C+25%29%5C%5C+x%5Cequiv-2%28mod%5C+49%29+%5Cend%7Bcases%7D) ，注意到 ![4,9,25,49](https://www.zhihu.com/equation?tex=4%2C9%2C25%2C49) 两两互素。

利用中国剩余定理， ![M_1=9\times 25\times 49,\ M_2=4\times 25\times 49](https://www.zhihu.com/equation?tex=M_1%3D9%5Ctimes+25%5Ctimes+49%2C%5C+M_2%3D4%5Ctimes+25%5Ctimes+49)

![M_3=4\times 9\times 49,\ M_4=4\times 9\times 25](https://www.zhihu.com/equation?tex=M_3%3D4%5Ctimes+9%5Ctimes+49%2C%5C+M_4%3D4%5Ctimes+9%5Ctimes+25)

接下来，不难求出 ![N_1=-1,N_2=-2,N_3=9,N_4=-19](https://www.zhihu.com/equation?tex=N_1%3D-1%2CN_2%3D-2%2CN_3%3D9%2CN_4%3D-19)

故 ![x=M_1N_1b_1+M_2N_2b_2+...+M_4N_4b_4](https://www.zhihu.com/equation?tex=x%3DM_1N_1b_1%2BM_2N_2b_2%2B...%2BM_4N_4b_4)

解得 ![x\equiv 29349(mod\ 44100)](https://www.zhihu.com/equation?tex=x%5Cequiv+29349%28mod%5C+44100%29)

由所求为最小的正整数， ![x=29349](https://www.zhihu.com/equation?tex=x%3D29349)

所求四个相邻正整数为 ![29348,29349,29350,29351](https://www.zhihu.com/equation?tex=29348%2C29349%2C29350%2C29351) 。

注：关于此处 ![N_i](https://www.zhihu.com/equation?tex=N_i) 的求法，我们在（一）的习题中证明了 ![N_i](https://www.zhihu.com/equation?tex=N_i) 必定可以通过**Euclid算法**求出。事实上，还有更加简便的算法。一种计算方法是**直接利用同余关系进行拼凑**（这是当数较小时最常用的方法）。

例如：上例中， ![m_3=25,M_3=4\times 9\times 49](https://www.zhihu.com/equation?tex=m_3%3D25%2CM_3%3D4%5Ctimes+9%5Ctimes+49) ，要求 ![N_3](https://www.zhihu.com/equation?tex=N_3) ，使得 ![M_3N_3\equiv 1(mod\ 25)](https://www.zhihu.com/equation?tex=M_3N_3%5Cequiv+1%28mod%5C+25%29)

发现 ![M_3=2^221^2\equiv 2^24^2\equiv -11(mod \ 25)](https://www.zhihu.com/equation?tex=M_3%3D2%5E221%5E2%5Cequiv+2%5E24%5E2%5Cequiv+-11%28mod+%5C+25%29)

故 ![M_3N_3\equiv -11N_3\equiv1(mod\ 25)](https://www.zhihu.com/equation?tex=M_3N_3%5Cequiv+-11N_3%5Cequiv1%28mod%5C+25%29)

![2\equiv -22N_3\equiv 3N_3(mod\ 25)](https://www.zhihu.com/equation?tex=2%5Cequiv+-22N_3%5Cequiv+3N_3%28mod%5C+25%29)

![16\equiv 24N_3\equiv -N_3(mod\ 25)](https://www.zhihu.com/equation?tex=16%5Cequiv+24N_3%5Cequiv+-N_3%28mod%5C+25%29)

故可以取 ![N_3=-9](https://www.zhihu.com/equation?tex=N_3%3D-9) 。

但是上述两种方法都有缺陷（对较大的数过程会很复杂）。其实还有更一般的方法，要利用到**连分数**。（此处不给出证明，读者可自行了解）

命题：对于 ![(a,m)=1](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D1) ，求 ![k,s.t.\ ka\equiv1(mod\ m)](https://www.zhihu.com/equation?tex=k%2Cs.t.%5C+ka%5Cequiv1%28mod%5C+m%29) ，只需记 ![\frac{a}{m}=q_1+\frac{1}{q_2+...+\frac{1}{q_n}},q_n=(a,m)=1](https://www.zhihu.com/equation?tex=%5Cfrac%7Ba%7D%7Bm%7D%3Dq_1%2B%5Cfrac%7B1%7D%7Bq_2%2B...%2B%5Cfrac%7B1%7D%7Bq_n%7D%7D%2Cq_n%3D%28a%2Cm%29%3D1) ，令 ![\frac{P}{Q}=q_1+\frac{1}{q_2+...+\frac{1}{q_{n-1}}},(P,Q)=1](https://www.zhihu.com/equation?tex=%5Cfrac%7BP%7D%7BQ%7D%3Dq_1%2B%5Cfrac%7B1%7D%7Bq_2%2B...%2B%5Cfrac%7B1%7D%7Bq_%7Bn-1%7D%7D%7D%2C%28P%2CQ%29%3D1)

则 ![k=(-1)^nQ](https://www.zhihu.com/equation?tex=k%3D%28-1%29%5EnQ) 即为所求。

此处再给出上述命题的应用之例：

求解方程 ![355x\equiv 2(mod\ 113)](https://www.zhihu.com/equation?tex=355x%5Cequiv+2%28mod%5C+113%29)

解： 

![(355,113)=1](https://www.zhihu.com/equation?tex=%28355%2C113%29%3D1) ，有唯一解。

![\frac{355}{113}=3+\frac{1}{7+\frac{1}{15+1}},n=4](https://www.zhihu.com/equation?tex=%5Cfrac%7B355%7D%7B113%7D%3D3%2B%5Cfrac%7B1%7D%7B7%2B%5Cfrac%7B1%7D%7B15%2B1%7D%7D%2Cn%3D4)

![\frac{P}{Q}=3+\frac{1}{7+\frac{1}{15}}=\frac{333}{106}](https://www.zhihu.com/equation?tex=%5Cfrac%7BP%7D%7BQ%7D%3D3%2B%5Cfrac%7B1%7D%7B7%2B%5Cfrac%7B1%7D%7B15%7D%7D%3D%5Cfrac%7B333%7D%7B106%7D)

则 ![k=106](https://www.zhihu.com/equation?tex=k%3D106) ，满足 ![335k\equiv 1(mod\ 113)](https://www.zhihu.com/equation?tex=335k%5Cequiv+1%28mod%5C+113%29)

由第二章中结论， ![x\equiv106\times2=212\equiv99(mod\ 113)](https://www.zhihu.com/equation?tex=x%5Cequiv106%5Ctimes2%3D212%5Cequiv99%28mod%5C+113%29) 为解。


另外，当 ![m_1,m_2,...,m_k](https://www.zhihu.com/equation?tex=m_1%2Cm_2%2C...%2Cm_k) 不两两互素时该如何求解，读者可以自己进行思考，习题中将会举出具体的例子进行说明。



**四、 ![mod \ p](https://www.zhihu.com/equation?tex=mod+%5C+p) （素数）的同余方程与Wilson定理**

**本章中![p](https://www.zhihu.com/equation?tex=p) 为素数**

考虑形如 ![f(x)=a_0x^n+a_1x^{n-1}+...+a_n\ (a_0,a_1,...,a_n\in \mathbb{Z})](https://www.zhihu.com/equation?tex=f%28x%29%3Da_0x%5En%2Ba_1x%5E%7Bn-1%7D%2B...%2Ba_n%5C+%28a_0%2Ca_1%2C...%2Ca_n%5Cin+%5Cmathbb%7BZ%7D%29) 的多项式。对于给定的 ![m\in\mathbb{N}](https://www.zhihu.com/equation?tex=m%5Cin%5Cmathbb%7BN%7D) ，求出所有 ![x\in \mathbb{Z},\ s.t.\ f(x)\equiv 0(mod\ m)](https://www.zhihu.com/equation?tex=x%5Cin+%5Cmathbb%7BZ%7D%2C%5C+s.t.%5C+f%28x%29%5Cequiv+0%28mod%5C+m%29) 。

回忆在（三）中提及Fermat定理时，我们曾给出过一条有用的性质：若 ![p](https://www.zhihu.com/equation?tex=p) 为素数，则对任意正整数 ![x](https://www.zhihu.com/equation?tex=x) ， ![x^p\equiv x(mod\ p)](https://www.zhihu.com/equation?tex=x%5Ep%5Cequiv+x%28mod%5C+p%29) 成立。由此，我们只需要考虑**次数小于 ![p](https://www.zhihu.com/equation?tex=p)** 的多项式即可。（否则可用此性质进行降次）

接下来，我们将给出一个非常重要且常用的定理：

**定理（ ![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p) 同余方程解的个数）：若![f(x)=a_0x^n+a_1x^{n-1}+...+a_n\ (a_0,a_1,...,a_n\in \mathbb{Z})](https://www.zhihu.com/equation?tex=f%28x%29%3Da_0x%5En%2Ba_1x%5E%7Bn-1%7D%2B...%2Ba_n%5C+%28a_0%2Ca_1%2C...%2Ca_n%5Cin+%5Cmathbb%7BZ%7D%29)， ![f(x)\equiv 0(mod\ p)](https://www.zhihu.com/equation?tex=f%28x%29%5Cequiv+0%28mod%5C+p%29) 有多于 ![n](https://www.zhihu.com/equation?tex=n) 个 ![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p) 两两不同余的解，则 ![\forall 1\leq i\leq n,p|a_i](https://www.zhihu.com/equation?tex=%5Cforall+1%5Cleq+i%5Cleq+n%2Cp%7Ca_i) 。**

证明：

不妨设该方程有 ![n+1](https://www.zhihu.com/equation?tex=n%2B1) 个解： ![x_1,x_2,...,x_{n+1}](https://www.zhihu.com/equation?tex=x_1%2Cx_2%2C...%2Cx_%7Bn%2B1%7D) ，![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p) 两两不同余。

我们接着用一些多项式变形的技巧将 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 用因式 ![x-x_1,x-x_2,...,x-x_n](https://www.zhihu.com/equation?tex=x-x_1%2Cx-x_2%2C...%2Cx-x_n) 来表出（ ![n](https://www.zhihu.com/equation?tex=n) 次多项式）。

记 ![f_1(x)=f(x)-a_0(x-x_1)(x-x_2)...(x-x_n)](https://www.zhihu.com/equation?tex=f_1%28x%29%3Df%28x%29-a_0%28x-x_1%29%28x-x_2%29...%28x-x_n%29) （目的是去除 ![x^n](https://www.zhihu.com/equation?tex=x%5En) 的项）

则 ![deg\ f_1\leq n-1](https://www.zhihu.com/equation?tex=deg%5C+f_1%5Cleq+n-1) ，设 ![f_1(x)首项为b_1x^{n-1}](https://www.zhihu.com/equation?tex=f_1%28x%29%E9%A6%96%E9%A1%B9%E4%B8%BAb_1x%5E%7Bn-1%7D) 。

用同样的手段，记 ![f_2(x)=f_1(x)-b_1(x-x_1)...(x-x_{n-1})](https://www.zhihu.com/equation?tex=f_2%28x%29%3Df_1%28x%29-b_1%28x-x_1%29...%28x-x_%7Bn-1%7D%29) ，则 ![deg\ f_2\leq n-2](https://www.zhihu.com/equation?tex=deg%5C+f_2%5Cleq+n-2)

以此类推地， ![f(x)=a_0(x-x_1)(x-x_2)...(x-x_n)+b_1(x-x_1)...(x-x_{n-1})+...+b_{n-1}(x-x_1)+b_n](https://www.zhihu.com/equation?tex=f%28x%29%3Da_0%28x-x_1%29%28x-x_2%29...%28x-x_n%29%2Bb_1%28x-x_1%29...%28x-x_%7Bn-1%7D%29%2B...%2Bb_%7Bn-1%7D%28x-x_1%29%2Bb_n)

此时取 ![x=x_1](https://www.zhihu.com/equation?tex=x%3Dx_1) 为根，得到 ![p|b_n](https://www.zhihu.com/equation?tex=p%7Cb_n) 。

再取 ![x=x_2](https://www.zhihu.com/equation?tex=x%3Dx_2) 为根，得到 ![b_{n-1}(x_2-x_1)+b_n\equiv 0(mod\ p)](https://www.zhihu.com/equation?tex=b_%7Bn-1%7D%28x_2-x_1%29%2Bb_n%5Cequiv+0%28mod%5C+p%29) ，又 ![p|b_n](https://www.zhihu.com/equation?tex=p%7Cb_n) ，故 ![p|b_{n-1}(x_2-x_1)](https://www.zhihu.com/equation?tex=p%7Cb_%7Bn-1%7D%28x_2-x_1%29) ，而所有根两两![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p)不同余，故 ![p|b_{n-1}](https://www.zhihu.com/equation?tex=p%7Cb_%7Bn-1%7D) 。

以此类推地， ![p|a_0,p|b_1,p|b_2,...,p|b_n](https://www.zhihu.com/equation?tex=p%7Ca_0%2Cp%7Cb_1%2Cp%7Cb_2%2C...%2Cp%7Cb_n) 。

而容易知道 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 所有的系数可由 ![a_0,b_1,...,b_n](https://www.zhihu.com/equation?tex=a_0%2Cb_1%2C...%2Cb_n) 经过加法运算与乘法运算表出，故 ![f(x)](https://www.zhihu.com/equation?tex=f%28x%29) 所有系数均为 ![p](https://www.zhihu.com/equation?tex=p) 的倍数。



值得一提的是，这个定理**仅对素数成立**，否则有如下反例：

例： ![x^2\equiv 1(mod\ 8)](https://www.zhihu.com/equation?tex=x%5E2%5Cequiv+1%28mod%5C+8%29)

容易看出所有 ![mod\ 8](https://www.zhihu.com/equation?tex=mod%5C+8) 不同余的解有四个： ![x\equiv \pm1,\pm 3(mod\ 8)](https://www.zhihu.com/equation?tex=x%5Cequiv+%5Cpm1%2C%5Cpm+3%28mod%5C+8%29) ，解的个数大于次数，但是并非所有系数都为 ![8](https://www.zhihu.com/equation?tex=8) 的倍数，定理不成立。


下面，我们利用上述定理给出WIlson定理，这也是有一个关于素书的重要结果，而且证明过程也非常巧妙。

**定理（Wilson）： ![p](https://www.zhihu.com/equation?tex=p) 为素数，则 ![(p-1)!+1\equiv 0(mod\ p )](https://www.zhihu.com/equation?tex=%28p-1%29%21%2B1%5Cequiv+0%28mod%5C+p+%29)**

证明：

不妨设 ![p>2](https://www.zhihu.com/equation?tex=p%3E2) ，为奇素数（否则容易验证）

我们的思路是构造多项式 ![f](https://www.zhihu.com/equation?tex=f)，某一项系数为 ![(p-1)!+1](https://www.zhihu.com/equation?tex=%28p-1%29%21%2B1) ，且根的数量大于次数。

![f(x)=(x-1)(x-2)...(x-p+1)-(x^{p-1}-1)](https://www.zhihu.com/equation?tex=f%28x%29%3D%28x-1%29%28x-2%29...%28x-p%2B1%29-%28x%5E%7Bp-1%7D-1%29) 为 ![p-2](https://www.zhihu.com/equation?tex=p-2) 次多项式。

由Fermat定理，对 ![i=1,2,...,p-1](https://www.zhihu.com/equation?tex=i%3D1%2C2%2C...%2Cp-1) ，有 ![(i,p)=1](https://www.zhihu.com/equation?tex=%28i%2Cp%29%3D1) ，故 ![i^{p-1}\equiv 1(mod\ p)](https://www.zhihu.com/equation?tex=i%5E%7Bp-1%7D%5Cequiv+1%28mod%5C+p%29)

故 ![1,2,...,p-1](https://www.zhihu.com/equation?tex=1%2C2%2C...%2Cp-1) 均为 ![f\equiv 0(mod\ p)](https://www.zhihu.com/equation?tex=f%5Cequiv+0%28mod%5C+p%29) 的根。

根的个数大于次数，由前一个定理，所有系数为 ![p](https://www.zhihu.com/equation?tex=p) 的倍数。

考虑常数项为 ![(-1)^{p-1}(p-1)!+1](https://www.zhihu.com/equation?tex=%28-1%29%5E%7Bp-1%7D%28p-1%29%21%2B1)![=(p-1)!+1](https://www.zhihu.com/equation?tex=%3D%28p-1%29%21%2B1) ，故得证。

Wilson定理对素数而言实际上是充要的，逆命题的证明将留作习题。（逆命题证明反而较简单）这也是Wilson定理的珍贵之处，因为判定一个正整数是否为素数一直不是一件简单的事。现在有了Wilson定理，我们就能够给出包含了所有素数的公式。（虽然这看上去是不可能的）

![f(n)=[\frac{n!\ mod \ (n+1)}{n}](n-1)+2](https://www.zhihu.com/equation?tex=f%28n%29%3D%5B%5Cfrac%7Bn%21%5C+mod+%5C+%28n%2B1%29%7D%7Bn%7D%5D%28n-1%29%2B2) ，此素数公式的证明留作习题，然而该公式生成所有素数的效率很低，仅具备理论上的可行性（更好的方法将要用到丢番图逼近）。



习题：

1、若 ![(p-1)!+1\equiv 0(mod\ p )](https://www.zhihu.com/equation?tex=%28p-1%29%21%2B1%5Cequiv+0%28mod%5C+p+%29) ，且 ![p>1](https://www.zhihu.com/equation?tex=p%3E1) ，证明 ![p](https://www.zhihu.com/equation?tex=p) 为素数。（**Wilson逆命题**）

2、证明： ![f(n)=[\frac{n!\ mod \ (n+1)}{n}](n-1)+2](https://www.zhihu.com/equation?tex=f%28n%29%3D%5B%5Cfrac%7Bn%21%5C+mod+%5C+%28n%2B1%29%7D%7Bn%7D%5D%28n-1%29%2B2) ，当 ![n](https://www.zhihu.com/equation?tex=n) 取任意正整数时， ![f(n)](https://www.zhihu.com/equation?tex=f%28n%29) 必定为素数。（**Wilson素数公式**）

3、 ![p](https://www.zhihu.com/equation?tex=p) 为大于2的素数， ![1\leq n\leq p-1](https://www.zhihu.com/equation?tex=1%5Cleq+n%5Cleq+p-1) ，证明： ![\binom{p-1}{n}\equiv (-1)^n(mod\ p)](https://www.zhihu.com/equation?tex=%5Cbinom%7Bp-1%7D%7Bn%7D%5Cequiv+%28-1%29%5En%28mod%5C+p%29)

4、解方程： ![6x\equiv 2(mod\ 9)](https://www.zhihu.com/equation?tex=6x%5Cequiv+2%28mod%5C+9%29) ， ![2x\equiv7(mod\ 11)](https://www.zhihu.com/equation?tex=2x%5Cequiv7%28mod%5C+11%29)

5、解方程： ![\begin{cases} x\equiv 3(mod\ 8)\\ x\equiv 11(mod\ 20)\\ x\equiv 1(mod \ 15) \end{cases} ](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+x%5Cequiv+3%28mod%5C+8%29%5C%5C+x%5Cequiv+11%28mod%5C+20%29%5C%5C+x%5Cequiv+1%28mod+%5C+15%29+%5Cend%7Bcases%7D+)

6、求 ![mod\ 11\ 的一组最小CRS](https://www.zhihu.com/equation?tex=mod%5C+11%5C+%E7%9A%84%E4%B8%80%E7%BB%84%E6%9C%80%E5%B0%8FCRS) ，满足其中每个数被 ![2,3,5,7](https://www.zhihu.com/equation?tex=2%2C3%2C5%2C7) 除的余数分别为 ![1,-1,1,-1](https://www.zhihu.com/equation?tex=1%2C-1%2C1%2C-1) 。




提示或解答：

1、证明：

反证，假设 ![p](https://www.zhihu.com/equation?tex=p) 不为素数，则其必有因子 ![d](https://www.zhihu.com/equation?tex=d) ，且 ![1<d<p](https://www.zhihu.com/equation?tex=1%3Cd%3Cp)

则 ![d=2 \ or\ 3\ or\ 4\ or\ ...\ or\ p-1](https://www.zhihu.com/equation?tex=d%3D2+%5C+or%5C+3%5C+or%5C+4%5C+or%5C+...%5C+or%5C+p-1)

故 ![d|(p-1)!](https://www.zhihu.com/equation?tex=d%7C%28p-1%29%21) ，而 ![d|(p-1)!+1](https://www.zhihu.com/equation?tex=d%7C%28p-1%29%21%2B1)

故 ![d|1](https://www.zhihu.com/equation?tex=d%7C1) 矛盾。故得证。

2、提示：考虑 ![n+1](https://www.zhihu.com/equation?tex=n%2B1) 为素数与其不为素数两种情况。

3、证明：

利用一次方程处提到的方法。

先考虑在同余式两边乘上 ![n!](https://www.zhihu.com/equation?tex=n%21) 去除分母。

![n!\binom{p-1}{n}=(p-1)(p-2)...(p-n)\equiv (-1)^nn!(mod\ p)](https://www.zhihu.com/equation?tex=n%21%5Cbinom%7Bp-1%7D%7Bn%7D%3D%28p-1%29%28p-2%29...%28p-n%29%5Cequiv+%28-1%29%5Enn%21%28mod%5C+p%29)

而 ![1\leq n\leq p-1](https://www.zhihu.com/equation?tex=1%5Cleq+n%5Cleq+p-1) ，故 ![(n!,p)=1](https://www.zhihu.com/equation?tex=%28n%21%2Cp%29%3D1) ，故两边可以同除以 ![n!](https://www.zhihu.com/equation?tex=n%21) 且不改变模，得证。

4、提示：利用一次方程结论，容易知道第一个方程无解，第二个方程有唯一解 ![x\equiv -2(mod\ 11)](https://www.zhihu.com/equation?tex=x%5Cequiv+-2%28mod%5C+11%29) 。

5、提示：注意到模并不是两两互素的，故不能直接利用中国剩余定理。想办法先进行等解变换，把模变为互素的数。

注意到原方程与 ![\begin{cases} x\equiv 3(mod\ 8)\\ x\equiv 11(mod\ 4)\\ x\equiv 11(mod\ 5)\\ x\equiv 1(mod\ 5)\\ x\equiv 1(mod\ 3) \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+x%5Cequiv+3%28mod%5C+8%29%5C%5C+x%5Cequiv+11%28mod%5C+4%29%5C%5C+x%5Cequiv+11%28mod%5C+5%29%5C%5C+x%5Cequiv+1%28mod%5C+5%29%5C%5C+x%5Cequiv+1%28mod%5C+3%29+%5Cend%7Bcases%7D) 等解，而在此 方程 组中 第三与第四个方程等价，满足第一个方程的 ![x](https://www.zhihu.com/equation?tex=x) 必定满足第二个方程。

故原方程与 ![\begin{cases} x\equiv 3(mod\ 8)\\ x\equiv 1(mod\ 5)\\ x\equiv 1(mod\ 3) \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+x%5Cequiv+3%28mod%5C+8%29%5C%5C+x%5Cequiv+1%28mod%5C+5%29%5C%5C+x%5Cequiv+1%28mod%5C+3%29+%5Cend%7Bcases%7D) 等解，此时模已经互素再运用中国剩余定理即可。

可得到 ![x\equiv 91(mod\ 120)](https://www.zhihu.com/equation?tex=x%5Cequiv+91%28mod%5C+120%29)

6、提示：同样是中国剩余定理的应用。

![m_1=2,m_2=3,m_3=5,m_4=7,m_5=11](https://www.zhihu.com/equation?tex=m_1%3D2%2Cm_2%3D3%2Cm_3%3D5%2Cm_4%3D7%2Cm_5%3D11) 两两互素。

![b_1=1,b_2=-1,b_3=1,b_4=-1,b_5=0,1,...,10](https://www.zhihu.com/equation?tex=b_1%3D1%2Cb_2%3D-1%2Cb_3%3D1%2Cb_4%3D-1%2Cb_5%3D0%2C1%2C...%2C10)

则可求得 ![M_1,M_2,...,M_5](https://www.zhihu.com/equation?tex=M_1%2CM_2%2C...%2CM_5) 。

![x=M_1N_1b_1+...+M_5N_5b_5](https://www.zhihu.com/equation?tex=x%3DM_1N_1b_1%2B...%2BM_5N_5b_5) ，**此处当 ![b_5](https://www.zhihu.com/equation?tex=b_5) 遍历 ![mod\ 11 \ CRS](https://www.zhihu.com/equation?tex=mod%5C+11+%5C+CRS) 时， ![x](https://www.zhihu.com/equation?tex=x) 也    应    遍历![mod\ 11 \ CRS](https://www.zhihu.com/equation?tex=mod%5C+11+%5C+CRS)。**

接下来可求得 ![N_1=1,N_2=-1,N_3=-2,N_4=1,N_5=1](https://www.zhihu.com/equation?tex=N_1%3D1%2CN_2%3D-1%2CN_3%3D-2%2CN_4%3D1%2CN_5%3D1)

故解得 ![x=210(b_5+3)+41](https://www.zhihu.com/equation?tex=x%3D210%28b_5%2B3%29%2B41)

故具有这样性质的 ![mod\ 11最小 CRS](https://www.zhihu.com/equation?tex=mod%5C+11%E6%9C%80%E5%B0%8F+CRS) 为 ![41,210+41,210\times 2+41,...,210\times 10+41](https://www.zhihu.com/equation?tex=41%2C210%2B41%2C210%5Ctimes+2%2B41%2C...%2C210%5Ctimes+10%2B41)


那么第四部分也就到此结束啦！ 

