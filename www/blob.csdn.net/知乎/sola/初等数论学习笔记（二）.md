# 初等数论学习笔记（二） - 知乎
# 

今天考完试了啦啦啦，之后几天也会把剩下的内容全部补齐www（个人比较喜欢在结课后写笔记，这样可以对整体有更好的理解）


**                                                          数论函数**

***一、 ![[x],\left \{ x \right \}](https://www.zhihu.com/equation?tex=%5Bx%5D%2C%5Cleft+%5C%7B+x+%5Cright+%5C%7D)***

**定义：**

**![x\in \mathbb{R},[x]](https://www.zhihu.com/equation?tex=x%5Cin+%5Cmathbb%7BR%7D%2C%5Bx%5D) 定义为不超过 ![x](https://www.zhihu.com/equation?tex=x) 的最大整数。**

**![\left \{ x \right \}=x-[x]](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+x+%5Cright+%5C%7D%3Dx-%5Bx%5D)**

则容易看出 ![x-1< [x]\leq x,\ ](https://www.zhihu.com/equation?tex=x-1%3C+%5Bx%5D%5Cleq+x%2C%5C+)![0 \leq \left \{ x \right \} < 1](https://www.zhihu.com/equation?tex=0+%5Cleq+%5Cleft+%5C%7B+x+%5Cright+%5C%7D+%3C+1) 。事实上，对于 ![x>0,\ ](https://www.zhihu.com/equation?tex=x%3E0%2C%5C+)![[x]](https://www.zhihu.com/equation?tex=%5Bx%5D) 为 ![x](https://www.zhihu.com/equation?tex=x) 的整数部分，而 ![\left \{ x \right \}](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+x+%5Cright+%5C%7D) 为 ![x](https://www.zhihu.com/equation?tex=x) 的小数部分。（ ![x<0](https://www.zhihu.com/equation?tex=x%3C0) 时情况有所不同，读者可自己给出）

关于取整函数的性质，有如下结论：

1、给定 ![x>0](https://www.zhihu.com/equation?tex=x%3E0) ，满足 ![n\leq x](https://www.zhihu.com/equation?tex=n%5Cleq+x) 的 ![n](https://www.zhihu.com/equation?tex=n) 个数 ![=\sum_{n \leq x}^{\ }1=[x]](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bn+%5Cleq+x%7D%5E%7B%5C+%7D1%3D%5Bx%5D)。特别地，若再给定 ![m>0](https://www.zhihu.com/equation?tex=m%3E0) ，则满足条件 ![\begin{cases} n\leq x\\ m|n \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+n%5Cleq+x%5C%5C+m%7Cn+%5Cend%7Bcases%7D) 的正数 ![n](https://www.zhihu.com/equation?tex=n) 的个数为 ![[\frac{x}m{}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7Bx%7Dm%7B%7D%5D) 。（证略）

2、 ![x\in\mathbb{R},c\in\mathbb{N^*},[\frac{[x]}{c}]=[\frac{x}{c}]](https://www.zhihu.com/equation?tex=x%5Cin%5Cmathbb%7BR%7D%2Cc%5Cin%5Cmathbb%7BN%5E%2A%7D%2C%5B%5Cfrac%7B%5Bx%5D%7D%7Bc%7D%5D%3D%5B%5Cfrac%7Bx%7D%7Bc%7D%5D)

证明：

设 ![k=[\frac{x}{c}],\ \frac{x}{c}=k+\alpha\ (0 \leq \alpha <1)](https://www.zhihu.com/equation?tex=k%3D%5B%5Cfrac%7Bx%7D%7Bc%7D%5D%2C%5C+%5Cfrac%7Bx%7D%7Bc%7D%3Dk%2B%5Calpha%5C+%280+%5Cleq+%5Calpha+%3C1%29)

则 ![x=ck+c\alpha\ (0 \leq c\alpha<c)\Rightarrow x=ck+[c\alpha]+\left \{ c\alpha \right \}](https://www.zhihu.com/equation?tex=x%3Dck%2Bc%5Calpha%5C+%280+%5Cleq+c%5Calpha%3Cc%29%5CRightarrow+x%3Dck%2B%5Bc%5Calpha%5D%2B%5Cleft+%5C%7B+c%5Calpha+%5Cright+%5C%7D)

则有 ![[x]=ck+[c\alpha]](https://www.zhihu.com/equation?tex=%5Bx%5D%3Dck%2B%5Bc%5Calpha%5D)

故 ![[\frac{[x]}{c}]=[k+\frac{[c\alpha]}{c}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7B%5Bx%5D%7D%7Bc%7D%5D%3D%5Bk%2B%5Cfrac%7B%5Bc%5Calpha%5D%7D%7Bc%7D%5D) ，其中 ![k\in \mathbb{Z},\ 0 \leq \frac{[c\alpha]}{c}<1](https://www.zhihu.com/equation?tex=k%5Cin+%5Cmathbb%7BZ%7D%2C%5C+0+%5Cleq+%5Cfrac%7B%5Bc%5Calpha%5D%7D%7Bc%7D%3C1)

故 ![[\frac{[x]}{c}]=[k]=k=[\frac{x}{c}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7B%5Bx%5D%7D%7Bc%7D%5D%3D%5Bk%5D%3Dk%3D%5B%5Cfrac%7Bx%7D%7Bc%7D%5D)

值得提及的是，性质2其实可以**通过性质1来理解**。

![[\frac{[x]}{c}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7B%5Bx%5D%7D%7Bc%7D%5D) 其实是满足条件 ![\begin{cases} n\leq [x]\\ c|n \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+n%5Cleq+%5Bx%5D%5C%5C+c%7Cn+%5Cend%7Bcases%7D) 的 ![n](https://www.zhihu.com/equation?tex=n) 的个数。而 ![[\frac{x}{c}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7Bx%7D%7Bc%7D%5D) 其实是满足条件 ![\begin{cases} n\leq x\\ c|n \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+n%5Cleq+x%5C%5C+c%7Cn+%5Cend%7Bcases%7D) 的 ![n](https://www.zhihu.com/equation?tex=n) 的个数。注意到此处 ![c\in\mathbb{N}](https://www.zhihu.com/equation?tex=c%5Cin%5Cmathbb%7BN%7D) ，故满足条件的 ![n\in\mathbb{N}](https://www.zhihu.com/equation?tex=n%5Cin%5Cmathbb%7BN%7D) ，故两个条件是等价的，故两个表达式值相等。

性质2在我们得出下面这个定理时会被应用到，但在此之前，我们先定义重数的概念。

**定义：**

**![\forall n,p,\ p](https://www.zhihu.com/equation?tex=%5Cforall+n%2Cp%2C%5C+p) 为素数， ![n](https://www.zhihu.com/equation?tex=n) 为整数， ![\exists !\ \alpha \geq 0, \ s.t. \ n=p^\alpha n_1, (n_1,p)=1](https://www.zhihu.com/equation?tex=%5Cexists+%21%5C+%5Calpha+%5Cgeq+0%2C+%5C+s.t.+%5C+n%3Dp%5E%5Calpha+n_1%2C+%28n_1%2Cp%29%3D1) ，则称 ![\alpha](https://www.zhihu.com/equation?tex=%5Calpha) 为 ![n](https://www.zhihu.com/equation?tex=n) 的 ![p-](https://www.zhihu.com/equation?tex=p-) 重数，记为 ![\alpha=ind_p n](https://www.zhihu.com/equation?tex=%5Calpha%3Dind_p+n) 。**

对重数概念的直观理解就是其为 ![n](https://www.zhihu.com/equation?tex=n) 中所包含的因子 ![p](https://www.zhihu.com/equation?tex=p) 的    最大个数    。即 ![p^\alpha|n](https://www.zhihu.com/equation?tex=p%5E%5Calpha%7Cn) 但 ![p^{\alpha+1}](https://www.zhihu.com/equation?tex=p%5E%7B%5Calpha%2B1%7D) 不整除 ![n](https://www.zhihu.com/equation?tex=n) 。

进一步地，我们容易得到一些关于重数 的性质。（证略）

![ind_p n=0\Leftrightarrow (p,n)=1](https://www.zhihu.com/equation?tex=ind_p+n%3D0%5CLeftrightarrow+%28p%2Cn%29%3D1) 以及 ![ind_p(mn)=ind_pm+ind_pn](https://www.zhihu.com/equation?tex=ind_p%28mn%29%3Dind_pm%2Bind_pn) （类似对数的性质）

有了重数的  概念，我们得以探讨以下问题：若 ![p](https://www.zhihu.com/equation?tex=p) 为素数，是否能求得 ![n!](https://www.zhihu.com/equation?tex=n%21) 中包含多少个因子 ![p](https://www.zhihu.com/equation?tex=p) 呢？我们给出下述对于 ![n!](https://www.zhihu.com/equation?tex=n%21) 的素因子结构的定理。

**定理：（ ![n!的p-重数](https://www.zhihu.com/equation?tex=n%21%E7%9A%84p-%E9%87%8D%E6%95%B0) ）**

**![n](https://www.zhihu.com/equation?tex=n) 为整数，![p](https://www.zhihu.com/equation?tex=p) 为素数， ![ind_p(n!)=\sum_{k=1}^{+\infty }[\frac{n}{p^k}]](https://www.zhihu.com/equation?tex=ind_p%28n%21%29%3D%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bn%7D%7Bp%5Ek%7D%5D) 。**

证明：

不妨设 ![p<n](https://www.zhihu.com/equation?tex=p%3Cn) （否则易证）

利用数学归纳法，假设 ![\forall m<n,\ ind_p(m!)=\sum_{k=1}^{+\infty }[\frac{m}{p^k}]](https://www.zhihu.com/equation?tex=%5Cforall+m%3Cn%2C%5C+ind_p%28m%21%29%3D%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bm%7D%7Bp%5Ek%7D%5D)

取 ![m=[\frac{n}{p}]<n](https://www.zhihu.com/equation?tex=m%3D%5B%5Cfrac%7Bn%7D%7Bp%7D%5D%3Cn)

考虑 ![1,2,...,n](https://www.zhihu.com/equation?tex=1%2C2%2C...%2Cn) 中 ![p](https://www.zhihu.com/equation?tex=p) 的倍数有 ![p,2p,...,mp](https://www.zhihu.com/equation?tex=p%2C2p%2C...%2Cmp) ，且其它数均与 ![p](https://www.zhihu.com/equation?tex=p) 互素。

故 ![n!=p(2p)...(mp)N](https://www.zhihu.com/equation?tex=n%21%3Dp%282p%29...%28mp%29N) ，其中 ![(N,p)=1](https://www.zhihu.com/equation?tex=%28N%2Cp%29%3D1)

故 ![n!=p^mm!N](https://www.zhihu.com/equation?tex=n%21%3Dp%5Emm%21N)

故 ![ind_pn!=ind_pp^m+ind_pm!+ind_pN=m+ind_pm!+0](https://www.zhihu.com/equation?tex=ind_pn%21%3Dind_pp%5Em%2Bind_pm%21%2Bind_pN%3Dm%2Bind_pm%21%2B0)

由归纳  假设， ![\forall m<n,\ ind_p(m!)=\sum_{k=1}^{+\infty }[\frac{m}{p^k}]](https://www.zhihu.com/equation?tex=%5Cforall+m%3Cn%2C%5C+ind_p%28m%21%29%3D%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bm%7D%7Bp%5Ek%7D%5D)

故 ![ind_pn!=m+\sum_{k=1}^{+\infty }[\frac{m}{p^k}]=[\frac{n}{p}]+\sum_{k=1}^{+\infty }[\frac{[\frac{n}{p}]}{p^k}]](https://www.zhihu.com/equation?tex=ind_pn%21%3Dm%2B%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bm%7D%7Bp%5Ek%7D%5D%3D%5B%5Cfrac%7Bn%7D%7Bp%7D%5D%2B%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7B%5B%5Cfrac%7Bn%7D%7Bp%7D%5D%7D%7Bp%5Ek%7D%5D)

由性质2， ![ind_pn!=[\frac{n}{p}]+\sum_{k=1}^{+\infty }[\frac{n}{p^{k+1}}]](https://www.zhihu.com/equation?tex=ind_pn%21%3D%5B%5Cfrac%7Bn%7D%7Bp%7D%5D%2B%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bn%7D%7Bp%5E%7Bk%2B1%7D%7D%5D)![=\sum_{k=1}^{+\infty }[\frac{n}{p^k}]](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bn%7D%7Bp%5Ek%7D%5D) 。

需要说明的是， ![\sum_{k=1}^{+\infty }[\frac{n}{p^k}]](https://www.zhihu.com/equation?tex=%5Csum_%7Bk%3D1%7D%5E%7B%2B%5Cinfty+%7D%5B%5Cfrac%7Bn%7D%7Bp%5Ek%7D%5D) 虽然看上去包含了 ![\infty](https://www.zhihu.com/equation?tex=%5Cinfty) ，但实际上是一个有限求和式，读者可自行验证。（之后还会有很多包含 ![\infty](https://www.zhihu.com/equation?tex=%5Cinfty) 的求和式出现，但是在数论中大多数情况下实质都是有限项求和）

此定理让我们能够清楚地看到 ![n!](https://www.zhihu.com/equation?tex=n%21) 的**素因子（强调一下定理中的**![p](https://www.zhihu.com/equation?tex=p)**必须是素数）**构成，以下给出一个实例。

例：求 ![20!](https://www.zhihu.com/equation?tex=20%21) 中    结尾有多少个0。

解：

即求 ![20!](https://www.zhihu.com/equation?tex=20%21) 中有多少个因子 ![10](https://www.zhihu.com/equation?tex=10) 。

然而不能直接将 ![p=10](https://www.zhihu.com/equation?tex=p%3D10) 代入（10不为素数）

注意到 ![10=2\times 5](https://www.zhihu.com/equation?tex=10%3D2%5Ctimes+5)

所以考虑 ![ind_2(20!)](https://www.zhihu.com/equation?tex=ind_2%2820%21%29) 与 ![ind_5(20!)](https://www.zhihu.com/equation?tex=ind_5%2820%21%29) 。

利用定理，求得 ![ind_2(20!)=18,ind_5(20!)=4](https://www.zhihu.com/equation?tex=ind_2%2820%21%29%3D18%2Cind_5%2820%21%29%3D4)

故 ![20！](https://www.zhihu.com/equation?tex=20%EF%BC%81) 中含有4个因子10，结尾有4个0。    



**二、积性函数与Mobius变换 ![\sum_{d|n}^{\ }](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D)**

**定义：定义在 ![\mathbb{N}](https://www.zhihu.com/equation?tex=%5Cmathbb%7BN%7D) 上的函数称为算术函数。**

**定义：若一个算术函数 ![\theta(n)](https://www.zhihu.com/equation?tex=%5Ctheta%28n%29) 不恒为0，且对于 ![(m,n)=1](https://www.zhihu.com/equation?tex=%28m%2Cn%29%3D1) ，总有 ![\theta(mn)=\theta(m)\theta(n)](https://www.zhihu.com/equation?tex=%5Ctheta%28mn%29%3D%5Ctheta%28m%29%5Ctheta%28n%29)成立 ，则称其为积性函数。特别地，若对于 ![\forall m,n,\ \theta(mn)=\theta(m)\theta(n)](https://www.zhihu.com/equation?tex=%5Cforall+m%2Cn%2C%5C+%5Ctheta%28mn%29%3D%5Ctheta%28m%29%5Ctheta%28n%29) 总成立，则称其为完全积性函数。**

以下均假定 ![\theta](https://www.zhihu.com/equation?tex=%5Ctheta) 为    积性函数， ![n](https://www.zhihu.com/equation?tex=n) 为正整数。

我们容易得到以下这些简单的性质（前三条读者可自行验证）

1、 ![\theta(1)=1](https://www.zhihu.com/equation?tex=%5Ctheta%281%29%3D1)

2、由算数基本定理， ![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数，则有 ![\theta(n)=\theta(p_1^{\alpha_1})\theta(p_2^{\alpha_2})...\theta(p_k^{\alpha_k})](https://www.zhihu.com/equation?tex=%5Ctheta%28n%29%3D%5Ctheta%28p_1%5E%7B%5Calpha_1%7D%29%5Ctheta%28p_2%5E%7B%5Calpha_2%7D%29...%5Ctheta%28p_k%5E%7B%5Calpha_k%7D%29)

3、若 ![\theta_1,\theta_2](https://www.zhihu.com/equation?tex=%5Ctheta_1%2C%5Ctheta_2) 均为积性函数，则 ![\theta_1\theta_2](https://www.zhihu.com/equation?tex=%5Ctheta_1%5Ctheta_2) 为积性函数。          

关于Mobius变换  ![\sum_{d|n}^{\ }](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D) ，其意义为对 ![n](https://www.zhihu.com/equation?tex=n) 的所有正因子求和，下面引出Mobius变换与积性函数之间的联系。

性质4、 ![\psi (n)=\sum_{d|n}^{\ }\theta(d)](https://www.zhihu.com/equation?tex=%5Cpsi+%28n%29%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Ctheta%28d%29) ，若 ![\theta](https://www.zhihu.com/equation?tex=%5Ctheta) 为积性函数，则 ![\psi](https://www.zhihu.com/equation?tex=%5Cpsi) 也为积性函数。特别地，对于 ![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数，则 ![\psi (n)=\left [1+\theta(p_1)+\theta(p_1^2)+...+\theta(p_1^{\alpha_1}) \right ]\left [1+\theta(p_2)+\theta(p_2^2)+...+\theta(p_2^{\alpha_2}) \right ]...\left [1+\theta(p_k)+\theta(p_k^2)+...+\theta(p_k^{\alpha_k}) \right ]](https://www.zhihu.com/equation?tex=%5Cpsi+%28n%29%3D%5Cleft+%5B1%2B%5Ctheta%28p_1%29%2B%5Ctheta%28p_1%5E2%29%2B...%2B%5Ctheta%28p_1%5E%7B%5Calpha_1%7D%29+%5Cright+%5D%5Cleft+%5B1%2B%5Ctheta%28p_2%29%2B%5Ctheta%28p_2%5E2%29%2B...%2B%5Ctheta%28p_2%5E%7B%5Calpha_2%7D%29+%5Cright+%5D...%5Cleft+%5B1%2B%5Ctheta%28p_k%29%2B%5Ctheta%28p_k%5E2%29%2B...%2B%5Ctheta%28p_k%5E%7B%5Calpha_k%7D%29+%5Cright+%5D) 证明：

当 ![(m,n)=1](https://www.zhihu.com/equation?tex=%28m%2Cn%29%3D1) 时， ![mn](https://www.zhihu.com/equation?tex=mn) 的任一因子 ![d](https://www.zhihu.com/equation?tex=d) 都能够唯一地写成 ![d=d_1d_2，\ 其中d_1|m,d_2|n,(d_1,d_2)=1](https://www.zhihu.com/equation?tex=d%3Dd_1d_2%EF%BC%8C%5C+%E5%85%B6%E4%B8%ADd_1%7Cm%2Cd_2%7Cn%2C%28d_1%2Cd_2%29%3D1)

故 ![\psi(mn)=\sum_{d|mn}^{\ }\theta(d)=\sum_{d_1|m}^{\ }\sum_{d_2|n}^{\ }\theta(d_1d_2)=\sum_{d_1|m}^{\ }\sum_{d_2|n}^{\ }\theta(d_1)\theta(d_2)](https://www.zhihu.com/equation?tex=%5Cpsi%28mn%29%3D%5Csum_%7Bd%7Cmn%7D%5E%7B%5C+%7D%5Ctheta%28d%29%3D%5Csum_%7Bd_1%7Cm%7D%5E%7B%5C+%7D%5Csum_%7Bd_2%7Cn%7D%5E%7B%5C+%7D%5Ctheta%28d_1d_2%29%3D%5Csum_%7Bd_1%7Cm%7D%5E%7B%5C+%7D%5Csum_%7Bd_2%7Cn%7D%5E%7B%5C+%7D%5Ctheta%28d_1%29%5Ctheta%28d_2%29)

![=\sum_{d_1|m}^{\ } \theta(d_1) \sum_{d_2|n}^{\ }\theta(d_2)=\psi(m)\psi(n)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd_1%7Cm%7D%5E%7B%5C+%7D+%5Ctheta%28d_1%29+%5Csum_%7Bd_2%7Cn%7D%5E%7B%5C+%7D%5Ctheta%28d_2%29%3D%5Cpsi%28m%29%5Cpsi%28n%29)

故 ![\psi](https://www.zhihu.com/equation?tex=%5Cpsi) 为   积性   函数。

![\psi(n)=\psi(p_1^{\alpha_1})\psi(p_2^{\alpha_2})...\psi(p_k^{\alpha_k})](https://www.zhihu.com/equation?tex=%5Cpsi%28n%29%3D%5Cpsi%28p_1%5E%7B%5Calpha_1%7D%29%5Cpsi%28p_2%5E%7B%5Calpha_2%7D%29...%5Cpsi%28p_k%5E%7B%5Calpha_k%7D%29)

而 ![\psi(p_1^{\alpha_1})=\sum_{d|p_1^{\alpha_1}}^{\ }\theta(d)=\theta(1)+\theta(p_1)+...+\theta(p_1^{\alpha_1})](https://www.zhihu.com/equation?tex=%5Cpsi%28p_1%5E%7B%5Calpha_1%7D%29%3D%5Csum_%7Bd%7Cp_1%5E%7B%5Calpha_1%7D%7D%5E%7B%5C+%7D%5Ctheta%28d%29%3D%5Ctheta%281%29%2B%5Ctheta%28p_1%29%2B...%2B%5Ctheta%28p_1%5E%7B%5Calpha_1%7D%29) ，故得证。

下举常用的除数函数之例：

**![\tau (n)](https://www.zhihu.com/equation?tex=%5Ctau+%28n%29) 的值为 ![n](https://www.zhihu.com/equation?tex=n) 的正因子个数，称为除数函数。**

显然地 ![\tau (n)=\sum_{d|n}^{\ }1](https://www.zhihu.com/equation?tex=%5Ctau+%28n%29%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D1) ，由性质4， ![\tau(n)](https://www.zhihu.com/equation?tex=%5Ctau%28n%29) 为    **积性函数**，且对于 ![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数时， ![\tau (n)=(1+\alpha_1)(1+\alpha_2)...(1+\alpha_k)](https://www.zhihu.com/equation?tex=%5Ctau+%28n%29%3D%281%2B%5Calpha_1%29%281%2B%5Calpha_2%29...%281%2B%5Calpha_k%29) 。这与我们在上一章的算数基本定理中得到的结论是统一的。



**三、Mobius函数 ![\mu (n)](https://www.zhihu.com/equation?tex=%5Cmu+%28n%29)**
**定义 ： ![\mu (1)=1,\mu(p)=-1,\mu(p^\alpha)=0](https://www.zhihu.com/equation?tex=%5Cmu+%281%29%3D1%2C%5Cmu%28p%29%3D-1%2C%5Cmu%28p%5E%5Calpha%29%3D0) ，此处 ![\alpha>1,\ p](https://www.zhihu.com/equation?tex=%5Calpha%3E1%2C%5C+p) 为 素数，且 ![\mu(n)](https://www.zhihu.com/equation?tex=%5Cmu%28n%29) 满足  积性函数条件。**

换言之，![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数，则 ![\mu(n)= \begin{cases} (-1)^k \ \ \ \ if\ \ \alpha_1=\alpha_2=...=\alpha_k=1\\ 0\ \ \ \ \ \ \ \ \ \ else \end{cases}](https://www.zhihu.com/equation?tex=%5Cmu%28n%29%3D+%5Cbegin%7Bcases%7D+%28-1%29%5Ek+%5C+%5C+%5C+%5C+if%5C+%5C+%5Calpha_1%3D%5Calpha_2%3D...%3D%5Calpha_k%3D1%5C%5C+0%5C+%5C+%5C+%5C+%5C+%5C+%5C+%5C+%5C+%5C+else+%5Cend%7Bcases%7D)

（由算数基本定理和积性函数性质可知事实上只需要确定1处和所有素数方幂处取值，则此积性函数必定存在且唯一确定）

下面简单地介绍Mobius函数的有趣性质  ：

1、假设 ![\theta](https://www.zhihu.com/equation?tex=%5Ctheta) 为   积性   函数，则 ![\mu\theta](https://www.zhihu.com/equation?tex=%5Cmu%5Ctheta) 也为积性函数，则 ![\sum_{d|n}^{\ }\mu(d)\theta(d)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cmu%28d%29%5Ctheta%28d%29) 也为积性函数，且 ![\sum_{d|n}^{\ }\mu(d)\theta(d)=\left [1+\mu(p_1)\theta(p_1)+\mu(p_1^2)\theta(p_1^2)+...+\mu(p_1^{\alpha_1})\theta(p_1^{\alpha_1}) \right ]...\left [1+\mu(p_k)\theta(p_k)+\mu(p_k^2)\theta(p_k^2)+...+\mu(p_k^{\alpha_k})\theta(p_k^{\alpha_k}) \right ]](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cmu%28d%29%5Ctheta%28d%29%3D%5Cleft+%5B1%2B%5Cmu%28p_1%29%5Ctheta%28p_1%29%2B%5Cmu%28p_1%5E2%29%5Ctheta%28p_1%5E2%29%2B...%2B%5Cmu%28p_1%5E%7B%5Calpha_1%7D%29%5Ctheta%28p_1%5E%7B%5Calpha_1%7D%29+%5Cright+%5D...%5Cleft+%5B1%2B%5Cmu%28p_k%29%5Ctheta%28p_k%29%2B%5Cmu%28p_k%5E2%29%5Ctheta%28p_k%5E2%29%2B...%2B%5Cmu%28p_k%5E%7B%5Calpha_k%7D%29%5Ctheta%28p_k%5E%7B%5Calpha_k%7D%29+%5Cright+%5D) （证略，利用二中性质 2，3，4易证）

我们接下来观察一些常用的特殊情况。

令 ![\theta(d)=1](https://www.zhihu.com/equation?tex=%5Ctheta%28d%29%3D1) (完全积性)，则有 ![\sum_{d|n}^{\ }\mu(d)= \begin{cases} 1 \ \ \ if \ n=1\\ 0 \ \ \ if\ n>1 \end{cases}](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cmu%28d%29%3D+%5Cbegin%7Bcases%7D+1+%5C+%5C+%5C+if+%5C+n%3D1%5C%5C+0+%5C+%5C+%5C+if%5C+n%3E1+%5Cend%7Bcases%7D) （与Eratosthenes筛法密切相关）

令 ![\theta(d)=\frac{1}{d}](https://www.zhihu.com/equation?tex=%5Ctheta%28d%29%3D%5Cfrac%7B1%7D%7Bd%7D) （完全积性），![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数，则有 ![\sum_{d|n}^{\ }\frac{\mu (d)}{d}=(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cfrac%7B%5Cmu+%28d%29%7D%7Bd%7D%3D%281-%5Cfrac%7B1%7D%7Bp_1%7D%29%281-%5Cfrac%7B1%7D%7Bp_2%7D%29...%281-%5Cfrac%7B1%7D%7Bp_k%7D%29) （后面推导Euler函数时用到）



**四、Euler函数 ![\varphi (n)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29)**

**定义： ![\varphi (n)=\sum_{m \leq n , (m,n)=1}^{\ }1](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%3D%5Csum_%7Bm+%5Cleq+n+%2C+%28m%2Cn%29%3D1%7D%5E%7B%5C+%7D1) ，即为 ![\leq n](https://www.zhihu.com/equation?tex=%5Cleq+n) 且与 ![n](https://www.zhihu.com/equation?tex=n) 互素的数的个数。**

对于素数 ![p](https://www.zhihu.com/equation?tex=p) ，显然有 ![\varphi (p)=p-1](https://www.zhihu.com/equation?tex=%5Cvarphi+%28p%29%3Dp-1) 。

在给出Euler函数的具体表达式之前，我们先介绍一下数论中对双重求和式交换求和顺序的技巧。（将会在推导表达式过程中用到）

命题1、（字母均默认正整数） ![\sum_{m \leq n}^{\ }\sum_{d|(m,n)}^{\ }f(d)=\sum_{d|n}^{\ }f(d)\frac{n}{d}](https://www.zhihu.com/equation?tex=%5Csum_%7Bm+%5Cleq+n%7D%5E%7B%5C+%7D%5Csum_%7Bd%7C%28m%2Cn%29%7D%5E%7B%5C+%7Df%28d%29%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29%5Cfrac%7Bn%7D%7Bd%7D)

证明：

左端为先对 ![d](https://www.zhihu.com/equation?tex=d) 再对 ![m](https://www.zhihu.com/equation?tex=m) 求和，现在交换求和顺序。需要满足的条件： ![m \leq n,d|m,d|n](https://www.zhihu.com/equation?tex=m+%5Cleq+n%2Cd%7Cm%2Cd%7Cn)

故原式 ![=\sum_{d|n}^{\ }\sum_{m \leq n,d|m}^{\ }f(d)=\sum_{d|n}^{\ }f(d)\sum_{m \leq n,d|m}^{\ }1](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Csum_%7Bm+%5Cleq+n%2Cd%7Cm%7D%5E%7B%5C+%7Df%28d%29%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29%5Csum_%7Bm+%5Cleq+n%2Cd%7Cm%7D%5E%7B%5C+%7D1)

![=\sum_{d|n}^{\ }f(d)[\frac{n}{d}]=\sum_{d|n}^{\ }f(d)\frac{n}{d}](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29%5B%5Cfrac%7Bn%7D%7Bd%7D%5D%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29%5Cfrac%7Bn%7D%7Bd%7D)

事实上，我们可以将交换求和顺序类比于重积分中的变量代换，选定两个自由变量，并且加上适当的约束条件即可。

**定理：（Euler函数）**

**![\varphi (n)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29) 为积性函数，且 ![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数时， ![\varphi (n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%3Dn%281-%5Cfrac%7B1%7D%7Bp_1%7D%29%281-%5Cfrac%7B1%7D%7Bp_2%7D%29...%281-%5Cfrac%7B1%7D%7Bp_k%7D%29) 。**

证明：

定义特征函数 ![\delta (m)= \begin{cases} 1 \ \ \ if(m,n)=1\\ 0 \ \ \ else \end{cases}](https://www.zhihu.com/equation?tex=%5Cdelta+%28m%29%3D+%5Cbegin%7Bcases%7D+1+%5C+%5C+%5C+if%28m%2Cn%29%3D1%5C%5C+0+%5C+%5C+%5C+else+%5Cend%7Bcases%7D)

则 ![\varphi (n)=\sum_{m\leq n}^{\ }\delta (m)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%3D%5Csum_%7Bm%5Cleq+n%7D%5E%7B%5C+%7D%5Cdelta+%28m%29)

由![\sum_{d|n}^{\ }\mu(d)= \begin{cases} 1 \ \ \ if \ n=1\\ 0 \ \ \ if\ n>1 \end{cases}](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cmu%28d%29%3D+%5Cbegin%7Bcases%7D+1+%5C+%5C+%5C+if+%5C+n%3D1%5C%5C+0+%5C+%5C+%5C+if%5C+n%3E1+%5Cend%7Bcases%7D)， ![\delta (m)=\sum_{d|(m,n)}^{\ }\mu(d)](https://www.zhihu.com/equation?tex=%5Cdelta+%28m%29%3D%5Csum_%7Bd%7C%28m%2Cn%29%7D%5E%7B%5C+%7D%5Cmu%28d%29)

故 ![\varphi (n)=\sum_{m \leq n}^{\ }\sum_{d|(m,n)}^{\ }\mu(d)=\sum_{d|n}^{\ }\mu(d)\frac{n}{d}=n\sum_{d|n}^{\ }\frac{\mu(d)}{d}](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%3D%5Csum_%7Bm+%5Cleq+n%7D%5E%7B%5C+%7D%5Csum_%7Bd%7C%28m%2Cn%29%7D%5E%7B%5C+%7D%5Cmu%28d%29%3D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cmu%28d%29%5Cfrac%7Bn%7D%7Bd%7D%3Dn%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cfrac%7B%5Cmu%28d%29%7D%7Bd%7D) （由命题1）

又因为 ![\sum_{d|n}^{\ }\frac{\mu (d)}{d}=(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cfrac%7B%5Cmu+%28d%29%7D%7Bd%7D%3D%281-%5Cfrac%7B1%7D%7Bp_1%7D%29%281-%5Cfrac%7B1%7D%7Bp_2%7D%29...%281-%5Cfrac%7B1%7D%7Bp_k%7D%29)

故 ![\varphi (n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%3Dn%281-%5Cfrac%7B1%7D%7Bp_1%7D%29%281-%5Cfrac%7B1%7D%7Bp_2%7D%29...%281-%5Cfrac%7B1%7D%7Bp_k%7D%29) 。

用此表达式，容易验证 ![\varphi (n)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29) 为积性函数。（读者自行验证）



五、von Mangoldt函数 ![\Lambda (n)](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29)

定义： ![p](https://www.zhihu.com/equation?tex=p) 为素数， ![\Lambda (n)= \begin{cases} lnp \ \ \ if\ n=p^\beta (\beta\geq 1)\\ 0 \ \ \ \ \ \ else \end{cases}](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29%3D+%5Cbegin%7Bcases%7D+lnp+%5C+%5C+%5C+if%5C+n%3Dp%5E%5Cbeta+%28%5Cbeta%5Cgeq+1%29%5C%5C+0+%5C+%5C+%5C+%5C+%5C+%5C+else+%5Cend%7Bcases%7D)

容易看到 ![\Lambda (1)=0,\Lambda(4)=\Lambda(2)=ln2](https://www.zhihu.com/equation?tex=%5CLambda+%281%29%3D0%2C%5CLambda%284%29%3D%5CLambda%282%29%3Dln2) ，故 ![\Lambda (n)](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29) 不可能是积性函数。（与二中性质1矛盾）

关于 ![\Lambda (n)](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29) 的性质：

1、 ![\sum_{d|n}^{\ }\Lambda (d)=ln(n) ](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5CLambda+%28d%29%3Dln%28n%29+)

证明：不妨设 ![n>1](https://www.zhihu.com/equation?tex=n%3E1) （ ![n=1](https://www.zhihu.com/equation?tex=n%3D1) 成立），由算数基本定理，![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数。

要使得 ![\begin{cases} \Lambda (d)\neq 0\\ d|n\\ \end{cases} \Rightarrow d=p_i^{\beta_i}(1\leq\beta_i \leq \alpha_i) ](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+%5CLambda+%28d%29%5Cneq+0%5C%5C+d%7Cn%5C%5C+%5Cend%7Bcases%7D+%5CRightarrow+d%3Dp_i%5E%7B%5Cbeta_i%7D%281%5Cleq%5Cbeta_i+%5Cleq+%5Calpha_i%29+)

故左端 ![=\sum_{d|p_1^{\alpha_1}}^{\ }\Lambda(d)+\sum_{d|p_2^{\alpha_2}}^{\ }\Lambda(d)+...+\sum_{d|p_k^{\alpha_k}}^{\ }\Lambda(d)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd%7Cp_1%5E%7B%5Calpha_1%7D%7D%5E%7B%5C+%7D%5CLambda%28d%29%2B%5Csum_%7Bd%7Cp_2%5E%7B%5Calpha_2%7D%7D%5E%7B%5C+%7D%5CLambda%28d%29%2B...%2B%5Csum_%7Bd%7Cp_k%5E%7B%5Calpha_k%7D%7D%5E%7B%5C+%7D%5CLambda%28d%29)

而 ![\sum_{d|p_1^{\alpha_1}}^{\ }\Lambda(d)=\alpha_1ln(p_1)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cp_1%5E%7B%5Calpha_1%7D%7D%5E%7B%5C+%7D%5CLambda%28d%29%3D%5Calpha_1ln%28p_1%29)

故左端 ![=\alpha_1ln(p_1)+...+\alpha_kln(p_k)=ln(n)](https://www.zhihu.com/equation?tex=%3D%5Calpha_1ln%28p_1%29%2B...%2B%5Calpha_kln%28p_k%29%3Dln%28n%29)

下面为了进一步研究 ![\Lambda (n)](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29) 的性质，我们再给出一个数论中关于双重求和式的命题。读者可以与四中命题1对照，会发现本质是相同的，都是等价变换。

命题1： ![\sum_{d \leq x}^{\ }f(d)[\frac{x}{d}]=\sum_{n \leq x}^{\ }\sum_{d|n}^{\ }f(d)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd+%5Cleq+x%7D%5E%7B%5C+%7Df%28d%29%5B%5Cfrac%7Bx%7D%7Bd%7D%5D%3D%5Csum_%7Bn+%5Cleq+x%7D%5E%7B%5C+%7D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29) （ ![x](https://www.zhihu.com/equation?tex=x) 为实数，其它字母为正整数）

证明：

原式 ![=\sum_{d \leq x}^{\ }\sum_{m \leq \frac{x}{d}}^{\ }f(d)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd+%5Cleq+x%7D%5E%7B%5C+%7D%5Csum_%7Bm+%5Cleq+%5Cfrac%7Bx%7D%7Bd%7D%7D%5E%7B%5C+%7Df%28d%29)

进行变换 ![n=dm](https://www.zhihu.com/equation?tex=n%3Ddm)

（读者可自行验证 ![\left \{ \left \langle d,m \right \rangle ,dm \leq x \right \}=\left \{ \left \langle n,d \right \rangle ,n \leq x,d|n \right \} ](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+%5Cleft+%5Clangle+d%2Cm+%5Cright+%5Crangle+%2Cdm+%5Cleq+x+%5Cright+%5C%7D%3D%5Cleft+%5C%7B+%5Cleft+%5Clangle+n%2Cd+%5Cright+%5Crangle+%2Cn+%5Cleq+x%2Cd%7Cn+%5Cright+%5C%7D+) ，其中 ![\left \langle \ ,\ \right \rangle](https://www.zhihu.com/equation?tex=%5Cleft+%5Clangle+%5C+%2C%5C+%5Cright+%5Crangle) 表示数对）

故

原式 ![=\sum_{n\leq x}^{\ }\sum_{d|n}^{\ }f(d)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bn%5Cleq+x%7D%5E%7B%5C+%7D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7Df%28d%29)

特别地，命题1也有一些常用的特殊情况：（证略，可能会用到之前的结论）

令 ![f(d)=\mu(d)](https://www.zhihu.com/equation?tex=f%28d%29%3D%5Cmu%28d%29) ，得 ![\sum_{d \leq x}^{\ }\mu(d)[\frac{x}{d}]=1](https://www.zhihu.com/equation?tex=%5Csum_%7Bd+%5Cleq+x%7D%5E%7B%5C+%7D%5Cmu%28d%29%5B%5Cfrac%7Bx%7D%7Bd%7D%5D%3D1)

令 ![f(d)=1](https://www.zhihu.com/equation?tex=f%28d%29%3D1) ，得 ![\sum_{d \leq x}^{\ }[\frac{x}{d}]=\sum_{n \leq x}^{\ }\tau(n)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd+%5Cleq+x%7D%5E%7B%5C+%7D%5B%5Cfrac%7Bx%7D%7Bd%7D%5D%3D%5Csum_%7Bn+%5Cleq+x%7D%5E%7B%5C+%7D%5Ctau%28n%29)


现在我们再回过头来给出![\Lambda (n)](https://www.zhihu.com/equation?tex=%5CLambda+%28n%29) 的性质2：

2、定义 ![\psi(x)=\sum_{d\leq x}^{\ }\Lambda(d)(x>0)](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29%3D%5Csum_%7Bd%5Cleq+x%7D%5E%7B%5C+%7D%5CLambda%28d%29%28x%3E0%29) ，则 ![\sum_{d=1}^{+\infty}\psi(\frac{x}{d})=\sum_{n \leq x}^{\ }ln(n)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%3D1%7D%5E%7B%2B%5Cinfty%7D%5Cpsi%28%5Cfrac%7Bx%7D%7Bd%7D%29%3D%5Csum_%7Bn+%5Cleq+x%7D%5E%7B%5C+%7Dln%28n%29)

证明：

![\sum_{d=1}^{+\infty}\psi(\frac{x}{d})=\sum_{d=1}^{+\infty}\sum_{m\leq \frac{x}{d}}^{\ }\Lambda(m)=\sum_{n \leq x}^{\ }\sum_{d|n}^{\ }\Lambda(d)=\sum_{n\leq x}^{\ }ln(n)](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%3D1%7D%5E%7B%2B%5Cinfty%7D%5Cpsi%28%5Cfrac%7Bx%7D%7Bd%7D%29%3D%5Csum_%7Bd%3D1%7D%5E%7B%2B%5Cinfty%7D%5Csum_%7Bm%5Cleq+%5Cfrac%7Bx%7D%7Bd%7D%7D%5E%7B%5C+%7D%5CLambda%28m%29%3D%5Csum_%7Bn+%5Cleq+x%7D%5E%7B%5C+%7D%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5CLambda%28d%29%3D%5Csum_%7Bn%5Cleq+x%7D%5E%7B%5C+%7Dln%28n%29) （利用命题1）



习题：

1、给定正整数 ![n \geq 1](https://www.zhihu.com/equation?tex=n+%5Cgeq+1) ，证明 ![\forall 0 \leq m\leq n](https://www.zhihu.com/equation?tex=%5Cforall+0+%5Cleq+m%5Cleq+n) 组合数 ![\binom{n}{m}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bm%7D) 均为奇数的充要条件是 ![n](https://www.zhihu.com/equation?tex=n) 具有形式 ![2^k-1](https://www.zhihu.com/equation?tex=2%5Ek-1) 。

2、 ![p,q>1](https://www.zhihu.com/equation?tex=p%2Cq%3E1) 均为奇数，且 ![(p,q)=1](https://www.zhihu.com/equation?tex=%28p%2Cq%29%3D1) ，（ ![m,n](https://www.zhihu.com/equation?tex=m%2Cn) 均为正整数）证明： ![\sum_{m<\frac{p}{2}}^{\ }[\frac{q}{p}m]+\sum_{n<\frac{q}{2}}^{\ }[\frac{p}{q}n]=\frac{p-1}{2}\frac{q-1}{2}](https://www.zhihu.com/equation?tex=%5Csum_%7Bm%3C%5Cfrac%7Bp%7D%7B2%7D%7D%5E%7B%5C+%7D%5B%5Cfrac%7Bq%7D%7Bp%7Dm%5D%2B%5Csum_%7Bn%3C%5Cfrac%7Bq%7D%7B2%7D%7D%5E%7B%5C+%7D%5B%5Cfrac%7Bp%7D%7Bq%7Dn%5D%3D%5Cfrac%7Bp-1%7D%7B2%7D%5Cfrac%7Bq-1%7D%7B2%7D)

3、实数 ![R>0](https://www.zhihu.com/equation?tex=R%3E0) ， ![M](https://www.zhihu.com/equation?tex=M) 为区域 ![x^2+y^2\leq R^2](https://www.zhihu.com/equation?tex=x%5E2%2By%5E2%5Cleq+R%5E2) 上的整点数（横纵坐标均为整数的点称为整点），证明：

（1）： ![M=1+4[R]+4\sum_{1\leq s\leq [R]}^{\ }[\sqrt{R^2-s^2}]](https://www.zhihu.com/equation?tex=M%3D1%2B4%5BR%5D%2B4%5Csum_%7B1%5Cleq+s%5Cleq+%5BR%5D%7D%5E%7B%5C+%7D%5B%5Csqrt%7BR%5E2-s%5E2%7D%5D)

（2）： ![M=1+4[R]+8\sum_{1\leq s\leq [\frac{R}{\sqrt{2}}]}^{\ }[\sqrt{R^2-s^2}]-4[\frac{R}{\sqrt{2}}]^2](https://www.zhihu.com/equation?tex=M%3D1%2B4%5BR%5D%2B8%5Csum_%7B1%5Cleq+s%5Cleq+%5B%5Cfrac%7BR%7D%7B%5Csqrt%7B2%7D%7D%5D%7D%5E%7B%5C+%7D%5B%5Csqrt%7BR%5E2-s%5E2%7D%5D-4%5B%5Cfrac%7BR%7D%7B%5Csqrt%7B2%7D%7D%5D%5E2)

4、 ![\forall k\in \mathbb{N}](https://www.zhihu.com/equation?tex=%5Cforall+k%5Cin+%5Cmathbb%7BN%7D)，证明： ![\sum_{d,\varphi (d)=k}^{\ }\mu(d)=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%2C%5Cvarphi+%28d%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%28d%29%3D0) 。

5、求出所有 ![n](https://www.zhihu.com/equation?tex=n) ，使得 ![\varphi (n)|n](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%7Cn) 。

6、证明 ![\sum_{d|n}^{\ }\varphi (d)=n](https://www.zhihu.com/equation?tex=%5Csum_%7Bd%7Cn%7D%5E%7B%5C+%7D%5Cvarphi+%28d%29%3Dn) 。



提示或解答：

1、证明：（重数的应用）

若 ![n=2^k-1](https://www.zhihu.com/equation?tex=n%3D2%5Ek-1) ， ![\binom{n}{m}=\frac{(2^k-1)(2^k-2)...(2^k-m)}{m!}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bm%7D%3D%5Cfrac%7B%282%5Ek-1%29%282%5Ek-2%29...%282%5Ek-m%29%7D%7Bm%21%7D)

![=\frac{2^k-1}{1}\frac{2^k-2}{2}...\frac{2^k-m}{m}](https://www.zhihu.com/equation?tex=%3D%5Cfrac%7B2%5Ek-1%7D%7B1%7D%5Cfrac%7B2%5Ek-2%7D%7B2%7D...%5Cfrac%7B2%5Ek-m%7D%7Bm%7D)

故 ![ind_2\binom{n}{m}=ind_2\frac{2^k-1}{1}+ind_2\frac{2^k-2}{2}+...+ind_2\frac{2^k-m}{m}](https://www.zhihu.com/equation?tex=ind_2%5Cbinom%7Bn%7D%7Bm%7D%3Dind_2%5Cfrac%7B2%5Ek-1%7D%7B1%7D%2Bind_2%5Cfrac%7B2%5Ek-2%7D%7B2%7D%2B...%2Bind_2%5Cfrac%7B2%5Ek-m%7D%7Bm%7D)

而容易知道 ![k>0, \forall 1 \leq l <2^k, ind_2\frac{2^k\pm l}{l}=0](https://www.zhihu.com/equation?tex=k%3E0%2C+%5Cforall+1+%5Cleq+l+%3C2%5Ek%2C+ind_2%5Cfrac%7B2%5Ek%5Cpm+l%7D%7Bl%7D%3D0)

故 ![ind_2\binom{n}{m}=0](https://www.zhihu.com/equation?tex=ind_2%5Cbinom%7Bn%7D%7Bm%7D%3D0) ， ![\binom{n}{m}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bm%7D) 为奇数。

若 ![n\neq 2^k-1](https://www.zhihu.com/equation?tex=n%5Cneq+2%5Ek-1) ， ![\exists k,\ s.t. \ n=2^k+l(0 \leq l<2^k-1)](https://www.zhihu.com/equation?tex=%5Cexists+k%2C%5C+s.t.+%5C+n%3D2%5Ek%2Bl%280+%5Cleq+l%3C2%5Ek-1%29)

下证明 ![\binom{n}{l+1}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bl%2B1%7D)为偶数。

![\binom{n}{l+1}=\frac{(2^k+l)(2^k+l-1)...2^k}{(l+1)!}=\frac{2^k+l}{l}\frac{2^k+l-1}{l-1}...\frac{2^k+1}{1}\frac{2^k}{l+1}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bl%2B1%7D%3D%5Cfrac%7B%282%5Ek%2Bl%29%282%5Ek%2Bl-1%29...2%5Ek%7D%7B%28l%2B1%29%21%7D%3D%5Cfrac%7B2%5Ek%2Bl%7D%7Bl%7D%5Cfrac%7B2%5Ek%2Bl-1%7D%7Bl-1%7D...%5Cfrac%7B2%5Ek%2B1%7D%7B1%7D%5Cfrac%7B2%5Ek%7D%7Bl%2B1%7D)

![ind_2\binom{n}{l+1}=ind_2\frac{2^k+l}{l}+ind_2\frac{2^k+l-1}{l-1}+...+ind_2\frac{2^k+1}{1}+ind_2\frac{2^k}{l+1}](https://www.zhihu.com/equation?tex=ind_2%5Cbinom%7Bn%7D%7Bl%2B1%7D%3Dind_2%5Cfrac%7B2%5Ek%2Bl%7D%7Bl%7D%2Bind_2%5Cfrac%7B2%5Ek%2Bl-1%7D%7Bl-1%7D%2B...%2Bind_2%5Cfrac%7B2%5Ek%2B1%7D%7B1%7D%2Bind_2%5Cfrac%7B2%5Ek%7D%7Bl%2B1%7D)

而 ![ind_2\frac{2^k}{l+1}\geq1](https://www.zhihu.com/equation?tex=ind_2%5Cfrac%7B2%5Ek%7D%7Bl%2B1%7D%5Cgeq1) ，故 ![ind_2\binom{n}{l+1}\geq 1](https://www.zhihu.com/equation?tex=ind_2%5Cbinom%7Bn%7D%7Bl%2B1%7D%5Cgeq+1) ,![\binom{n}{l+1}](https://www.zhihu.com/equation?tex=%5Cbinom%7Bn%7D%7Bl%2B1%7D)为偶数。

得证。

2、证明：（与几何图形建立联系）

考虑直角坐标系中的区域 ![0< x\leq \frac{p}{2},0 < y\leq \frac{q}{2}](https://www.zhihu.com/equation?tex=0%3C+x%5Cleq+%5Cfrac%7Bp%7D%7B2%7D%2C0+%3C+y%5Cleq+%5Cfrac%7Bq%7D%7B2%7D)

显然其中有 ![\frac{p-1}{2}\frac{q-1}{2}](https://www.zhihu.com/equation?tex=%5Cfrac%7Bp-1%7D%7B2%7D%5Cfrac%7Bq-1%7D%7B2%7D) 个整点。

作直线 ![y=\frac{q}{p}x](https://www.zhihu.com/equation?tex=y%3D%5Cfrac%7Bq%7D%7Bp%7Dx) ，恰好为矩形区域的对角线。

因为 ![(p,q)=1](https://www.zhihu.com/equation?tex=%28p%2Cq%29%3D1) ，故直线上不存在区域中的整点。

考虑此直线以下的整点数。

当 ![x=1](https://www.zhihu.com/equation?tex=x%3D1) 时， ![0<y \leq \frac{q}{p}](https://www.zhihu.com/equation?tex=0%3Cy+%5Cleq+%5Cfrac%7Bq%7D%7Bp%7D) ，共 ![[\frac{q}{p}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7Bq%7D%7Bp%7D%5D) 个整点。

当 ![x=2](https://www.zhihu.com/equation?tex=x%3D2) 时， ![0<y \leq \frac{2q}{p}](https://www.zhihu.com/equation?tex=0%3Cy+%5Cleq+%5Cfrac%7B2q%7D%7Bp%7D) ，共 ![[\frac{2q}{p}]](https://www.zhihu.com/equation?tex=%5B%5Cfrac%7B2q%7D%7Bp%7D%5D) 个整点。

以此类推，当 ![x=\frac{p-1}{2}](https://www.zhihu.com/equation?tex=x%3D%5Cfrac%7Bp-1%7D%7B2%7D) 时， ![0<y \leq \frac{(p-1)q}{2p}](https://www.zhihu.com/equation?tex=0%3Cy+%5Cleq+%5Cfrac%7B%28p-1%29q%7D%7B2p%7D) ，共 ![ [\frac{(p-1)q}{2p}]](https://www.zhihu.com/equation?tex=+%5B%5Cfrac%7B%28p-1%29q%7D%7B2p%7D%5D) 个整点。

故直线下共有 ![\sum_{m<\frac{p}{2}}^{\ }[\frac{q}{p}m]](https://www.zhihu.com/equation?tex=%5Csum_%7Bm%3C%5Cfrac%7Bp%7D%7B2%7D%7D%5E%7B%5C+%7D%5B%5Cfrac%7Bq%7D%7Bp%7Dm%5D) 个整点。

同理地，直线上方共有 ![\sum_{n<\frac{q}{2}}^{\ }[\frac{p}{q}n]](https://www.zhihu.com/equation?tex=%5Csum_%7Bn%3C%5Cfrac%7Bq%7D%7B2%7D%7D%5E%7B%5C+%7D%5B%5Cfrac%7Bp%7D%7Bq%7Dn%5D) 个整点，故得证。

3、提示：同2做法，画出图形计数即可，附上我之前写过的解答。。
[有些数学问题不会，求教?​www.zhihu.com![图标](https://pic2.zhimg.com/v2-b59a5a00bfb1f3a955573fbdedda0a7d_120x160.jpg)](https://www.zhihu.com/question/287849195/answer/457693777)
4、证明：（善于利用积性进行变换）

由 ![\mu(d)](https://www.zhihu.com/equation?tex=%5Cmu%28d%29) 为积性函数，及其定义， ![\mu(d)\neq 0](https://www.zhihu.com/equation?tex=%5Cmu%28d%29%5Cneq+0) 当且仅当 ![d](https://www.zhihu.com/equation?tex=d) 的每个素因子方幂为1，故 ![ind_2(d)=0\ or\ 1](https://www.zhihu.com/equation?tex=ind_2%28d%29%3D0%5C+or%5C+1)

由 ![\varphi (n)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29) 为积性函数，当 ![n](https://www.zhihu.com/equation?tex=n) 为奇数时， ![(n,2)=1](https://www.zhihu.com/equation?tex=%28n%2C2%29%3D1) ，![\varphi (2n)=\varphi (2)\varphi (n)=\varphi (n)](https://www.zhihu.com/equation?tex=%5Cvarphi+%282n%29%3D%5Cvarphi+%282%29%5Cvarphi+%28n%29%3D%5Cvarphi+%28n%29)

原式 ![=\sum_{d \ is \ odd,\varphi (d)=k}^{\ }\mu(d)+\sum_{d \ is \ even,\varphi (d)=k}^{\ }\mu(d)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd+%5C+is+%5C+odd%2C%5Cvarphi+%28d%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%28d%29%2B%5Csum_%7Bd+%5C+is+%5C+even%2C%5Cvarphi+%28d%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%28d%29)

对第二项中的 ![d](https://www.zhihu.com/equation?tex=d) ， ![ind_2d=1](https://www.zhihu.com/equation?tex=ind_2d%3D1) ，故 ![d=2d_1](https://www.zhihu.com/equation?tex=d%3D2d_1) ，其中 ![d_1](https://www.zhihu.com/equation?tex=d_1) 为奇数。

故原式 ![=\sum_{d \ is \ odd,\varphi (d)=k}^{\ }\mu(d)+\sum_{d_1 \ is \ odd,\varphi (d_1)=k}^{\ }\mu(2d_1)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd+%5C+is+%5C+odd%2C%5Cvarphi+%28d%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%28d%29%2B%5Csum_%7Bd_1+%5C+is+%5C+odd%2C%5Cvarphi+%28d_1%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%282d_1%29)

而因为 ![(2,d_1)=1](https://www.zhihu.com/equation?tex=%282%2Cd_1%29%3D1) ， ![\mu(n)](https://www.zhihu.com/equation?tex=%5Cmu%28n%29) 为积性函数

![\Rightarrow \mu(2d_1)=\mu(2)\mu(d_1)=-\mu(d_1)](https://www.zhihu.com/equation?tex=%5CRightarrow+%5Cmu%282d_1%29%3D%5Cmu%282%29%5Cmu%28d_1%29%3D-%5Cmu%28d_1%29)

故原式 ![=\sum_{d \ is \ odd,\varphi (d)=k}^{\ }\mu(d)+\sum_{d_1 \ is \ odd,\varphi (d_1)=k}^{\ }-\mu(d_1)=0](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bd+%5C+is+%5C+odd%2C%5Cvarphi+%28d%29%3Dk%7D%5E%7B%5C+%7D%5Cmu%28d%29%2B%5Csum_%7Bd_1+%5C+is+%5C+odd%2C%5Cvarphi+%28d_1%29%3Dk%7D%5E%7B%5C+%7D-%5Cmu%28d_1%29%3D0)

5、解：（利用重数对素因数个数进行限制）

![n=1](https://www.zhihu.com/equation?tex=n%3D1) 成立，不妨设 ![n>1](https://www.zhihu.com/equation?tex=n%3E1)

由算数基本定理，![n=p_1^{\alpha_1}p_2^{\alpha_2}...p_k^{\alpha_k}](https://www.zhihu.com/equation?tex=n%3Dp_1%5E%7B%5Calpha_1%7Dp_2%5E%7B%5Calpha_2%7D...p_k%5E%7B%5Calpha_k%7D) ，此处 ![p_i](https://www.zhihu.com/equation?tex=p_i) 两两互异均为素数

![n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})|n](https://www.zhihu.com/equation?tex=n%281-%5Cfrac%7B1%7D%7Bp_1%7D%29%281-%5Cfrac%7B1%7D%7Bp_2%7D%29...%281-%5Cfrac%7B1%7D%7Bp_k%7D%29%7Cn)

![\Rightarrow (p_1-1)(p_2-1)...(p_k-1)|p_1p_2...p_k](https://www.zhihu.com/equation?tex=%5CRightarrow+%28p_1-1%29%28p_2-1%29...%28p_k-1%29%7Cp_1p_2...p_k)

若 ![n](https://www.zhihu.com/equation?tex=n) 为奇数， ![p_i](https://www.zhihu.com/equation?tex=p_i) 均为奇数， ![(p_1-1)(p_2-1)...(p_k-1)](https://www.zhihu.com/equation?tex=%28p_1-1%29%28p_2-1%29...%28p_k-1%29) 奇， ![p_1p_2...p_k](https://www.zhihu.com/equation?tex=p_1p_2...p_k) 偶，矛盾。

故 ![n](https://www.zhihu.com/equation?tex=n) 为偶数，不妨设 ![p_1=2](https://www.zhihu.com/equation?tex=p_1%3D2) 。

![\frac{p_1p_2...p_k}{(p_1-1)(p_2-1)...(p_k-1)}=2\frac{p_2...p_k}{(p_2-1)...(p_k-1)}](https://www.zhihu.com/equation?tex=%5Cfrac%7Bp_1p_2...p_k%7D%7B%28p_1-1%29%28p_2-1%29...%28p_k-1%29%7D%3D2%5Cfrac%7Bp_2...p_k%7D%7B%28p_2-1%29...%28p_k-1%29%7D) 为整数。

考虑分子与分母的2-重数。

![ind_2 p_1p_2...p_k=1](https://www.zhihu.com/equation?tex=ind_2+p_1p_2...p_k%3D1)

![ind_2 (p_1-1)(p_2-1)...(p_k-1)\geq k-1](https://www.zhihu.com/equation?tex=ind_2+%28p_1-1%29%28p_2-1%29...%28p_k-1%29%5Cgeq+k-1)

故 ![1\geq k-1\Rightarrow k\leq 2](https://www.zhihu.com/equation?tex=1%5Cgeq+k-1%5CRightarrow+k%5Cleq+2)

![k=1](https://www.zhihu.com/equation?tex=k%3D1) 时， ![n](https://www.zhihu.com/equation?tex=n) 为2的方幂。

![k=2](https://www.zhihu.com/equation?tex=k%3D2) 时， ![\frac{p_1p_2...p_k}{(p_1-1)(p_2-1)...(p_k-1)}=2\frac{p_2}{(p_2-1)}\in\mathbb{Z}](https://www.zhihu.com/equation?tex=%5Cfrac%7Bp_1p_2...p_k%7D%7B%28p_1-1%29%28p_2-1%29...%28p_k-1%29%7D%3D2%5Cfrac%7Bp_2%7D%7B%28p_2-1%29%7D%5Cin%5Cmathbb%7BZ%7D) （ ![p_2](https://www.zhihu.com/equation?tex=p_2) 为奇素数）

![\Rightarrow p_2-1|2\Rightarrow p_2=3](https://www.zhihu.com/equation?tex=%5CRightarrow+p_2-1%7C2%5CRightarrow+p_2%3D3)

综上， 当且仅当![n=2^\alpha3^\beta(\alpha,\beta\geq 0)](https://www.zhihu.com/equation?tex=n%3D2%5E%5Calpha3%5E%5Cbeta%28%5Calpha%2C%5Cbeta%5Cgeq+0%29) 时 ![\varphi (n)|n](https://www.zhihu.com/equation?tex=%5Cvarphi+%28n%29%7Cn)

6、提示：利用Euler函数的积性，若 ![p_1](https://www.zhihu.com/equation?tex=p_1) 为素数， ![\varphi (p_1^{\alpha_1})=p_1^{\alpha_1}-p_1^{\alpha_1-1}\Rightarrow \sum_{\varepsilon _1=0}^{\alpha_1}\varphi (p_1^{\varepsilon _1})=p_1^{\alpha_1}](https://www.zhihu.com/equation?tex=%5Cvarphi+%28p_1%5E%7B%5Calpha_1%7D%29%3Dp_1%5E%7B%5Calpha_1%7D-p_1%5E%7B%5Calpha_1-1%7D%5CRightarrow+%5Csum_%7B%5Cvarepsilon+_1%3D0%7D%5E%7B%5Calpha_1%7D%5Cvarphi+%28p_1%5E%7B%5Cvarepsilon+_1%7D%29%3Dp_1%5E%7B%5Calpha_1%7D)


这样总算是把第二大块也写完了嘿嘿嘿嘿（叉会儿腰(｀・ω・´)

