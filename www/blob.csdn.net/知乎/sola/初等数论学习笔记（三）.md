# 初等数论学习笔记（三） - 知乎
# 

第三块的内容是有关于同余和两个重要定理的（内容就比较少啦233）


**同余，Euler定理，Fermat定理**

**一、定义与基本性质**

以下默认 ![a,b,c,...](https://www.zhihu.com/equation?tex=a%2Cb%2Cc%2C...) 为整数， ![m](https://www.zhihu.com/equation?tex=m) 为正整数。

**定义：**

**若 ![a-b](https://www.zhihu.com/equation?tex=a-b) 为 ![m](https://www.zhihu.com/equation?tex=m) 的倍数（ ![m|a-b](https://www.zhihu.com/equation?tex=m%7Ca-b) ），则 ![a](https://www.zhihu.com/equation?tex=a) 与 ![b](https://www.zhihu.com/equation?tex=b) 模 ![m](https://www.zhihu.com/equation?tex=m) 同余。记为 ![a\equiv b(mod\ m)](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29) 。**

如下几条性质不加证明地直接给出（前三条都很显然啦，留给读者）

1、 ![a\equiv b(mod\ m)\Leftrightarrow \exists t\in\mathbb{Z},\ s.t.\ a=b+mt](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29%5CLeftrightarrow+%5Cexists+t%5Cin%5Cmathbb%7BZ%7D%2C%5C+s.t.%5C+a%3Db%2Bmt)

2、 ![\begin{cases} a_1\equiv b_1\\ a_2\equiv b_2\\ ...\\ a_k\equiv b_k \end{cases} (mod\ m) \Rightarrow \begin{cases} a_1+...+a_k\equiv b_1+...+b_k\\ a_1a_2...a_k\equiv b_1b_2...b_k \end{cases} (mod \ m)](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+a_1%5Cequiv+b_1%5C%5C+a_2%5Cequiv+b_2%5C%5C+...%5C%5C+a_k%5Cequiv+b_k+%5Cend%7Bcases%7D+%28mod%5C+m%29+%5CRightarrow+%5Cbegin%7Bcases%7D+a_1%2B...%2Ba_k%5Cequiv+b_1%2B...%2Bb_k%5C%5C+a_1a_2...a_k%5Cequiv+b_1b_2...b_k+%5Cend%7Bcases%7D+%28mod+%5C+m%29)

3、 ![a\equiv b(mod\ m)\Rightarrow \begin{cases} ka\equiv kb\\ a^n\equiv b^n \end{cases} (mod\ m)](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29%5CRightarrow+%5Cbegin%7Bcases%7D+ka%5Cequiv+kb%5C%5C+a%5En%5Cequiv+b%5En+%5Cend%7Bcases%7D+%28mod%5C+m%29)

4、 ![a\equiv b(mod\ m)\Rightarrow \begin{cases} (a,m)=(b,m)\\ \left \{ \frac{a}{m} \right \}=\left \{ \frac{b}{m} \right \} \end{cases}](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29%5CRightarrow+%5Cbegin%7Bcases%7D+%28a%2Cm%29%3D%28b%2Cm%29%5C%5C+%5Cleft+%5C%7B+%5Cfrac%7Ba%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Cleft+%5C%7B+%5Cfrac%7Bb%7D%7Bm%7D+%5Cright+%5C%7D+%5Cend%7Bcases%7D)

证明：由 ![a\equiv b(mod\ m)](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29) 与带余除法， ![\exists r,q_1,q_2,\ s.t.\ \begin{cases} a=q_1m+r\\ b=q_2m+r \end{cases}](https://www.zhihu.com/equation?tex=%5Cexists+r%2Cq_1%2Cq_2%2C%5C+s.t.%5C+%5Cbegin%7Bcases%7D+a%3Dq_1m%2Br%5C%5C+b%3Dq_2m%2Br+%5Cend%7Bcases%7D) ， ![0\leq r<m](https://www.zhihu.com/equation?tex=0%5Cleq+r%3Cm)

由最大公因数的性质， ![(a,m)=(m,r),(b,m)=(m,r)](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D%28m%2Cr%29%2C%28b%2Cm%29%3D%28m%2Cr%29) ，故 ![(a,m)=(b,m)](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D%28b%2Cm%29)

又 ![\frac{a}{m}=q_1+\frac{r}{m}(0\leq \frac{r}{m}<1)](https://www.zhihu.com/equation?tex=%5Cfrac%7Ba%7D%7Bm%7D%3Dq_1%2B%5Cfrac%7Br%7D%7Bm%7D%280%5Cleq+%5Cfrac%7Br%7D%7Bm%7D%3C1%29) ，故 ![\left \{ \frac{a}{m} \right \}=\frac{r}{m}](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+%5Cfrac%7Ba%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Cfrac%7Br%7D%7Bm%7D) 。

同理， ![\left \{ \frac{b}{m} \right \}=\frac{r}{m}](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+%5Cfrac%7Bb%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Cfrac%7Br%7D%7Bm%7D) ，得证。

**二、完全剩余系（ ![CRS](https://www.zhihu.com/equation?tex=CRS) ）**

**定义：**

**给定 ![m\in\mathbb{N},\mathbb{Z}_a=\left \{ km+a|k\in\mathbb{Z} \right \}](https://www.zhihu.com/equation?tex=m%5Cin%5Cmathbb%7BN%7D%2C%5Cmathbb%7BZ%7D_a%3D%5Cleft+%5C%7B+km%2Ba%7Ck%5Cin%5Cmathbb%7BZ%7D+%5Cright+%5C%7D)**

**![\forall r\in \mathbb{Z},\ \exists ! a,\ 0\leq a \leq m-1,\ s.t.\ r\in\mathbb{Z}_a](https://www.zhihu.com/equation?tex=%5Cforall+r%5Cin+%5Cmathbb%7BZ%7D%2C%5C+%5Cexists+%21+a%2C%5C+0%5Cleq+a+%5Cleq+m-1%2C%5C+s.t.%5C+r%5Cin%5Cmathbb%7BZ%7D_a)**

**则 ![S](https://www.zhihu.com/equation?tex=S) 为 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 完全剩余系 ![\Leftrightarrow ](https://www.zhihu.com/equation?tex=%5CLeftrightarrow+)****![S](https://www.zhihu.com/equation?tex=S) 满足 ![\begin{cases} S\subseteq \mathbb{Z}\\ \forall a,\ 0 \leq a \leq m-1,\exists !r\in S,\ s.t. r\in \mathbb{Z}_a \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+S%5Csubseteq+%5Cmathbb%7BZ%7D%5C%5C+%5Cforall+a%2C%5C+0+%5Cleq+a+%5Cleq+m-1%2C%5Cexists+%21r%5Cin+S%2C%5C+s.t.+r%5Cin+%5Cmathbb%7BZ%7D_a+%5Cend%7Bcases%7D)**

以下总是假定 ![S](https://www.zhihu.com/equation?tex=S) 为 ![mod \ m](https://www.zhihu.com/equation?tex=mod+%5C+m) 完全剩余系，则 ![S](https://www.zhihu.com/equation?tex=S) 有如下性质：

1、 ![|S|=m](https://www.zhihu.com/equation?tex=%7CS%7C%3Dm) ，且 ![S](https://www.zhihu.com/equation?tex=S) 中元素可排列为 ![S=\left \{ r_0,r_1,...,r_{m-1} \right \},\ s.t.r_a\equiv a(mod\ m) (0 \leq a \leq m-1)](https://www.zhihu.com/equation?tex=S%3D%5Cleft+%5C%7B+r_0%2Cr_1%2C...%2Cr_%7Bm-1%7D+%5Cright+%5C%7D%2C%5C+s.t.r_a%5Cequiv+a%28mod%5C+m%29+%280+%5Cleq+a+%5Cleq+m-1%29) 。（证略，根据定义即可推出）

2、若 ![|S|=m](https://www.zhihu.com/equation?tex=%7CS%7C%3Dm) ， ![S](https://www.zhihu.com/equation?tex=S) 中元素 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 两两不同余，则 ![S](https://www.zhihu.com/equation?tex=S) 为 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m)![CRS](https://www.zhihu.com/equation?tex=CRS) 。

证明：

对于 ![r\in \mathbb{Z}_a](https://www.zhihu.com/equation?tex=r%5Cin+%5Cmathbb%7BZ%7D_a) ，定义函数 ![f:S\rightarrow \left \{ \mathbb{Z}_0,\mathbb{Z}_1,...,\mathbb{Z}_{m-1} \right \},\ s.t.\ f(r)=\mathbb{Z}_a](https://www.zhihu.com/equation?tex=f%3AS%5Crightarrow+%5Cleft+%5C%7B+%5Cmathbb%7BZ%7D_0%2C%5Cmathbb%7BZ%7D_1%2C...%2C%5Cmathbb%7BZ%7D_%7Bm-1%7D+%5Cright+%5C%7D%2C%5C+s.t.%5C+f%28r%29%3D%5Cmathbb%7BZ%7D_a)

![S](https://www.zhihu.com/equation?tex=S) 中元素 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 两两不同余 ![\Rightarrow f](https://www.zhihu.com/equation?tex=%5CRightarrow+f) 为单射

![|S|=m](https://www.zhihu.com/equation?tex=%7CS%7C%3Dm)![\Rightarrow f](https://www.zhihu.com/equation?tex=%5CRightarrow+f) 为满射

故 ![f](https://www.zhihu.com/equation?tex=f) 为双射，故 ![S](https://www.zhihu.com/equation?tex=S) 为 ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS) 。

3、![S](https://www.zhihu.com/equation?tex=S) 为 ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS)， ![(k,m)=1](https://www.zhihu.com/equation?tex=%28k%2Cm%29%3D1) ，则 ![kS=\left \{ kr|r\in S \right \}](https://www.zhihu.com/equation?tex=kS%3D%5Cleft+%5C%7B+kr%7Cr%5Cin+S+%5Cright+%5C%7D) 为 ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS) 。

证明：

![|kS|=m](https://www.zhihu.com/equation?tex=%7CkS%7C%3Dm) ，根据性质2，只需证明 ![kS](https://www.zhihu.com/equation?tex=kS) 中元素 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 两两不同余。

反证，假设 ![kr_1\equiv kr_2(mod\ m)\Rightarrow m|k(r_1-r_2)](https://www.zhihu.com/equation?tex=kr_1%5Cequiv+kr_2%28mod%5C+m%29%5CRightarrow+m%7Ck%28r_1-r_2%29)

又 ![(k,m)=1](https://www.zhihu.com/equation?tex=%28k%2Cm%29%3D1) ，故 ![m|r_1-r_2\Rightarrow r_1\equiv r_2(mod\ m)](https://www.zhihu.com/equation?tex=m%7Cr_1-r_2%5CRightarrow+r_1%5Cequiv+r_2%28mod%5C+m%29)

与完全剩余系中元素 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 的唯一性矛盾。

故得证。

关于 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m)![CRS](https://www.zhihu.com/equation?tex=CRS) ，最自然的一个便就是 ![\left \{ 0,1,2,...,m-1 \right \}](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+0%2C1%2C2%2C...%2Cm-1+%5Cright+%5C%7D) 。

事实上， ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS) 在 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 加法和 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 乘法两个运算下构成交换幺环，取其中元素 ![a](https://www.zhihu.com/equation?tex=a) ，则 ![a](https://www.zhihu.com/equation?tex=a) 的逆元存在当且仅当 ![(a,m)=1](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D1) ，且 ![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS) 为有限域当且仅当 ![m](https://www.zhihu.com/equation?tex=m) 为素数，且任意两个![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS)都是**同构**的。（从抽象代数的角度看，从 ![CRS](https://www.zhihu.com/equation?tex=CRS) 到接下来介绍的 ![RRS](https://www.zhihu.com/equation?tex=RRS)的转变的实质是**去除那些不可逆的元素** ）


**三、既约剩余系（ ![RRS](https://www.zhihu.com/equation?tex=RRS) ）**

**定义： ![T](https://www.zhihu.com/equation?tex=T) 为 ![mod \ m\ RRS](https://www.zhihu.com/equation?tex=mod+%5C+m%5C+RRS)****![\Leftrightarrow T](https://www.zhihu.com/equation?tex=%5CLeftrightarrow+T) 满足条件 ![\begin{cases} T\subseteq \mathbb{Z}\\ \forall t\in T,\ (m,t)=1\\ \forall \mathbb{Z}_a,(a,m)=1,\exists !r\in T,\ s.t.\ r\in \mathbb{Z}_a \end{cases}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+T%5Csubseteq+%5Cmathbb%7BZ%7D%5C%5C+%5Cforall+t%5Cin+T%2C%5C+%28m%2Ct%29%3D1%5C%5C+%5Cforall+%5Cmathbb%7BZ%7D_a%2C%28a%2Cm%29%3D1%2C%5Cexists+%21r%5Cin+T%2C%5C+s.t.%5C+r%5Cin+%5Cmathbb%7BZ%7D_a+%5Cend%7Bcases%7D)**

顾名思义，既约剩余系的“既约”就体现在将完全剩余系中元素均约去了与 ![m](https://www.zhihu.com/equation?tex=m)所有的公共因子。 

当 ![m=p](https://www.zhihu.com/equation?tex=m%3Dp) 为素数时，特别地，有 ![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p) 的一个既约剩余系 ![\left \{ 1,2,...,p-1 \right \}](https://www.zhihu.com/equation?tex=%5Cleft+%5C%7B+1%2C2%2C...%2Cp-1+%5Cright+%5C%7D) 。不难发现， ![mod\ p](https://www.zhihu.com/equation?tex=mod%5C+p) 的 ![CRS](https://www.zhihu.com/equation?tex=CRS) 与 ![RRS](https://www.zhihu.com/equation?tex=RRS) 是统一的。

下面给出 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 的性质（读者可类比 ![CRS](https://www.zhihu.com/equation?tex=CRS)尝试自己写出，此处证明同上 ）

下设 ![T](https://www.zhihu.com/equation?tex=T) 为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS)

1、 ![|T|=\varphi (m)](https://www.zhihu.com/equation?tex=%7CT%7C%3D%5Cvarphi+%28m%29)

2、若 ![|T|=\varphi (m)](https://www.zhihu.com/equation?tex=%7CT%7C%3D%5Cvarphi+%28m%29) ， ![T](https://www.zhihu.com/equation?tex=T) 中元素 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 两两不同余， ![T](https://www.zhihu.com/equation?tex=T) 中任一元素与 ![m](https://www.zhihu.com/equation?tex=m) 互素，则 ![T ](https://www.zhihu.com/equation?tex=T+) 为 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m)![RRS](https://www.zhihu.com/equation?tex=RRS) 。

3、![T](https://www.zhihu.com/equation?tex=T) 为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS)， ![(k,m)=1](https://www.zhihu.com/equation?tex=%28k%2Cm%29%3D1) ，则 ![kT=\left \{ kr|r\in T \right \}](https://www.zhihu.com/equation?tex=kT%3D%5Cleft+%5C%7B+kr%7Cr%5Cin+T+%5Cright+%5C%7D) 为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 。

可能有很多没有接触过抽象代数的读者会困惑：完全剩余系与既约剩余系到底有什么具体的作用呢？下面要给出的著名的Euler定理虽然能展现出既约剩余系的威力，但是既约剩余系更多地用于进行规范化（任意两个 ![mod\ m\ CRS ](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS+) 间，必定存在一个双射使得两个完全剩余系中的元素得以一一对应，同样对 ![RRS](https://www.zhihu.com/equation?tex=RRS) 也成立）。（我们将在练习中得以更好地体会到）



**四、Euler定理与Fermat定理**

**定理：（Euler）若 ![(a,m)=1\Rightarrow a^{\varphi (m)}\equiv 1(mod\ m)](https://www.zhihu.com/equation?tex=%28a%2Cm%29%3D1%5CRightarrow+a%5E%7B%5Cvarphi+%28m%29%7D%5Cequiv+1%28mod%5C+m%29)**

证明：

我们先观察这个定理的形式，发现 ![\varphi (m)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28m%29) 刚好是 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 中元素的个数，而有![\varphi (m)](https://www.zhihu.com/equation?tex=%5Cvarphi+%28m%29)个 ![a](https://www.zhihu.com/equation?tex=a) 相乘，我们自然地想到去考虑![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 中所有元素的乘积的性质。

而![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 中所有元素均与 ![m](https://www.zhihu.com/equation?tex=m) 互素，这个条件允许我们在 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 同余式的两端同时除去任意多个既约剩余系中元素并且保持同余式仍然成立。

到此为止，我们似乎将所有条件串在了一起。

由既约剩余系的性质3，设 ![T](https://www.zhihu.com/equation?tex=T) 为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS)，则 ![aT=\left \{ ar|r\in T \right \}](https://www.zhihu.com/equation?tex=aT%3D%5Cleft+%5C%7B+ar%7Cr%5Cin+T+%5Cright+%5C%7D) 仍为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) 。

考虑既约剩余系中所有元素的乘积： ![T=\left \{ t_1,t_2,...,t_c \right \},aT=\left \{ at_1,at_2,...,at_c \right \}](https://www.zhihu.com/equation?tex=T%3D%5Cleft+%5C%7B+t_1%2Ct_2%2C...%2Ct_c+%5Cright+%5C%7D%2CaT%3D%5Cleft+%5C%7B+at_1%2Cat_2%2C...%2Cat_c+%5Cright+%5C%7D)，其中 ![c=\varphi (m)](https://www.zhihu.com/equation?tex=c%3D%5Cvarphi+%28m%29) 。

存在双射 ![f](https://www.zhihu.com/equation?tex=f) ，使得 ![T](https://www.zhihu.com/equation?tex=T) 中元素与 ![aT](https://www.zhihu.com/equation?tex=aT) 中元素一一对应（ ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 同余）

由同余的性质2， ![t_1t_2...t_c\equiv (at_1)(at_2)...(at_c)\ \ (mod\ m)](https://www.zhihu.com/equation?tex=t_1t_2...t_c%5Cequiv+%28at_1%29%28at_2%29...%28at_c%29%5C+%5C+%28mod%5C+m%29)

![ (a^c-1)t_1t_2...t_c\equiv 0\ \ (mod\ m)](https://www.zhihu.com/equation?tex=+%28a%5Ec-1%29t_1t_2...t_c%5Cequiv+0%5C+%5C+%28mod%5C+m%29)

注意到既约剩余系中每个元素与 ![m](https://www.zhihu.com/equation?tex=m) 互素，故 ![a^{c}\equiv 1(mod\ m)](https://www.zhihu.com/equation?tex=a%5E%7Bc%7D%5Cequiv+1%28mod%5C+m%29) ，得证。

特别地，当 ![m](https://www.zhihu.com/equation?tex=m) 为素数时，我们有：

**推论：（Fermat） ![p](https://www.zhihu.com/equation?tex=p) 为素数，且 ![(a,p)=1](https://www.zhihu.com/equation?tex=%28a%2Cp%29%3D1) ，则 ![a^{p-1}\equiv 1\ (mod \ p)](https://www.zhihu.com/equation?tex=a%5E%7Bp-1%7D%5Cequiv+1%5C+%28mod+%5C+p%29) 。**

在Euler定理的证明过程中，我们不难体会到既约剩余系的规范性作用（不知道我起的名字咋样233，其实已经带有群论的味道了），我们利用既约剩余系中元素作为中介，造出另一个既约剩余系，却在最后又消去了既约剩余系中元素，来得到一些普遍的结论（是代数学中很重要的思想）

这里多嘴地再提一句，当我们想要证明 ![a\equiv b(mod\ m)](https://www.zhihu.com/equation?tex=a%5Cequiv+b%28mod%5C+m%29) 时，如果证明遇到困难然而 ![\exists\ k,ka,kb](https://www.zhihu.com/equation?tex=%5Cexists%5C+k%2Cka%2Ckb) 的**形式比较简单**，**可以利用的一种方法**是先证明 ![ka\equiv kb(mod\ m)](https://www.zhihu.com/equation?tex=ka%5Cequiv+kb%28mod%5C+m%29) ，再证明 ![(k,m)=1](https://www.zhihu.com/equation?tex=%28k%2Cm%29%3D1) 来得到结论。

在习题中我们还能够再有机会深入体会到剩余系的规范性作用。但是此处既然讲到了Fermat定理，想要再给出一些其他证明方法。。。。。（也是帮助拓宽思路）

Fermat另证一：（二项式系数+累加）

考虑 ![(a+1)^p](https://www.zhihu.com/equation?tex=%28a%2B1%29%5Ep) 的二项展开式，容易知道 ![p|\binom{p}{i}(\forall 1\leq i\leq p-1)](https://www.zhihu.com/equation?tex=p%7C%5Cbinom%7Bp%7D%7Bi%7D%28%5Cforall+1%5Cleq+i%5Cleq+p-1%29) （读者可自己证明）

得 ![a^p+1\equiv (a+1)^p\ (mod\ p)](https://www.zhihu.com/equation?tex=a%5Ep%2B1%5Cequiv+%28a%2B1%29%5Ep%5C+%28mod%5C+p%29)

如下进行累加： ![\begin{cases} 1^p+1\equiv 2^p\\ 2^p+1\equiv 3^p\\ ...\\ a^p+1\equiv (a+1)^p \end{cases} (mod\ p)](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+1%5Ep%2B1%5Cequiv+2%5Ep%5C%5C+2%5Ep%2B1%5Cequiv+3%5Ep%5C%5C+...%5C%5C+a%5Ep%2B1%5Cequiv+%28a%2B1%29%5Ep+%5Cend%7Bcases%7D+%28mod%5C+p%29)

得 ![(a+1)^p\equiv a+1(mod\ p)\Rightarrow a^p\equiv a(mod\ p)](https://www.zhihu.com/equation?tex=%28a%2B1%29%5Ep%5Cequiv+a%2B1%28mod%5C+p%29%5CRightarrow+a%5Ep%5Cequiv+a%28mod%5C+p%29)

又 ![(a,p)=1](https://www.zhihu.com/equation?tex=%28a%2Cp%29%3D1) ，故得证。

从上述证明中我们又能得到一个很有用的推论：

**推论：![p](https://www.zhihu.com/equation?tex=p) 为素数，则 **![a^{p}\equiv a\ (mod \ p)](https://www.zhihu.com/equation?tex=a%5E%7Bp%7D%5Cequiv+a%5C+%28mod+%5C+p%29)** 。**

**注意：这里不再需要两数互素的条件，适用范围更加广。**

Fermat另证二：（组合数学）

考虑现在有一些珠子 ，一共![a](https://www.zhihu.com/equation?tex=a) 种颜色，现在要取出 ![p](https://www.zhihu.com/equation?tex=p) 颗串成一项链使得项链中珠子的颜色至少有两种。先考虑排成直线的情况，则共有 ![a^p-a](https://www.zhihu.com/equation?tex=a%5Ep-a) 种排列方法。然而线排列变为圆排列时，方法数变为 ![\frac{a^p-a}{p}](https://www.zhihu.com/equation?tex=%5Cfrac%7Ba%5Ep-a%7D%7Bp%7D) ，而方法数必为整数，故 ![a^p\equiv a(mod\ p)](https://www.zhihu.com/equation?tex=a%5Ep%5Cequiv+a%28mod%5C+p%29) ，得证。



习题：（若无特别说明，字母均为正整数）

1、 ![S=\left \{ r_0,r_1,...,r_{m-1} \right \}](https://www.zhihu.com/equation?tex=S%3D%5Cleft+%5C%7B+r_0%2Cr_1%2C...%2Cr_%7Bm-1%7D+%5Cright+%5C%7D) 为 ![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 完全剩余系， ![f:\mathbb{R}\rightarrow \mathbb{C}](https://www.zhihu.com/equation?tex=f%3A%5Cmathbb%7BR%7D%5Crightarrow+%5Cmathbb%7BC%7D) 为周期为1的函数，证明： ![\sum_{i=0}^{m-1}f(\frac{r_i}{m})=\sum_{i=0}^{m-1}f(\frac{i}{m})](https://www.zhihu.com/equation?tex=%5Csum_%7Bi%3D0%7D%5E%7Bm-1%7Df%28%5Cfrac%7Br_i%7D%7Bm%7D%29%3D%5Csum_%7Bi%3D0%7D%5E%7Bm-1%7Df%28%5Cfrac%7Bi%7D%7Bm%7D%29) 。

2、 ![\forall k,b,(k,m)=1,](https://www.zhihu.com/equation?tex=%5Cforall+k%2Cb%2C%28k%2Cm%29%3D1%2C) 证明： ![\sum_{i=0}^{m-1}\left \{ \frac{ki+b}{m} \right \}=\frac{m-1}{2}](https://www.zhihu.com/equation?tex=%5Csum_%7Bi%3D0%7D%5E%7Bm-1%7D%5Cleft+%5C%7B+%5Cfrac%7Bki%2Bb%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Cfrac%7Bm-1%7D%7B2%7D) 。

3、 ![T_1,T_2](https://www.zhihu.com/equation?tex=T_1%2CT_2) 为 ![mod\ m\ RRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+RRS) ，![f:\mathbb{R}\rightarrow \mathbb{C}](https://www.zhihu.com/equation?tex=f%3A%5Cmathbb%7BR%7D%5Crightarrow+%5Cmathbb%7BC%7D) 为周期为1的函数，证明： ![\sum_{s\in T_1}^{\ }f(\frac{s}{m})=\sum_{t\in T_2}^{\ }f(\frac{t}{m})](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T_1%7D%5E%7B%5C+%7Df%28%5Cfrac%7Bs%7D%7Bm%7D%29%3D%5Csum_%7Bt%5Cin+T_2%7D%5E%7B%5C+%7Df%28%5Cfrac%7Bt%7D%7Bm%7D%29) 。

4、 ![T为mod\ m\ RRS](https://www.zhihu.com/equation?tex=T%E4%B8%BAmod%5C+m%5C+RRS) ，证明： ![\sum_{s\in T}^{\ }\left \{ \frac{s}{m} \right \}=\frac{\varphi (m)}{2}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7D%5Cleft+%5C%7B+%5Cfrac%7Bs%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Cfrac%7B%5Cvarphi+%28m%29%7D%7B2%7D)

5、证明： ![ka\equiv kb(mod\ m)\Leftrightarrow a\equiv b(mod\ \frac{m}{(k,m)})](https://www.zhihu.com/equation?tex=ka%5Cequiv+kb%28mod%5C+m%29%5CLeftrightarrow+a%5Cequiv+b%28mod%5C+%5Cfrac%7Bm%7D%7B%28k%2Cm%29%7D%29)

6、证明： ![\sum_{r=0}^{m-1}e^{2\pi ir\frac{k}{m}}= \begin{cases} m\ \ if\ m|k\\ 0\ \ \ else \end{cases}](https://www.zhihu.com/equation?tex=%5Csum_%7Br%3D0%7D%5E%7Bm-1%7De%5E%7B2%5Cpi+ir%5Cfrac%7Bk%7D%7Bm%7D%7D%3D+%5Cbegin%7Bcases%7D+m%5C+%5C+if%5C+m%7Ck%5C%5C+0%5C+%5C+%5C+else+%5Cend%7Bcases%7D)

7、 ![(m_1,m_2)=1](https://www.zhihu.com/equation?tex=%28m_1%2Cm_2%29%3D1) ，![S_1为mod\ m_1\ CRS，S_2为mod\ m_2\ CRS](https://www.zhihu.com/equation?tex=S_1%E4%B8%BAmod%5C+m_1%5C+CRS%EF%BC%8CS_2%E4%B8%BAmod%5C+m_2%5C+CRS) ，证明： ![S=\left \{ s_1m_2+s_2m_1|s_1\in S_1,s_2\in S_2 \right \}为mod\ m_1m_2\ CRS](https://www.zhihu.com/equation?tex=S%3D%5Cleft+%5C%7B+s_1m_2%2Bs_2m_1%7Cs_1%5Cin+S_1%2Cs_2%5Cin+S_2+%5Cright+%5C%7D%E4%B8%BAmod%5C+m_1m_2%5C+CRS) 。

8、![(m_1,m_2)=1](https://www.zhihu.com/equation?tex=%28m_1%2Cm_2%29%3D1) ，![T_1为mod\ m_1\ RRS，T_2为mod\ m_2\ RRS](https://www.zhihu.com/equation?tex=T_1%E4%B8%BAmod%5C+m_1%5C+RRS%EF%BC%8CT_2%E4%B8%BAmod%5C+m_2%5C+RRS) ，证明： ![T=\left \{ t_1m_2+t_2m_1|t_1\in T_1,t_2\in T_2 \right \}为mod\ m_1m_2\ RRS](https://www.zhihu.com/equation?tex=T%3D%5Cleft+%5C%7B+t_1m_2%2Bt_2m_1%7Ct_1%5Cin+T_1%2Ct_2%5Cin+T_2+%5Cright+%5C%7D%E4%B8%BAmod%5C+m_1m_2%5C+RRS) 。

9、![T为mod\ m\ RRS](https://www.zhihu.com/equation?tex=T%E4%B8%BAmod%5C+m%5C+RRS)

（1）： ![m=p](https://www.zhihu.com/equation?tex=m%3Dp) 为素数，求 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D)

（2）： ![m=p^\alpha,p](https://www.zhihu.com/equation?tex=m%3Dp%5E%5Calpha%2Cp) 为素数， ![\alpha>1](https://www.zhihu.com/equation?tex=%5Calpha%3E1) ，求 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D)

（3）：从以上两条可以发现 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D) 与哪一个数论函数的关联？证明你的猜想。



解答或提示：

1、提示：利用任意两个![mod\ m](https://www.zhihu.com/equation?tex=mod%5C+m) 完全剩余系之间存在双射。

2、提示：利用1的结论（可以感受到 ![CRS](https://www.zhihu.com/equation?tex=CRS) 的规范化作用）

3、提示：做法同1。

4、提示：（ ![RRS](https://www.zhihu.com/equation?tex=RRS) 的规范化作用）

设 ![T_1=\left \{ s|1\leq s<\frac{m}{2},(s,m)=1 \right \},T_2=\left \{ s|\frac{m}{2}\leq s<m,(s,m)=1 \right \}](https://www.zhihu.com/equation?tex=T_1%3D%5Cleft+%5C%7B+s%7C1%5Cleq+s%3C%5Cfrac%7Bm%7D%7B2%7D%2C%28s%2Cm%29%3D1+%5Cright+%5C%7D%2CT_2%3D%5Cleft+%5C%7B+s%7C%5Cfrac%7Bm%7D%7B2%7D%5Cleq+s%3Cm%2C%28s%2Cm%29%3D1+%5Cright+%5C%7D)

容易证明 ![T_1\cup T_2](https://www.zhihu.com/equation?tex=T_1%5Ccup+T_2) 为![mod\ m\ CRS](https://www.zhihu.com/equation?tex=mod%5C+m%5C+CRS)。

又注意到 ![(s,m)=1\Leftrightarrow (m-s,m)=1](https://www.zhihu.com/equation?tex=%28s%2Cm%29%3D1%5CLeftrightarrow+%28m-s%2Cm%29%3D1) ，容易证明 ![T_2=\left \{ m-s|s\in T_1 \right \}](https://www.zhihu.com/equation?tex=T_2%3D%5Cleft+%5C%7B+m-s%7Cs%5Cin+T_1+%5Cright+%5C%7D) 。

![2\sum_{s\in T}^{\ }\left \{ \frac{s}{m} \right \}=\sum_{s\in T_1}^{\ }\left \{ \frac{s}{m} \right \}+\sum_{s\in T_2}^{\ }\left \{ \frac{s}{m} \right \}](https://www.zhihu.com/equation?tex=2%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7D%5Cleft+%5C%7B+%5Cfrac%7Bs%7D%7Bm%7D+%5Cright+%5C%7D%3D%5Csum_%7Bs%5Cin+T_1%7D%5E%7B%5C+%7D%5Cleft+%5C%7B+%5Cfrac%7Bs%7D%7Bm%7D+%5Cright+%5C%7D%2B%5Csum_%7Bs%5Cin+T_2%7D%5E%7B%5C+%7D%5Cleft+%5C%7B+%5Cfrac%7Bs%7D%7Bm%7D+%5Cright+%5C%7D)

![=\sum_{s\in T_1} \frac{s}{m} +\sum_{s\in T_1} \frac{m-s}{m} =\sum_{s\in T_1}1=\varphi(m)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bs%5Cin+T_1%7D+%5Cfrac%7Bs%7D%7Bm%7D+%2B%5Csum_%7Bs%5Cin+T_1%7D+%5Cfrac%7Bm-s%7D%7Bm%7D+%3D%5Csum_%7Bs%5Cin+T_1%7D1%3D%5Cvarphi%28m%29)

5、提示：化为整除问题即可，比较简单。

6、提示： ![m|k](https://www.zhihu.com/equation?tex=m%7Ck) 时容易证明，否则可利用等比数列求和公式证明。

7、提示：利用 ![CRS](https://www.zhihu.com/equation?tex=CRS) 性质2验证即可。

8、提示：利用 ![RRS](https://www.zhihu.com/equation?tex=RRS) 性质2验证即可。

9、解答：（一个**重要而又优美的定理**，嘿嘿嘿）

（1）：注意到 ![e^{2\pi ir\frac{k}{m}}](https://www.zhihu.com/equation?tex=e%5E%7B2%5Cpi+ir%5Cfrac%7Bk%7D%7Bm%7D%7D) 为关于 ![r](https://www.zhihu.com/equation?tex=r) 周期1的函数，故取 ![T=\left \{ 0,1,2,...,p-1 \right \}](https://www.zhihu.com/equation?tex=T%3D%5Cleft+%5C%7B+0%2C1%2C2%2C...%2Cp-1+%5Cright+%5C%7D) ，即可得到 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{p}}=-1](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bp%7D%7D%3D-1) 。

（2）：考虑 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{p^\alpha}}(\alpha>1)](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bp%5E%5Calpha%7D%7D%28%5Calpha%3E1%29) ，此时 ![(s,p^\alpha)=1](https://www.zhihu.com/equation?tex=%28s%2Cp%5E%5Calpha%29%3D1) ， ![s可取遍1到p^\alpha-1中不是p的方幂的所有整数](https://www.zhihu.com/equation?tex=s%E5%8F%AF%E5%8F%96%E9%81%8D1%E5%88%B0p%5E%5Calpha-1%E4%B8%AD%E4%B8%8D%E6%98%AFp%E7%9A%84%E6%96%B9%E5%B9%82%E7%9A%84%E6%89%80%E6%9C%89%E6%95%B4%E6%95%B0) 。

故将 ![s](https://www.zhihu.com/equation?tex=s) 表示为如下形式： ![s=s_1+ps_2(1\leq s_1 \leq p-1,0\leq s_2 \leq p^{\alpha-1}-1)](https://www.zhihu.com/equation?tex=s%3Ds_1%2Bps_2%281%5Cleq+s_1+%5Cleq+p-1%2C0%5Cleq+s_2+%5Cleq+p%5E%7B%5Calpha-1%7D-1%29)

则有： ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{p^\alpha}}=\sum_{1\leq s_1 \leq p-1,0\leq s_2 \leq p^{\alpha-1}-1}e^{2\pi i\frac{s_1}{p^\alpha}}e^{2\pi i\frac{s_2}{p^{\alpha-1}}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bp%5E%5Calpha%7D%7D%3D%5Csum_%7B1%5Cleq+s_1+%5Cleq+p-1%2C0%5Cleq+s_2+%5Cleq+p%5E%7B%5Calpha-1%7D-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_1%7D%7Bp%5E%5Calpha%7D%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bp%5E%7B%5Calpha-1%7D%7D%7D)

![=\sum_{s_1=1}^{p-1}e^{2\pi i\frac{s_1}{p^\alpha}}\sum_{s_2=0}^{p^{\alpha-1}-1}e^{2\pi i\frac{s_2}{p^{\alpha-1}}}](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bs_1%3D1%7D%5E%7Bp-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_1%7D%7Bp%5E%5Calpha%7D%7D%5Csum_%7Bs_2%3D0%7D%5E%7Bp%5E%7B%5Calpha-1%7D-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bp%5E%7B%5Calpha-1%7D%7D%7D)

考虑 ![\sum_{s_2=0}^{p^{\alpha-1}-1}e^{2\pi i\frac{s_2}{p^{\alpha-1}}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs_2%3D0%7D%5E%7Bp%5E%7B%5Calpha-1%7D-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bp%5E%7B%5Calpha-1%7D%7D%7D) ，容易验证 ![\sum_{s_2=1}^{p^{\alpha-1}-1}e^{2\pi i\frac{s_2}{p^{\alpha-1}}}=-1](https://www.zhihu.com/equation?tex=%5Csum_%7Bs_2%3D1%7D%5E%7Bp%5E%7B%5Calpha-1%7D-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bp%5E%7B%5Calpha-1%7D%7D%7D%3D-1) ，而 ![s_2=0](https://www.zhihu.com/equation?tex=s_2%3D0) 对应项为 ![1](https://www.zhihu.com/equation?tex=1) ，故 ![\sum_{s_2=0}^{p^{\alpha-1}-1}e^{2\pi i\frac{s_2}{p^{\alpha-1}}}=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bs_2%3D0%7D%5E%7Bp%5E%7B%5Calpha-1%7D-1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bp%5E%7B%5Calpha-1%7D%7D%7D%3D0)

故 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{p^\alpha}}=0](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bp%5E%5Calpha%7D%7D%3D0)

（3）： ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D) 在素数处取值为 ![-1](https://www.zhihu.com/equation?tex=-1) ，在素数的大于1的方幂处取值为

![0](https://www.zhihu.com/equation?tex=0) ，发现与Mobius函数 ![\mu(m)](https://www.zhihu.com/equation?tex=%5Cmu%28m%29) 吻合。

**定理：![T为mod\ m\ RRS](https://www.zhihu.com/equation?tex=T%E4%B8%BAmod%5C+m%5C+RRS)， ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}=\mu(m)](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D%3D%5Cmu%28m%29) 。**

证明：

只需再证明 ![f(m)=\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m}}](https://www.zhihu.com/equation?tex=f%28m%29%3D%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm%7D%7D) 具有积性性质即可。

即证 ![(m_1,m_2)=1时，f(m_1m_2)=f(m_1)f(m_2)](https://www.zhihu.com/equation?tex=%28m_1%2Cm_2%29%3D1%E6%97%B6%EF%BC%8Cf%28m_1m_2%29%3Df%28m_1%29f%28m_2%29) 。

对于 ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m_1m_2}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm_1m_2%7D%7D) ， ![T为mod\ m_1m_2\ RRS](https://www.zhihu.com/equation?tex=T%E4%B8%BAmod%5C+m_1m_2%5C+RRS) ，由8的结论，可构造![T^1=\left \{ t_1m_2+t_2m_1|t_1\in T_1,t_2\in T_2 \right \}为mod\ m_1m_2\ RRS](https://www.zhihu.com/equation?tex=T%5E1%3D%5Cleft+%5C%7B+t_1m_2%2Bt_2m_1%7Ct_1%5Cin+T_1%2Ct_2%5Cin+T_2+%5Cright+%5C%7D%E4%B8%BAmod%5C+m_1m_2%5C+RRS) 。

由3的结论， ![\sum_{s\in T}^{\ }e^{2\pi i\frac{s}{m_1m_2}}=\sum_{s_1\in T_1}\sum_{s_2\in T_2}e^{2\pi i\frac{s_1m_2+s_2m_1}{m_1m_2}}](https://www.zhihu.com/equation?tex=%5Csum_%7Bs%5Cin+T%7D%5E%7B%5C+%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs%7D%7Bm_1m_2%7D%7D%3D%5Csum_%7Bs_1%5Cin+T_1%7D%5Csum_%7Bs_2%5Cin+T_2%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_1m_2%2Bs_2m_1%7D%7Bm_1m_2%7D%7D)![=\sum_{s_1\in T_1}e^{2\pi i\frac{s_1}{m_1}}\sum_{s_2\in T_2}e^{2\pi i\frac{s_2}{m_2}}=f(m_1)f(m_2)](https://www.zhihu.com/equation?tex=%3D%5Csum_%7Bs_1%5Cin+T_1%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_1%7D%7Bm_1%7D%7D%5Csum_%7Bs_2%5Cin+T_2%7De%5E%7B2%5Cpi+i%5Cfrac%7Bs_2%7D%7Bm_2%7D%7D%3Df%28m_1%29f%28m_2%29) ，得证。

这个定理将既约剩余系与数论函数联系在了一起，进一步地，既约剩余系是可以生成Mobius函数的，在进一步地，既约剩余系也可以生成其他数论函数，如： ![\varphi(m),\tau(m)](https://www.zhihu.com/equation?tex=%5Cvarphi%28m%29%2C%5Ctau%28m%29) 等等。这让我们再一次看到了既约剩余系在初等数论中举足轻重的地位。

到此为止，第三部分就施工完毕啦！

