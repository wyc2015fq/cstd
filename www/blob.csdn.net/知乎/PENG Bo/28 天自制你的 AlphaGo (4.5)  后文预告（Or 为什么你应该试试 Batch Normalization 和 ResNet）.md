# 28 天自制你的 AlphaGo (4.5) : 后文预告（Or 为什么你应该试试 Batch Normalization 和 ResNet） - 知乎
# 


知乎对于人机大战的关注度很高，所以写这个系列，希望能让大家对于人工智能和围棋有更多的了解。如果有收获，请记得点一下赞。
本系列已更新多篇，其它几篇的传送门：
- *(1) : 围棋 AI 基础 [知乎专栏](https://zhuanlan.zhihu.com/p/24801451)*
- *(2) : 安装 MXNet 搭建深度学习环境 [知乎专栏](https://zhuanlan.zhihu.com/p/24879716)*
- *(3) : 训练策略网络，真正与之对弈 [知乎专栏](https://zhuanlan.zhihu.com/p/24885190)*
- *(4) : 对于策略网络的深入分析（以及它的弱点所在） [知乎专栏](https://zhuanlan.zhihu.com/p/24939269)*


各位新年好。说说后文的计划，在此先看网络的方面：

**1. 适当提高内容的专业性，运用最近几年的深层卷积网络的最新发展，如 BN，ResNet ResNeXt，Inception v1 v2 v3 v4，SqueezeNet，DSD 等等。**
- 标题图是 Inception 模块。其实目前深层卷积网络的某种结构范式已经隐隐出现，就是 Inception 加 ResNet（保证信息高速公路畅通，千层网络不是梦），中间都是 BN 和 ReLU，再找地方加 bottleneck，缩尺寸用各种 pooling 和 stride convolution 配合（这个对于围棋不需要）。

**2. 高速训练网络的实际技巧，和高速训练程序的架构设计。如果使用各种技巧，可以很快训练出效果好的网络。**我试了一下，GTX1070 跑 Tygem 的两万多局，用几个小时就可以到 50% 预测准确率，中低端显卡跑一天也肯定可以。

简单说一下：
- 请用 MXnet。
- 喂数据应该专门开一个进程（用 Queue 储存和读取），这样 GPU 就不会经常停下来等候。

- Batch size 的选择。学习速率可以用"聪明"的方法自适应下降。梯度下降方法的选择。

- 网络的架构。如果你没有集群，BN 是必须要用的免费午餐，简单地说类似于"校准准星"，收敛速度可以快很多倍（而且只需要一行代码）。加入 ResNet 结构后更快！其实 ResNet 也几乎就是一行代码。另外，会说说为什么大家的卷积核都用 3x3，最后一层为什么也用卷积（而不是全链接层）。
- 顺便说一句，这几年在图像分类问题上大家已经很少用全链接层，经典的 DropOut 等正则化方法也不见得要用了。
- 顺便说一句，现在的流行趋势是卷积核越来越小，1x1 1x3 3x1 大行其道，这也是有原因的。特别是 1x1 是必须掌握的。
- 有趣的问题是 BN 层应该放在哪里。理论上是应该放在 ReLU 前面。不过也有人放在 ReLU 后面，或者说卷积层前面。其实，深度网络中的层的顺序，是个重要的问题（例如 ResNet 的第二篇论文）。
- **数据集的随机性很重要。数据集的增强（8种对称性），如果不做处理，必然会严重过拟合。**
- 顺便说一句，大家都习惯发论文用 KGS 7d+ 数据，但这个数据集有个问题。请看 KGS 的排名：[Top 100 KGS Players](https://link.zhihu.com/?target=http%3A//www.gokgs.com/top100.jsp) 可见 7d+ 的人数目前是 100 位以内（从前可能更少），活跃的用户更少，所以实际上学到的更像是寥寥几十位业余高手的行棋习惯（唯一好处是：容易刷榜！预测准确率可以高几个百分点）。个人建议花 15 刀买个 GoGod。

**3. 进一步揭开深层卷积网络的"思考"过程。**神经网络并不是一个黑盒子，之前已经有许多人在图像识别的问题上运用这些方法解释网络的运作：- 第一，可以看到每一步的理由：电脑认为，应该走这里的理由是什么（会在棋盘上显示相应的关键区域），不应该走那里的理由是什么。

- 第二，可以看到神经网络的每一层具体是在做什么。我们会发现，神经网络与人类棋手的思维有很多相似之处，但也有微妙的区别，十分有趣。

- 第三，人工一步步模拟一个简化的网络的计算过程，体验"人间AlphaGo"的感觉。

这篇就到此吧，我们下一篇见。**大家可以留言说说对于哪里感兴趣，我看看下篇从哪里开始写。**

> 如需转载本系列，请先与本人联系，谢谢。小广告：晚上工作学习是否觉得光线不够舒服，精神不够集中，眼睛容易疲劳？不妨点击看看我们的自然全光谱灯系列：[Blink Sunshine护眼LED灯泡 高显指97显色指数无频闪学习台灯床头](https://link.zhihu.com/?target=https%3A//item.taobao.com/item.htm%3Fid%3D40134613056) 如果需要好用的耳机或钱包，我们也有 :-)


