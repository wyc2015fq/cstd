# 由图的3-着色问题论四色问题及NP=P? - 知乎
# 

> 作者简介： [@胡qy](https://www.zhihu.com/people/e7b403615f68e3af7539e08dc70c00bd) 湖南大学04年本科毕业、高中数学老师、业余时间研读并发表paper
*欢迎原链接转发，转载请前往*[@留德华叫兽](https://www.zhihu.com/people/961e8cc4f7512fda1ea6626ce9a05e8e)*的主页获取信息，盗版必究。**敬请关注和扩散本专栏及同名公众号，会邀请**全球知名学者**陆续发布运筹学、人工智能中优化理论等相关干货、[知乎Live](https://www.zhihu.com/lives/users/961e8cc4f7512fda1ea6626ce9a05e8e)及行业动态：*[『运筹OR帷幄』大数据人工智能时代的运筹学--知乎专栏](https://zhuanlan.zhihu.com/operations-research)

## **前言**

作者[@胡qy](https://www.zhihu.com/people/e7b403615f68e3af7539e08dc70c00bd)本科湖南大学数学专业，2003年底开始研究四色问题的手工证明。由于不注意查文献，走了很多弯路，也加深了对着色问题的理解。自2011年了解了NP完全问题及其实用意义，得知一般的图着色问题是NP完全的，在考虑一般的图着色问题中发现仍然绕不过图的3-着色问题，查阅文献发现原来图的3-着色问题也是NP完全问题。某一天突然得到几个重要的概念，经过对这些概念的深刻理解，自认为对四色问题以及NP=P?的研究有突破性的进展，几经斟酌，修补漏洞，最终得到了图的3-着色问题的多项式时间算法。然而，其中一个关键命题的严格且完整的证明却始终得不到，虽然本人越验证越觉得其正确。因此，抛砖引玉，望高人能解我疑惑。

**摘要：**本文给出了证明四色定理的一个新思路；给出了对平面图的顶点进行4-着色的多项式时间算法；给出了图的3-着色问题（著名的NP完全问题）存在多项式时间算法——即NP=P——的充要条件。在假设所给的NP=P的充要条件成立的基础上（本人所能给的是部分证明，严格但是不完整），本文给出了图的3-着色问题的多项式时间算法。

`关键词：平面图  3-着色问题  多项式时间  算法  NP完全问题`

## **正文**

**概述：**著名的“四色定理”说明，平面图的顶点可以4-着色。但证明是由计算机得到的，至今没有手工的证明。

对于任意简单无向图G，判断G的顶点可否3-着色是一个NP完全问题，哪怕G是平面图且每个顶点的度都不大于4[1]。

图的3-着色问题之所以困难，在于两点：一、即使图可3-着色，但若其中存在不相邻却必须着色相同或不同的顶点，要确定这样的顶点非常困难（如果图不可3-着色，则困难在于找到一个极小的色数为4的子图——该子图去掉任意一个顶点及其所有关联边都可以3-着色）；二、即

使图可3-着色，且其中任意两个不相邻的顶点可以着色相同或者不同，找到一个多项式时间的3-着色方案也不容易。本文对这两点一一做了分析，给出了图3-着色问题的一个多项式时间算法，该算法的时间复杂度不超过O（n^9）。

由概述，先给出一些重要的定义，这些定义对于四色问题及图的3-着色问题的多项式时间算法起到了关键作用。

定义（3-可着色）：设G=（V，E）是简单无向图，G存在奇回路，若存在函数f：V→{1,2,3}，使得只要（u，v）∈E，就有f（u）≠f（v），则称G是可3-着色的，G的顶点色数为3，f是G的一个正确的3-着色方案。

定义（对等点）：设G=（V，E）是简单无向图，G的顶点色数S（G）=3，va、vb是G中不相邻的两个顶点，若对G的任意一种正确的3-着色方案，va、vb都着相同颜色，则称“va、vb是G的一对对等点”4-（或“G存在对等点va、vb”，“va（vb）存在对等点vb（va）”）。

例1.如图1所示，G=（V，E），V={v1，v2，v3，v4}，E={（v1，v2），（v1，v3），（v2，v3），（v2，v4），（v3，v4）},v1、v4是G的一对对等点。
![](https://pic2.zhimg.com/v2-b3a67e60791ece7f50692b0bd46942bd_b.jpg)
例2.如图2所示，G=（V，E），V={vi|1≤i≤9}，E={（v1，v2），（v1，v3），（v1，v4），（v2，v3），（v2，v5），（v3，v6），（v3，v7），（v4，v8），（v4，v9），（v5，v6），（v5，v8），（v6，v7），（v7，v9），（v8，v9）},v3、v5是G的一对对等点。
![](https://pic1.zhimg.com/v2-be6b4afdbb534d7a8d17145e6480e3d0_b.jpg)
例3.如图5所示，G=（V，E），V={vi|1≤i≤18}，E={（v1，v2），（v1，v3），（v2，v3），（v1，v4），（v1，v5），（v4，v5），（v2，v6），（v2，v7），（v6，v7），（v7，v8），（v7，v18），（v8，v18），（v3，v8），（v3，v9），（v8，v9），（v4，v9），（v4，v10），（v9，v10），（v10，v11），（v10，v18），（v11，v18），（v5，v11），（v5，v12），（v11，v12），（v12，v16），（v12，v17），（v16，v17），（v14，v15），（v14，v16），（v15，v16），（v6，v13），（v6，v14），（v13，v14）},v6、v12、v15中的任意两个是G的一对对等点；

v13、v16是G的一对对等点；v14、v17是G的一对对等点。
![](https://pic1.zhimg.com/v2-f2454f5f06fa0d0632223cdbd5bb1a28_b.jpg)
定义（比邻点）：设G=（V，E）是简单无向图，G的顶点色数S（G）=3，va、vb是G中不相邻的两个顶点，若对G的任意一种可行的3-着色方案，va、vb都着不同颜色，则称“va、vb为G的一对比邻点”（或“G存在比邻点va、vb”，“va（vb）存在比邻点vb（va）”）。

例4.如图3所示，G=（V，E），V={vi|1≤i≤12}，E={（v1，v2），（v1，v3），（v2，v3），（v2，v4），（v2，v5），（v4，v5），（v4，v8），（v4，v9），（v8，v9），（v9，v10），（v9，v11），（v10，v11），（v7，v11），（v7，v12），（v11，v12），

（v3，v6），（v3，v7），（v6，v7），（v5，v6），（5v，v10），（v6，v10）},v1、v8、v12中的任意两个是G的一对比邻点。

即G有3个顶点构成3对比邻点。
![](https://pic2.zhimg.com/v2-ff75215caef144dd3b69c907015fa401_b.jpg)

定义（理想图）：设G=（V，E）是简单无向图，G的顶点色数为3，若对G的任意两个不相邻顶点va、vb，存在对G的两种正确的3-着色方案，使得在这两种方案中，va、vb的着色分别相同和不同，则称G为理想图。

由定义可知，理想图中不存在对等点、比邻点。并且容易知道理想图的任意4阶子图的边数不大于4（否则G有对等点）。

定义（胡图）：设G=（V，E）是简单无向图，G的顶点色数为3，若G存在对等点或比邻点，则称G为胡图。

定义（极小胡图）：设G=（V，E）是胡图，若G去掉任意一条边所得图都是理想图，则称G为极小胡图。

定义（简单胡图）：设G=（V，E）是胡图，若G去掉任意一个顶点及其所有关联边所得图都是理想图，则称G为简单胡图。

定理0.简单胡图必有子图是极小胡图。

证明：显然。

注意：理想图可以有真子图是极小胡图。例如，在图3中添加3条边（v1，v8），（v1，v12），（v8，v12）所得图即为理想图。

例5.例1和例2中的G都是极小胡图。例4中的G去掉v12及其所有关联边所得图也是极小胡图。

定理1.设G=（V，E）是简单无向图，G的子图G1的顶点色数S（G1）=3，va、vb是G1的一对对等点，但va、vb在G中相邻，则G的顶点色数S（G）≥4。

证明：显然。

推论1.设G=（V，E）是简单无向图，S（G）=3，va、vb是G的一对对等点，E'=E∪{（va，vb）}，G'=（V，E'）,则S（G’）=4。

推论2.设G=（V，E）是简单无向图，S（G）=3，va、vb是G的一对比邻点，E'=E∪{（va，vb）}，G'=（V，E'）,则S（G’）=3。

例6.如图4所示，G=（V，E），V={vi|1≤i≤7}，E={（v1，v2），（v1，v3），（v2，v3），（v2，v4），（v3，v4），（v4，v5），（v4，v6），（v5，v6），（v5，v7），（v6，v7），（v1，v7）}，G去掉边（v1，v7）得到G1，显然S（G1）=3，v1、v7是G1的一对对等点，但v1、v7在G中相邻，则G的顶点色数S（G）≥4。
![](https://pic1.zhimg.com/v2-0e4c0693baa719926fdad02e2cfbe8c8_b.jpg)
定理2.设G=（V，E）是简单无向图，G的顶点色数S（G）=3，va、vb是G的一对对等点，vb、vc也是G中的一对对等点，则va、vc是G的一对对等点。

证明：显然。

例7.在例3中，v6、v15是G的一对对等点，v15、v12也是G中的一对对等点，则v6、v12是G的一对对等点。

定理3.设G=（V，E）是简单无向图，G的顶点色数S（G）=3，va、vb是G的一对对等点，vb、vc是G中的一对比邻点，且va、vc在G中不相邻，则va、vc是G的一对比邻点。

证明：显然。

例8.在例3中，v6、v15是G的一对对等点，v15、v5是G中的一对比邻点，且v6、v5在G中不相邻，则v6、v5是G的一对比邻点。

定理4.设G=（V，E）是简单无向图，G的子图G1的顶点色数S（G1）=3,va、vb是G1的一对对等点，则G的顶点色数S（G）=3的必要条件是：va、vb是G中的一对对等点。

证明：显然。

定义（素图）：设G=（V，E）是极大平面图，G的阶数大于4。若G的阶数大于3的任意真子图都不是极大平面图，则称G为素图,；

否则称G为合图。

要证明四色定理，只需证明任意极大平面图的顶点色数都小于5。

显然，只需要证明任意素图的顶点色数小于5。

公开的文献有以下结果：四色定理成立当且仅当任意极大平面图对应的4-正则图的顶点色数为3。

由以上结果，很容易得到四色定理的一个等价命题。

命题1.四色定理成立当且仅当任意素图所对应的4-正则图的顶点色数为3。

事实上，我们可以证明：任意素图所对应的4-正则图G是理想图；G去掉一个K3子图的3条边，得图G1，G1再去掉任意一个度为2的顶点得图G2，则G2是不含对等点、有且只有一对比邻点的极小胡图。

> 参考文献
[1]M.R.Garey,D.S.Johnson and L.Stockmeyer, Some simplified
NP-complete graph problems,Theoretical Computer Science(1976)
237-267.

第一篇完。

在下篇中，本人将给出关于四色问题的更多细节，包括对任意素图所对

应的4-正则图的多项式时间3-着色算法。

如果你是运筹学/人工智能硕博或在读，请添加微信号：zf13772441490（备注请务必按照：姓名/昵称-加群类型-单位/学校-最高/在读学位-研究方向，**否则不会通过**），她会拉你进全球运筹或AI学者群（群内学界、业界大佬云集）。

如果你是运筹学/控制论/随机优化爱好者，欢迎加qq群：686387574

如果你是人工智能爱好者，欢迎加qq群： 685839321

敬请关注和扩散本专栏及同名公众号，会邀请**全球知名学者**陆续发布运筹学、人工智能中优化理论等相关干货、[知乎Live](https://www.zhihu.com/lives/users/961e8cc4f7512fda1ea6626ce9a05e8e)及行业动态。

专栏文章汇总和有奖投稿须知：

[『运筹OR帷幄』专栏文章分类汇总+面向学术界/工业界征稿(含招聘广告)+专栏编辑/审稿招募](https://zhuanlan.zhihu.com/p/31654430)
![](https://pic3.zhimg.com/v2-c6f5318638932eebcfaf3d32003e577e_b.jpg)

