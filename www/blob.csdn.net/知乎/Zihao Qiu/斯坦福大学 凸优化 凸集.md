# 斯坦福大学 凸优化 凸集 - 知乎
# 

这是《凸优化》这本书的第二章，主要介绍了凸集的定义及一些例子，一些可以应用在凸集上的保凸运算。在本章的后半部分将介绍正常锥（proper cone）及广义不等式，初次读到这里我还感到奇怪为什么会介绍这些看似与凸集关系不大的东西，直到读到后来我发现，这些是用以描述二阶锥规划（Second Order Cone Programming，SOCP）和半正定规划（Semidefinite Programming，SDP）的工具，而经常遇到的线性规划（LP），二次规划（QP）等都是它们的特例。


仿射集：如果集合 ![C\subseteq R^n](https://www.zhihu.com/equation?tex=C%5Csubseteq+R%5En) 中任意两个不同点确定的直线仍在集合 ![C](https://www.zhihu.com/equation?tex=C) 中，则称集合 ![C ](https://www.zhihu.com/equation?tex=C+) 是仿射的。

比如：线性方程组的解集 ![C=\{x|Ax=b\}](https://www.zhihu.com/equation?tex=C%3D%5C%7Bx%7CAx%3Db%5C%7D) ，其中 ![A\in R^{m\times n}](https://www.zhihu.com/equation?tex=A%5Cin+R%5E%7Bm%5Ctimes+n%7D) ， ![b\in R^m](https://www.zhihu.com/equation?tex=b%5Cin+R%5Em) ，是仿射集合。

凸集：如果集合 ![C](https://www.zhihu.com/equation?tex=C) 中任意两点间的线段仍在 ![C](https://www.zhihu.com/equation?tex=C) 中，即对于任意 ![x_1,x_2\in C](https://www.zhihu.com/equation?tex=x_1%2Cx_2%5Cin+C) 和![0\leq \theta \leq 1](https://www.zhihu.com/equation?tex=0%5Cleq+%5Ctheta+%5Cleq+1)都有 ![\theta x_1+(1-\theta)x_2\in C](https://www.zhihu.com/equation?tex=%5Ctheta+x_1%2B%281-%5Ctheta%29x_2%5Cin+C) ，则 ![C](https://www.zhihu.com/equation?tex=C) 为凸集。

凸组合：点 ![\theta_1x_1+\cdots+\theta_k x_k](https://www.zhihu.com/equation?tex=%5Ctheta_1x_1%2B%5Ccdots%2B%5Ctheta_k+x_k) 为 ![x_1,\cdots,x_k](https://www.zhihu.com/equation?tex=x_1%2C%5Ccdots%2Cx_k) 的凸组合，其中 ![\theta_1+\cdots+\theta_k=1](https://www.zhihu.com/equation?tex=%5Ctheta_1%2B%5Ccdots%2B%5Ctheta_k%3D1) 且 ![\theta_i \geq0](https://www.zhihu.com/equation?tex=%5Ctheta_i+%5Cgeq0) ， ![i=1,\cdots,k](https://www.zhihu.com/equation?tex=i%3D1%2C%5Ccdots%2Ck) 。

凸包：集合 ![C](https://www.zhihu.com/equation?tex=C) 中所有点的凸组合的集合为凸包（convex hull），记为 ![conv\ C](https://www.zhihu.com/equation?tex=conv%5C+C) ：

![conv\ C=\{\theta_1x_1+\cdots+\theta_kx_k|x_i\in C,\theta_i\geq0,i=1,\cdots,k,\sum_{i=1}^k\theta_i=1\}](https://www.zhihu.com/equation?tex=conv%5C+C%3D%5C%7B%5Ctheta_1x_1%2B%5Ccdots%2B%5Ctheta_kx_k%7Cx_i%5Cin+C%2C%5Ctheta_i%5Cgeq0%2Ci%3D1%2C%5Ccdots%2Ck%2C%5Csum_%7Bi%3D1%7D%5Ek%5Ctheta_i%3D1%5C%7D)

这是包含 ![C](https://www.zhihu.com/equation?tex=C) 的最小凸集。

凸锥（convex cone）：集合 ![C](https://www.zhihu.com/equation?tex=C) 为凸锥，即对于任意 ![x_1,x_2\in C](https://www.zhihu.com/equation?tex=x_1%2Cx_2%5Cin+C) 和 ![\theta_1,\theta_2\geq0](https://www.zhihu.com/equation?tex=%5Ctheta_1%2C%5Ctheta_2%5Cgeq0) ，都有 ![\theta_1x_1+\theta_2x_2\in C](https://www.zhihu.com/equation?tex=%5Ctheta_1x_1%2B%5Ctheta_2x_2%5Cin+C) 。如下图所示：
![](https://pic3.zhimg.com/v2-5583c457e884be0010eac257880732d2_b.jpg)凸锥（convex cone）
该凸锥的两条边是 ![\theta_1x_1](https://www.zhihu.com/equation?tex=%5Ctheta_1x_1) 和 ![\theta_2x_2](https://www.zhihu.com/equation?tex=%5Ctheta_2x_2) ，凸锥内部的点为 ![\theta_1x_1+\theta_2x_2](https://www.zhihu.com/equation?tex=%5Ctheta_1x_1%2B%5Ctheta_2x_2) 。

锥包：集合 ![C](https://www.zhihu.com/equation?tex=C) 的锥包是 ![C](https://www.zhihu.com/equation?tex=C) 中元素的所有锥组合的集合，即：

![\{\theta_1x_1+\cdots+\theta_kx_k|x_i\in C,\theta_i\geq 0,i=1,\cdots,k\}](https://www.zhihu.com/equation?tex=%5C%7B%5Ctheta_1x_1%2B%5Ccdots%2B%5Ctheta_kx_k%7Cx_i%5Cin+C%2C%5Ctheta_i%5Cgeq+0%2Ci%3D1%2C%5Ccdots%2Ck%5C%7D) ，它是包含 ![C](https://www.zhihu.com/equation?tex=C) 的最小的凸锥。
![](https://pic2.zhimg.com/v2-b77da55fd3a0e63273cc84075a026d25_b.jpg)锥包

下面介绍几个重要的凸集：
- 线段，射线都是凸的
- 超平面是具有如下形式的集合： ![\{x|a^Tx=b\}](https://www.zhihu.com/equation?tex=%5C%7Bx%7Ca%5ETx%3Db%5C%7D) ，其中 ![a\in R^n,a\neq0,b\in R](https://www.zhihu.com/equation?tex=a%5Cin+R%5En%2Ca%5Cneq0%2Cb%5Cin+R) 。一个超平面可将 ![R^n](https://www.zhihu.com/equation?tex=R%5En) 分成两个半空间，（闭的）半空间具有如下形式： ![\{x|a^Tx\leq b\}](https://www.zhihu.com/equation?tex=%5C%7Bx%7Ca%5ETx%5Cleq+b%5C%7D) ，其中 ![a\neq 0](https://www.zhihu.com/equation?tex=a%5Cneq+0) 。半空间是凸的。
- ![R^n](https://www.zhihu.com/equation?tex=R%5En) 中的空间Euclid球具有如下形式： ![B(x_c,r)=\{x|\lVert x-x_c\rVert_{2}\leq r\}=\{x|(x-x_c)^T(x-x_c)\leq r^2\}](https://www.zhihu.com/equation?tex=B%28x_c%2Cr%29%3D%5C%7Bx%7C%5ClVert+x-x_c%5CrVert_%7B2%7D%5Cleq+r%5C%7D%3D%5C%7Bx%7C%28x-x_c%29%5ET%28x-x_c%29%5Cleq+r%5E2%5C%7D) ，其中 向量![x_c](https://www.zhihu.com/equation?tex=x_c) 是球心，标量 ![r](https://www.zhihu.com/equation?tex=r) 为半径。Euclid球为凸集。
- 对Euclid球进行泛化，可以得到椭球（ellipsoid）： ![\mathcal{E}=\{x|(x-x_c)^TP^{-1}(x-x_c)\leq 1\}](https://www.zhihu.com/equation?tex=%5Cmathcal%7BE%7D%3D%5C%7Bx%7C%28x-x_c%29%5ETP%5E%7B-1%7D%28x-x_c%29%5Cleq+1%5C%7D) ，其中 ![x_c](https://www.zhihu.com/equation?tex=x_c) 是椭球的球心， ![P](https://www.zhihu.com/equation?tex=P) 是对称正定矩阵，决定椭球的形状。
- 设 ![\lVert\cdot\rVert](https://www.zhihu.com/equation?tex=%5ClVert%5Ccdot%5CrVert) 是 ![R^n](https://www.zhihu.com/equation?tex=R%5En) 中的范数，范数球即为： ![\{x|\lVert x-x_c\rVert\leq r\}](https://www.zhihu.com/equation?tex=%5C%7Bx%7C%5ClVert+x-x_c%5CrVert%5Cleq+r%5C%7D) 。范数球也是凸的，证明如下：假设 ![x,y](https://www.zhihu.com/equation?tex=x%2Cy) 为两个在范数球中的点，于是有 ![\lVert x-x_c\rVert\leq r](https://www.zhihu.com/equation?tex=%5ClVert+x-x_c%5CrVert%5Cleq+r) 和 ![\lVert y-x_c\rVert\leq r](https://www.zhihu.com/equation?tex=%5ClVert+y-x_c%5CrVert%5Cleq+r) ，那么不妨考虑点 ![\frac{x+y}{2}](https://www.zhihu.com/equation?tex=%5Cfrac%7Bx%2By%7D%7B2%7D) ，于是又范数的三角不等式有： ![\lVert \frac{x+y}{2}-x_c\rVert\leq \lVert \frac{x}{2}-\frac{x_c}{2}\rVert + \lVert \frac{y}{2}-\frac{x_c}{2}\rVert](https://www.zhihu.com/equation?tex=%5ClVert+%5Cfrac%7Bx%2By%7D%7B2%7D-x_c%5CrVert%5Cleq+%5ClVert+%5Cfrac%7Bx%7D%7B2%7D-%5Cfrac%7Bx_c%7D%7B2%7D%5CrVert+%2B+%5ClVert+%5Cfrac%7By%7D%7B2%7D-%5Cfrac%7Bx_c%7D%7B2%7D%5CrVert) ，再由范数的齐次性，可得 ![\lVert \frac{x}{2}-\frac{x_c}{2}\rVert + \lVert \frac{y}{2}-\frac{x_c}{2}\rVert =\frac{1}{2}\lVert x-x_c\rVert +\frac{1}{2}\lVert y-x_c\rVert \leq r](https://www.zhihu.com/equation?tex=%5ClVert+%5Cfrac%7Bx%7D%7B2%7D-%5Cfrac%7Bx_c%7D%7B2%7D%5CrVert+%2B+%5ClVert+%5Cfrac%7By%7D%7B2%7D-%5Cfrac%7Bx_c%7D%7B2%7D%5CrVert+%3D%5Cfrac%7B1%7D%7B2%7D%5ClVert+x-x_c%5CrVert+%2B%5Cfrac%7B1%7D%7B2%7D%5ClVert+y-x_c%5CrVert+%5Cleq+r) 。
- 范数 ![\lVert\cdot\rVert](https://www.zhihu.com/equation?tex=%5ClVert%5Ccdot%5CrVert) 可以导出范数锥（norm cone），范数锥是指集合 ![C=\{(x,t)|\lVert x\rVert\leq t\} \subseteq R^{n+1}](https://www.zhihu.com/equation?tex=C%3D%5C%7B%28x%2Ct%29%7C%5ClVert+x%5CrVert%5Cleq+t%5C%7D+%5Csubseteq+R%5E%7Bn%2B1%7D) ，这是一个凸锥。下图所示的是二阶锥 ![\{(x_1,x_2,t)|(x_1^2+x_2^2)^{\frac{1}{2}}\leq t\}](https://www.zhihu.com/equation?tex=%5C%7B%28x_1%2Cx_2%2Ct%29%7C%28x_1%5E2%2Bx_2%5E2%29%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%5Cleq+t%5C%7D)
![](https://pic3.zhimg.com/v2-2468136847276e111f2a209158582d6a_b.jpg)二阶锥- 多面体被定义为有限个线性等式和不等式的解集： ![\mathcal{P}=\{x|a_j^T x\leq b_j,j=1,\cdots,m,c_j^Tx=d_j,j=1,\cdots,p\}](https://www.zhihu.com/equation?tex=%5Cmathcal%7BP%7D%3D%5C%7Bx%7Ca_j%5ET+x%5Cleq+b_j%2Cj%3D1%2C%5Ccdots%2Cm%2Cc_j%5ETx%3Dd_j%2Cj%3D1%2C%5Ccdots%2Cp%5C%7D) ，可以紧凑地表示成 ![\mathcal{P}=\{x|Ax\preceq b,Cx=d\}](https://www.zhihu.com/equation?tex=%5Cmathcal%7BP%7D%3D%5C%7Bx%7CAx%5Cpreceq+b%2CCx%3Dd%5C%7D) ，这里的 ![\preceq](https://www.zhihu.com/equation?tex=%5Cpreceq) 为component-wise的小于。
- 集合 ![S_{+}^n](https://www.zhihu.com/equation?tex=S_%7B%2B%7D%5En) 是一个凸锥。 ![S_{+}^n](https://www.zhihu.com/equation?tex=S_%7B%2B%7D%5En) 表示对称半正定矩阵集合。


下面是一些保凸运算，利用它们可以从形式简单的凸集构造出形式复杂的凸集。
- 交集运算是保凸的。如果两个凸集的交仍是凸的。事实上，一个闭集 ![S](https://www.zhihu.com/equation?tex=S) 是包含它的所有半空间的交集。
- 函数 ![f:R^n\rightarrow R^m](https://www.zhihu.com/equation?tex=f%3AR%5En%5Crightarrow+R%5Em) 是仿射的，如果其具有这样的形式： ![f(x)=Ax+b](https://www.zhihu.com/equation?tex=f%28x%29%3DAx%2Bb) ，其中 ![A\in R^{m\times n}](https://www.zhihu.com/equation?tex=A%5Cin+R%5E%7Bm%5Ctimes+n%7D) ， ![b\in R^m](https://www.zhihu.com/equation?tex=b%5Cin+R%5Em) 。仿射函数具有很强的性质，若 ![S\subseteq R^n](https://www.zhihu.com/equation?tex=S%5Csubseteq+R%5En) 是凸的， ![f](https://www.zhihu.com/equation?tex=f) 是仿射函数，那么 ![S](https://www.zhihu.com/equation?tex=S) 在 ![f:R^n\rightarrow R^m](https://www.zhihu.com/equation?tex=f%3AR%5En%5Crightarrow+R%5Em) 下的象是凸的， ![S](https://www.zhihu.com/equation?tex=S) 在 ![f:R^k\rightarrow R^n](https://www.zhihu.com/equation?tex=f%3AR%5Ek%5Crightarrow+R%5En) 下的原象也是凸的。
- 透视函数（perspective function）的定义如下： ![P:R^{n+1}\rightarrow R^n,P(z,t)=z/t](https://www.zhihu.com/equation?tex=P%3AR%5E%7Bn%2B1%7D%5Crightarrow+R%5En%2CP%28z%2Ct%29%3Dz%2Ft) ，透视函数对输入的n+1维向量进行伸缩，并使得最后一维分量为1，舍弃最后一维分量，便得到了输出。如果 ![C\subseteq dom\ P](https://www.zhihu.com/equation?tex=C%5Csubseteq+dom%5C+P) 是凸集，那么其象 ![P(C)=\{P(x)|x\in C\}](https://www.zhihu.com/equation?tex=P%28C%29%3D%5C%7BP%28x%29%7Cx%5Cin+C%5C%7D) 也是凸集。这个结论有着直观的意义，通过小孔观察一个凸的物体，可以得到一个凸的象。
- 线性分式函数（linear functional function）由透视函数和仿射函数复合而成， ![f:R^n\rightarrow R^m](https://www.zhihu.com/equation?tex=f%3AR%5En%5Crightarrow+R%5Em) ， ![f(x)=\frac{Ax+b}{c^Tx+d}](https://www.zhihu.com/equation?tex=f%28x%29%3D%5Cfrac%7BAx%2Bb%7D%7Bc%5ETx%2Bd%7D) ， ![dom\ f=\{x|c^Tx+d>0\}](https://www.zhihu.com/equation?tex=dom%5C+f%3D%5C%7Bx%7Cc%5ETx%2Bd%3E0%5C%7D) 。线性函数也是保凸的。


在处理二阶锥规划（SOCP）和半正定规划（SDP）时，需要处理一类特殊的凸集——正常锥（proper cone）。称锥 ![K\subseteq R^n](https://www.zhihu.com/equation?tex=K%5Csubseteq+R%5En)为正常锥当其满足如下条件：
- ![K](https://www.zhihu.com/equation?tex=K) 是凸的
- ![K](https://www.zhihu.com/equation?tex=K) 是闭的，即包含边界
- ![K](https://www.zhihu.com/equation?tex=K) 是实的，即具有非空内部
- ![K](https://www.zhihu.com/equation?tex=K) 是尖的，即不包含直线

利用正常锥 ![K](https://www.zhihu.com/equation?tex=K) 可以定义广义不等式，即 ![R^n](https://www.zhihu.com/equation?tex=R%5En) 上的偏序关系：

![x\preceq_{K}y\Leftrightarrow y-x\in K](https://www.zhihu.com/equation?tex=x%5Cpreceq_%7BK%7Dy%5CLeftrightarrow+y-x%5Cin+K)

![x\prec_{K}y\Leftrightarrow y-x\in \textbf{int}\ K](https://www.zhihu.com/equation?tex=x%5Cprec_%7BK%7Dy%5CLeftrightarrow+y-x%5Cin+%5Ctextbf%7Bint%7D%5C+K)

由此可见，当 ![K=R_{+}](https://www.zhihu.com/equation?tex=K%3DR_%7B%2B%7D) 时，偏序关系 ![\preceq_{K}](https://www.zhihu.com/equation?tex=%5Cpreceq_%7BK%7D) 就是通常意义上 ![R](https://www.zhihu.com/equation?tex=R) 中的 ![\leq](https://www.zhihu.com/equation?tex=%5Cleq) 。于是 ![R](https://www.zhihu.com/equation?tex=R) 上的不等式可以看成广义不等式的一种特殊情况。

回到凸优化问题中，在LP问题中，非负象限 ![K=R_{+}^n](https://www.zhihu.com/equation?tex=K%3DR_%7B%2B%7D%5En)是一个正常锥，相应的广义不等式 ![\preceq_{K}](https://www.zhihu.com/equation?tex=%5Cpreceq_%7BK%7D) 对应向量间的分量不等式；在SDP中，半正定锥是 ![S^{n}](https://www.zhihu.com/equation?tex=S%5E%7Bn%7D)空间中的正常锥， 相应的广义不等式 ![\preceq_{K}](https://www.zhihu.com/equation?tex=%5Cpreceq_%7BK%7D) 对应矩阵不等式。

广义不等式并不是线性序，这意味着不是任意两个元素都是可比的。所以由此可以定义最小元（minimum）和极小元（minimal）。如果某点是最小元，意味着其他所有点都大于等于它；如果某点是极小元，意味着没有点比它小。

能否用一个超平面（或者说仿射函数）将两个凸集分开，答案是肯定的，超平面分离定理保证了这一点。

若一个超平面与集合 ![C](https://www.zhihu.com/equation?tex=C) 相切于 ![C](https://www.zhihu.com/equation?tex=C) 上某点且该超平面的一个半空间包含 ![C](https://www.zhihu.com/equation?tex=C) ，则称此超平面为支撑超平面。

一个易见的结论是对任意非空凸集 ![C](https://www.zhihu.com/equation?tex=C) 和任意 ![C](https://www.zhihu.com/equation?tex=C) 边界上的点 ![x_0](https://www.zhihu.com/equation?tex=x_0) ，在 ![x_0](https://www.zhihu.com/equation?tex=x_0) 处存在 ![C](https://www.zhihu.com/equation?tex=C) 的支撑超平面，这个被称为支撑超平面定理，可以有超平面分离定理证得。这两个定理的作用是为了后面证明对偶不等式定义的最小元与极小元的性质。

若 ![K](https://www.zhihu.com/equation?tex=K) 为一个锥，则其对偶锥 ![K^{*}](https://www.zhihu.com/equation?tex=K%5E%7B%2A%7D) 的定义为：

![K^{*}=\{y|x^{T}y\geq 0, \forall x\in K \}](https://www.zhihu.com/equation?tex=K%5E%7B%2A%7D%3D%5C%7By%7Cx%5E%7BT%7Dy%5Cgeq+0%2C+%5Cforall+x%5Cin+K+%5C%7D)

从几何上看，![K^{*}](https://www.zhihu.com/equation?tex=K%5E%7B%2A%7D) 中任意一点与 ![K](https://www.zhihu.com/equation?tex=K) 中所有点的夹角不超过90°。

可以证明，非负象限和半正定锥的对偶锥是其本身，称其为自对偶锥（self-dual）。

对偶锥 ![K^{*}](https://www.zhihu.com/equation?tex=K%5E%7B%2A%7D) 可以定义广义不等式 ![\preceq_{K^{*}}](https://www.zhihu.com/equation?tex=%5Cpreceq_%7BK%5E%7B%2A%7D%7D) ，广义不等式及其对偶有一些重要的性质：

![x\preceq_{K} y\Leftrightarrow \forall \lambda \succeq_{K^{*}} 0,\ \lambda^Tx\leq \lambda^Ty](https://www.zhihu.com/equation?tex=x%5Cpreceq_%7BK%7D+y%5CLeftrightarrow+%5Cforall+%5Clambda+%5Csucceq_%7BK%5E%7B%2A%7D%7D+0%2C%5C+%5Clambda%5ETx%5Cleq+%5Clambda%5ETy)

![x\prec_{K} y\Leftrightarrow \forall \lambda \succeq_{K^{*}} 0,\ \lambda\ne 0, \ \lambda^Tx < \lambda^Ty](https://www.zhihu.com/equation?tex=x%5Cprec_%7BK%7D+y%5CLeftrightarrow+%5Cforall+%5Clambda+%5Csucceq_%7BK%5E%7B%2A%7D%7D+0%2C%5C+%5Clambda%5Cne+0%2C+%5C+%5Clambda%5ETx+%3C+%5Clambda%5ETy)

从这里可以看出为什么对偶锥要这样定义。对偶锥中的每个元素（向量）可以看成原来锥的一个合法的投影方向，原来锥上两个点在这些合法的投影方向上序不变！于是我们便可以借助对偶不等式来定义最小元和极小元。这里仅给出结论：
- ![x ](https://www.zhihu.com/equation?tex=x+) 是 ![S](https://www.zhihu.com/equation?tex=S) 的最小元 ![\Leftrightarrow](https://www.zhihu.com/equation?tex=%5CLeftrightarrow) 对所有 ![\lambda \succ_{K^{*}} 0](https://www.zhihu.com/equation?tex=%5Clambda+%5Csucc_%7BK%5E%7B%2A%7D%7D+0) ， ![x](https://www.zhihu.com/equation?tex=x) 是在 ![S](https://www.zhihu.com/equation?tex=S) 上最小化 ![\lambda^Tz](https://www.zhihu.com/equation?tex=%5Clambda%5ETz) 的唯一最优解
- ![\exists \lambda \succ_{K^{*}} 0](https://www.zhihu.com/equation?tex=%5Cexists+%5Clambda+%5Csucc_%7BK%5E%7B%2A%7D%7D+0) ， ![x](https://www.zhihu.com/equation?tex=x) 在 ![S](https://www.zhihu.com/equation?tex=S) 上最小化 ![\lambda^Tz](https://www.zhihu.com/equation?tex=%5Clambda%5ETz)![\Rightarrow](https://www.zhihu.com/equation?tex=%5CRightarrow)![x](https://www.zhihu.com/equation?tex=x) 是一个极小元
- ![x](https://www.zhihu.com/equation?tex=x) 是凸集 ![S](https://www.zhihu.com/equation?tex=S) 的一个极小元 ![\Rightarrow](https://www.zhihu.com/equation?tex=%5CRightarrow)![\exists \lambda \succ_{K^{*}} 0,\lambda\ne0](https://www.zhihu.com/equation?tex=%5Cexists+%5Clambda+%5Csucc_%7BK%5E%7B%2A%7D%7D+0%2C%5Clambda%5Cne0) 使得![x](https://www.zhihu.com/equation?tex=x) 在 ![S](https://www.zhihu.com/equation?tex=S) 上最小化 ![\lambda^Tz](https://www.zhihu.com/equation?tex=%5Clambda%5ETz)

证明参见书。注意最小元的判断有充要条件，然而极小元的充分条件和必要条件之间有gap。

