# 代数数论（4.2）：modular form and  sum of squares - 知乎
# 

二平方和，四平方和定理的模形式证明。

首先推荐模形式的初步介绍（由于几乎网上每个人都写过这玩意的入门，我就不班门弄斧了）

59页的PPT

Generating Functions, Partitions, and q-series:
An Introduction to Classical Modular Forms 

[http://www.math.purdue.edu/~egoins/seminar/16-06-28.pdf](https://link.zhihu.com/?target=http%3A//www.math.purdue.edu/~egoins/seminar/16-06-28.pdf)
以及

[Modular form - Wikipedia](https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Modular_form)

以及

[http://web.stanford.edu/~aaronlan/assets/landesman_junior_paper.pdf](https://link.zhihu.com/?target=http%3A//web.stanford.edu/~aaronlan/assets/landesman_junior_paper.pdf)

——————————————————————————————————

考虑

![\vartheta(z) =\sum_{a \in \mathbb Z}^{}{q^{a^2}} ](https://www.zhihu.com/equation?tex=%5Cvartheta%28z%29+%3D%5Csum_%7Ba+%5Cin+%5Cmathbb+Z%7D%5E%7B%7D%7Bq%5E%7Ba%5E2%7D%7D+),![q=e^{2 \pi i z}, Im z >0](https://www.zhihu.com/equation?tex=q%3De%5E%7B2+%5Cpi+i+z%7D%2C+Im+z+%3E0)

Poisson求和：

![](https://pic1.zhimg.com/v2-c02ff66db51444b6894e44b1cc8ca334_b.png)对![f(x)=e^{-\pi t x^2},t>0](https://www.zhihu.com/equation?tex=f%28x%29%3De%5E%7B-%5Cpi+t+x%5E2%7D%2Ct%3E0)使用，整理可得：

①![\vartheta(\frac{-1}{4z}) =\sqrt{-2iz} \vartheta{(z)}](https://www.zhihu.com/equation?tex=%5Cvartheta%28%5Cfrac%7B-1%7D%7B4z%7D%29+%3D%5Csqrt%7B-2iz%7D+%5Cvartheta%7B%28z%29%7D)

对z属于正虚轴都成立，由于解析延拓唯一性知其在上半平面都成立。

显然

②![\vartheta(z+1) =\vartheta{(z)}](https://www.zhihu.com/equation?tex=%5Cvartheta%28z%2B1%29+%3D%5Cvartheta%7B%28z%29%7D)

所以考虑函数![\theta=\vartheta^4](https://www.zhihu.com/equation?tex=%5Ctheta%3D%5Cvartheta%5E4)，其**第n项系数恰好是表n为四平方和的方法数。**

①②表明

![\theta](https://www.zhihu.com/equation?tex=%5Ctheta)在变换![z \rightarrow z+1, z \rightarrow \frac{-1}{4z}](https://www.zhihu.com/equation?tex=z+%5Crightarrow+z%2B1%2C+z+%5Crightarrow+%5Cfrac%7B-1%7D%7B4z%7D)下满足一定关系，即
![\theta \in M_2(\Gamma_0(4))](https://www.zhihu.com/equation?tex=%5Ctheta+%5Cin+M_2%28%5CGamma_0%284%29%29)

**由于![M_2(\Gamma(4))](https://www.zhihu.com/equation?tex=M_2%28%5CGamma%284%29%29)是有限维的，我们甚至知道它的基。**

（可以忽略最后两句废话）

2.

**令**

**![G_2(z)=\sum_{(c,d)}^{}{\frac{1}{(cz+d)^2}} ](https://www.zhihu.com/equation?tex=G_2%28z%29%3D%5Csum_%7B%28c%2Cd%29%7D%5E%7B%7D%7B%5Cfrac%7B1%7D%7B%28cz%2Bd%29%5E2%7D%7D+),其中c，d跑遍所有不同时为0的整数对**

**由于**

**![](https://pic2.zhimg.com/v2-e6071fe4bc893c656bffcdefc6170e8d_b.png)复分析告诉我们左边是：![](https://pic4.zhimg.com/v2-99620db3f7d3763a41abcc1ccd53a7c3_b.png)所以![](https://pic4.zhimg.com/v2-64261d6a4a18bc8c531e9189221d403b_b.png)**

**求导得到**

**![](https://pic2.zhimg.com/v2-69a4818b034b7ac1b730822115a97781_b.png)这个式子代入**![G_2(z)=\sum_{(c,d)}^{}{\frac{1}{(cz+d)^2}} ](https://www.zhihu.com/equation?tex=G_2%28z%29%3D%5Csum_%7B%28c%2Cd%29%7D%5E%7B%7D%7B%5Cfrac%7B1%7D%7B%28cz%2Bd%29%5E2%7D%7D+)**得到![G_2(\tau )](https://www.zhihu.com/equation?tex=G_2%28%5Ctau+%29)实际上等于：**

![](https://pic3.zhimg.com/v2-ed4af70be5a22d10a98b7164103d98c6_b.png)这个表示用来算，而![G_2(z)=\sum_{(c,d)}^{}{\frac{1}{(cz+d)^2}} ](https://www.zhihu.com/equation?tex=G_2%28z%29%3D%5Csum_%7B%28c%2Cd%29%7D%5E%7B%7D%7B%5Cfrac%7B1%7D%7B%28cz%2Bd%29%5E2%7D%7D+)告诉我们G_2(z)在变化下满足一定关系的，例如

①![\frac{1}{z^2}G_2(-\frac{1}{z})=G_2(z)-\frac{2\pi i}{z}](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bz%5E2%7DG_2%28-%5Cfrac%7B1%7D%7Bz%7D%29%3DG_2%28z%29-%5Cfrac%7B2%5Cpi+i%7D%7Bz%7D)

②![G_2(z+1) =G_2{(z)}](https://www.zhihu.com/equation?tex=G_2%28z%2B1%29+%3DG_2%7B%28z%29%7D)

看起来和之前的有些像.

令

![G_{2,4}(z)=G_2(z) -4G_2(4z) ](https://www.zhihu.com/equation?tex=G_%7B2%2C4%7D%28z%29%3DG_2%28z%29+-4G_2%284z%29+)，用上面的“凭自己本事”算出来的表达式：

![](https://pic1.zhimg.com/v2-9edec57aa2e53201c0f2bd5c0704fc94_b.png)
那么可以由①②出发直接得到
![G_{2,4}(z)=G_2(z) -4G_2(4z) ](https://www.zhihu.com/equation?tex=G_%7B2%2C4%7D%28z%29%3DG_2%28z%29+-4G_2%284z%29+)

①![G_{2,4}(\frac{-1}{4z}) =-4z^2 G_{2,4}{(z)}](https://www.zhihu.com/equation?tex=G_%7B2%2C4%7D%28%5Cfrac%7B-1%7D%7B4z%7D%29+%3D-4z%5E2+G_%7B2%2C4%7D%7B%28z%29%7D)

②![G_{2,4}(z+1)=G_{2,4}(z)](https://www.zhihu.com/equation?tex=G_%7B2%2C4%7D%28z%2B1%29%3DG_%7B2%2C4%7D%28z%29)

注意之前已经证明：

![\theta=\vartheta^4](https://www.zhihu.com/equation?tex=%5Ctheta%3D%5Cvartheta%5E4)满足

①![\theta (\frac{-1}{4z}) =-4z^2 \theta{(z)}](https://www.zhihu.com/equation?tex=%5Ctheta+%28%5Cfrac%7B-1%7D%7B4z%7D%29+%3D-4z%5E2+%5Ctheta%7B%28z%29%7D)

②![\theta(z+1)=\theta (z)](https://www.zhihu.com/equation?tex=%5Ctheta%28z%2B1%29%3D%5Ctheta+%28z%29)

并且![\theta(z) = \sum_{n=0}^{\infty}{r_4(n)e^{2\pi i nz}} ](https://www.zhihu.com/equation?tex=%5Ctheta%28z%29+%3D+%5Csum_%7Bn%3D0%7D%5E%7B%5Cinfty%7D%7Br_4%28n%29e%5E%7B2%5Cpi+i+nz%7D%7D+)

我们可以手动计算两者表达式，得到

![\theta(z) = \sum_{n=0}^{\infty}{r_4(n)e^{2\pi i nz}} ](https://www.zhihu.com/equation?tex=%5Ctheta%28z%29+%3D+%5Csum_%7Bn%3D0%7D%5E%7B%5Cinfty%7D%7Br_4%28n%29e%5E%7B2%5Cpi+i+nz%7D%7D+)与

![](https://pic1.zhimg.com/v2-9edec57aa2e53201c0f2bd5c0704fc94_b.png)
前者的第n项系数恰好是后者的![-\frac{1}{\pi^2}](https://www.zhihu.com/equation?tex=-%5Cfrac%7B1%7D%7B%5Cpi%5E2%7D)(对n=0,1,2,3,4,5,6,7,8,9,10)

所以
![\theta=\frac{-1}{\pi^2}G_{2,4}](https://www.zhihu.com/equation?tex=%5Ctheta%3D%5Cfrac%7B-1%7D%7B%5Cpi%5E2%7DG_%7B2%2C4%7D)

这是为什么呢？

**由于模形式空间![M_2(\Gamma(4))](https://www.zhihu.com/equation?tex=M_2%28%5CGamma%284%29%29)是有限维的，我们甚至知道它的基。所以前若干项相同那么必须恒等，但是这样就得到了**

**![](https://pic4.zhimg.com/v2-e1bf0f705c0132c1c1df6fb26583d1db_b.png)特别地其大于0，所以任何正整数总可以表成4个整数平方和。**

二平方和同理。

注：

模形式好处都有啥？谁说对了就给他

① 刚性:：

两个同一空间的模形式如果前若干项相同，它们就相同。

②可构造：

我们一般可以和2一样构造出模形式空间中的典型元素（艾森斯坦级数）

虽然中途会有一些计算，但是至少我们把**技术上的困难转换成了计算上的困难，知道要做什么后算出需要的系数就好了（当然更复杂的case还需要更多分析，不仅仅是单纯的计算）****。**

这么说起来，膜形式还真是有用呢（SHENG DI YA GE）

![](https://pic4.zhimg.com/v2-4564093c8678e43a00c11e1b84cd72e3_b.png)
（此段送给上课前总喜欢在教室外放金坷垃鬼畜乐的某同学，我TM昨晚还梦到了……）

Ref：

[http://web.stanford.edu/~aaronlan/assets/landesman_junior_paper.pdf](https://link.zhihu.com/?target=http%3A//web.stanford.edu/~aaronlan/assets/landesman_junior_paper.pdf)

