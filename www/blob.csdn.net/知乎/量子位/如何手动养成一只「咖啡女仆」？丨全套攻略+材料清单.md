# 如何手动养成一只「咖啡女仆」？丨全套攻略+材料清单 - 知乎
# 



> 原作者 Valentin Fg 
郭一璞 编译 
量子位 出品 | 公众号 QbitAI



![](https://pic2.zhimg.com/v2-30474af37a2982aaabf90a78c0d54df9_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='400'></svg>)



“两杯美式，谢谢。”

“主人的两杯咖啡好啦，欢迎品尝~”

醒醒，你不是在看日漫，你家里也没有咖啡女仆。

不过，作为万能的工程师，自己DIY也不是不可以。硬件爱好者Valentin Fg就把家里的咖啡机改装成了“咖啡女仆”，只要一句话，不用跑去咖啡机旁自己动手做，TA就乖乖地开始给你做咖啡。

后来，他还整理了一份DIY咖啡女仆攻略，只要7步就可完成。

## **Step 1：剁手一些物料**

首先，你需要一台**咖啡机**。作者选用的是德龙的Delonghi Ecam 22.140B型号，国内电商也有这个牌子。



![](https://pic3.zhimg.com/v2-04e504ad1913a04731e0eedf528b688a_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='578' height='786'></svg>)



然后，你需要买五块控制器，分别是：

**树莓派3B+主板**，亲测某宝可购。



![](https://pic1.zhimg.com/v2-437bb586eb8d4596ab8801138535bee4_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='425'></svg>)



**ReSpeaker 2-Mics Pi HAT**，适配树莓派的双麦克风扩展板，可以拿来做AI语音应用。



![](https://pic1.zhimg.com/v2-8a974bf1b4cb89abc8685b8af6e7a19c_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='417'></svg>)



**Arduino nano**，一款基于ATmega328P（Arduino Nano 3.x）的小型主板。






![](https://pic2.zhimg.com/v2-1e1948eb8c294605837e5db24890747d_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='401'></svg>)



**8通道继电器板**



![](https://pic1.zhimg.com/v2-c2fe674884990aea9c4701afafd14f88_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='381'></svg>)



**步进电机+控制板**



![](https://pic1.zhimg.com/v2-9ac18764856268f4b112389da6671060_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='440'></svg>)



另外还需要充电器、microSDHC卡、USB 2.0转接线、8x8耦合器、一些18AWG导线（最好是红黑的）、2xM3x15螺丝钉、2xM3x45螺丝钉。



![](https://pic2.zhimg.com/v2-5cc302f1943825127386f00cab5a0695_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='480'></svg>)



然后准备一些工具，包括一个热熔胶枪、不同尺寸的一套钻头、一台电磨机、一些热缩套管、一个电烙铁、一个飞利浦螺丝刀、一个Torx TS 20螺丝刀，另外最好有3D打印机，没有的话就去万能的某宝找人帮你做。

## **Step 2：拆咖啡机**

现在，可以把买来的咖啡机大卸八块了（别哭，后面我们还会装回去）。

先把后面的这五个螺丝拧下来，注意螺丝钉不要丢。






![](https://pic1.zhimg.com/v2-4b0cc667bc70216de1fff7bfdcc7c7d0_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='711'></svg>)



然后可以吧咖啡机的“左脸”和“右脸”悄咪咪往后滑动拖下来。



![](https://pic4.zhimg.com/v2-8bcad6f2da3337474788c7958eb47bfb_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



现在把固定“头盖骨”的两个螺丝拧下来，先不要着急掀起咖啡机的头盖骨。



![](https://pic2.zhimg.com/v2-d8c07311f4f3f441b273ffad8cc04ea1_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



这个时候，你会发现咖啡机的“右脸颊”有一个用于固定“头盖骨”的螺丝钉，把它拧下来。“左脸颊”也有一个，同样拧下来。






![](https://pic4.zhimg.com/v2-d359e72fc4da79f2dfe50b60781545d3_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='533'></svg>)



然后把蒸汽主开关拉向你站立的方向，取下来。



![](https://pic2.zhimg.com/v2-abe69d5644b251e01d37818dfd8b24e1_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



现在可以掀起咖啡机的“头盖骨”啦！

掀完之后，可以“面对”你的咖啡机正脸，把左右两侧的两个螺丝拧下来。



![](https://pic3.zhimg.com/v2-78ad43291b1744ff0f8e0cff32d32eca_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='405'></svg>)








![](https://pic3.zhimg.com/v2-f268cdbc137a0706be13e73c69109cf6_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



再把面板背面的4个螺钉拧下来。面板左右两侧有两个灰色的塑料卡，取下面板的时候轻一点不要弄坏它们，不然就装不回去了。



![](https://pic3.zhimg.com/v2-a545a8cf3d11869db13158b87e880752_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='343'></svg>)



面板下面的PCB板右上角有个连接处，轻轻地把它拔出来。



![](https://pic3.zhimg.com/v2-13e76d7df69ae46aed51048ca9665bbe_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='323'></svg>)



完美，现在你的咖啡机成功被大卸八块了。

## **Step 3：前面板焊接**

现在，你可以把咖啡机正脸上的面板拿下来，准备加工它了。

先在面板上戳5个洞，位置如下图。注意洞的大小，需要保证两根18AWG导线通过。



![](https://pic2.zhimg.com/v2-782c65ba7a2dffd0dd37a96b276744e9_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='455'></svg>)



现在，拿起你的电烙铁，开始把导线焊道面板按钮下面的引脚处，面板上7个按钮分别连一对红黑导线。



![](https://pic2.zhimg.com/v2-e22f1ab5c935b0d8b2150eb5964264c5_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



## **Step 4：把咖啡机的脸再装回去**

先装按钮和透明壳，注意导线的站位，不要卡住。

不过，考虑到反正你要用语音控制咖啡机了，不装按钮也不会怎样，略略略略略~



![](https://pic2.zhimg.com/v2-23b752e990d0e649b1cdbec89a8be805_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



这块面板的背壳也要和面板一样，戳一些洞洞，方便导线通过。



![](https://pic2.zhimg.com/v2-d57596209c6d35c89b9f15fcdd27ec29_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='427'></svg>)



现在，在咖啡机外壳正脸的最上方中央戳个半圆的洞，也是为了过导线。

另外，作者还3D打印了一个部件，这个部件的下边中央是另外一个半圆。

两个半圆的位置如下图红色大圆圈所示，而两个红色小圆圈的位置需要打直径2.8毫米的孔。






![](https://pic2.zhimg.com/v2-58dec7cbd570a56de4a578b3788b45ed_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='453'></svg>)



现在，可以把正面的PCB板、外壳等连在一起了。电线留20厘米左右的长度。



![](https://pic3.zhimg.com/v2-a037556b5999ba54b64b30d828ed05a6_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



用M3x15螺丝钉将步进电机固定到3D打印部件上。

在步进机的尖端添加耦合器（暂不夹紧）。使用M3X45螺钉将3D部件固定到正面外壳上。



![](https://pic2.zhimg.com/v2-1f5b4ff46ec4a230a183d8d5c71941dd_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='398'></svg>)



现在，把所有电线顺到咖啡机右侧，把整个咖啡机正面装回卡飞机上，注意现在也不要夹住耦合器。



![](https://pic4.zhimg.com/v2-f6fe91d0d0d876f24132cb19d7ec34ef_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



## **Step 5：原理和安装**

下面是整体的电路图，可以按照这个来连接导线。



![](https://pic4.zhimg.com/v2-b8f63bc346f7e9308ebc799b0550ee6f_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='640'></svg>)



连好之后，可以把所有器件一股脑儿塞在咖啡机的右侧，当然要保证里面没有短路的情况，然后找个合适的位置，拿热熔胶固定好。



![](https://pic2.zhimg.com/v2-25538fde65d617564f6468609ce7920d_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'></svg>)



## **Step 6：写代码和安装程序**

可以直接复制这段声控代码


```python
#include <Wire.h>
  #include <Stepper.h>
  
  #define STEPS 64
  #define REVOLUTION 2048
  #define SLAVE_ADDRESS 0x04
  
  //naming Arduino pin
  int ONOFF = ;
 int x1short = ; // button for  short coffee
 int x2short = ; // button for  short coffee
 int clean = ; // button clean
 int vape = ; // button vape
 int x1long = ; // button for  long coffee
 int x2long = ; // button for  long coffee
 
 int count = ;
 int number = ;
 int state = ;
 int steps = ;
 int max_step = (int)(250.0 / 180.0 * (float)REVOLUTION / 2.0);
 int nb_step = ;
 Stepper stepper(STEPS, , , , );
 
 int servo_pos = ;
 
 void setup() {
   // start serial for output
   Serial.begin();
   Serial.println("Ready!");
 
   // setup pin Mode
   pinMode(ONOFF, OUTPUT);
   pinMode(x1short, OUTPUT);
   pinMode(x2short, OUTPUT);
   pinMode(x1long, OUTPUT);
   pinMode(x2long, OUTPUT);
   pinMode(vape, OUTPUT);
   pinMode(clean, OUTPUT);
 
   //set default status
   digitalWrite(ONOFF, HIGH);
   digitalWrite(x1short, HIGH);
   digitalWrite(x2short, HIGH);
   digitalWrite(x1long, HIGH);
   digitalWrite(x2long, HIGH);
   digitalWrite(vape, HIGH);
   digitalWrite(clean, HIGH);
   stepper.setSpeed();
   stepper.step();
   turn_right();
   turn_left();
 }
 
 /*
  * Run undefinitly
  */
 void loop() {
   if (Serial.available() > ) {
     // read the incoming byte:
     int incomingByte = Serial.read();
     if (incomingByte == 'B') {
       // command have to start with 'B'
       number = ;
       count = ;
     } else if (incomingByte == 'E') {
       // command have to end with 'E'
       start_coffee(number);
       number = ;
       count = ;
     }
     else if (incomingByte >= '0' && incomingByte <= '9') {
       // save as an int all the character coming from Serial
       int tmp = incomingByte - '0';
       number *= ;
       number += tmp;
       count++;
     }
   }
 }
 
 /*
  * Utils 
  */
 
 /*
  * turn the stepper motor to the left
  */
 void turn_left(int v) {
   Serial.println("turn left\n");
   if (v == )
     return;
   if (v == ) {
     stepper.step();
     return;
   }
   if (v == ) {
     stepper.step();
     return;
  }
  if (v == ) {
    stepper.step();
    return;
  }
}
/*
 * turn the stepper motor to the right
 */
void turn_right(int v) {
  Serial.println("turn right\n");
  if (v == )
    return;
  if (v == ) {
    stepper.step(-);
    return;
  }
  if (v == ) {
    stepper.step(-);
    return;
  }
  if (v == ) {
    stepper.step(-);
    return;
  }
}

/*
 * simulate push a button
 */
void touch_button(int pin) {
  digitalWrite(pin, LOW);
  Serial.print(" touchdown\n");
  delay();
  digitalWrite(pin, HIGH);
}

/*
 * simulate push button for  short coffees
 */
void touch_x2() {
  Serial.println("touch x2\n");
  touch_button(x2short);
}
/*
 * simulate push button for  long coffees
 */
void touch_x2_long() {
  Serial.println("touch x2 long\n");
  touch_button(x2long);
}
/*
 * simulate push button for  short coffee
 */
void touch_x1() {
  Serial.println("touch x1\n");
  touch_button(x1short);
}
/*
 * simulate push button for  long coffee
 */
void touch_x1_long() {
  Serial.println("touch x1 long\n");
  touch_button(x1long);
}

/*
 * simulate push button for cleaning
 */
void touch_clean() {
  Serial.println("touch rince\n");
  touch_button(clean);
}

/*
 * simulate push button for on and off
 */
void onoff() {
  Serial.println("turn on/off\n");
  touch_button(ONOFF);
}

/*
 * Select the intensity fort the coffee by moving the stepper motor
 *  -> mild
 *  -> standard
 *  -> strong
 *  -> extra strong
 */
void select_intensity(int intensity) {
  turn_right(intensity);
}

/*
 * Set the stepper motor to its default position
 */
void default_intensity(int intensity) {
  turn_left(intensity);
}

/*
 * compute int into order
 */
void start_coffee(unsigned int type) {
  int number = type % ;
  int coffee_type = type /  % ;
  int coffee_size = type /  % ;
  int intensity = type /  % ;
  int special = type /  % ;
  Serial.print(type);
  if (special != ) {
    switch (special) {
      case :
        onoff();
        return;
    }
  } else if (coffee_type == ) {
    select_intensity(intensity);
    if (number == )
      if (coffee_size == )
        touch_x1();
      else
        touch_x1_long();
    else if (coffee_size == )
      touch_x2();
    else
      touch_x2_long();
    delay();
    default_intensity(intensity);
  }
}
```





之后需要设置一下你的树莓派主板，确保它安装了Raspbian Stretch Lite。

然后在树莓派主板上设置Snips语音平台，先连上网，然后启用SSH，安装SAM。

把Snips要安装在SAM上，重启即可启动，把上面的咖啡机程序装进Snips控制台。

## **Step 7：喝咖啡走起**

现在大功告成啦，连上电源，打开树莓派程序，打开咖啡机，你就可以“点”一杯咖啡试试：

“Hey Snips，我要两杯咖啡，蟹蟹。”

## **传送门**

作者原文：

[https://medium.com/snips-ai/your-personal-home-barista-comes-to-life-with-this-voice-enabled-coffee-machine-5fc333326f31](https://link.zhihu.com/?target=https%3A//medium.com/snips-ai/your-personal-home-barista-comes-to-life-with-this-voice-enabled-coffee-machine-5fc333326f31)

内附各种亚马逊链接，不过大家完全可以去（准备退休的）马爸爸那里剁手。

就酱，做手工愉快~

— **完** —

欢迎大家关注我们的专栏：[量子位 - 知乎专栏](https://zhuanlan.zhihu.com/qbitai)

诚挚招聘

量子位正在招募编辑/记者，工作地点在北京中关村。期待有才气、有热情的同学加入我们！相关细节，请在量子位公众号(QbitAI)对话界面，回复“招聘”两个字。

[量子位 QbitAI](https://zhuanlan.zhihu.com/qbitai)· 头条号签约作者

վ'ᴗ' ի 追踪AI技术和产品新动态


