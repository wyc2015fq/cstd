# ä¸‰åˆ†é’Ÿè®­ç»ƒçœ¼çƒè¿½è¸ªæœ¯ï¼ŒAIå°±çŸ¥é“ä½ åœ¨çœ‹å“ªä¸ªå¦¹å­ - çŸ¥ä¹
# 



> åœ†æ —å­ ç¼–è¯‘æ•´ç†
é‡å­ä½ å‡ºå“ | å…¬ä¼—å· QbitAI
![](https://pic4.zhimg.com/v2-52ee4744e5c78b3a03995b2462f989df_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='690' height='450'></svg>)
å•Šï¼Œè€æ¿çš„çœ¼ç¥é£è¿‡æ¥äº†ï¼Œè¿˜ä¸å¿«åˆ‡å›å·¥ä½œç•Œé¢ï¼Ÿ

ä»å‰ï¼Œæˆ‘ä»¬å‡ ä¹æ— ä»èº²é¿æ¥è‡ªèº«åçš„ç›®å…‰ï¼Œä½†ç°åœ¨ä¸ä¸€å®šäº†ã€‚

å¦‚æœæœ‰ä¸ª**çœ¼çƒè¿½è¸ª**AIï¼ŒåŠ ä¸Š**äººè„¸è¯†åˆ«**ï¼Œæˆ–è®¸å°±èƒ½åœ¨è¢«è€æ¿ç›¯ä¸Šçš„ç¬é—´ï¼Œè¿›å…¥å¥‹åŠ›å·¥ä½œæ¨¡å¼ã€‚

æˆæ˜¯æœ‰ç‚¹å¤šã€‚ä¸è¿‡çœ¼çƒè¿½è¸ªè¿™ä»¶äº‹ï¼Œåªè¦æœ‰ç”µè„‘çš„å‰ç½®æ‘„åƒå¤´ï¼Œå†æœ‰ä¸ªæµè§ˆå™¨ï¼ŒçœŸçš„å¯ä»¥åšåˆ°ã€‚
![](https://pic3.zhimg.com/v2-a9a12b2c27bf05cdf16daef9daa3e682_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='700' height='468'></svg>)
æ¥è‡ªæ…•å°¼é»‘çš„ç¨‹åºçŒ¿Max Schumacherï¼Œå°±ç”¨**TensorFlow.js**åšäº†ä¸€ä¸ªæ¨¡å‹ï¼Œä½ çœ‹å‘å±å¹•çš„**æŸä¸€ç‚¹**ï¼Œå®ƒå°±çŸ¥é“ä½ åœ¨çœ‹çš„æ˜¯å“ªä¸€ç‚¹äº†ã€‚

## **æˆ‘æ¥è®­ç»ƒä¸€æŠŠ**

è¿™ä¸ªæ¨¡å‹å«***Lookie Lookie***ï¼Œä¸ç”¨æœåŠ¡å™¨ï¼Œæ‰“å¼€æ‘„åƒå¤´å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šè®­ç»ƒï¼Œ**ä¸å‡ºä¸‰åˆ†é’Ÿ**å°±èƒ½å…»æˆä¸€åªå°AIã€‚

åœ¨ä¸‹è¯•äº†ä¸€è¯•ã€‚

æ‘„åƒå¤´æ‹åˆ°çš„ç”»é¢å°±æ˜¾ç¤ºåœ¨å±å¹•å·¦ä¸Šè§’ï¼Œè„¸ä¸Šæ˜¯ç»¿è‰²çš„è½®å»“ï¼Œçœ¼ç›è¢«ä¸€ä¸ªçº¢è‰²æ–¹æ¡†æ¡†ä½ã€‚
![](https://pic2.zhimg.com/v2-28b503e5390381d844fd8ab856a65915_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='312' height='136'></svg>)
æ”¶é›†æ•°æ®çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªè¦å››å¤„ç§»åŠ¨é¼ æ ‡ï¼Œçœ¼ç›è·Ÿç€é¼ æ ‡èµ°ï¼Œç„¶åéšæ—¶æŒ‰ä¸‹ç©ºæ ¼é”®ï¼Œæ¯æŒ‰ä¸€æ¬¡å°±é‡‡é›†ä¸€ä¸ªæ•°æ®ç‚¹ã€‚

**ç¬¬ä¸€æ³¢**ï¼Œåªè¦æŒ‰20æ¬¡ç©ºæ ¼ï¼Œç³»ç»Ÿå°±æç¤ºï¼Œå¯ä»¥ç‚¹å‡»è®­ç»ƒæŒ‰é’®äº†ã€‚

è®­ç»ƒå¥½ä¹‹åï¼Œå±å¹•ä¸Šå‡ºç°ä¸€ä¸ª**ç»¿åœˆåœˆ**ã€‚è¿™æ—¶å€™ï¼Œæˆ‘çš„çœ¼ç›çœ‹å“ªé‡Œï¼Œç»¿åœˆåœˆéƒ½åº”è¯¥è·Ÿç€æˆ‘èµ°çš„ã€‚
![](https://pic3.zhimg.com/v2-6266384a85ab2952d2e72f93f3a4bb2e_b.gif)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='368'></svg>)
å¯å®ƒä¼¼ä¹æœ‰äº›çŠ¹è±«ã€‚ç³»ç»Ÿåˆæç¤ºï¼šç°åœ¨æ•°æ®ä¸å¤ªå¤Ÿï¼Œå¯èƒ½è¿˜æ²¡è®­ç»ƒå¥½ï¼Œå†å–ä¸€äº›æ•°æ®å§ã€‚

é‚£å¥½ï¼Œå†å–ä¸ªäºŒä¸‰åå¼ å›¾ï¼Œè®­ç»ƒç¬¬äºŒæ³¢ã€‚

æœç„¶ï¼Œè¿™æ¬¡ç»¿åœˆåœˆè·‘å¾—**è‡ªä¿¡**äº†ä¸€äº›ï¼Œå·¦çœ‹å³çœ‹ï¼Œå®ƒéƒ½é©°éª‹ (æ¯”è¾ƒ) å¦‚é£ã€‚
![](https://pic4.zhimg.com/v2-42fbab9f53dc6f1b488f81a2d0af0327_b.gif)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='580' height='137'></svg>)
ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¯¹äº**ä¸Šä¸‹**ç§»åŠ¨çš„ç›®å…‰ï¼ŒAIçš„ååº”ä¼¼ä¹æ²¡æœ‰é‚£ä¹ˆæ•é”ã€‚å¤§æ¦‚æ˜¯å› ä¸ºï¼Œç”µè„‘å±å¹•ä¸Šä¸‹è·ç¦»ä¸å¤Ÿå®½ï¼Œçœ¼çƒè½¬åŠ¨ä¸å……åˆ†å§ã€‚

ä¸è¿‡ï¼Œåœ¨è®­ç»ƒæ•°æ®å¦‚æ­¤è´«ä¹çš„å‰æä¸‹ï¼Œç¥ç»ç½‘ç»œä¹Ÿç®—æ˜¯èŒå£®æˆé•¿äº†ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”¶é›†æ•°æ®çš„æ—¶å€™ï¼Œè„¸**ä¸è¦ç¦»å±å¹•å¤ªè¿œ** (ä¹Ÿä¸è¦å€’ç«‹ğŸ™ƒ) ã€‚

## **DIYå…¨æ”»ç•¥ (ä¸Š) ï¼šæ¶å­æ­èµ·æ¥**

ä½œä¸ºä¸€ä¸ªä¸éœ€è¦ä»»ä½•æœåŠ¡å™¨å°±èƒ½è®­ç»ƒçš„æ¨¡å‹ï¼Œå¦‚æœè¦å¤„ç†**æ•´å¹…æ•´å¹…**çš„è§†é¢‘æˆªå›¾ï¼Œè´Ÿæ‹…å¯èƒ½æœ‰äº›é‡ã€‚
![](https://pic4.zhimg.com/v2-e89efeae4290b7f43c570bca307ea16b_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1080' height='275'></svg>)
æ‰€ä»¥ï¼Œè¿˜æ˜¯å…ˆ**æ£€æµ‹äººè„¸**ï¼Œå†æ¡†å‡ºçœ¼ç›æ‰€åœ¨çš„éƒ¨åˆ†ã€‚**åªæŠŠ**è¿™ä¸ªåŒºåŸŸ (ä¸Šå›¾å³ä¸€) äº¤ç»™ç¥ç»ç½‘ç»œçš„è¯ï¼Œä»»åŠ¡å°±è½»æ¾äº†ã€‚

å¾·å›½å°‘å¹´é€‰æ‹©äº†**clmtrackr**äººè„¸æ£€æµ‹æ¨¡å‹ï¼Œå®ƒçš„ä¼˜ç‚¹ä¹Ÿæ˜¯è·‘èµ·æ¥è½»å¿«ã€‚

é‚£ä¹ˆï¼Œå…ˆæŠŠå®ƒä¸‹ä¸‹æ¥ï¼š

> [https://raw.githubusercontent.com/auduno/clmtrackr/dev/build/clmtrackr.js](https://link.zhihu.com/?target=https%3A//raw.githubusercontent.com/auduno/clmtrackr/dev/build/clmtrackr.js)

ç„¶åï¼Œæ‰“å¼€ä¸€ä¸ªç©ºçš„**html**æ–‡ä»¶ï¼Œå¯¼å…¥jQuery, TensorFlow.jsï¼Œclmtrackr.jsï¼Œä»¥åŠmain.jsã€‚ä»£ç å¦‚ä¸‹ï¼š


```python
<!doctype html>
<html>
<body>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.0"></script>
    <script src="clmtrackr.js"></script>
    <script src="main.js"></script>
</body>
</html>
```


è¿™æ ·ï¼Œå‡†å¤‡æ´»åŠ¨å°±åšå¥½äº†ã€‚ä¸‹é¢æ­£å¼å¼€å§‹ã€‚

## **Â· å¯¼å‡ºè§†é¢‘æµ**

ç¬¬ä¸€æ­¥ï¼Œè¦ç»è¿‡ä½  (ç”¨æˆ·) çš„**åŒæ„**ï¼Œæ‰èƒ½æ‰“å¼€æ‘„åƒå¤´ï¼Œæ¸²æŸ“è§†é¢‘æµï¼ŒæŠŠç”»é¢æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚

å…ˆå†™è¿™è¡Œä»£ç  (æ­¤å¤„é»˜è®¤ç”¨çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„Chrome) ï¼š


```python
<video id="webcam" width="400" height="300" autoplay></video>
```


ç„¶åä»main.jså¼€å§‹ï¼š


```python
$(document).ready(function() {
  const video = $('#webcam')[];

  function onStreaming(stream) {
    video.srcObject = stream;
  }

  navigator.mediaDevices.getUserMedia({ video: true }).then(onStreaming);
});
```


åˆ°è¿™é‡Œï¼Œæµè§ˆå™¨å°±è¯¥é—®ä½ â€œè¦ä¸è¦æ‰“å¼€æ‘„åƒå¤´â€äº†ã€‚

## **Â· æ‰¾åˆ°ä½ çš„è„¸**

ä¸Šæ–‡æåˆ°çš„clmtrackr.jsäººè„¸è¿½è¸ªå™¨ï¼Œè¿™é‡Œå°±å‡ºåœºã€‚

å…ˆåœ¨const video=â€¦ä¸‹é¢ï¼Œ**åˆå§‹åŒ–**è¿½è¸ªå™¨ï¼š


```python
const ctrack = new clm.tracker();
ctrack.init();
```


ç„¶åï¼Œåœ¨onStreaming() é‡Œé¢ï¼ŒåŠ ä¸‹é¢è¿™å¥è¯ï¼Œå°±èƒ½è®©è¿½è¸ªå™¨æ£€æµ‹è§†é¢‘é‡Œçš„äººè„¸äº†ï¼š


```python
ctrack.start(video);
```


å†™å¥½è¿™å‡ è¡Œï¼Œå®ƒåº”è¯¥**å·²ç»**èƒ½çœ‹å‡ºä½ çš„è„¸ã€‚ä¸ç›¸ä¿¡çš„è¯ï¼Œå°±è®©å®ƒ**æå‡ºæ¥**ã€‚

è¿™é‡Œéœ€è¦ä¸€ä¸ªç»˜å›¾å·¥å…·ã€‚ç”¨htmlé‡Œé¢çš„<canvas>æ ‡ç­¾ï¼Œåœ¨è§†é¢‘ä¸Šé¢**é‡å ä¸€å¼ ç”»å¸ƒ**ã€‚

åœ¨<video>ä¸‹é¢ï¼Œå†™ä¸Šè¿™ä¸€ä¸²ä»£ç ï¼š


```python
<canvas id="overlay" width="400" height="300"></canvas>
<style>
    #webcam, #overlay {
        position: absolute;
        top: ;
        left: ;
    }
</style>
```


è¿™æ ·ï¼Œå°±æœ‰äº†è·Ÿè§†é¢‘**å°ºå¯¸ä¸€æ ·çš„ç”»å¸ƒ**ã€‚CSSèƒ½ä¿è¯ç”»å¸ƒå’Œè§†é¢‘çš„ä½ç½®å®Œå…¨å»åˆã€‚

æµè§ˆå™¨æ¯åšä¸€æ¬¡æ¸²æŸ“ï¼Œæˆ‘ä»¬å°±è¦åœ¨ç”»å¸ƒä¸Šç”»ç‚¹ä»€ä¹ˆäº†ã€‚ç”»ä¹‹å‰ï¼Œè¦å…ˆæŠŠä¹‹å‰ç”»è¿‡çš„å†…å®¹æ“¦æ‰ã€‚

ä»£ç é•¿è¿™æ ·ï¼Œå†™åœ¨ctrack.init() ä¸‹é¢ï¼š


```python
const overlay = $('#overlay')[];
 const overlayCC = overlay.getContext('2d');
 
 function trackingLoop() {
   // Check if a face is detected, and if so, track it.
   requestAnimationFrame(trackingLoop);
 
   let currentPosition = ctrack.getCurrentPosition();
   overlayCC.clearRect(, , , );

  if (currentPosition) {
    ctrack.draw(overlay);
  }
}
```


ç°åœ¨ï¼Œåœ¨onStreaming() çš„ctrack.starg() åé¢ï¼Œè°ƒç”¨trackingLoop() ã€‚æ¯ä¸€å¸§é‡Œï¼Œå®ƒéƒ½ä¼šé‡æ–°è¿è¡Œã€‚

è¿™ä¸ªæ—¶å€™ï¼Œåˆ·æ–°ä¸€ä¸‹æµè§ˆå™¨ï¼Œä½ çš„è„¸ä¸Šåº”è¯¥æœ‰ä¸€ä¸ª**ç»¿è‰²åˆè¯¡å¼‚çš„è½®å»“**äº†ã€‚
![](https://pic3.zhimg.com/v2-72d40dd204170972db4d5de8718c76ca_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='400' height='300'></svg>)
## **Â· çœ¼ç›æˆªä¸‹æ¥**

è¿™ä¸€æ­¥ï¼Œæ˜¯è¦åœ¨çœ¼ç›å‘¨å›´ç”»ä¸ª**çŸ©å½¢æ¡†**ã€‚

cmltrackrå¾ˆå–„è‰¯ï¼Œé™¤äº†ç”»ä¸ªè½®å»“ä¹‹å¤–ï¼Œè¿˜æœ‰**70**ä¸ªé¢éƒ¨ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è‡ªå·±éœ€è¦çš„éƒ¨åˆ†ã€‚



![](https://pic1.zhimg.com/v2-7f2dce34151d52f5426f1298385aa9a8_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='407' height='420'></svg>)



è¿™é‡Œï¼Œé€‰23ã€28ã€24ã€26å°±å¤Ÿäº†ï¼Œåœ¨æ¯ä¸ªæ–¹å‘ä¸Šï¼Œå¾€å¤–æ‰©å¤§5ä¸ªåƒç´ ã€‚

ç„¶åï¼ŒçŸ©å½¢æ¡†åº”è¯¥è¶³å¤Ÿè¦†ç›–é‡è¦é¢éƒ¨ä¿¡æ¯äº† (ä¸ç¦»å¤ªè¿œã€ä¸å€’ç«‹) ã€‚

ç°åœ¨ï¼Œå†æ‹¿**å¦å¤–ä¸€å¼ ç”»å¸ƒ**ï¼Œæ¥æ•æ‰è¿™ä¸ªæˆªä¸‹æ¥çš„çŸ©å½¢ã€‚è¿™å¼ ç”»å¸ƒ**50 x 25**åƒç´ å³å¯ï¼Œåªè¦æŠŠçŸ©å½¢æ¡†çš„å°ºå¯¸è°ƒä¸€ä¸‹ï¼Œå°±èƒ½æ”¾è¿›å»ï¼š


```python
<canvas id="eyes" width="50" height="25"></canvas>
<style>
    #eyes {
        position: absolute;
        top: ;
        right: ;
    }
</style>
```


ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼Œä¼šè¿”å› (x,y) åæ ‡ï¼Œä»¥åŠçŸ©å½¢çš„é•¿å®½ã€‚ç»™å®ƒè¾“å…¥çš„æ˜¯clmtrackré‡Œé¢çš„ä½ç½®é˜µåˆ— (Position Array) ï¼š


```python
function getEyesRectangle(positions) {
   const minX = positions[][] - ;
   const maxX = positions[][] + ;
   const minY = positions[][] - ;
   const maxY = positions[][] + ;
 
   const width = maxX - minX;
   const height = maxY - minY;
 
  return [minX, minY, width, height];
}
```


æ¥ä¸‹æ¥ï¼Œè¦æŠŠçŸ©å½¢æ¡†æå–å‡ºæ¥ã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼Œåœ¨ç¬¬ä¸€å¼ ç”»å¸ƒä¸ŠæŠŠå®ƒææˆçº¢è‰²ï¼Œå†å¤åˆ¶åˆ°ç¬¬äºŒå¼ ç”»å¸ƒä¸Šã€‚

æ›¿æ¢trackingLoop() é‡Œé¢çš„ifå—ï¼š


```python
if (currentPosition) {
   // Draw facial mask on overlay canvas:
   ctrack.draw(overlay);
 
   // Get the eyes rectangle and draw it in red:
   const eyesRect = getEyesRectangle(currentPosition);
   overlayCC.strokeStyle = 'red';
   overlayCC.strokeRect(eyesRect[], eyesRect[], eyesRect[], eyesRect[]);
 
  // The video might internally have a different size, so we need these
  // factors to rescale the eyes rectangle before cropping:
  const resizeFactorX = video.videoWidth / video.width;
  const resizeFactorY = video.videoHeight / video.height;

  // Crop the eyes from the video and paste them in the eyes canvas:
  const eyesCanvas = $('#eyes')[];
  const eyesCC = eyesCanvas.getContext('2d');

  eyesCC.drawImage(
    video,
    eyesRect[] * resizeFactorX, eyesRect[] * resizeFactorY,
    eyesRect[] * resizeFactorX, eyesRect[] * resizeFactorY,
    , , eyesCanvas.width, eyesCanvas.height
  );
}
```


ç°åœ¨ï¼Œåº”è¯¥çœ‹å¾—åˆ°çœ¼ç›å‘¨å›´çš„**çº¢è‰²çŸ©å½¢æ¡†**äº†ã€‚

## **DIYå…¨æ”»ç•¥ (ä¸‹) ï¼šè®­ç»ƒä¸æµ‹è¯•**

## **Â· æ”¶é›†æ•°æ®**

çœ¼çƒè¿½è¸ªï¼Œæ”¶é›†æ•°æ®çš„æ–¹æ³•å…¶å®æœ‰å¾ˆå¤šç§ã€‚ä¸è¿‡ï¼Œè®©çœ¼ç›è·Ÿç€é¼ æ ‡èµ°ï¼Œæ˜¯æœ€ç®€å•çš„ï¼Œéšæ—¶æŒ‰ä¸‹ç©ºæ ¼éƒ½å¯ä»¥æ•è·ä¸€å¹…å›¾åƒã€‚

**1) è¿½è¸ªé¼ æ ‡**

æƒ³çŸ¥é“é¼ æ ‡æ¯æ—¶æ¯åˆ»éƒ½åœ¨ä»€ä¹ˆä½ç½®ï¼Œå°±ç»™document.onmousemoveåŠ ä¸Šä¸€ä¸ªEventListenerã€‚

è¿™æ ·åšè¿˜å¯ä»¥æŠŠåæ ‡å½’ä¸€åŒ– (è½¬åŒ–åˆ° [-1, 1] çš„èŒƒå›´é‡Œ) ï¼š


```python
// Track mouse movement:
 const mouse = {
   x: ,
   y: ,
 
   handleMouseMove: function(event) {
     // Get the mouse position and normalize it to [-, ]
     mouse.x = (event.clientX / $(window).width()) *  - ;
     mouse.y = (event.clientY / $(window).height()) *  - ;
  },
}

document.onmousemove = mouse.handleMouseMove;
```


**2) æ•æ‰å›¾åƒ**

è¿™é‡Œè¦åšçš„æ˜¯ï¼ŒæŒ‰ä¸‹ç©ºæ ¼é”®**ä¹‹å**çš„ä»»åŠ¡ï¼šä»ç”»å¸ƒä¸Šæ•æ‰å›¾åƒï¼Œå‚¨å­˜ä¸ºå¼ é‡ã€‚

TensorFlow.jsæä¾›äº†ä¸€ä¸ªåŠ©æ‰‹å‡½æ•°ï¼Œå«tf.fromPixels() ï¼Œåªè¦ç”¨å®ƒæ¥å‚¨å­˜ç¬¬äºŒå¼ ç”»å¸ƒé‡Œèµ°å‡ºçš„å›¾åƒï¼Œç„¶åå½’ä¸€åŒ–ï¼š


```python
function getImage() {
   // Capture the current image in the eyes canvas as a tensor.
   return tf.tidy(function() {
     const image = tf.fromPixels($('#eyes')[]);
     // Add a batch dimension:
     const batchedImage = image.expandDims();
     // Normalize and return it:
     return batchedImage.toFloat().div(tf.scalar()).sub(tf.scalar());
   });
}
```


æ³¨æ„æ³¨æ„ï¼Œè™½ç„¶æŠŠæ‰€æœ‰æ•°æ®åšæˆä¸€ä¸ª**å¤§è®­ç»ƒé›†**ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†è¿˜æ˜¯ç•™ä¸€éƒ¨åˆ†åš**éªŒè¯é›†**æ¯”è¾ƒç§‘å­¦ï¼Œæ¯”å¦‚20%ã€‚

è¿™æ ·ï¼Œä¾¿ä¸æ£€æµ‹æ¨¡å‹çš„æ€§èƒ½ï¼Œä»¥åŠç¡®è®¤å®ƒæ²¡æœ‰**è¿‡æ‹Ÿåˆ**ã€‚

ä»¥ä¸‹æ˜¯æ·»åŠ æ–°æ•°æ®ç‚¹ç”¨çš„ä»£ç ï¼š


```python
const dataset = {
   train: {
     n: ,
     x: null,
     y: null,
   },
   val: {
     n: ,
     x: null,
    y: null,
  },
}

function captureExample() {
  // Take the latest image from the eyes canvas and add it to our dataset.
  tf.tidy(function() {
    const image = getImage();
    const mousePos = tf.tensor1d([mouse.x, mouse.y]).expandDims();

    // Choose whether to add it to training (%) or validation (%) set:
    const subset = dataset[Math.random() > 0.2 ? 'train' : 'val'];

    if (subset.x == null) {
      // Create new tensors
      subset.x = tf.keep(image);
      subset.y = tf.keep(mousePos);
    } else {
      // Concatenate it to existing tensors
      const oldX = subset.x;
      const oldY = subset.y;

      subset.x = tf.keep(oldX.concat(image, ));
      subset.y = tf.keep(oldY.concat(mousePos, ));
    }

    // Increase counter
    subset.n += ;
  });
}
```


æœ€åï¼ŒæŠŠ**ç©ºæ ¼é”®**å…³è”è¿›æ¥ï¼š


```python
$('body').keyup(function(event) {
  // On space key:
  if (event.keyCode == ) {
    captureExample();

    event.preventDefault();
    return false;
  }
});
```


è‡³æ­¤ï¼Œåªè¦ä½ æŒ‰ä¸‹ç©ºæ ¼ï¼Œæ•°æ®é›†é‡Œå°±ä¼šå¢åŠ ä¸€ä¸ªæ•°æ®ç‚¹äº†ã€‚

## **Â· è®­ç»ƒæ¨¡å‹**

å°±æ­ä¸ªæœ€ç®€å•çš„**CNN**å§ã€‚
![](https://pic3.zhimg.com/v2-3fb72156eb00a71dec7e8af8e5b68886_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1080' height='285'></svg>)
TensorFlow.jsé‡Œé¢æœ‰ä¸€ä¸ªå’ŒKeraså¾ˆç›¸ä¼¼çš„**API**å¯ä»¥ç”¨ã€‚

è¿™ä¸ªç½‘ç»œé‡Œï¼Œè¦æœ‰ä¸€ä¸ªå·ç§¯å±‚ï¼Œä¸€ä¸ªæœ€å¤§æ± åŒ–ï¼Œè¿˜è¦æœ‰ä¸ªå¯†é›†å±‚ï¼Œå¸¦ä¸¤ä¸ªè¾“å‡ºå€¼ (åæ ‡) çš„é‚£ç§ã€‚

ä¸­é—´ï¼ŒåŠ äº†ä¸€ä¸ªdropoutä½œä¸ºæ­£åˆ™åŒ–å™¨ï¼›è¿˜æœ‰ï¼Œç”¨flattenæŠŠ2Dæ•°æ®é™æˆ1Dã€‚è®­ç»ƒç”¨çš„æ˜¯Adamä¼˜åŒ–å™¨ã€‚

æ¨¡å‹ä»£ç é•¿è¿™æ ·ï¼š


```python
let currentModel;
 
 function createModel() {
   const model = tf.sequential();
 
   model.add(tf.layers.conv2d({
     kernelSize: ,
     filters: ,
     strides: ,
    activation: 'relu',
    inputShape: [$('#eyes').height(), $('#eyes').width(), ],
  }));

  model.add(tf.layers.maxPooling2d({
    poolSize: [, ],
    strides: [, ],
  }));

  model.add(tf.layers.flatten());

  model.add(tf.layers.dropout(0.2));

  // Two output values x and y
  model.add(tf.layers.dense({
    units: ,
    activation: 'tanh',
  }));

  // Use ADAM optimizer with learning rate of 0.0005 and MSE loss
  model.compile({
    optimizer: tf.train.adam(0.0005),
    loss: 'meanSquaredError',
  });

  return model;
}
```


è®­ç»ƒå¼€å§‹ä¹‹å‰ï¼Œè¦å…ˆè®¾ç½®ä¸€ä¸ª**å›ºå®š**çš„epochæ•°ï¼Œå†æŠŠæ‰¹å°ºå¯¸è®¾æˆ**å˜é‡** (å› ä¸ºæ•°æ®é›†å¾ˆå°) ï¼š


```python
function fitModel() {
   let batchSize = Math.floor(dataset.train.n * 0.1);
   if (batchSize < ) {
     batchSize = ;
   } else if (batchSize > ) {
     batchSize = ;
   }
 
   if (currentModel == null) {
    currentModel = createModel();
  }

  currentModel.fit(dataset.train.x, dataset.train.y, {
    batchSize: batchSize,
    epochs: ,
    shuffle: true,
    validationData: [dataset.val.x, dataset.val.y],
  });
}
```


ç„¶åï¼Œåœ¨é¡µé¢ä¸Šåšä¸ª**è®­ç»ƒæŒ‰é’®**å§ï¼š


```python
<button id="train">Train!</button>
 <style>
     #train {
         position: absolute;
         top: %;
         left: %;
         transform: translate(-%, -%);
         font-size: pt;
     }
</style>
```


è¿˜æœ‰JSï¼š


```python
<button id="train">Train!</button>
 <style>
     #train {
         position: absolute;
         top: %;
         left: %;
         transform: translate(-%, -%);
         font-size: pt;
     }
</style>
```


## **Â· æ‹‰å‡ºæ¥é›é›**

**ç»¿è‰²åœˆåœˆ**ç»ˆäºæ¥äº†ã€‚AIåˆ¤æ–­ä½ åœ¨çœ‹å“ªï¼Œå®ƒå°±å‡ºç°åœ¨å“ªã€‚

å…ˆå†™ç»¿åœˆåœˆï¼š


```python
<div id="target"></div>
 <style>
     #target {
         background-color: lightgreen;
         position: absolute;
         border-radius: %;
         height: px;
         width: px;
         transition: all 0.1s ease;
        box-shadow:   px px white;
        border: px solid rgba(,,,0.5);
    }
</style>
```


ç„¶åï¼Œæƒ³è®©ç»¿åœˆåœˆåŠ¨èµ·æ¥ï¼Œå°±è¦**å®šæœŸ**æŠŠçœ¼ç›å›¾åƒä¼ ç»™ç¥ç»ç½‘ç»œã€‚é—®å®ƒä½ åœ¨çœ‹å“ªï¼Œå®ƒå°±å›ç­”ä¸€ä¸ªåæ ‡ï¼š


```python
function moveTarget() {
   if (currentModel == null) {
     return;
   }
   tf.tidy(function() {
     const image = getImage();
     const prediction = currentModel.predict(image);
 
     // Convert normalized position back to screen position:
    const targetWidth = $('#target').outerWidth();
    const targetHeight = $('#target').outerHeight();
    const x = (prediction.get(, ) + ) /  * ($(window).width() - targetWidth);
    const y = (prediction.get(, ) + ) /  * ($(window).height() - targetHeight);

    // Move target there:
    const $target = $('#target');
    $target.css('left', x + 'px');
    $target.css('top', y + 'px');
  });
}

setInterval(moveTarget, );
```


é—´éš”è®¾çš„æ˜¯**100æ¯«ç§’**ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥æ”¹çš„ã€‚

æ€»ä¹‹ï¼Œå¤§åŠŸå‘Šæˆã€‚
![](https://pic1.zhimg.com/v2-5a5876927f7d512ddea8e8af2cce7b94_b.jpg)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='225' height='150'></svg>)
## **é¼»å­”çœ¼ç›åˆ†ä¸æ¸…ï¼Ÿ**

çœ¼çƒè¿½è¸ªæ¨¡å‹å¾ˆæœ‰æ„æ€ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰ä¸€äº›å¯çˆ±çš„ç¼ºé™·ã€‚

æ¯”å¦‚ï¼Œç®—æ³•è¿˜åªèƒ½è¯†åˆ«æ­£é¢ï¼Œè„¸ç¨å¾®**ä¾§ä¸€ç‚¹**AIå°±ä¼šå›°æƒ‘ã€‚

æ¯”å¦‚ï¼Œæœ‰æ—¶å€™ä¼šæŠŠ**é¼»å­”**è¯†åˆ«æˆçœ¼ç›ã€‚

æ¯”å¦‚ï¼Œå¿…é¡»æ•´å¼ è„¸éƒ½å‡ºç°åœ¨ç”»é¢é‡Œï¼Œæ‰èƒ½è¯†åˆ«çœ¼ç›çš„æ‰€åœ¨ï¼Œ**æ‚ä½å˜´**ä¹Ÿä¸è¡Œã€‚
![](https://pic4.zhimg.com/v2-6b0ba67f197dde5168736f718a5a2317_b.gif)![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='243' height='162'></svg>)â–³ æ¥è‡ªæ€ªå¼‚å›
Maxä¹Ÿè¯´ï¼Œè¿˜æœ‰å¾ˆå¤šå¯ä»¥æ¢ç´¢çš„ç©ºé—´ã€‚


è‡ªå·±è®­ç»ƒä¼ é€é—¨ï¼š
[https://cpury.github.io/lookie-lookie/](https://link.zhihu.com/?target=https%3A//cpury.github.io/lookie-lookie/)

ä»£ç å®ç°ä¼ é€é—¨ï¼š
[https://github.com/cpury/lookie-lookie](https://link.zhihu.com/?target=https%3A//github.com/cpury/lookie-lookie)

æ•™ç¨‹åŸæ–‡ä¼ é€é—¨ï¼š
[https://cpury.github.io/learning-where-you-are-looking-at/](https://link.zhihu.com/?target=https%3A//cpury.github.io/learning-where-you-are-looking-at/)

â€” **å®Œ** â€”

æ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘ä»¬çš„ä¸“æ ï¼š[é‡å­ä½ - çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/qbitai)

è¯šæŒšæ‹›è˜

é‡å­ä½æ­£åœ¨æ‹›å‹Ÿç¼–è¾‘/è®°è€…ï¼Œå·¥ä½œåœ°ç‚¹åœ¨åŒ—äº¬ä¸­å…³æ‘ã€‚æœŸå¾…æœ‰æ‰æ°”ã€æœ‰çƒ­æƒ…çš„åŒå­¦åŠ å…¥æˆ‘ä»¬ï¼ç›¸å…³ç»†èŠ‚ï¼Œè¯·åœ¨é‡å­ä½å…¬ä¼—å·(QbitAI)å¯¹è¯ç•Œé¢ï¼Œå›å¤â€œæ‹›è˜â€ä¸¤ä¸ªå­—ã€‚

[é‡å­ä½ QbitAI](https://zhuanlan.zhihu.com/qbitai)Â· å¤´æ¡å·ç­¾çº¦ä½œè€…

Õ¾'á´—' Õ« è¿½è¸ªAIæŠ€æœ¯å’Œäº§å“æ–°åŠ¨æ€


