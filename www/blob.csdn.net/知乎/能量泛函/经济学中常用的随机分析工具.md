# 经济学中常用的随机分析工具 - 知乎
# 

**【CH1.范围】**

本系列文章旨在归纳、总结在**高级数理经济学（不是高级计量经济学）**中使用频率最高的**主流数学工具**（注意并非全部数学工具）。

包括以下几个方面：

**1.不确定性经济学**

常用的随机差分方程和随机微分方程、哥萨诺夫定理。

**2.动态系统**

流形与切丛的概念、动态系统的概念、证明流形上动态系统均衡的存在性、稳定性、唯一性的数学工具

**3.最优化理论**

函数方程分析基础、动态规划的使用方法、本维尼斯特-沙因克曼定理的证明、随机控制与卡尔曼滤波

**【CH2.不确定性】**

这篇文章主要介绍处理不确定性经济学的数学工具。

面对随机差分方程，经常需要处理随机变量构成的无穷级数。**实变函数**中的**单调收敛定理**和**控制收敛定理**是我们求取随机变量无穷级数期望值的重要工具，现示范如下：

一个简单的**MA过程**：

![X_{t}=\sum_{j=-\infty}^{\infty}{a_{j}\varepsilon_{t-j}}](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%7Ba_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D%7D)

![EX_{t}=E\sum_{j=-\infty}^{\infty}{a_{j}\varepsilon_{t-j}}](https://www.zhihu.com/equation?tex=EX_%7Bt%7D%3DE%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%7Ba_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D%7D)

由于 ![\left| \sum_{-\infty}^{+\infty}{}a_{j}\varepsilon_{t-j} \right|\leq \sum_{-\infty}^{+\infty}{\left| a_{j}\varepsilon_{t-j} \right|}](https://www.zhihu.com/equation?tex=%5Cleft%7C+%5Csum_%7B-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D%7B%7Da_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D+%5Cright%7C%5Cleq+%5Csum_%7B-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D%7B%5Cleft%7C+a_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D+%5Cright%7C%7D)

我们只要证明上式不等号右边的式子是控制函数（即它的无条件期望值是有限的），我们就可以运用**DCT**（控制收敛定理），从而可以把期望算子放到无穷求和号里面。

如是，则可得：

![EX_{t}=E \sum_{j=-\infty}^{\infty}{a_{j}\varepsilon_{t-j}}=\sum_{-\infty}^{+\infty}{Ea_{j}\varepsilon_{t-j}}=0](https://www.zhihu.com/equation?tex=EX_%7Bt%7D%3DE+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%7Ba_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D%7D%3D%5Csum_%7B-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D%7BEa_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D%7D%3D0)

所以我们只需要证明：

![E\sum_{-\infty}^{+\infty}{\left| a_{j}\varepsilon_{t-j} \right|}\prec\infty](https://www.zhihu.com/equation?tex=E%5Csum_%7B-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D%7B%5Cleft%7C+a_%7Bj%7D%5Cvarepsilon_%7Bt-j%7D+%5Cright%7C%7D%5Cprec%5Cinfty)

即可。注意到这是一串递增型非负随机变量和，利用单调收敛定理易证上式成立。

现定义随机序列 ![\left\{ w_{t} \right\}](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+w_%7Bt%7D+%5Cright%5C%7D) 是一个相应于信息集 ![\left\{ I_{t} \right\}](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+I_%7Bt%7D+%5Cright%5C%7D) 的**条件同方差+鞅差分序列**。所谓信息集，是包含了所有 ![\left\{ x_{0},w_{1},w_{2},... \right\}](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+x_%7B0%7D%2Cw_%7B1%7D%2Cw_%7B2%7D%2C...+%5Cright%5C%7D) 的可测函数生成的。 ![\left\{ x_{t} \right\}](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+x_%7Bt%7D+%5Cright%5C%7D) 是一个 ![n](https://www.zhihu.com/equation?tex=n) 维状态变量。迭代得到线性随机差分方程：

![x_{t+1}=Ax_{t}+Cw_{t+1}](https://www.zhihu.com/equation?tex=x_%7Bt%2B1%7D%3DAx_%7Bt%7D%2BCw_%7Bt%2B1%7D)

预测，就是基于随机差分方程来计算均衡。令 ![E_{t}](https://www.zhihu.com/equation?tex=E_%7Bt%7D) 表示基于 ![t](https://www.zhihu.com/equation?tex=t) 时刻信息的条件期望，则最优线性预测为：

![E_{t}x_{t+1}=Ax_{t}](https://www.zhihu.com/equation?tex=E_%7Bt%7Dx_%7Bt%2B1%7D%3DAx_%7Bt%7D)

同时基于 ![I_{t}](https://www.zhihu.com/equation?tex=I_%7Bt%7D) 的条件协方差矩阵为 ![CC^{'}](https://www.zhihu.com/equation?tex=CC%5E%7B%27%7D)

我们还可以将该**VAR过程**转变为**VMA过程:**

![x_{t}=Ax_{t-1}+Cw_{t}= A^{2}x_{t-2}+ACw_{t-1}+Cw_{t}=...](https://www.zhihu.com/equation?tex=x_%7Bt%7D%3DAx_%7Bt-1%7D%2BCw_%7Bt%7D%3D+A%5E%7B2%7Dx_%7Bt-2%7D%2BACw_%7Bt-1%7D%2BCw_%7Bt%7D%3D...)

从而通解为 ![x_{t}=\sum_{j=0}^{t-1}{A^{j}Cw_{t-j}}+A^{t}x_{0}](https://www.zhihu.com/equation?tex=x_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bt-1%7D%7BA%5E%7Bj%7DCw_%7Bt-j%7D%7D%2BA%5E%7Bt%7Dx_%7B0%7D)

移动平均的形式显式地表达l了**脉冲响应函数。**

**【Wold分解】指的是一个弱平稳随机过程都可以写成MA（∞）形式，即：**
![](https://pic4.zhimg.com/v2-9d3189e5bbca9afcb82e52526b0186cf_b.jpg)![](https://pic1.zhimg.com/v2-b8db90f95f985943f883e222ac8d08dc_b.jpg)
称为脉冲响应函数。

考虑矩阵的**Jordan分解**![A=TDT^{-1}](https://www.zhihu.com/equation?tex=A%3DTDT%5E%7B-1%7D)

令 ![x_{t}^{*}=T^{-1}x_{t}](https://www.zhihu.com/equation?tex=x_%7Bt%7D%5E%7B%2A%7D%3DT%5E%7B-1%7Dx_%7Bt%7D)

则方程变为 ![x_{t+1}^{*}=Dx_{t}^{*}+T^{-1}Cw_{t+1}](https://www.zhihu.com/equation?tex=x_%7Bt%2B1%7D%5E%7B%2A%7D%3DDx_%7Bt%7D%5E%7B%2A%7D%2BT%5E%7B-1%7DCw_%7Bt%2B1%7D)

由于Jordan矩阵 ![D](https://www.zhihu.com/equation?tex=D) 是一个分块矩阵，我们实现了系统的**解耦**。根据Jordan矩阵的性质，设 ![\delta_{j}](https://www.zhihu.com/equation?tex=%5Cdelta_%7Bj%7D) 为 ![A](https://www.zhihu.com/equation?tex=A) 的特征值，只要 ![\left| \delta_{j} \right|](https://www.zhihu.com/equation?tex=%5Cleft%7C+%5Cdelta_%7Bj%7D+%5Cright%7C) 小于1，则随机差分方程是稳定的。

下面是**渐进分析**中经常使用的结论：
![](https://pic4.zhimg.com/v2-c4fc72dcfaa32973b6efbd07f51a69b7_b.jpg)![](https://pic4.zhimg.com/v2-55c1ce6a54d656255e91c58d2eafbe0b_b.png)
使用方法：在宏观经济学/金融学研究中，我们列出随机动态规划问题的**Bellman方程**，导出相应的**Euler方程**。我们经常能够据此得到某个序列（如消费序列）是一个**非负上鞅。**根据**鞅收敛定理，**我们知道该消费序列几乎必然收敛，则根据渐进分析中的连续性定理，我们可以**得到任何关于该序列的连续函数都是几乎必然收敛的！**从而为分析系统的极限行为提供了数理依据。我们知道了系统收敛的必要条件，也可以反过来使用这些结论得出**避免使得随机系统发散**的条件。

以下两个随机过程的极限定理在宏观经济分析中也经常用到：
![](https://pic3.zhimg.com/v2-0e35cd7120bb5ada07714f21a19c5cce_b.jpg)![](https://pic3.zhimg.com/v2-54d1758a9be013570536d1dd2d466162_b.jpg)

分析连续型随机系统主要依靠三个工具：
![](https://pic2.zhimg.com/v2-8f094d562110305a92805a372a18a811_b.jpg)![](https://pic4.zhimg.com/v2-56e5661182148f45f0a88fbd4b9950d3_b.jpg)![](https://pic3.zhimg.com/v2-4aa6ec44101deeb3da4426cce7cb97ba_b.jpg)![](https://pic2.zhimg.com/v2-1b75898e294fe4422f58f7250fd7996d_b.jpg)
考虑随机微分方程：

一种常见的随机微分方程是**Ornstein-Uhlenbeck过程，**可以证明（详见《期权、期货及其他衍生产品》第21章），**GARCH（1，1）**模型可以与该过程等价。

![(1) dX_{t}=-\mu X_{t}dt+\sigma dW_{t}](https://www.zhihu.com/equation?tex=%281%29+dX_%7Bt%7D%3D-%5Cmu+X_%7Bt%7Ddt%2B%5Csigma+dW_%7Bt%7D)

变形得 ![e^{\mu t}\left( dX_{t}+\mu X_{t} dt\right)=\sigma e^{\mu t}dW_{t}](https://www.zhihu.com/equation?tex=e%5E%7B%5Cmu+t%7D%5Cleft%28+dX_%7Bt%7D%2B%5Cmu+X_%7Bt%7D+dt%5Cright%29%3D%5Csigma+e%5E%7B%5Cmu+t%7DdW_%7Bt%7D)

即 ![d\left( X_{t} e^{\mu t}\right)=\sigma e^{\mu t}dW_{t}](https://www.zhihu.com/equation?tex=d%5Cleft%28+X_%7Bt%7D+e%5E%7B%5Cmu+t%7D%5Cright%29%3D%5Csigma+e%5E%7B%5Cmu+t%7DdW_%7Bt%7D)

两边积分得 ![X_{t}=X_{t_{0}}e^{\mu (t_{0}-t)}+\int_{t_{0}}^{t}\sigma e^{-\mu(t-s)}dW_{s}](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DX_%7Bt_%7B0%7D%7De%5E%7B%5Cmu+%28t_%7B0%7D-t%29%7D%2B%5Cint_%7Bt_%7B0%7D%7D%5E%7Bt%7D%5Csigma+e%5E%7B-%5Cmu%28t-s%29%7DdW_%7Bs%7D)

此外，平方根过程也是数理经济学、金融数学中经常用到的一种随机微分方程。其形式为：

![（2）dr_{t}=\alpha\left( \mu-r_{t} \right)dt+\sigma\sqrt{r_{t}}dW_{t}](https://www.zhihu.com/equation?tex=%EF%BC%882%EF%BC%89dr_%7Bt%7D%3D%5Calpha%5Cleft%28+%5Cmu-r_%7Bt%7D+%5Cright%29dt%2B%5Csigma%5Csqrt%7Br_%7Bt%7D%7DdW_%7Bt%7D)

其中 ![\alpha、\mu、\sigma](https://www.zhihu.com/equation?tex=%5Calpha%E3%80%81%5Cmu%E3%80%81%5Csigma) 均为正的常数。

由于在经济学研究中经常遇到这一类方程，我们不妨单独拎出来研究下它。

首先根据观察可知，它同Ornstein-Uhlenbeck过程一样具有**均值回复**特征。这是显然的。这篇短文的主要目的就是要得到该随机过程的**条件期望**与**条件方差**。

首先，我们介绍一个有用的引理：

引理：设 ![X_{t}](https://www.zhihu.com/equation?tex=X_%7Bt%7D) 是一个Ito过程，则 ![\frac{dE(X_{t})}{dt}=\frac{E\left( dX_{t} \right)}{dt}](https://www.zhihu.com/equation?tex=%5Cfrac%7BdE%28X_%7Bt%7D%29%7D%7Bdt%7D%3D%5Cfrac%7BE%5Cleft%28+dX_%7Bt%7D+%5Cright%29%7D%7Bdt%7D)

我们对（2）两边取期望： ![E\left( dr_{t} \right)=\alpha\left[ \left( \mu-Er_{t} \right) \right]dt](https://www.zhihu.com/equation?tex=E%5Cleft%28+dr_%7Bt%7D+%5Cright%29%3D%5Calpha%5Cleft%5B+%5Cleft%28+%5Cmu-Er_%7Bt%7D+%5Cright%29+%5Cright%5Ddt)

从而 ![d\left( Er_{t} \right)=\alpha\left[ \left( \mu-Er_{t} \right) \right]dt](https://www.zhihu.com/equation?tex=d%5Cleft%28+Er_%7Bt%7D+%5Cright%29%3D%5Calpha%5Cleft%5B+%5Cleft%28+%5Cmu-Er_%7Bt%7D+%5Cright%29+%5Cright%5Ddt)

边界条件为 ![Er_{0}=r_{0}](https://www.zhihu.com/equation?tex=Er_%7B0%7D%3Dr_%7B0%7D)

令 ![y=Er_{t}-\mu](https://www.zhihu.com/equation?tex=y%3DEr_%7Bt%7D-%5Cmu) 则通过对前式简单变形，我们可以得到： ![dlny=-\alpha dt](https://www.zhihu.com/equation?tex=dlny%3D-%5Calpha+dt)

简单化简，我们就得到了第一个结果 ![Er_{t}=\mu+Ce^{-\alpha t}](https://www.zhihu.com/equation?tex=Er_%7Bt%7D%3D%5Cmu%2BCe%5E%7B-%5Calpha+t%7D)

结合边界条件，知： ![Er_{t}=\mu+\left( r_{0}-\mu \right)e^{-\alpha t}](https://www.zhihu.com/equation?tex=Er_%7Bt%7D%3D%5Cmu%2B%5Cleft%28+r_%7B0%7D-%5Cmu+%5Cright%29e%5E%7B-%5Calpha+t%7D)

接下来，运用**Ito公式**，可以得到：

![dr_{t}^{2}=\left[ 2\alpha r_{t} \left( \mu-r_{t} \right)\right]dt+\sigma\sqrt{r_{t}}dW_{t}](https://www.zhihu.com/equation?tex=dr_%7Bt%7D%5E%7B2%7D%3D%5Cleft%5B+2%5Calpha+r_%7Bt%7D+%5Cleft%28+%5Cmu-r_%7Bt%7D+%5Cright%29%5Cright%5Ddt%2B%5Csigma%5Csqrt%7Br_%7Bt%7D%7DdW_%7Bt%7D)

所以再由引理，知： ![\frac{Edr_{t}^{2}}{dt}=\frac{d\left( Er_{t}^{2} \right)}{dt}=\left( 2\alpha \mu+\sigma^{2} \right)Er_{t}-2\alpha Er_{t}^{2}](https://www.zhihu.com/equation?tex=%5Cfrac%7BEdr_%7Bt%7D%5E%7B2%7D%7D%7Bdt%7D%3D%5Cfrac%7Bd%5Cleft%28+Er_%7Bt%7D%5E%7B2%7D+%5Cright%29%7D%7Bdt%7D%3D%5Cleft%28+2%5Calpha+%5Cmu%2B%5Csigma%5E%7B2%7D+%5Cright%29Er_%7Bt%7D-2%5Calpha+Er_%7Bt%7D%5E%7B2%7D)

将 ![Er_{t}](https://www.zhihu.com/equation?tex=Er_%7Bt%7D) 的结果代入上式，就可以得到一个关于 ![Er_{t}^{2}](https://www.zhihu.com/equation?tex=Er_%7Bt%7D%5E%7B2%7D) 的常微分方程，不难，解出即可得

![Er_{t}^{2}=r_{0}e^{-2\alpha t}+r_{0}\left( \frac{\sigma^{2}}{\alpha} +2\mu\right)\left( e^{-\alpha t}-e^{-2\alpha t} \right)+\left( \frac{\ \sigma^{2}}{2\alpha}\mu+\mu^{2} \right)\left( 1-e^{-\alpha t} \right)^{2}](https://www.zhihu.com/equation?tex=Er_%7Bt%7D%5E%7B2%7D%3Dr_%7B0%7De%5E%7B-2%5Calpha+t%7D%2Br_%7B0%7D%5Cleft%28+%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B%5Calpha%7D+%2B2%5Cmu%5Cright%29%5Cleft%28+e%5E%7B-%5Calpha+t%7D-e%5E%7B-2%5Calpha+t%7D+%5Cright%29%2B%5Cleft%28+%5Cfrac%7B%5C+%5Csigma%5E%7B2%7D%7D%7B2%5Calpha%7D%5Cmu%2B%5Cmu%5E%7B2%7D+%5Cright%29%5Cleft%28+1-e%5E%7B-%5Calpha+t%7D+%5Cright%29%5E%7B2%7D)

得到一个随机微分方程的期望和方差是非常难得的，并且往往需要借助一些奇技淫巧。所以平方根过程是如此友善，以至于我们应该珍惜这一类方程！想要得到基于t时刻信息集 ![F_{t}](https://www.zhihu.com/equation?tex=F_%7Bt%7D) 的关于未来时刻 ![T](https://www.zhihu.com/equation?tex=T) 的条件期望和条件方差，只需将公式中的  ![t](https://www.zhihu.com/equation?tex=t) 换成 ![T-t](https://www.zhihu.com/equation?tex=T-t)

最后举一个债券定价的    例子：
![](https://pic2.zhimg.com/v2-b2b3b1ce64a3ebee407d3f7b4b77bde5_b.jpg)![](https://pic1.zhimg.com/v2-5a64e1bdc2bf32b1fb2ddc614e7c3e0c_b.jpg)![](https://pic4.zhimg.com/v2-abc5ee0babbf62a1f69019b0070a87db_b.jpg)![](https://pic1.zhimg.com/v2-2848bed7d0c0eac2e4e221114c4e5e38_b.jpg)![](https://pic2.zhimg.com/v2-f5183e21094126d6880870b642fc50a9_b.jpg)
在风险中性概率测度**Q**下：
![](https://pic1.zhimg.com/v2-4777b6928ec12d1abab8314ed4fe1a30_b.png)
从而**SDE**变为
![](https://pic2.zhimg.com/v2-0654dbebf718d3332464dd2645879f8d_b.jpg)
假定**Girsanov定理**条件成立。
![](https://pic2.zhimg.com/v2-5250595d883ec0350c0ccf45b87a1bb1_b.jpg)

