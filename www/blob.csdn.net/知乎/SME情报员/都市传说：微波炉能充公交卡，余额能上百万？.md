# 都市传说：微波炉能充公交卡，余额能上百万？ - 知乎
# 

![](https://pic3.zhimg.com/v2-920870c28e9cd3276779527c180c25ea_b.jpg)
也不知道是不是因为雾霾功力太强，前段时间天上地下的交通都遭不住了，逼得菊长只好转战地下。

结果才没几天，就发现公交卡余额已经是个位数了，又要去便利店排队充值了，说好的公共交通便宜又方便的呢？
![](https://pic4.zhimg.com/v2-4c7618a6ef2ffad894dc1e622a1d124f_b.jpg)

没办法，菊长打开浏览器，搜索**“关于公交卡有哪些不为人知的奇技淫巧？”**，结果还真发现了一些秘密。

有这样一个应该是来自香港的帖子，其宣称将一张余额不低于300元的**八达通**（香港公交卡）放入**微波炉**中用最大火力“叮”大约5秒，**微波炉所产生的电磁波就能影响八达通内的数据芯片，造成数据溢位，最终余额会不可想象地增加**，成千上万都没有什么困难。
![](https://pic2.zhimg.com/v2-d440d7e4469d580e55c90626ea730cb5_b.jpg)

还称保证卡中余额300元以上的目的是为了占用芯片中更多的内存，更容易触发数据溢位。**还附上了一张余额高达380万的八达通闸机提示信息照片。**
![](https://pic4.zhimg.com/v2-a2923fc9c8daaae3637d6c1ed81ece0f_b.jpg)

无独有偶，墙内的中国论坛也流传着类似的说法，不过略有不同。

> 
首先，拿一张A4纸或者报纸，将公交卡包裹起来，要确保两边都是3层（这个是我试验了几次才摸索出来的），放入微波炉，档位：大火，定时25秒（如果不能定25秒，就自己用秒表掐，一般手机都有这个功能。）然后开机，发射电磁波，电荷累积，金额增加，时间到了请立即关机， 到此，充值成功。

![](https://pic1.zhimg.com/v2-0460afa041dbf4176fa5e38a4f720ad4_b.jpg)

对于这些说法，有必要切实求证一下。两种说法中都有提到一个很关键的词语**“电磁波”**。实际上，**公交卡是属于非接触式IC卡**（integrated circuitcard即集成电路卡）。公交卡也的确是通过电磁波进行无线通讯的。

而手机上用的SIM卡、早期的公共电话卡和新一代的银行卡这种有裸露触点的，则属于接触式IC卡，需要插入机器接触读取信息。
![](https://pic1.zhimg.com/v2-8b3bc8f8bd459b9bfdc467d60411c140_b.jpg)
图：几乎绝迹了的公共电话卡是最典型的接触式IC卡

这么看来，微波炉从最基础的原理上来说的确是可以影响到公交卡的，难道这个说法不是谣言？

但又有人指出了，公交卡是属于**RFID**卡，通常的工作频率在**13.56MHz**，而微波炉所产生的微波频率高达**2450MHz**，根本就是跟荷兰人讲河南话的状态。

RFID卡又是什么？不是说公交卡是非接触式IC卡吗？到底IC卡和RFID卡是什么关系？
![](https://pic1.zhimg.com/v2-324d0f83a596bea9e07036e4af2838b0_b.jpg)

RFID全称radio frequency identification，中文学名**射频识别**，可以说大部分RFID卡基本上也都是非接触式IC卡，二者并不冲突。

RFID技术应用范围很广泛，除了可以作为消费卡之外，也常常作为物品的电子标签，在相当大的电磁场范围内都能有效地被识别。

著名的运动用品超市**迪卡侬**就采用了RFID技术，将RFID线圈芯片封装在衣物的内衬标签里，收银结账时将商品放置在特定的区域内就能准确地识别出商品的信息，不需要激光扫描条形码这样繁琐的步骤。
![](https://pic3.zhimg.com/v2-2af713bda48b9c0eed130d912d605646_b.png)
图：迪卡侬的RFID商品标签

然而，根据资料显示RFID卡又的确有2450MHz这一工作频段，莫非还真的可行？

好了，扯得也够多了，微波炉充公交卡的都市传说是个彻头彻尾的恶作剧。把公交卡放进微波炉，微波作用于卡内的芯片，瞬间起火，管你什么牛鬼蛇神，卡内余额多少，通通轰杀。**就算放入的公交卡支持2450MHz的通信频率，但你见过哪台充值机的发射功率是上千瓦的？**
![](https://pic1.zhimg.com/v2-cc186b4e90724831999bdbb104dbbf28_b.jpg)
图：网友用对传言的实验测试

退一万步说，就算用的是专业的RFID读写设备，也并不能随意读取修改公交卡。

国内的公交卡一般采用飞利浦电子公司（现已更名为恩智浦半导体公司）的**Mifare**解决方案，通信频率为13.56MHz，用户所用的卡片内包含天线和芯片。
![](https://pic4.zhimg.com/v2-29da7c1a3afdc5b2dbf3d4be71d41223_b.jpg)
图：使用最广泛的Mifare Classic 1K卡，此为透明演示卡

Mifare系列卡片拥有一定的储存空间，用于储存余额信息和最近的通讯记录。公交卡不记名、不挂失、不补办，充值需要通过设备写入信息，基本上都是将余额信息储存在芯片中，而扣费所用的读卡机只记录资费的变化值，上传服务系统。

相比之下，银行卡内的芯片则不记录余额信息，只存有账户身份验证信息，账户余额信息都存储在银行系统网络中，修改这些余额信息难度不亚于攻破NASA。
![](https://pic3.zhimg.com/v2-9ca62faccc755c3b8c93ad4c5d20c39a_b.jpg)
图：广州公交卡“羊城通”

如果单纯从通信原理上来看，公交卡又的确是能被非法充值的，可是为什么我们几乎很少听到有类似的犯罪案件发生呢？

实际上公交卡所用的Mifare系统安全性还是十分有保障的。读写机在读取卡片时，先会向卡片发送一段请求信息，卡片中的天线收到信息向读写机发送随机数，二者通过特定的密钥运算，比对结果最终验证其合法性后，才能读取和修改卡内信息。

**所以，并不是什么机器都能够读取和修改公交卡的，只有知道对应的密钥与算法才能够操作。**
![](https://pic2.zhimg.com/v2-e53cf0033ae0253fbe30359e6af3c481_b.jpg)

简言之，这种验证方式类似与各大网站的登陆验证码，例如12306的变态验证码，人类的思维和生活经验就是不可函数化的高级算法，网站系统可以很容易阻止掉大量的机器非法登陆操作，逻辑上与公交卡的验证流程一致。
![](https://pic3.zhimg.com/v2-78d19a6e066ebf7624f6971d403716fe_b.jpg)

那这么说来，Mifare公交卡不仅不可能被什么微波炉、电磁炉、电吹风这些东西轻易改写，而且安全性还相当高，是一种十分可靠的解决方案。

这话如果是在2008年前说的，有任何一个质疑者胆敢跳出来，你都可以用“你行你上”反驳他。

然而今时不同往日，2008年，一位德国的研究员和美国弗吉尼亚大学计算机的博士合作**用电脑成功破解了Mifare经典芯片**，也是十几年来全球应用范围最广的IC卡芯片，顿时引起了各国的恐慌。

![](https://pic1.zhimg.com/v2-7a17e3d609e450b93105b036d5307624_b.jpg)

**甚至有高中生用简单的设备就能破解学校的Mifare饭卡，修改余额至上万，成为“饭堂王思聪”。**

事情是这样的，这位黑客小哥带着**科研学习的态度**对学校的饭卡产生了浓厚的兴趣，决定对饭卡做一番实验。

实验工具有：**电脑一台、ACR122U-A9 Mifare读写器一台、带NFC功能的手机一台，Mifare Classic Tool（简称MCT）软件、饭卡一张。**
![](https://pic1.zhimg.com/v2-ec8c0a5740ae6595d4281523959f8888_b.jpg)
图：饭卡一张

![](https://pic3.zhimg.com/v2-87baee7947f21cd8620be4664fe230be_b.png)
图：读写器一个

首先在手机上安装有MTC软件，开启手机NFC，尝试用软件自带的默认密钥访问饭卡。

> 
NFC功能实际上是RFID的衍生产品，除了可以模拟成被动的RFID标签外，还可以读取RFID标签、甚至是点对点传输。

此处用手机NFC简单尝试可判断饭卡的加密情况。
![](https://pic2.zhimg.com/v2-f5f30da877be6c5e482ca034ca690971_b.jpg)
图：诺基亚早在2006年就推出了首款NFC手机

小哥发现他学校的饭卡并不是完全加密的，有部分扇区（储存分区）仍然采用默认的密钥，可以采用验证漏洞进行破解。

简单来说，就是访问未加密的扇区，通过与卡之间数据交换的加密算法反推出其他扇区的密钥。破解出所有扇区的密钥后就如同将饭卡扒光了一样，可以顺利进行下一步工作。
![](https://pic2.zhimg.com/v2-aaaf337906a9e6890a59c1f592591e45_b.png)
图：用手机读取的饭卡信息，有一个扇区并没有加密

接下来就是对卡中的十六进制数据进行解析，确定每组数据的功能。比较繁琐的是需要在修改数据后再到饭堂的刷卡机验证数据的功能，需要多次尝试才能将所有数据的作用弄明白。

**最终成功破解学校饭卡，不仅拥有上万的余额，还能拥有各种拉风的名字，这个逼装的能给满分。**
![](https://pic3.zhimg.com/v2-fb8d734aa6b6b0d815a354a654e6b9de_b.jpg)
图：上万的余额

![](https://pic1.zhimg.com/v2-f8941118c8e1416227ef4a8e4d884b40_b.jpg)
图：拉风的ID

虽说成功修改了饭卡中的数据，但这并不意味着万事大吉，因为计费系统中的数据异常必然会泄露出非法的行径，甚至可以通过卡中的身份信息追查到始作俑者，还是小心使得万年船啊。

**所以小哥每隔一段时间就把饭卡里的身份信息改成别人的，深藏功与名。**
![](https://pic1.zhimg.com/v2-42db93c3deaf14772191dbda2d74f7f4_b.jpg)

看完小哥的实验，你是不是内心有股冲动，是不是也想自己试试？

可不要以为学校饭卡的破解成功就意味着公交卡会有相同的遭遇，如今的公交卡已经提高了安全性，甚至采用了更新更复杂的加密系统，想想就好了。毕竟前两年不法分子没有动过卡里的数据，只是克隆了重残免费卡出售，都轻易地被发现查处了。
![](https://pic3.zhimg.com/v2-a4b4bfc45824168684d9d6c1752f1ae2_b.jpg)
图：进了微波炉的八达通

至此，微波炉充公交卡的都市传说彻底被粉碎，其貌不扬的公交卡实则包含着许多工程师的心血，是人类信息技术发展中的典范。作为技术的受惠方，难道不应该心怀感激吗？

**传播这样的谣言会被当作智商欠费，到时进微波炉充值的就不一定是公交卡了。**

