# 三个应知应会的数学技巧 - 知乎
# 

**这是本专栏的第 *16* 篇日记**

题外话：上周的行为经济学课，我去找教授要课件（我是旁听，登不上网络课堂），教授说你是不是经常去面试啊，为什么我问的题目（参见之前的专栏文章）你都答得上来呢？我才不告诉他我闲着没事干一直在知乎上回答问题所以他问的这些我都听说过呢……（比如那一次课的课前他问了这道题：[100个囚犯与100个抽屉的问题？ - 匡世珉的回答](https://www.zhihu.com/question/27050108/answer/35041211)，还有一次他问过“车平均10分钟一班那么平均等车时间是多少”的问题，差不多是我这个回答 [有哪些违背直觉的数学问题？ - Richard Xu 的回答](https://www.zhihu.com/question/41408857/answer/90964732) 里例三的意思）  

这里的“应知应会”当然不是对所有人来说的……其实这来自于上上周习题课的时候助教（博士生四年级）对我们如何学好高微的忠告，这三个数学技巧分别是：分部积分、隐函数求导和包络定理（Envelope Theorem）。不过说实话，这不是博一的数学水平，而是大一的数学水平吧……我不由得回想起暑假Math Camp的时候韩国同学上黑板求导都求错了（汗……）

分部积分就是利用![(fg)'=f'g+fg'](https://www.zhihu.com/equation?tex=%28fg%29%27%3Df%27g%2Bfg%27)，得到![\int fg' = fg - \int f'g](https://www.zhihu.com/equation?tex=%5Cint+fg%27+%3D+fg+-+%5Cint+f%27g)来帮助计算积分。

前不久我们在学不完全信息静态博弈（比如拍卖中的First/Second-Price Sealed-Bid Auction以及之前的专栏文章 [如何建造一座海峡大桥](https://zhuanlan.zhihu.com/p/22587986) 中的机制设计问题），就经常会用到这种求积分方法（主要是因为其中有很多涉及到概率计算，创造了使用分部积分的机会）。

隐函数求导最简单的二元情形就是将方程![f(x,y)=0](https://www.zhihu.com/equation?tex=f%28x%2Cy%29%3D0)中的![y](https://www.zhihu.com/equation?tex=y)视为![x](https://www.zhihu.com/equation?tex=x)的函数，直接对方程求导得![\frac{\partial f}{\partial x}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial x}=0](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x%7D%2B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+y%7D%5Cfrac%7B%5Cpartial+y%7D%7B%5Cpartial+x%7D%3D0)，这时候再移项得到![\frac{\partial y}{\partial x}= - \frac{\partial f}{\partial x} / \frac{\partial f}{\partial y}](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+y%7D%7B%5Cpartial+x%7D%3D+-+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x%7D+%2F+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+y%7D)。

在优化问题当中，很多时候目标函数都是抽象的，这时候一阶条件往往只能写成方程的形式。比如这样一个模型，某垄断厂商在进行生产时有两个变量，一个是投资![I](https://www.zhihu.com/equation?tex=I)，一个是生产量![Q](https://www.zhihu.com/equation?tex=Q)，考虑三种情况：（1）厂商自己控制![I](https://www.zhihu.com/equation?tex=I)和![Q](https://www.zhihu.com/equation?tex=Q)，最大化利润；（2）政府控制![I](https://www.zhihu.com/equation?tex=I)和![Q](https://www.zhihu.com/equation?tex=Q)，最大化社会总剩余；（3）政府控制![I](https://www.zhihu.com/equation?tex=I)，在给定![I](https://www.zhihu.com/equation?tex=I)的基础上厂商选择![Q](https://www.zhihu.com/equation?tex=Q)来最大化利润，反过来政府在知道厂商的最优反应的情况下选择![I](https://www.zhihu.com/equation?tex=I)来最大化社会总剩余。现在我们只知道价格是产量的函数，成本是产量和投资的函数，知道各阶导数的正负性，所以我们能够写出三种情况下的一阶条件（方程的形式），但是无法求出具体的最优投资和最优产量是多少。这时候可以采用示意图的做法，画出一阶条件所表示的曲线，来比较交点位置。绘制示意图的关键之一就是曲线各点的斜率大小（起码是相对的大小），而斜率就可以用隐函数求导得出。

包络定理说的是，对于某函数![H(x,b)](https://www.zhihu.com/equation?tex=H%28x%2Cb%29)，若对于给定的参数![b](https://www.zhihu.com/equation?tex=b)，![x=x^*(b)](https://www.zhihu.com/equation?tex=x%3Dx%5E%2A%28b%29)时![H(x,b)](https://www.zhihu.com/equation?tex=H%28x%2Cb%29)取得最大值![H^*(b)](https://www.zhihu.com/equation?tex=H%5E%2A%28b%29)（注意这是关于![b](https://www.zhihu.com/equation?tex=b)的函数），那么有![\frac{\text{d} H^*}{\text{d} b} = \frac{\partial H}{\partial x}\frac{\partial x}{\partial b} + \frac{\partial H}{\partial b} = \frac{\partial H}{\partial b}](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Ctext%7Bd%7D+H%5E%2A%7D%7B%5Ctext%7Bd%7D+b%7D+%3D+%5Cfrac%7B%5Cpartial+H%7D%7B%5Cpartial+x%7D%5Cfrac%7B%5Cpartial+x%7D%7B%5Cpartial+b%7D+%2B+%5Cfrac%7B%5Cpartial+H%7D%7B%5Cpartial+b%7D+%3D+%5Cfrac%7B%5Cpartial+H%7D%7B%5Cpartial+b%7D)（因为当![x=x^*(b)](https://www.zhihu.com/equation?tex=x%3Dx%5E%2A%28b%29)时满足![\frac{\partial H}{\partial x}=0](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+H%7D%7B%5Cpartial+x%7D%3D0)）。

这里![b](https://www.zhihu.com/equation?tex=b)通常是一个外生的参数，所以包络定理对于比较静态分析（Comparative Statics）很有用；此外，在前面提到的不完全信息静态博弈中也很有用，比如Sealed-Bid Auction，每个竞拍者自己的估值![v](https://www.zhihu.com/equation?tex=v)就可以看作参数，我们想要求一个竞拍函数![b^*(v)](https://www.zhihu.com/equation?tex=b%5E%2A%28v%29)，使得竞拍者的期望收益![W(b,v)](https://www.zhihu.com/equation?tex=W%28b%2Cv%29)在![b=b^*(v)](https://www.zhihu.com/equation?tex=b%3Db%5E%2A%28v%29)时最大，这一看就是可以用包络定理的地方。

还有一个可以用到包络定理的地方，就是带约束的最优化问题，这种问题一般用拉格朗日乘数法来解决。比如最优化效用![U(x_1,x_2)](https://www.zhihu.com/equation?tex=U%28x_1%2Cx_2%29)的时候，购买的商品总价值![p_1x_1+p_2x_2](https://www.zhihu.com/equation?tex=p_1x_1%2Bp_2x_2)不能超过收入![I](https://www.zhihu.com/equation?tex=I)，那么我们可能会问这样一个问题：如果我增加收入![I](https://www.zhihu.com/equation?tex=I)，我的效用（在最优化的情况下）会发生怎样的（边际）变化呢？注意到拉格朗日乘数法下我们不再是单单最优化![U(x_1,x_2)](https://www.zhihu.com/equation?tex=U%28x_1%2Cx_2%29)，而是最优化![L(x_1,x_2,\lambda;I)=U(x_1,x_2)+\lambda(I-p_1x_1-p_2x_2)](https://www.zhihu.com/equation?tex=L%28x_1%2Cx_2%2C%5Clambda%3BI%29%3DU%28x_1%2Cx_2%29%2B%5Clambda%28I-p_1x_1-p_2x_2%29)（![I](https://www.zhihu.com/equation?tex=I)用分号隔开，表明我们把![I](https://www.zhihu.com/equation?tex=I)当作参数，不是当作选择的变量，当然这主要是出于阅读的习惯，实际处理上把![I](https://www.zhihu.com/equation?tex=I)视为变量也无不可），那么用包络定理可知，在最优化的情况下![\frac{\text{d} L^*}{\text{d} I} = \frac{\partial L}{\partial I}  = \lambda](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Ctext%7Bd%7D+L%5E%2A%7D%7B%5Ctext%7Bd%7D+I%7D+%3D+%5Cfrac%7B%5Cpartial+L%7D%7B%5Cpartial+I%7D++%3D+%5Clambda)，也就是说这时候**拉格朗日乘数的经济意义就是收入边际增加时提高的边际效用**。

进一步地，在宏观经济学当中，如果一个禀赋经济满足第一福利定理和第二福利定理，那么可以用Negishi's Method来求解其Competitive Equilibrium，这个Method分成两步，第一步是求解Social Planner's Problem来得出所有的Pareto Efficient Allocation，第二步是从中找出Competitive Equilibrium。在第二步中有一个trick，就是怎么确定在Competitive Equilibrium下每个时刻t的价格。而上述对于带约束最优化问题的讨论就给了我们一个启发：在求解Social Planner's Problem的时候，我们会面临一个资源约束，即这个经济在时刻t的消费总量等于其在时刻t的禀赋总量，如果我们假设No Free Disposal，浪费资源也要付出成本，所以资源约束永远Binding，那么为这个资源约束添加的拉格朗日乘数![\mu_t](https://www.zhihu.com/equation?tex=%5Cmu_t)的含义就是，如果我们给这个经济在时刻t多增加一单位禀赋，就给整个经济增加了![\mu_t](https://www.zhihu.com/equation?tex=%5Cmu_t)的边际效用；既然如此，这一单位禀赋理所应当被定价为![p_t=\mu_t](https://www.zhihu.com/equation?tex=p_t%3D%5Cmu_t)，这就给出了支持Competitive Equilibrium的价格。注意这不是严格的证明，只是出于直觉的想法，但是这个想法最终可以证明是正确的。

*(Photo credit: "[Linear Programming](https://link.zhihu.com/?target=https%3A//visualhunt.com/f/photo/3238035711/235546c8a9/)" by [Lambroso](https://link.zhihu.com/?target=https%3A//www.flickr.com/photos/colleague/3238035711/) via [Visual hunt](https://link.zhihu.com/?target=https%3A//visualhunt.com/) / [CC BY-SA 2.0](https://link.zhihu.com/?target=http%3A//creativecommons.org/licenses/by-sa/2.0/))*

