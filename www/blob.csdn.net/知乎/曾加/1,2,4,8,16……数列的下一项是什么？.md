# 1,2,4,8,16……数列的下一项是什么？ - 知乎
# 

![](https://pic1.zhimg.com/v2-a2cd335d28ff12311fed6459528cbf30_b.jpg)
## 【引子】

小时候，有一类数学题总是让我们抓狂，这类题目叫做「找规律填数」。这类题之所以让人觉得困难，是因为题目常常稀奇古怪，让我们猜不到出题者的意图。

比如，随便给你出两道题：
- 9，61，__，63，94，46
- 26，16，__，68，88

你会做吗？[注1]

好了，先把这种奇奇怪怪的题目搁一边，我来给你出一道看起来「正常」一点的题目：
- 1，2，4，8，16，__

相信看了这道题，你会会心一笑：这题简单，2 的幂我都背过很多遍了，下一项显然是 32。

可是，谁告诉你这就一定是一个等比数列呢？为什么不能是由 **多项式 **组成的数列？

## 【1】用多项式方程解数列通项

如果你学过初中数学，你一定知道，两个点可以确定一条直线，三个不共线的点可以确定一条抛物线；如果你又在大学里学过一点线性代数，你也一定知道，**在大多数情况下，平面上的 n 个点可以用一个 n-1 次函数准确地拟合出来。**[注2]

那么，针对 1，2，4，8，16…… 这个数列，我们已经有了 5 项，于是我们可以用一个 4 次函数来拟合，即：

![y=f(x)=a_{4}x^{4}+a_{3}x^{3}+a_{2}x^{2}+a_{1}x+a_{0}](https://www.zhihu.com/equation?tex=y%3Df%28x%29%3Da_%7B4%7Dx%5E%7B4%7D%2Ba_%7B3%7Dx%5E%7B3%7D%2Ba_%7B2%7Dx%5E%7B2%7D%2Ba_%7B1%7Dx%2Ba_%7B0%7D)

带入 x = 1，2，3，4，5 的情形，我们有：
- ![a_{4}+a_{3}+a_{2}+a_{1}+a_{0}=1 ](https://www.zhihu.com/equation?tex=a_%7B4%7D%2Ba_%7B3%7D%2Ba_%7B2%7D%2Ba_%7B1%7D%2Ba_%7B0%7D%3D1+)
- ![16a_{4}+8a_{3}+4a_{2}+2a_{1}+a_{0}=2 ](https://www.zhihu.com/equation?tex=16a_%7B4%7D%2B8a_%7B3%7D%2B4a_%7B2%7D%2B2a_%7B1%7D%2Ba_%7B0%7D%3D2+)
- ![81a_{4}+27a_{3}+9a_{2}+3a_{1}+a_{0}=4 ](https://www.zhihu.com/equation?tex=81a_%7B4%7D%2B27a_%7B3%7D%2B9a_%7B2%7D%2B3a_%7B1%7D%2Ba_%7B0%7D%3D4+)
- ![256a_{4}+64a_{3}+16a_{2}+4a_{1}+a_{0}=8 ](https://www.zhihu.com/equation?tex=256a_%7B4%7D%2B64a_%7B3%7D%2B16a_%7B2%7D%2B4a_%7B1%7D%2Ba_%7B0%7D%3D8+)
- ![625a_{4}+125a_{3}+25a_{2}+5a_{1}+a_{0}=16 ](https://www.zhihu.com/equation?tex=625a_%7B4%7D%2B125a_%7B3%7D%2B25a_%7B2%7D%2B5a_%7B1%7D%2Ba_%7B0%7D%3D16+)

这是一个四元一次方程，用传统的消元法不太好解，用 [克莱姆法则](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%25E5%2585%258B%25E8%258E%25B1%25E5%25A7%2586%25E6%25B3%2595%25E5%2588%2599/7211518%3Ffr%3Daladdin) 解方程组运算会更通用一点，最后得到的解是： ![a_{4}=\frac{1}{24}，a_{3}=-\frac{1}{4}，a_{2}=\frac{23}{24}，a_{1}=-\frac{3}{4}，a_{0}=1 ](https://www.zhihu.com/equation?tex=a_%7B4%7D%3D%5Cfrac%7B1%7D%7B24%7D%EF%BC%8Ca_%7B3%7D%3D-%5Cfrac%7B1%7D%7B4%7D%EF%BC%8Ca_%7B2%7D%3D%5Cfrac%7B23%7D%7B24%7D%EF%BC%8Ca_%7B1%7D%3D-%5Cfrac%7B3%7D%7B4%7D%EF%BC%8Ca_%7B0%7D%3D1+) 。

于是数列的通项公式是： ![f(n)=\frac{1}{24}(n^{4}-6n^{3}+23n^{2}-18n+24)](https://www.zhihu.com/equation?tex=f%28n%29%3D%5Cfrac%7B1%7D%7B24%7D%28n%5E%7B4%7D-6n%5E%7B3%7D%2B23n%5E%7B2%7D-18n%2B24%29)

在这个通项公式下，数列的第 6 项当然就不是 32 了，它是 —— **31**。 

这不禁让人觉得有些诡异，主要有两点：① 在系数都不是整数的情况下，第 6 项竟然还是一个整数；② 这个整数距离 2 的 5 次幂竟然只差了 1。 

## 【2】拉格朗日插值法

上面我们用解方程的方法推出了数列的第 6 项，但要涉及高阶的行列式运算，不免有些麻烦，其实，还有一种更为直观的方法，叫做 **拉格朗日插值法**。

拉格朗日插值法的表达式是：
- 定义： ![l_{i}(x)={\prod_{j=1,j\ne i}^{n}}\frac{x-x_{j}}{x_{i}-x_{j}}](https://www.zhihu.com/equation?tex=l_%7Bi%7D%28x%29%3D%7B%5Cprod_%7Bj%3D1%2Cj%5Cne+i%7D%5E%7Bn%7D%7D%5Cfrac%7Bx-x_%7Bj%7D%7D%7Bx_%7Bi%7D-x_%7Bj%7D%7D)   ① 
- ![y=f(x)=\sum_{i=1}^{n}{f(x_{i})}l_{i}(x)=\sum_{i=1}^{n}f(x_{i}){\prod_{j=1,j\ne i}^{n}}\frac{x-x_{j}}{x_{i}-x_{j}}](https://www.zhihu.com/equation?tex=y%3Df%28x%29%3D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%7Bf%28x_%7Bi%7D%29%7Dl_%7Bi%7D%28x%29%3D%5Csum_%7Bi%3D1%7D%5E%7Bn%7Df%28x_%7Bi%7D%29%7B%5Cprod_%7Bj%3D1%2Cj%5Cne+i%7D%5E%7Bn%7D%7D%5Cfrac%7Bx-x_%7Bj%7D%7D%7Bx_%7Bi%7D-x_%7Bj%7D%7D)  ②

这么看公式可能不太直观。稍微解释一下：从式 ① 中我们可以发现，对于我们已经有对应值的  ![x_{j}](https://www.zhihu.com/equation?tex=x_%7Bj%7D) ，当* j = i* 时， ![l_{i}(x)=1](https://www.zhihu.com/equation?tex=l_%7Bi%7D%28x%29%3D1)；当* j ≠ i* 时， ![l_{i}(x)=0](https://www.zhihu.com/equation?tex=l_%7Bi%7D%28x%29%3D0) 。这个性质使得当 *i =* 1，2，……，n 时， ![y=f(x_{i})](https://www.zhihu.com/equation?tex=y%3Df%28x_%7Bi%7D%29) 都能成立，故式 ② 也成立。

现在我们已经知道了 ![f(1)=1;f(2)=2;f(3)=4;f(4)=8;f(5)=16 ](https://www.zhihu.com/equation?tex=f%281%29%3D1%3Bf%282%29%3D2%3Bf%283%29%3D4%3Bf%284%29%3D8%3Bf%285%29%3D16+)，带入式 ① 
- ![l_{1}(x)=\frac{(x-2)(x-3)(x-4)(x-5)}{(1-2)(1-3)(1-4)(1-5)}=\frac{1}{24}(x-2)(x-3)(x-4)(x-5)](https://www.zhihu.com/equation?tex=l_%7B1%7D%28x%29%3D%5Cfrac%7B%28x-2%29%28x-3%29%28x-4%29%28x-5%29%7D%7B%281-2%29%281-3%29%281-4%29%281-5%29%7D%3D%5Cfrac%7B1%7D%7B24%7D%28x-2%29%28x-3%29%28x-4%29%28x-5%29)
- ![l_{2}(x)=\frac{(x-1)(x-3)(x-4)(x-5)}{(2-1)(2-3)(2-4)(2-5)}=-\frac{1}{6}(x-1)(x-3)(x-4)(x-5)](https://www.zhihu.com/equation?tex=l_%7B2%7D%28x%29%3D%5Cfrac%7B%28x-1%29%28x-3%29%28x-4%29%28x-5%29%7D%7B%282-1%29%282-3%29%282-4%29%282-5%29%7D%3D-%5Cfrac%7B1%7D%7B6%7D%28x-1%29%28x-3%29%28x-4%29%28x-5%29)
- ![l_{3}(x)=\frac{(x-1)(x-2)(x-4)(x-5)}{(3-1)(3-2)(3-4)(3-5)}=\frac{1}{4}(x-1)(x-2)(x-4)(x-5)](https://www.zhihu.com/equation?tex=l_%7B3%7D%28x%29%3D%5Cfrac%7B%28x-1%29%28x-2%29%28x-4%29%28x-5%29%7D%7B%283-1%29%283-2%29%283-4%29%283-5%29%7D%3D%5Cfrac%7B1%7D%7B4%7D%28x-1%29%28x-2%29%28x-4%29%28x-5%29)
- ![l_{4}(x)=\frac{(x-1)(x-2)(x-3)(x-5)}{(4-1)(4-2)(4-3)(4-5)}=-\frac{1}{6}(x-1)(x-2)(x-3)(x-5)](https://www.zhihu.com/equation?tex=l_%7B4%7D%28x%29%3D%5Cfrac%7B%28x-1%29%28x-2%29%28x-3%29%28x-5%29%7D%7B%284-1%29%284-2%29%284-3%29%284-5%29%7D%3D-%5Cfrac%7B1%7D%7B6%7D%28x-1%29%28x-2%29%28x-3%29%28x-5%29)
- ![l_{5}(x)=\frac{(x-1)(x-2)(x-3)(x-4)}{(5-1)(5-2)(5-3)(5-4)}=\frac{1}{24}(x-1)(x-2)(x-3)(x-4)](https://www.zhihu.com/equation?tex=l_%7B5%7D%28x%29%3D%5Cfrac%7B%28x-1%29%28x-2%29%28x-3%29%28x-4%29%7D%7B%285-1%29%285-2%29%285-3%29%285-4%29%7D%3D%5Cfrac%7B1%7D%7B24%7D%28x-1%29%28x-2%29%28x-3%29%28x-4%29)

再带入式 ②， ![y=f(x)=\sum_{i=1}^{5}{f(x_{i})}l_{i}(x)=\frac{1}{24}(n^{4}-6n^{3}+23n^{2}-18n+24)](https://www.zhihu.com/equation?tex=y%3Df%28x%29%3D%5Csum_%7Bi%3D1%7D%5E%7B5%7D%7Bf%28x_%7Bi%7D%29%7Dl_%7Bi%7D%28x%29%3D%5Cfrac%7B1%7D%7B24%7D%28n%5E%7B4%7D-6n%5E%7B3%7D%2B23n%5E%7B2%7D-18n%2B24%29)

这样我们同样得到了数列的通项公式，而且**实际上我们可以不用合并同类项，从而规避复杂的行列式计算，使结果更加直观。**

拉格朗日插值法告诉我们一个道理：如果我们设定 n=6，无论 f(6) 等于多少，我们都可以迅速得到通项公式（最高为 5 次），所以，**理论上来说，如果不限定多项式的最高次幂，数列的第 6 项可以是任何数！不过，如果限定多项式的最高为 4 次，那么数列的第 6 项则是确定的，那就是 31。**

## 【3】数列在几何中的现实意义

看到这里，你也许会有疑问：文章极力说明数列 1,2,4,8,16,…… 的第 6 项其实可以是 31， 但文章也提到，如果不限定多项式的幂，数列的第 6 项可以是任何数，那么，第 6 项是 31 的现实意义是什么呢？

有意义的。因为昨天我收到了这样一封私信：
![](https://pic4.zhimg.com/v2-027562f291a3f7930500ce8ffded5fab_b.jpg)
问题很简单：**圆上的 n 个点两两相连，最多可以把圆分成几个部分？**

显然 *n* 为 1~5 的时候，答案分别是 1，2，4，8，16：
![](https://pic1.zhimg.com/v2-77d4285432bcf9433067de28d31fafe4_b.jpg)
看起来，n=6 的时候，应该是 32 个部分才对，但实际上并不是。

该怎么解这个问题呢？我的解法是这样的：
- 第一步：什么不连接的时候，圆有 1 个部分；
- 第二步：每连接一条线，圆至少能被多分成一个部分，由于有 n 个点，每个点能连 n-1 条线，于是共连上了 ![C_{n}^{2}=\frac{1}{2}n(n-1)](https://www.zhihu.com/equation?tex=C_%7Bn%7D%5E%7B2%7D%3D%5Cfrac%7B1%7D%7B2%7Dn%28n-1%29) 条线，于是圆能多出 ![C_{n}^{2}](https://www.zhihu.com/equation?tex=C_%7Bn%7D%5E%7B2%7D) 部分；
- 第三步：每次有连线和另一条线相交，圆就会多出 1 个部分，因为每两条线相交需要有 4 个点，所以理论上最多有 ![C_{n}^{4}=\frac{1}{24}n(n-1)(n-2)(n-3)](https://www.zhihu.com/equation?tex=C_%7Bn%7D%5E%7B4%7D%3D%5Cfrac%7B1%7D%7B24%7Dn%28n-1%29%28n-2%29%28n-3%29) 个交点。

综上，对于 n 个圆上的点，圆最多可以被分成的部分数为：

![f(n)=1+C_{n}^{2}+C_{n}^{4}=\frac{1}{24}(n^{4}-6n^{3}+23n^{2}-18n+24)](https://www.zhihu.com/equation?tex=f%28n%29%3D1%2BC_%7Bn%7D%5E%7B2%7D%2BC_%7Bn%7D%5E%7B4%7D%3D%5Cfrac%7B1%7D%7B24%7D%28n%5E%7B4%7D-6n%5E%7B3%7D%2B23n%5E%7B2%7D-18n%2B24%29)

这个答案的表达式非常简洁，并且和之前那个数列的通项公式一模一样！ 所以，n=6 时，答案显然就是 31 了。

这是巧合吗？**不，当多项式的前 5 项是 1，2，4，8，16 并且最高次数为 4 时，这个结果已经被注定啦！ **[注3]

————————————

注释：

[1] 这两道数列题的答案分别是 52 和 06；第一道：将数列每一项的数字逆序写，是完全平方数；第二道：倒过来看这些数字，分别是 88~92。

[2]  平面上的 n 个点可以用一个 n-1 次函数准确地拟合出来的充要条件是：它的系数矩阵是满秩的。

[3] 这个数列被 OEIS 收录，参见：[A000127 - OEIS](https://link.zhihu.com/?target=http%3A//oeis.org/A000127)。
![](https://pic4.zhimg.com/v2-41b4c0baccf10df1562ee96b24ba093f_b.jpg)

