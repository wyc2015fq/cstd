# 点灯游戏：迟到8年的美丽，用数学绘制的“二维码”！ - 知乎
# 

![](https://pic1.zhimg.com/046ae76cb174a104f3fc64b286016818_b.jpg)
“[点灯游戏](https://link.zhihu.com/?target=http%3A//baike.baidu.com/view/768314.htm%3Ffr%3Daladdin)”是一个简单而又有趣的小游戏。它的基本规则如下：

有一行N行N列的灯，开始时全部是灭的，当你点击其中一盏灯时的它自身及它的上下左右的灯（若存在的话）状态全部改变，要求用尽可能少的步数，将全部的灯点亮。
![](https://pic2.zhimg.com/24cac53d38d895709112a5dc4838961d_b.jpg)
在8年前，还是个初三的孩子时，我曾经探索过这个问题。

（链接如下：[有关“十全十美”的研究](https://link.zhihu.com/?target=http%3A//tieba.baidu.com/p/122273131)，我的ID“仙灵魂”，当时还是吧主） 

当时用文曲星的 GVBASIC 计算到n=14，也得到一些漂亮的结果，但因为文曲星性能所限，没有继续算下去。 

8年之后，偶然的机会让我重新发现了这个被遗弃的问题，突然感到很怀旧。

于是用Java编程，重温了这个问题。 

———————— 

8年前，我曾做过**游戏技巧的总结**： 

（1）  显然，点灯游戏的解，和点下方格的**次序无关**，仅和点下方格的**位置有关**。 

（2）  在一个方格下累计点下两次，和没有点下过的效果是一样的。所以**最优解必然只是在某些格子下点下过一次**。 

（3）  **当第1行被点下的格子确定时，若存在方案，则方案唯一**。 

这是因为一个格子（坐标[a,b]）的灯是否点亮只和其初始状态以及以下五个点：

[a-1,b][a,b-1][a,b][a,b+1][a+1,b]是否被点下有关，其中只有[a+1,b]是位于第a+1行，其它均在第a行之前。 

举例说明：如下图所示
![](https://pic4.zhimg.com/7cf97c8f52bda111724534733964a13f_b.jpg)
5×5的方格，假设紫色格一开始是暗的，我的目标是把它点亮，而前两行点下的位置已经确定（如图中的1），那么由于紫色格的状态只与自身以及周围4个点被按下次数有关（**总和应是奇数**），而绿格和紫格累计被按下2次，所以在第3行，红色格必须被按下。

所以，当我固定了第一行的点灯位置（共![2^{n} ](https://www.zhihu.com/equation?tex=2%5E%7Bn%7D+)种状态，考虑对称性的话能去掉接近一半的状态），那么，剩下的步骤是确定的，点完第n行可以让第n-1行的灯全亮，所以，我可以确保除最后一行外，所有位置的灯都能点亮，而最后一行是否恰好都被点亮，则要看天意。但是在n较小的情况下，暴力求解并不麻烦。 

（4）  **如果初始亮灯位置是随机的话，就没有确定的解，甚至不一定有解**，只能按照上面（3）的方法逐个尝试。但是如果初始状态是全部灯暗，是可以通过穷举找到确定方案的。

**比如**，5×5共有4个解，如果考虑对称性和旋转性，此解是唯一的。

下面是5×5的方案，可以看到，它在斜对角线有一条对称轴：

![](https://pic4.zhimg.com/bc167296fca127489723427b4c6e9f2b_b.jpg) ———————— 

游戏的技巧大致就这些，但**游戏的内涵却远不止于此**。 

这个问题其实并不容易。即使用计算机算，考虑到之前所说的技巧，只需要确定第一行点下的灯，在目前的算法下，复杂度达到了![O(2^{n} n^{2} )](https://www.zhihu.com/equation?tex=O%282%5E%7Bn%7D+n%5E%7B2%7D+%29)，随着n的增大，复杂度指数增长，所以能算得的n也并不是太大，当n达到30的时候，一次全遍历的计算就要花上大约3个小时。 

/** ( 当然本人的算法是野路子，还有很大改进空间，复杂度应该可以大幅降低，比如把n从指数上拉下来。这里还请各位数学大神和ACM大神多多指教**）**/

/**（P.S.目前已知可以用n×n矩阵的[高斯消元法](https://link.zhihu.com/?target=http%3A//baike.baidu.com/view/33268.htm%3Ffr%3Daladdin)把算法的复杂度降低到![O\left( n^{6}  \right) ](https://www.zhihu.com/equation?tex=O%5Cleft%28+n%5E%7B6%7D++%5Cright%29+)，我猜如果结合Coppersmith-Winograd方法 (参见[Strassen算法](https://link.zhihu.com/?target=http%3A//zh.wikipedia.org/wiki/Strassen%25E6%25BC%2594%25E7%25AE%2597%25E6%25B3%2595))可以进一步降低复杂度到![O\left( n^{4.7454}  \right) ](https://www.zhihu.com/equation?tex=O%5Cleft%28+n%5E%7B4.7454%7D++%5Cright%29+)，不过这是**同余方程**，鄙人尚在学习该怎么写这个算法）* */

于是得到了n=1-30的解：
![](https://pic3.zhimg.com/3119e515812a4acec70ea3ccff0ff916_b.jpg)
这张表格里有很多耐人寻味的规律：

**1、****是否对于每个n，都存在解？**

**2、****若都存在解，是否解的个数（蓝色数字）必是4的整数次幂？**

**3、****对于每个n，它的每个解的步数是否总是和n同奇同偶？**

这些规律或许已经有证明，或许还没有，或者存在反例，但是**发现规律本身就足够令人兴奋了**。 

————————

如果仅仅是那些数据，也许还看不到它的美妙，那就上图吧，看看玩n×n的“点灯游戏”，到底需要点击哪些位置的点。
![](https://pic4.zhimg.com/e9167fd7e1454cb475b7598c54088857_b.jpg)![](https://pic2.zhimg.com/bf85a9a780a706ed8d54e85ab77ec855_b.jpg)![](https://pic1.zhimg.com/1ff9244bf6458219166f3b162029af7c_b.jpg)![](https://pic1.zhimg.com/aaa451c6244e31446de0e647688e0350_b.jpg)
**（8年前，我在这里止步，只能看到这些美丽）**

**————沧海桑田的8年————**

**（8年后，那时看不到的美丽，在Java中展现无遗）**
![](https://pic3.zhimg.com/a94f14142aa41915fb876f24bb4920ce_b.jpg)![](https://pic2.zhimg.com/80c8652f6be10d9185be0c83a1d0f2e9_b.jpg)![](https://pic1.zhimg.com/d508e7d38b4d6860a2101a09da45da30_b.jpg)![](https://pic4.zhimg.com/b7d492e2c97cdcbf94f3a41ad481c297_b.jpg)
**多么美妙的图形！！！**

等等！你确定这不是**二维码**？

**用数学绘制的“二维码”，竟然也如此美丽！**

———————— 

最后的话： 

如此简单而有意思的问题，如果说这个世界上从来没有人研究过，**那你一定是在逗我**。果然，还真有人研究过，最新的成果是2014年5月发布的，比我可是晚了八年啊！

参见 [Lights Out Puzzle -- from Wolfram MathWorld](https://link.zhihu.com/?target=http%3A//mathworld.wolfram.com/LightsOutPuzzle.html)

这里的很多结果，都计算到 n=80，个别甚至到了n=120……神奇的算法。

**可是，又有多少人，能探究数学的路上驻足，静静地绘制和欣赏她的美丽呢？ **

（笑）

————————

 2006年8月10日第一稿

2006年9月9日第一次修改

2006年10月3日第二次修改

2006年12月1日第三次修改

**2014年8月9日第四次修改**

————————

注：

1） 本文由回答：[Flip Game（又名翻转游戏、点灯游戏、灭灯游戏）的游戏技巧是什么？](http://www.zhihu.com/question/22716573/answer/28973033)所引申。

2） 题注 所述歌曲地址：[爱不醒就是真的_塔斯肯、李敏](https://link.zhihu.com/?target=http%3A//music.baidu.com/song/98800071)

