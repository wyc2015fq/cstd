# 10035 赌徒的长征(2)——递推法的困境 - 知乎
# 

　　既然无法用简单的几句话证明阿聪策略的期望收益为0，那么我们就来算一算，这个策略的期望收益到底是多少。计算这种问题常用递推法。为了说明递推法的原理，我们拿胆小的赌徒小白作为例子：

> **小白策略：**初始赌本为1块钱；赌注也是1块钱，且始终不变。如果赢到5块钱，那就见好就收；如果输光了，那也没办法了。
　　在任一时刻，小白手里的钱数只能是0、1、2、3、4、5这几个数字之一，那么我们就把这个钱数作为状态。用![f(m)](https://www.zhihu.com/equation?tex=f%28m%29)表示从赌本为![m](https://www.zhihu.com/equation?tex=m)块钱的状态出发，到游戏结束时赌本的期望。显然![f(0) = 0](https://www.zhihu.com/equation?tex=f%280%29+%3D+0)，![f(5) = 5](https://www.zhihu.com/equation?tex=f%285%29+%3D+5)，因为![m](https://www.zhihu.com/equation?tex=m)等于0或5时游戏就已经结束了，![m](https://www.zhihu.com/equation?tex=m)就是最后的赌本。而对于![1 \le m \le 4](https://www.zhihu.com/equation?tex=1+%5Cle+m+%5Cle+4)，由于下一局有一半的可能性赢（赌本变成![m+1](https://www.zhihu.com/equation?tex=m%2B1)），有一半的可能性输（赌本变成![m-1](https://www.zhihu.com/equation?tex=m-1)），所以有递推式：

> ★　![f(m) = \frac{1}{2} f(m+1) + \frac{1}{2} f(m-1) \quad (1 \le m \le 4)](https://www.zhihu.com/equation?tex=f%28m%29+%3D+%5Cfrac%7B1%7D%7B2%7D+f%28m%2B1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+f%28m-1%29+%5Cquad+%281+%5Cle+m+%5Cle+4%29)

根据这个递推式和边界条件![f(0) = 0](https://www.zhihu.com/equation?tex=f%280%29+%3D+0)，![f(5) = 5](https://www.zhihu.com/equation?tex=f%285%29+%3D+5)，容易算出![f(m) = m](https://www.zhihu.com/equation?tex=f%28m%29+%3D+m)，也就是说，无论初始赌本是多少，赌到最后，期望都是不赔不赚的。

　　上面设了一个函数![f(m)](https://www.zhihu.com/equation?tex=f%28m%29)，表示最终赌本的期望，而![f(m) - m](https://www.zhihu.com/equation?tex=f%28m%29+-+m)才是期望收益。其实完全可以直接设![g(m) = f(m) - m](https://www.zhihu.com/equation?tex=g%28m%29+%3D+f%28m%29+-+m)，递推式仍然是

> ★　![g(m) = \frac{1}{2} g(m+1) + \frac{1}{2} g(m-1) \quad (1 \le m \le 4)](https://www.zhihu.com/equation?tex=g%28m%29+%3D+%5Cfrac%7B1%7D%7B2%7D+g%28m%2B1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+g%28m-1%29+%5Cquad+%281+%5Cle+m+%5Cle+4%29)

而边界条件变成了![g(0) = g(5) = 0](https://www.zhihu.com/equation?tex=g%280%29+%3D+g%285%29+%3D+0)。容易解得![g(m) = 0](https://www.zhihu.com/equation?tex=g%28m%29+%3D+0)，这也说明期望收益为0。

　　这种递推法，还可以用来求从赌本为![m](https://www.zhihu.com/equation?tex=m)块钱的状态出发，最终输光的概率![p(m)](https://www.zhihu.com/equation?tex=p%28m%29)。递推式仍然不变：

> ★　![p(m) = \frac{1}{2} p(m+1) + \frac{1}{2} p(m-1) \quad (1 \le m \le 4)](https://www.zhihu.com/equation?tex=p%28m%29+%3D+%5Cfrac%7B1%7D%7B2%7D+p%28m%2B1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+p%28m-1%29+%5Cquad+%281+%5Cle+m+%5Cle+4%29)

边界条件是![p(0) = 1](https://www.zhihu.com/equation?tex=p%280%29+%3D+1)，![p(5) = 0](https://www.zhihu.com/equation?tex=p%285%29+%3D+0)。容易解得![p(m) = 1 - m/5](https://www.zhihu.com/equation?tex=p%28m%29+%3D+1+-+m%2F5)，所以从手中有1块钱的状态出发，会有4/5的概率输光。

　　同样的递推法还可以用来求从赌本为![m](https://www.zhihu.com/equation?tex=m)块钱的状态出发，到游戏结束为止，要赌的局数的期望![T(m)](https://www.zhihu.com/equation?tex=T%28m%29)。这次的递推式变成了：

> ★　![T(m) = 1 + \frac{1}{2} T(m+1) + \frac{1}{2} T(m-1) \quad (1 \le m \le 4)](https://www.zhihu.com/equation?tex=T%28m%29+%3D+1+%2B+%5Cfrac%7B1%7D%7B2%7D+T%28m%2B1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+T%28m-1%29+%5Cquad+%281+%5Cle+m+%5Cle+4%29)

式中的1表示先赌一局，后两项表示的是这一局之后，期望还要赌多少局。边界条件为![T(0) = T(5) = 0](https://www.zhihu.com/equation?tex=T%280%29+%3D+T%285%29+%3D+0)，可以解得![T(1) = T(4) = 4](https://www.zhihu.com/equation?tex=T%281%29+%3D+T%284%29+%3D+4)，![T(2) = T(3) = 6](https://www.zhihu.com/equation?tex=T%282%29+%3D+T%283%29+%3D+6)。这说明，从赌本为1块钱的状态出发，平均要赌4局才能结束。

![](https://pic1.zhimg.com/00efd76c785593c29ccc7863b18e8588_b.jpg)　　现在我们来研究阿聪的策略。与小白策略不同的是，赌局在将来的发展情况，不仅取决于当前赌本![m](https://www.zhihu.com/equation?tex=m)，还取决于当前赌注![n](https://www.zhihu.com/equation?tex=n)，二者合在一起才构成状态。用![g(m,n)](https://www.zhihu.com/equation?tex=g%28m%2Cn%29)表示从赌本为![m](https://www.zhihu.com/equation?tex=m)、赌注为![n](https://www.zhihu.com/equation?tex=n)的状态出发，到游戏结束为止的期望收益，则我们想求的是![g(2,1)](https://www.zhihu.com/equation?tex=g%282%2C1%29)。显然，![m \le 0](https://www.zhihu.com/equation?tex=m+%5Cle+0)或![n=0](https://www.zhihu.com/equation?tex=n%3D0)代表游戏已经结束，这些时候的![g(m,n) = 0](https://www.zhihu.com/equation?tex=g%28m%2Cn%29+%3D+0)。对于其它状态，可以写出如下的递推式：

> ★　![g(m,n) = \frac{1}{2} g(m+n, n-1) + \frac{1}{2} g(m-n, n+1) \quad (m > 0, n > 0)](https://www.zhihu.com/equation?tex=g%28m%2Cn%29+%3D+%5Cfrac%7B1%7D%7B2%7D+g%28m%2Bn%2C+n-1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+g%28m-n%2C+n%2B1%29+%5Cquad+%28m+%3E+0%2C+n+%3E+0%29)

显然![g(m,n) \equiv 0](https://www.zhihu.com/equation?tex=g%28m%2Cn%29+%5Cequiv+0)是一个满足递推式的解。但它是唯一解吗？我们还是要递推一下来看看。
![](https://pic1.zhimg.com/8fecfa7769238b4e8ee2f66e910dfe88_b.jpg)
　　取![m=n=1](https://www.zhihu.com/equation?tex=m%3Dn%3D1)，可以确定![g(1,1) = 0](https://www.zhihu.com/equation?tex=g%281%2C1%29+%3D+0)。上图中的红线，连接了递推式涉及到的三个状态。

　　但不幸的是，从现在开始，无法再取得一对![(m,n)](https://www.zhihu.com/equation?tex=%28m%2Cn%29)，使得递推式中有两项已知、一项未知了。为了能够递推下去，必须设未知数。好吧，那就设我们要求的![g(2,1) = x](https://www.zhihu.com/equation?tex=g%282%2C1%29+%3D+x)。由此出发，可以依次求得![g(1,2)](https://www.zhihu.com/equation?tex=g%281%2C2%29)、![g(3,1)](https://www.zhihu.com/equation?tex=g%283%2C1%29)、![g(2,2)](https://www.zhihu.com/equation?tex=g%282%2C2%29)、![g(4,1)](https://www.zhihu.com/equation?tex=g%284%2C1%29)、![g(3,2)](https://www.zhihu.com/equation?tex=g%283%2C2%29)，每一步的依据，依次用红、橙、绿、蓝、紫线标了出来。

![](https://pic2.zhimg.com/847677bd1986c81feb758b0d6eb050e9_b.jpg)　　到这里又卡住了，只能继续设未知数。设![g(5,1) = y](https://www.zhihu.com/equation?tex=g%285%2C1%29+%3D+y)，由此可以求得![g(4,2)](https://www.zhihu.com/equation?tex=g%284%2C2%29)和![g(1,3)](https://www.zhihu.com/equation?tex=g%281%2C3%29)（红线、橙线）。此时，再利用![(m,n) = (3,2)](https://www.zhihu.com/equation?tex=%28m%2Cn%29+%3D+%283%2C2%29)时的递推式（绿线），就能把![y](https://www.zhihu.com/equation?tex=y)用![x](https://www.zhihu.com/equation?tex=x)表示出来（![y=32x](https://www.zhihu.com/equation?tex=y%3D32x)）：

![](https://pic1.zhimg.com/ff44e9ad85efa9594b59a4ac9a419444_b.jpg)　　用类似的方法，一直可以填到这么多：

![](https://pic4.zhimg.com/e851a496286fdf9e1f63f586f7c1db1b_b.jpg)但接下来又卡住了，因为橙线不能用了，蓝线也用不了：
![](https://pic3.zhimg.com/67d1557b80ebf3190b66721e6d5c4b2a_b.jpg)
　　至此，我们不仅没能解出![g(2,1)](https://www.zhihu.com/equation?tex=g%282%2C1%29)这个未知数，反而又引入了一个新的未知数![g(8,1)](https://www.zhihu.com/equation?tex=g%288%2C1%29)。事实上，所有形如![g(2k^2,1)](https://www.zhihu.com/equation?tex=g%282k%5E2%2C1%29)（![k](https://www.zhihu.com/equation?tex=k)为整数）的项都会引入新的未知数，未知数会越来越多。

![](https://pic1.zhimg.com/00efd76c785593c29ccc7863b18e8588_b.jpg)
　　阿聪的策略毕竟比较复杂，赌本、赌注都在变化。但其实，有一些比阿聪策略更简单的策略，用递推法一样会遇到困难。比如赌徒大白的策略：

> **大白策略：**初始赌本为1块钱；赌注也是1块钱，且始终不变。如果出现**三连胜**，那就见好就收；如果输光了，那也没办法了。

　　与小白策略不同，大白一定要赌到三连胜，这使得赌局可能无限进行下去：赢、赢、输，赢、赢、输，赢、赢、输，一直不出现三连胜，但赌本却每三局涨1块钱。下面我们会看到，在这种存在“无限”的情况下，递推法又一次会失效。

　　大白策略中，赌注始终为1，所以不必包含在状态里。但是，状态需要记录到目前为止已经取得了几连胜。用![g(m,n)](https://www.zhihu.com/equation?tex=g%28m%2Cn%29)表示从赌本为![m](https://www.zhihu.com/equation?tex=m)、已经取得![n](https://www.zhihu.com/equation?tex=n)连胜的状态出发，到游戏结束为止的期望收益，则我们要求![g(1,0)](https://www.zhihu.com/equation?tex=g%281%2C0%29)。递推式为：

> ★　![g(m,n) = \frac{1}{2} g(m+1, n+1) + \frac{1}{2} g(m-1, 0) \quad (m > 0, 0 \le n \le 2)](https://www.zhihu.com/equation?tex=g%28m%2Cn%29+%3D+%5Cfrac%7B1%7D%7B2%7D+g%28m%2B1%2C+n%2B1%29+%2B+%5Cfrac%7B1%7D%7B2%7D+g%28m-1%2C+0%29+%5Cquad+%28m+%3E+0%2C+0+%5Cle+n+%5Cle+2%29)
边界条件为![g(m,n) = 0 \quad (m = 0 \text{ or } n = 3)](https://www.zhihu.com/equation?tex=g%28m%2Cn%29+%3D+0+%5Cquad+%28m+%3D+0+%5Ctext%7B+or+%7D+n+%3D+3%29)。递推过程如下，关系线使用的顺序为红、绿、蓝，红、绿、蓝……：
![](https://pic1.zhimg.com/7d05b280a837379f955b2a407ed1a4b4_b.jpg)这样递推下去，虽然不会引入新的未知数，但![x](https://www.zhihu.com/equation?tex=x)本身是解不出来的。
![](https://pic1.zhimg.com/00efd76c785593c29ccc7863b18e8588_b.jpg)
　　大白策略的递推法其实只差一个条件，就能解出未知数![x](https://www.zhihu.com/equation?tex=x)。[@Jack Diamond](https://www.zhihu.com/people/ce43350682495256bf0220e728ab0f2e)找到了这个条件。他发现，如果大白拿着2块钱入场，其实可以看作先拿1块钱入场，如果三连胜则结束，如果输光了，则再拿剩下的1块钱入场。这样，初始赌本为2时的期望收益，就可以分成两部分：一部分是初始赌本为1时的期望收益；另一部分还是初始赌本为1时的期望收益，不过只在第1块钱输光的情况下才取得。用![P](https://www.zhihu.com/equation?tex=P)表示初始赌本为1时输光的概率，则上面的结论可以写成：

> ★　![g(2,0) = g(1,0) + P \cdot g(1,0)](https://www.zhihu.com/equation?tex=g%282%2C0%29+%3D+g%281%2C0%29+%2B+P+%5Ccdot+g%281%2C0%29)

而之前，我们设了![g(1,0) = x](https://www.zhihu.com/equation?tex=g%281%2C0%29+%3D+x)，并已经用递推法求得![g(2,0) = 6x](https://www.zhihu.com/equation?tex=g%282%2C0%29+%3D+6x)，故有

> ★　![6x = x + Px](https://www.zhihu.com/equation?tex=6x+%3D+x+%2B+Px)

因为![0 < P < 1](https://www.zhihu.com/equation?tex=0+%3C+P+%3C+1)，上式若把![x](https://www.zhihu.com/equation?tex=x)约掉，则不可能成立，所以必有![x=0](https://www.zhihu.com/equation?tex=x%3D0)。

　　事实上，![P](https://www.zhihu.com/equation?tex=P)本身也能够求出来。用递推法，可以得到2块钱入场输光的概率为![6P-4](https://www.zhihu.com/equation?tex=6P-4)：

![](https://pic4.zhimg.com/72aafc13a2b10a82f8758c3d537a29fb_b.jpg)而还有一个条件可以发掘出来：2块钱入场输光只有一种可能，即第1块钱输光，第2块钱也输光，故有![6P-4 = P^2](https://www.zhihu.com/equation?tex=6P-4+%3D+P%5E2)。由此可解得![P = 3 - \sqrt{5}](https://www.zhihu.com/equation?tex=P+%3D+3+-+%5Csqrt%7B5%7D)。

　　通过发掘隐藏条件，我们用递推法证明了大白策略的期望收益为0。不过阿聪策略到底还是比大白策略复杂得多，未知数都有无穷多个，要找到无穷多个隐藏条件，谈何容易！必须另辟蹊径。

