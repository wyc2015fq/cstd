# 贝叶斯推断 3. 离散随机变量的先验和建模 - 浅梦的博客 - CSDN博客





2017年08月21日 15:30:53[浅梦s](https://me.csdn.net/u012151283)阅读数：416








# Beta分布

> 
贝塔分布（Beta Distribution) 是一个作为伯努利分布和二项式分布的共轭先验分布的密度函数，在机器学习和数理统计学中有重要应用。 

  贝塔分布中的参数可以理解为伪计数，伯努利分布的似然函数可以表示为，表示一次事件发生的概率，它为贝塔有相同的形式，因此可以用贝塔分布作为其先验分布。—–百度百科 

  概率密度函数$0<x<1$
$f(x;\alpha,\beta)=\frac{x^{\alpha-1}(1-x)^{\beta-1}}{\int_0^1{u^{\alpha-1}(1-u)^{\beta-1}du}}=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1-x)^{\beta-1}=\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}$

  这里，$B(\alpha,\beta)=\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}$是一个归一化常数，确保总概率是1。 
$\Gamma(n+1)=n!$
# 推导先验参数为均匀分布的二项分布的后验分布

参数为$\theta$的n次独立重复的似然函数为$f(y|\theta)=\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}$， 

参数$\theta$的先验分布为0-1均匀分布，当$\theta$取值为0，1之间时，其概率密度函数始终为常数1,$f(\theta)=1$。 

现在来看后验分布， 
$f(\theta|y)=\frac{f(y|\theta)f(\theta)}{\int{f(y|\theta)f(\theta)d\theta}}=\frac{\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}}{\int_0^1{\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}d\theta}}$

还记得上面说的Beta分布的概率密度函数吗，我们现在对分母进行等价变换，凑出一个Beta分布的概率密度函数的形式， 
$f(\theta|y)=\frac{\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}}{B(\sum{y_i}+1,n-\sum{y_i}+1)\int_0^1{\frac{1}{B(\sum{y_i}+1,n-\sum{y_i}+1)}\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}d\theta}}$分母中右侧一项为一个Beta分布的概率密度函数在0,1区间上的积分，可以直接得出其结果为1。上式化简为$f(\theta|y)=\frac{\theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}}}{B(\sum{y_i}+1,n-\sum{y_i}+1)}$，这说明后验分布的是Beta分布， 

得出$\theta|y \sim Beta(\sum{y_i}+1,n-\sum{y_i}+1))$
# 共轭先验

在贝叶斯框架下，如果后验概率分布$P(\theta|x)$和先验概率$P(\theta)$满足相同形式的分布律。则先验分布和后验分布为**共轭分布**,先验分布叫做似然函数的**共轭先验分布**。 

现在看下参数先验为Beta分布的伯努利分布的后验分布 
$f(\theta)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1-x)^{\beta-1}$
$f(\theta|y) \propto f(y|\theta)f(\theta)= \theta^{\sum{y_i}}(1-\theta)^{n-\sum{y_i}} \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\theta^{\alpha-1}(1-\theta)^{\beta-1}\propto \theta^{\alpha+\sum{y_i}-1}(1-\theta)^{\beta+n-\sum{y_i}-1}$

即 
$\theta|y \sim Beta(a+\sum{y_i},\beta+n-\sum{y_i})$

可以看到，对于伯努利分布（二项分布）来说，当参数的先验分布为Beta分布时，其后验分布也是Beta分布。我们说二项分布的共轭先验是Beta分布。 

特别地，当Beta分布为Beta(1,1)时，退化为0-1区间上的均匀分布。
# 后验均值和有效样本数

对于先验分布Beta(a,b)，有效样本量为a+b，$\theta$的期望为$\frac{\alpha}{\alpha+\beta}$，$\theta$后验的期望为$\frac{a+\sum{y_i}}{a+\sum{y_i}+\beta+n-\sum{y_i}}=\frac{\alpha+\sum{y_i}}{\alpha+\beta+n}=\frac{\alpha+\beta}{\alpha+\beta+n}\times\frac{\alpha}{\alpha+\beta}+\frac{n}{\alpha+\beta+n}\times\frac{\sum{y_i}}{n}$

解释为posterior mean = prior_weight * prior_mean + data_weight*data_mean 

这可告诉我们多大的选取样本n可以让后验的权重更大一些。
# 泊松分布数据和Gamma分布

泊松分布 
$ P(X=k)=\frac{\lambda^k}{k!}e^{-\lambda},k=0,1,…$

Gamma分布 

假设随机变量X为等到第$\alpha$件事发生所需等待时间，那么X服从$\Gamma(a,\beta)$，概率密度函数为 
$f(x,\alpha,\beta)=\frac{\beta^\alpha}{\Gamma(\alpha)}x^{\alpha-1}e^{-\beta x},x>0$

参数$\alpha$称为形状(shape)参数，$\beta$为尺度(scale)参数。 
$E(X)=\frac{a}{\beta},Var(X)=\frac{a}{\beta^2}$

有效样本量$\beta$

下面推导参数先验为Gamma分布的泊松分布的后验分布， 
$f(\lambda|y)\propto f(y|\lambda)f(\lambda)\propto\lambda^{\sum{y_i}}e^{-n\lambda}\lambda^{a-1}e^{-\beta\lambda}\propto\lambda^{a+\sum{y_i}-1}e^{-(\beta+n)\lambda}$

说明后验概率是$\Gamma(a+\sum{y_i},\beta+n)$

后验均值 
$\frac{a+\sum{y_i}}{\beta+n}=\frac{\beta}{\beta+n}\times\frac{a}{\beta}+\frac{n}{n+\beta}\times\frac{\sum{y_i}}{n}$
# 逆Gamma分布

如果随机变量$X\sim Gamma(a,\beta)$，则$\frac{1}{X}\sim Inv-Gamma(a,\beta)$
$IG(a,\beta)$，概率密度函数为 
$f(x,\alpha,\beta)=\frac{\beta^\alpha}{\Gamma(\alpha)}x^{-\alpha-1}e^{\frac{-\beta}{x}},x>0$









