# 矩阵求导简要笔记 - 浅梦的博客 - CSDN博客





2017年05月01日 15:01:10[浅梦s](https://me.csdn.net/u012151283)阅读数：3209








# 导数与微分的关系
- 一元微积分中导数与微分的关系：$df = f'(x)dx$
- 多元微积分中梯度与微分的关系：$df=\sum_{i} \frac{\partial f}{\partial x_i}dx_i=\frac{\partial f^T}{\partial x}dx$

第一个等号是全微分公式，第二个等号是梯度与微分的关系
- 根据以上，建立矩阵导数与微分的联系 
$df =\sum_{i,j} \frac{\partial f}{\partial X_{i,j}}dX_{i,j}=tr(\frac{\partial f^T}{\partial X}dX)$

这里tr代表迹(trace)是方阵对角线元素之和，满足性质：对尺寸相同的矩阵A,B，$tr(A^TB)=\sum_{i,j}A_{i,j}B_{i,j}$，这用泛函分析的语言来说$tr(A^TB)$是矩阵A,B的内积，因此上式与原定义相容。
# 常用的矩阵微分运算法则

![这里写图片描述](https://img-blog.csdn.net/20170501144905635?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

# 矩阵求导

利用矩阵导数与微分的联系$df =tr(\frac{\partial f^T}{\partial X}dX)$，求出作则的微分$df$后，利用迹技巧(trace trick)转换成等号右侧的形式，从而得到对矩阵的导数。 

1. 标量的迹：$tr(a)=a$

2. 转置：$tr(A^T)=tr(A)$

3. 线性：$tr(AB)=tr(A)\pm tr(B)$

4. 矩阵乘法交换：$tr(AB)=tr(BA)=\sum_{i,j} A_{i,j}B_{i,j}$

5. 矩阵乘法/逐元素乘法交换：$tr(A^T(B\odot C))=tr((A \odot B)^T C)=\sum_{i,j}A_{i,j}B_{i,j}C_{i,j}$
# 总结

利用矩阵微分求解实值函数$f(X)$的梯度矩阵，分成两步进行。 

第一，求实值函数$f(X)$相对于变元矩阵$X$的矩阵微分$df(X)$，并将其表示成规范形式$df(X)=tr(AdX)$(通过迹技巧转换)。 

第二，根据梯度矩阵与Jacobian矩阵的关系 
$df(X)=tr(AdX) \Longleftrightarrow \bigtriangledown_xf(X)=A^T$

求得的$A^T$即为函数$f(X)$关于矩阵$X$的梯度矩阵。
# 矩阵乘法记法

![这里写图片描述](https://img-blog.csdn.net/20170829211125043?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

![这里写图片描述](https://img-blog.csdn.net/20171215145403360?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20171215145437583?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20171215145520001?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

参考资料

> 
[知乎《矩阵求导术》](https://zhuanlan.zhihu.com/p/24709748)

  《矩阵分析》 张贤达








