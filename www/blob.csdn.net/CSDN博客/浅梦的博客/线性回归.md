# 线性回归 - 浅梦的博客 - CSDN博客





2017年08月29日 22:04:35[浅梦s](https://me.csdn.net/u012151283)阅读数：151
个人分类：[机器学习																[线性模型](https://blog.csdn.net/u012151283/article/category/7194653)](https://blog.csdn.net/u012151283/article/category/6653295)








# 最小二乘法线性回归模型

## 模型

$y_i \approx w_0+\sum\limits_{j=1}^dx_{ij}w_j$

## 模型学习

平方误差损失 
$w_{LS}=\arg\min_w\sum\limits_{i=1}^n(y_i-f(x_i;w))=\arg\min_w L$

## 最小二乘法解（矩阵版本）



$\begin{align*}L&=\sum\limits_{i=1}^n(y_i-x_i^Tw)^2\\&=||y-Xw||^2\\&=(y-Xw)^T(y-Xw)\end{align*}$

对w求导 
$\nabla_wL=2X^TXw-2X^Ty=0\Rightarrow w_{LS}=(X^TX)^{-1}X^Ty $
## 潜在问题

计算$w_{LS}=(X^TX)^{-1}X^Ty$架设了$(X^TX)^{-1}$存在 

什么时候$(X^TX)^{-1}$不存在？ 

当$(X^TX)^{-1}$不是满纸矩阵的时候。 

什么时候$(X^TX)^{-1}$是满秩的？ 

当$n\times(d+1)$矩阵$X$有至少$d+1$线性无关的行时。这说明任意一个样本都能通过$X$中的$d+1$行的线性组合得到。 

显然，当$n<d+1$时，不能使用最小二乘法。如果$(X^TX)^{-1}$不存在，会存在无穷多解。 
**结论**：希望$n>>d$，（i.e. X 矩阵高且瘦）
# 几何解释

$y-Xw_{LS}$为一个正交于$\hat y$的误差向量。 

线性回归的任务就是在d+1维子空间上找到一个预测向量$\hat y$使得目标向量$y$和预测向量$\hat y$的差向量的模的平方最小。 

根据几何知识可知，当预测向量$\hat y$为原始向量$y$在子空间上的正交投影时，差向量的模最小。 
![这里写图片描述](https://img-blog.csdn.net/20170911134136050?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170911134330278?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
# 概率解释

假设线性回归的噪音$\epsilon_i=y_i-x_i^Tw$

互相独立且满足高斯分布 

也就是说 


$\begin{align*}1. y&=x_i^Tw+\epsilon_i,\\\epsilon_i&\sim(i.i.d)N(0,\sigma^2) i=1,...,n\\2. y_i&\sim(i.i.d)N(x_i^Tw,\sigma^2)i=1,...,n\\3. y&\sim N(Xw,\sigma I)\end{align*}$
![这里写图片描述](https://img-blog.csdn.net/20170829222724301?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170829215126542?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170829215936773?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170829220102479?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170829220308766?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjE1MTI4Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
# Ridge








