# 快速幂 - 紫芝的博客 - CSDN博客





2018年05月08日 21:34:17[紫芝](https://me.csdn.net/qq_40507857)阅读数：36










![](https://img-blog.csdn.net/20180508213055851)

## 计算(A^B)%c

```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
//计算(A^B)%c

ll quick_mod(ll a,ll b,ll c)
{
    ll ans=1;
    while(b){
        if(b&1)
            ans=(ans*a)%c;
        a=(a*a)%c;
        b>>=1;
    }
    return ans;
}

int main()
{
	ios::sync_with_stdio(false);
    ll a,b,c;
    while(cin>>a>>b>>c){
        cout<<quick_mod(a,b,c)<<endl;
    }
	return 0;
 }
```



### 利用快速乘法优化

```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
typedef unsigned long long ull;

//利用快速乘法优化
ull quick_mul(ull a,ull b,ull r)
{
    ull ans=0;
    while(b){
        if(b&1)
            ans=(ans+a)%r;
        a=(a+a)%r;
        b>>=1;
    }
    return ans;
}
ull quick_pow(ull a,ull b,ull r)
{
    ull ans=1;
    while(b){
        if(b&1)
            ans=quick_mul(ans,a,r);
            a=quick_mul(a,a,r);
            b>>=1;
    }
    return ans;
}

int main()
{
	ios::sync_with_stdio(false);
    ll a,b,r;
    while(cin>>a>>b>>r){
        //计算(a^b)%r
        cout<<quick_pow(a,b,r)<<endl;
    }
	return 0;
 }
```




