# 指数型母函数 - 紫芝的博客 - CSDN博客





2018年09月25日 10:54:29[紫芝](https://me.csdn.net/qq_40507857)阅读数：139








### 生成函数（母函数）有普通生成函数和指数生成函数：

1.普通生成函数用于解决多重集的组合问题

2.指数型母函数用于解决多重集的排列问题

***[普通型母函数](https://blog.csdn.net/qq_40507857/article/details/82824047)***

***[百度文库连接](https://wenku.baidu.com/view/c0f7ee05cc1755270722080d.html)***

### 问题：HDU1521

有n种物品，每种物品有ki件，从中选出m件的排列数

### 分析：

有n个元素，其中a1,a2,a3.....an互不相同，进行全排列，可得N！个不同的排列

若某一个元素ai重复了ni次，全排列出来必有重复元素，其中真正不同的全排列数为![\frac{n!}{ni!}](https://private.codecogs.com/gif.latex?%5Cfrac%7Bn%21%7D%7Bni%21%7D)  ,即其重复度为ni!

同理a1重复了n1次，a2重复了n2次......ak重复了nk次，n1+n2+n3.....+nk=n;

对于这样n个元素进行全排列，可得到不同排列的个数是  ![\frac{n!}{n1!*n2!*n3!.....nk!}](https://private.codecogs.com/gif.latex?%5Cfrac%7Bn%21%7D%7Bn1%21*n2%21*n3%21.....nk%21%7D)

若只对其中m个元素进行排列，就是指数型母函数

构造函数   ![G(x)=a0+\frac{a1}{1!}*x+\frac{a2}{2!}*x^{2}+\frac{a3}{3!}*x^{3}+\frac{a4}{4!}*x^{4}+\frac{a5}{5!}*x^{5}+.......+\frac{an}{n!}*x^{n}](https://private.codecogs.com/gif.latex?G%28x%29%3Da0&plus;%5Cfrac%7Ba1%7D%7B1%21%7D*x&plus;%5Cfrac%7Ba2%7D%7B2%21%7D*x%5E%7B2%7D&plus;%5Cfrac%7Ba3%7D%7B3%21%7D*x%5E%7B3%7D&plus;%5Cfrac%7Ba4%7D%7B4%21%7D*x%5E%7B4%7D&plus;%5Cfrac%7Ba5%7D%7B5%21%7D*x%5E%7B5%7D&plus;.......&plus;%5Cfrac%7Ban%7D%7Bn%21%7D*x%5E%7Bn%7D)

称G（X)是数列a0,a1,a2,a3....an的指数型生成函数

![](http://aliyunzixunbucket.oss-cn-beijing.aliyuncs.com/csdn/ca061cda-ef57-4156-ab97-14ac0715cb6f)

以前讨论的母函数和指数母函数的差别，就在于前者直接用an作幂级数的系数，而后者则是用![指数型母函数：hdu 1521 排列组合](http://aliyunzixunbucket.oss-cn-beijing.aliyuncs.com/csdn/ac9f7b4f-f6ba-4caa-947d-77f2b19ff371)作为幂级数的系数，且真正有意义的就是an.

![指数型母函数：hdu 1521 排列组合](http://aliyunzixunbucket.oss-cn-beijing.aliyuncs.com/csdn/577b8a75-fd99-4d2b-b2e2-6e9a567b1102)

总的说来，指数型母函数可以说是普通母函数的衍生，要注意的是两者间的区别，一个是系数，另一个是指数的变化。

好了，有了一定的母函数基础，加上指数型母函数的知识，就可以求这道题了，注意要用到double数组啦，考虑浮点数精度误差等问题。

c++

```cpp
#include<iostream>
#include<cstdio>
#include<cstring>

using namespace std;

const int maxn=15;
double a[maxn],b[maxn];
int fact[maxn];
int num[maxn];
void init(){
    fact[0]=1;
    for(int i=1;i<maxn;i++)
        fact[i]=i*fact[i-1];
    memset(a,0,sizeof a);
    memset(b,0,sizeof b);
}
int main()
{
    int n,m;
    while(scanf("%d%d",&n,&m)!=EOF){
        init();
        for(int i=1;i<=n;i++)
            scanf("%d",&num[i]);

        for(int i=0;i<=num[1];i++)//第一项初始赋值
            a[i]=1.0/fact[i];
            
        for(int i=2;i<=n;i++){//循环第2到第n项
            for(int j=0;j<=m;j++)
                for(int k=0;k<=num[i]&&k+j<=m;k++)
                b[k+j]+=a[j]/fact[k];

            for(int j=0;j<=m;j++){
                a[j]=b[j];
                b[j]=0;
            }
        }
        printf("%.0f\n",a[m]*fact[m]);
    }
}
```

Java

```java
import java.util.*;
import java.math.*;

public class Main {
	static int maxn=15;
	static double[] a=new double[maxn];
	static double[] b=new double[maxn];
	static int[] num=new int[maxn];
	static int[] fact=new int[maxn];
	static void init() {
		for(int i=0;i<maxn;i++) {
			a[i]=0.0;
			b[i]=0.0;
			num[i]=0;
		}
		fact[0]=1;
		for(int i=1;i<maxn;i++)
			fact[i]=fact[i-1]*i;
	}
	public static void main(String[] args) {
		Scanner cin=new Scanner(System.in);
		
		while(cin.hasNext()) {
			init();
			int n=cin.nextInt();
			int m=cin.nextInt();
			/*
			for(int i=0;i<maxn;i++)
				System.out.println(fact[i]);
			*/
			for(int i=1;i<=n;i++)
				num[i]=cin.nextInt();
			
			for(int i=0;i<=num[1];i++)
				a[i]=(1.0/fact[i]);
			
			for(int i=2;i<=n;i++) {
				for(int j=0;j<=m;j++)
					for(int k=0;k<=num[i]&&j+k<=m;k++)
						b[j+k]+=(a[j]/fact[k]);
				
				for(int j=0;j<=m;j++) {
					a[j]=b[j];
					b[j]=0.0;
				}
			}
			int ans=(int)(a[m]*fact[m]+0.5);
			System.out.println(ans);
		}
		cin.close();
	}
}
```





