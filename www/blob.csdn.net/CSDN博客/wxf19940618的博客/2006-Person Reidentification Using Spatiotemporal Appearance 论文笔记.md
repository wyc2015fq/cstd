# 2006-Person Reidentification Using Spatiotemporal Appearance 论文笔记 - wxf19940618的博客 - CSDN博客





2019年01月04日 15:03:41[rxdffz](https://me.csdn.net/wxf19940618)阅读数：39








2006-Person Reidentification Using Spatiotemporal Appearance 论文笔记

一、提出问题
- 需要建立对应关系，即确定应该将一个图像的哪些部分与第二个图像中的哪些部分进行比较；
- 需要生成对照明，姿势和服装的动态外观变化不变的表征。

二、论文贡献
- 提出用时空分割算法来生成对服装外观变化具有鲁棒性的显著边缘。通过组合标准化颜色和显著边缘直方图来生成不变表征。
- 提出了两种方法来生成对应关系：（i）基于模型的方法，该方法适合于个体建立对应图的关节模型，（ii）提出兴趣点算子，利用区域生长策略生成大量潜在的对应关系。

三、整体方案

本文提出了两种行人人重识别方法，分别使用兴趣算子和模型拟合来建立两个个体之间的空间对应关系。另外，本文还提出了一种新颖的时空分割算法，以空间和时间为线索生成行人的服装的不变特征。

1、基于模型的算法：需要建立从一个人到另一个人的映射。本文中使用可分解的三角图来模拟人的关节形状，动态编程算法用于使模型符合人的形象，模型拟合定位不同的身体部位，如手臂，躯干，腿部和头部，从而便于比较相应身体部位之间的外观和结构。

2、兴趣算子方法：由于人的外表的动态性，许多兴趣点算子的反应不会持续很长一段时间。为了解决这个问题，本文的策略是选择在具有高信息含量的区域中生成大量响应的运算符，从而增加在同一个体的图像之间建立真实对应的概率，在本文中应用的是Hessian仿射不变算子。特征匹配用于建立两组兴趣点之间的对应关系，基于最终一组对应关系的基数来计算匹配分数。

3、构建不变特征的方法：通过颜色和结构的组合信息来生成用于比较不同区域的不变特征。
- 基于色调和饱和度的直方图获取颜色信息
- 通过归一化实现了对环境照明差异的不变性
- 由于行人身上的衣服结构外观是高度动态的，为了解决传统边缘算子不能很好拟合衣服边缘的问题，本文提出将一种新的时空分割算法应用于图像，该算法生成显着的边缘信息
- 分水岭算法用于生成每个帧的过分割
- 将每个区域视为节点并将边缘放置在空间和时间上的相邻区域来生成时空图
- 使用将每个聚类建模为最小生成树的图分区算法生成对应于每种类型服装的显著边缘
- 区域特征用这些显著边缘的局部直方图获得。

3.1特征生成

局部区域i的特征向量表示为hi

1、局部特征的第一个分量是该区域的色调和饱和度的直方图。为了克服HSV直方图对室外场景中照明和阴影变化的敏感性，本文使用了对亮度和Gamma不变的色调定义：

![](https://img-blog.csdnimg.cn/20190104150033624.png)



2、局部特征的第二部分表示该区域的的结构特性，用在区域i的边缘的直方图表示。本文使用由新的时空分割算法生成的显著边缘，时空分割消除了时间上不稳定的边缘信息，仅考虑前景内部的边缘。每个边缘1对主要局部边界方向（垂直或水平）以及边缘1两侧的两个区域的RGB颜色分量之间的比率进行编码。 RGB颜色分量的比率每个被量化为4个可能的值，所以将产生7位的边缘表示。

       在匹配过程中，使用交叉直方图定义两个特征hi和hj之间的距离：

![](https://img-blog.csdnimg.cn/20190104150033628.png)



3.2 时空分割

本文提出以边缘的形式产生稳定的结构信息，用于定义区域特征。即使许多衣物来自具有均匀反射特性的材料，但是给定类型的材料在整个图像中和随着时间的推移可能看起来非常不同。这是因为松散贴合的衣服在铰接运动下的表面法线是高度动态的。本文提出的时空分割方法对属于相同类型结构的像素进行分组，显著边缘是位于两个分组之间边界上的像素。

由于织物有褶皱所以内部边界随时间变化是不稳定的，对于给定的时间窗，对每个图像执行过分割。这产生了一组连续区域![](https://img-blog.csdnimg.cn/20190104150033631.png)，其中![](https://img-blog.csdnimg.cn/20190104150033645.png)是图像t的第i个区域。图G = {V，E}由一组顶点![](https://img-blog.csdnimg.cn/20190104150033644.png)和边![](https://img-blog.csdnimg.cn/20190104150033644.png)定义，其中![](https://img-blog.csdnimg.cn/20190104150033652.png)对应于区域![](https://img-blog.csdnimg.cn/20190104150033653.png)，![](https://img-blog.csdnimg.cn/20190104150033653.png)是连接顶点![](https://img-blog.csdnimg.cn/20190104150033656.png)和![](https://img-blog.csdnimg.cn/20190104150033669.png)的边缘。通过将G划分为一组聚类来获得区域分组。

通过两个阶段获得定义V的过分割。首先，将Sobel算子应用于每个灰度图像的前景，然后进行高斯滤波。其次，应用分水岭分割算法，这产生图像前景的强度值均匀区域，这个方法适用于没有过度纹理化的衣物。

给定V可以定义边缘结构，构造了空间和时间两种类型的边缘。如果两个区域![](https://img-blog.csdnimg.cn/20190104150033665.png)和![](https://img-blog.csdnimg.cn/20190104150033666.png) 共享一个边界，形成了空间边缘![](https://img-blog.csdnimg.cn/20190104150033673.png)。对于每个区域![](https://img-blog.csdnimg.cn/20190104150033679.png)，确定区域![](https://img-blog.csdnimg.cn/20190104150033683.png)，使得![](https://img-blog.csdnimg.cn/20190104150033683.png)具有与![](https://img-blog.csdnimg.cn/20190104150033690.png)相对应的相同材料的最高概率，这建立了时间边缘![](https://img-blog.csdnimg.cn/20190104150033692.png)。 基于运动场估计确定![](https://img-blog.csdnimg.cn/20190104150033701.png)，频率图像![](https://img-blog.csdnimg.cn/20190104150033707.png)定义为：

![](https://img-blog.csdnimg.cn/20190104150033710.png)

其中It（x，y）是时间t和t处的像素（x，y）的强度值，H定义为：

![](https://img-blog.csdnimg.cn/20190104150033715.png)

对于阈值δ，对于具有均匀强度和均匀运动的给定区域，![](https://img-blog.csdnimg.cn/20190104150033726.png)的值将在对应于向前运动方向的区域侧更高。对于每个重叠区域![](https://img-blog.csdnimg.cn/20190104150033730.png)，计算在![](https://img-blog.csdnimg.cn/20190104150033729.png)和![](https://img-blog.csdnimg.cn/20190104150033728.png)的交叉点上![](https://img-blog.csdnimg.cn/20190104150033738.png)的积分。具有最高频率积分的重叠区域被选择用于时间边缘。有关频率图像的示例，请参见图3-1。

![](https://img-blog.csdnimg.cn/20190104150033795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)

图3-1 频率图像的示例

如果两个相邻区域对应于同一块织物，则它们将周期性具有相似的外观。这是因为织物内边界具有固有不稳定性，因此边缘权重![](https://img-blog.csdnimg.cn/20190104150033755.png)可定义为将两个区域组合在一起的成本：

![](https://img-blog.csdnimg.cn/20190104150033796.png)

其中![](https://img-blog.csdnimg.cn/20190104150033795.png)是区域![](https://img-blog.csdnimg.cn/20190104150033800.png)的中值强度值。时间边缘允许更大的外观变化，如果存在通过空间、时间或两者的组合连接它们的低成本路径，则应该对两个区域进行分组。因此，图分区算法基于搜索具有低成本时空最小生成树的聚类算法。





3.2.1 图分区

一旦生成了十个连续帧的时空图G，图分割算法用于对时空相似的区域进行分组。该分区算法的基本思想是在它们之间的距离小于每个单独簇的内部变化时合并连接的簇。为了有效地实现该方法，每个簇C由通过其所有顶点VC的最小生成树EC表示。最小生成树的最大边权重用于定义集群C的内部变化，即：

![](https://img-blog.csdnimg.cn/20190104150033801.png)

给定两个簇Cm和Cn，簇间距离D(Cm,Cn)被定义为它们之间的最低边缘权重，即：

![](https://img-blog.csdnimg.cn/20190104150033796.png)

如果与各个簇的内部变化相比，簇间距离较小，则合并两个簇。具体而言，如果将群集Cm和Cn合并

![](https://img-blog.csdnimg.cn/20190104150033802.png)

![](https://img-blog.csdnimg.cn/20190104150033802.png)

因子κ/ | C | 基于群集的大小，并推动形成更大的群集。否则在合并过程开始时，非常小的簇的内部变化往往太小，导致合并过程过早停止。

可利用一种贪婪算法来获得满足上述条件的图分割。时空图中的所有边根据非减小边权重进行排序，然后按此顺序进行处理。让边缘![](https://img-blog.csdnimg.cn/20190104150033803.png)在两个独立的簇之间Cm和Cn是一个参考因素。如果，![](https://img-blog.csdnimg.cn/20190104150033818.png)![](https://img-blog.csdnimg.cn/20190104150033800.png)，则Cm和Cn合并，边缘![](https://img-blog.csdnimg.cn/20190104150033806.png)添加到组合群集的最小生成树中。重复此步骤，直到处理完所有边缘。 、由上述算法产生的分割是最优的，因为每个簇的最小生成树的最大边缘权重小于它们的每个相邻簇的所有边缘的权重。有关此算法应用的示例，请参见图3-1。

3.2.2 前景-背景分离

由于需要估计前景patch，本文发现一种合理的方法是先计算最大频率图像，定义如下：

![](https://img-blog.csdnimg.cn/20190104150033813.png)

该结果是在运动边界附近的低值，在阈值处理和形态滤波（填充中心）之后，实现了合理的前景/背景分割。



3.3 兴趣点匹配

给定一个人的图像，Hessian仿射不变兴趣算子用于挑选兴趣点。随着时间的的变化，Hessian算子会变得不稳定，但是它提供了大量的兴趣点，并且在颜色变化方面提供了更多信息，这增加了在同一个体的图像之间产生真实对应的概率。 对于每个兴趣点i，基于以位置i为中心的固定半径r的圆形支撑区域C（i，r）生成特征向量hi。为了限制前景分割误差的影响，不考虑包含大量背景的兴趣点。

当比较两个图像I和J时，挑选初始的一组对应关系。使用公式3评估潜在匹配（i→j）的优点，反向匹配用于确保对应关系的一致性。对于图像I中的每个兴趣点，在图像J中确定最可能的对应关系是![](https://img-blog.csdnimg.cn/20190104150033815.png)，如果i和![](https://img-blog.csdnimg.cn/20190104150033820.png)的特征之间的距离低于阈值，则确定图像I中最可能的兴趣点![](https://img-blog.csdnimg.cn/20190104150033827.png)对应点![](https://img-blog.csdnimg.cn/20190104150033830.png)。如果i和![](https://img-blog.csdnimg.cn/20190104150033850.png)之间的欧氏距离小于阈值，则接受对应关系（i→![](https://img-blog.csdnimg.cn/20190104150033835.png)）。

最后验证阶段用于完善初始对应关系。 用于对应兴趣点的区域在垂直方向上迭代扩展，再次为每个扩展区域构建区域特征，并用公式3进行比较。如果两个特征之间的距离低于固定阈值，则该对应关系被归于最终的对应集合。

图像I和J之间的匹配分数基于最终对应集的基数，这个匹配过程的两个例子如图3-2所示。

![](https://img-blog.csdnimg.cn/20190104150033916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)

图3-2 匹配过程实例



3.4 动态规划模型拟合

本文提出一种基于模型的方法，该方法产生不同身体部位（例如头部，手臂，腿部和躯干）之间的对应关系。由于个体的手臂，腿和躯干的相对位置因场景而异，所以本文提出在场景中使用基于模型的自顶向下分割，不同部分可以被准确地定位。该分割用于在两个场景中建立个体的不同身体部位之间的对应关系，这有助于比较这些身体部位的外观。

使用可分解的三角图作为模拟拟合人的新方法，有关示例请参见图3-3。已有研究证明可分解的三角图可以表示可变形的形状，存在所有顶点的消除顺序，使得每个被消除的顶点仅属于一个三角形，以及可分解的三角图是消除顶点的结果。由于这些图形支持完美的消除顺序，因此可以使用动态编程算法有效地完成模型优化。

使用能量最小化方法将可分解的三角图用于建模和分割场景中的行人。模型拟合算法的起点是感兴趣人的边界框。假设模型是具有n个三角形的可分解三角图T，Ti，i = 1，....，n。 可以寻找将模型映射到图像域的函数g，使模型与显着图像特征的一致性最大化，并且使底层模型的变形最小化。该函数g被限制为分段仿射映射，其中模型中每个三角形gi（Ti）的变形是仿射变换。 然后试图最小化的能量函数E（g，I）可以写成模型中每个三角形的一组成本的成本之和。

![](https://img-blog.csdnimg.cn/20190104150033858.png)

其中I表示底层图像。

至于如何制定模型中每个三角形的形状和数据成本，每个三角形的形状成本是根据其仿射变换的极分解来定义的，对于仿射矩阵A，极化分解定义为：

![](https://img-blog.csdnimg.cn/20190104150033858.png)

S是刻度剪切矩阵，R（ψ）是与A1最接近的旋转矩阵。极化分解可以从仿射变换的常用奇异值分解中导出。然后将形状定义为

![](https://img-blog.csdnimg.cn/20190104150033893.png)

其中λ1和λ2是尺度剪切矩阵的特征值。 第一项是对数各向异性项并且惩罚高宽比的变化，而第二项则惩罚剪切。

能量函数中的数据成本将模型趋紧于显着图像特征，可分解的三角图具有边界边和内边，并且数据成本仅针对边界边定义。所有内部边缘的数据成本为零，两组互补的图像特征用于定义数据成本：使用Canny算法检测图像中的突出边缘和使用时空分割获得的前景蒙版。模型拟合方法 丢失边缘的存在不敏感性，因此使用Canny边缘和时空前景掩模的组合来计算数据成本

在使用Canny算法提取边缘之后，应用欧几里德距离变换来获得边缘特征图像D-边缘成本测量边界三角形边缘与Canny边缘的距离。沿着采样的三角形边缘的平均边缘特征值L =（xi，yi），i = 1，....，n用作边缘成本，即

![](https://img-blog.csdnimg.cn/20190104150033889.png)

       前景成本测量模型与前景蒙板的一致性，并由边界三角形边缘两侧的窗口中的前景像素的相对数量来定义。

![](https://img-blog.csdnimg.cn/20190104150033884.png)

其中N f g1和N1是窗口一侧的前景像素数和总像素数。 N2f g和N2类似地定义为另一侧。

对于计算模型的最佳变形的动态编程算法，想要找到将模型的顶点映射到图像位置的g，使得等式13中的能量函数最小化。动态编程对候选位置进行穷举搜索以找到全局最优值。将模型顶点的候选位置限制为前景蒙版和Canny边缘的边界。由于此处使用的三角模型具有完美的消除阶数，并且等式13中定义的成本是可扩展的，因此可以使用串行动态编程算法进行优化。在算法的每次迭代中，完美消除顺序用于从模型中消除一个顶点，并且其最佳位置根据其两个相邻顶点进行编码。重复该过程直到消除所有顶点。模型中所有顶点的最终位置由标准回溯计算。图3-4显示了两个代表性案例的结果

完成模型拟合后，计算个体的外观和形状特征，使用拟合模型将个体划分为突出的身体部位，如图3-3所示。例如，考虑如何为上半身生成特征，使用对应于上躯干的所有三角形（图3-3中的红色），提取外观和形状特征。 类似地，计算所有显着身体部位的特征并使用公式3进行比较。

![](https://img-blog.csdnimg.cn/20190104150033905.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)

图3-3 模型拟合人体躯干

![](https://img-blog.csdnimg.cn/20190104150033965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)

图3-4 拟合模型法实例



四、实验结果

![](https://img-blog.csdnimg.cn/2019010415003410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)

![](https://img-blog.csdnimg.cn/20190104150033973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ZjE5OTQwNjE4,size_16,color_FFFFFF,t_70)



