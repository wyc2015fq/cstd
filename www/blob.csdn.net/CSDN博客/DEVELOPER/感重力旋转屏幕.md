# 感重力旋转屏幕 - DEVELOPER - CSDN博客





2014年09月12日 15:19:51[学术袁](https://me.csdn.net/u012827205)阅读数：1547标签：[感重力旋转屏幕																[感重力																[屏幕旋转](https://so.csdn.net/so/search/s.do?q=屏幕旋转&t=blog)
个人分类：[感重力旋转屏幕](https://blog.csdn.net/u012827205/article/category/2557353)





![](https://img-blog.csdn.net/20140912150806897?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvanVuaHVhaG91c2U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)![](https://img-blog.csdn.net/20140912151109480?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvanVuaHVhaG91c2U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[](http://download.csdn.net/detail/u012827205/7903503)

[*这个是效果图，点击这里下载源码；*](http://download.csdn.net/detail/u012827205/7903503)

实现该功能只需要实现三部曲：第一步重写Handler：

```java
public class ChangeOrientationHandler extends Handler {

	private Activity activity;

	public ChangeOrientationHandler(Activity ac) {
		super();
		activity = ac;
	}
	
	@Override
	public void handleMessage(Message msg) {  
		if (msg.what==888) {
			int orientation = msg.arg1;
			if (orientation>45&&orientation<135) {
				activity.setRequestedOrientation(8);
			}else if (orientation>135&&orientation<225){
				activity.setRequestedOrientation(9);
			}else if (orientation>225&&orientation<315){
				activity.setRequestedOrientation(0);
			}else if ((orientation>315&&orientation<360)||(orientation>0&&orientation<45)){
				activity.setRequestedOrientation(1);
			}
		}
		
		super.handleMessage(msg);        		
	}
	
}
```
第二步重写SensorEventListener：
```java
public class OrientationSensorListener implements SensorEventListener {
	 private static final int _DATA_X = 0;
     private static final int _DATA_Y = 1;
     private static final int _DATA_Z = 2;
     
     public static final int ORIENTATION_UNKNOWN = -1;
     
     private Handler rotateHandler;
     
     
     
	public OrientationSensorListener(Handler handler) {
		rotateHandler = handler;
	}

	public void onAccuracyChanged(Sensor arg0, int arg1) {
		// TODO Auto-generated method stub

	}

	public void onSensorChanged(SensorEvent event) {
		float[] values = event.values;
        int orientation = ORIENTATION_UNKNOWN;
        float X = -values[_DATA_X];
        float Y = -values[_DATA_Y];
        float Z = -values[_DATA_Z];        
        float magnitude = X*X + Y*Y;
        // Don't trust the angle if the magnitude is small compared to the y value
        if (magnitude * 4 >= Z*Z) {
            float OneEightyOverPi = 57.29577957855f;
            float angle = (float)Math.atan2(-Y, X) * OneEightyOverPi;
            orientation = 90 - (int)Math.round(angle);
            // normalize to 0 - 359 range
            while (orientation >= 360) {
                orientation -= 360;
            } 
            while (orientation < 0) {
                orientation += 360;
            }
        }
        
        if (rotateHandler!=null) {
			rotateHandler.obtainMessage(888, orientation, 0).sendToTarget();
		}

	}

}
```


第三步到MainActivity.java中配置：XXXXXX     ~~~~搞定！](https://so.csdn.net/so/search/s.do?q=感重力&t=blog)](https://so.csdn.net/so/search/s.do?q=感重力旋转屏幕&t=blog)




