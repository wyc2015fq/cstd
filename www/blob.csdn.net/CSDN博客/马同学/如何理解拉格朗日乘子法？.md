# 如何理解拉格朗日乘子法？ - 马同学 - CSDN博客
2018年08月01日 10:53:21[马同学高等数学](https://me.csdn.net/ccnt_2012)阅读数：1960
**1 与原点的最短距离**
假如有方程：
![x^2y=3](https://www.zhihu.com/equation?tex=x%5E2y%3D3)
图像是这个样子滴：
![](https://img-blog.csdn.net/20180801104757417?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
现在我们想求其上的点与原点的最短距离：
![](https://img-blog.csdn.net/20180801104757795?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
这里介绍一种解题思路。首先，与原点距离为![a](https://www.zhihu.com/equation?tex=a) 的点全部在半径为![a](https://www.zhihu.com/equation?tex=a) 的圆上：
![](https://img-blog.csdn.net/20180801104757887?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
那么，我们逐渐扩大圆的半径：
![](https://img-blog.csdn.net/20180801104757971?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
显然，第一次与![x^2y=3](https://www.zhihu.com/equation?tex=x%5E2y%3D3) 相交的点就是距离原点最近的点：
![](https://img-blog.csdn.net/20180801104757713?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
此时，圆和曲线相切，也就是在该点切线相同：
![](https://img-blog.csdn.net/20180801104757722?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
至此，我们分析出了：
![在极值点，圆与曲线相切](https://www.zhihu.com/equation?tex=%E5%9C%A8%E6%9E%81%E5%80%BC%E7%82%B9%EF%BC%8C%E5%9C%86%E4%B8%8E%E6%9B%B2%E7%BA%BF%E7%9B%B8%E5%88%87)
**2 等高线**
为了继续解题，需要引入等高线。这些同心圆：
![](https://img-blog.csdn.net/20180801104757893?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
可以看作函数![f(x,y)=x^2+y^2](https://www.zhihu.com/equation?tex=f(x%2Cy)%3Dx%5E2%2By%5E2) 的等高线：
![](https://img-blog.csdn.net/20180801104758537?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
根据梯度的性质（关于梯度可以查看[如何通俗地理解梯度？](https://www.matongxue.com/madocs/222.html)），梯度向量：
![\nabla f=\begin{pmatrix}\frac{\partial f}{\partial x}\\\frac{\partial f}{\partial y}\end{pmatrix}=\begin{pmatrix}2x\\2y\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cnabla%20f%3D%5Cbegin%7Bpmatrix%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5C%5C%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20y%7D%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D2x%5C%5C2y%5Cend%7Bpmatrix%7D)
是等高线的法线：
![](https://img-blog.csdn.net/20180801104758371?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
另外一个函数![g(x,y)=x^2y](https://www.zhihu.com/equation?tex=g(x%2Cy)%3Dx%5E2y) 的等高线为：
![](https://img-blog.csdn.net/20180801104758402?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
之前的曲线![x^2y=3](https://www.zhihu.com/equation?tex=x%5E2y%3D3) 就是其中值为3的等高线：
![](https://img-blog.csdn.net/20180801104758567?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
，因此，梯度向量：
![\nabla g=\begin{pmatrix}\frac{\partial g}{\partial x}\\\frac{\partial g}{\partial y}\end{pmatrix}=\begin{pmatrix}2xy\\x^2\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cnabla%20g%3D%5Cbegin%7Bpmatrix%7D%5Cfrac%7B%5Cpartial%20g%7D%7B%5Cpartial%20x%7D%5C%5C%5Cfrac%7B%5Cpartial%20g%7D%7B%5Cpartial%20y%7D%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D2xy%5C%5Cx%5E2%5Cend%7Bpmatrix%7D)
也垂直于等高线![x^2y=3](https://www.zhihu.com/equation?tex=x%5E2y%3D3) ：
![](https://img-blog.csdn.net/20180801104758563?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
梯度向量是等高线的法线，更准确地表述是：
![梯度与等高线的切线垂直](https://www.zhihu.com/equation?tex=%E6%A2%AF%E5%BA%A6%E4%B8%8E%E7%AD%89%E9%AB%98%E7%BA%BF%E7%9A%84%E5%88%87%E7%BA%BF%E5%9E%82%E7%9B%B4)
**3 拉格朗日乘子法**
**3.1 求解**
根据之前的两个分析：
![\begin{cases}     在极值点，圆与曲线相切\\     \\     梯度与等高线的切线垂直 \end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%E5%9C%A8%E6%9E%81%E5%80%BC%E7%82%B9%EF%BC%8C%E5%9C%86%E4%B8%8E%E6%9B%B2%E7%BA%BF%E7%9B%B8%E5%88%87%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%E6%A2%AF%E5%BA%A6%E4%B8%8E%E7%AD%89%E9%AB%98%E7%BA%BF%E7%9A%84%E5%88%87%E7%BA%BF%E5%9E%82%E7%9B%B4%0A%5Cend%7Bcases%7D%0A)
综合可知，在相切点，圆的梯度向量和曲线的梯度向量平行：
![](https://img-blog.csdn.net/20180801104758936?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
也就是梯度向量平行，用数学符号表示为：
![\nabla f=\lambda\nabla g](https://www.zhihu.com/equation?tex=%5Cnabla%20f%3D%5Clambda%5Cnabla%20g)
还必须引入![x^2y=3](https://www.zhihu.com/equation?tex=x%5E2y%3D3) 这个条件，否则这么多等高线，不知道指的是哪一根：
![](https://img-blog.csdn.net/20180801104758900?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
因此联立方程：
![\begin{cases}    \nabla f=\lambda\nabla g\\    \\    x^2y=3\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cnabla%20f%3D%5Clambda%5Cnabla%20g%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20x%5E2y%3D3%0A%5Cend%7Bcases%7D%0A)
求一下试试：
![\begin{cases}    \begin{pmatrix}2x\\2y\end{pmatrix}=\lambda\begin{pmatrix}2xy\\x^2\end{pmatrix}\\    \\    x^2y=3\end{cases}\implies\begin{cases}    x\approx\pm 1.61\\    \\    y\approx 1.1\\    \\    \lambda\approx 0.87\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cbegin%7Bpmatrix%7D2x%5C%5C2y%5Cend%7Bpmatrix%7D%3D%5Clambda%5Cbegin%7Bpmatrix%7D2xy%5C%5Cx%5E2%5Cend%7Bpmatrix%7D%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20x%5E2y%3D3%0A%5Cend%7Bcases%7D%0A%5Cimplies%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20x%5Capprox%5Cpm%201.61%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20y%5Capprox%201.1%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%5Clambda%5Capprox%200.87%0A%5Cend%7Bcases%7D%0A)
这就是拉格朗日乘子法。
**3.2 定义**
要求函数![f](https://www.zhihu.com/equation?tex=f) 在![g](https://www.zhihu.com/equation?tex=g) 约束下的极值这种问题可以表示为：
![minmax\ f\\    s.t.\ g=0](https://www.zhihu.com/equation?tex=%0A%20%20%20%20minmax%5C%20f%5C%5C%0A%20%20%20%20s.t.%5C%20g%3D0%0A)
![s.t.](https://www.zhihu.com/equation?tex=s.t.) 意思是subject to，服从于，约束于的意思。
可以列出方程组进行求解：
![\begin{cases}    \nabla f=\lambda\nabla g\\    \\    g=0\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cnabla%20f%3D%5Clambda%5Cnabla%20g%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20g%3D0%0A%5Cend%7Bcases%7D%0A)
用这个定义来翻译下刚才的例子，要求：
令：
![\begin{cases}    f(x,y)=x^2+y^2\\    \\    g(x,y)=x^2y-3\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20f(x%2Cy)%3Dx%5E2%2By%5E2%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20g(x%2Cy)%3Dx%5E2y-3%0A%5Cend%7Bcases%7D%0A)
求：
![min\ f(x,y)\\    s.t.\ g(x,y)=0](https://www.zhihu.com/equation?tex=%0A%20%20%20%20min%5C%20f(x%2Cy)%5C%5C%0A%20%20%20%20s.t.%5C%20g(x%2Cy)%3D0%0A)
联立方程进行求解：
![\begin{cases}    \nabla f=\lambda\nabla g\\    \\    g(x,y)=0\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cnabla%20f%3D%5Clambda%5Cnabla%20g%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20g(x%2Cy)%3D0%0A%5Cend%7Bcases%7D%0A)
**3.3 变形**
这个定义还有种变形也比较常见，要求：
![minmax\ f\\    s.t.\ g=0](https://www.zhihu.com/equation?tex=%0A%20%20%20%20minmax%5C%20f%5C%5C%0A%20%20%20%20s.t.%5C%20g%3D0%0A)
定义：
![F=f+\lambda g](https://www.zhihu.com/equation?tex=F%3Df%2B%5Clambda%20g)
求解下面方程组即可得到答案：
![\begin{pmatrix}\frac{F}{\partial x}\\\frac{F}{\partial y}\\\frac{F}{\partial \lambda}\end{pmatrix}=\begin{pmatrix}0\\0\\0\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cbegin%7Bpmatrix%7D%5Cfrac%7BF%7D%7B%5Cpartial%20x%7D%5C%5C%5Cfrac%7BF%7D%7B%5Cpartial%20y%7D%5C%5C%5Cfrac%7BF%7D%7B%5Cpartial%20%5Clambda%7D%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D0%5C%5C0%5C%5C0%5Cend%7Bpmatrix%7D)
把等式左边的偏导算出来就和上面的定义是一样的了。
**3.4 多个约束条件**
如果增加一个约束条件呢？比如说：
![x-y-3=0](https://www.zhihu.com/equation?tex=x-y-3%3D0)
求：
![min\ x^2+y^2\\    s.t.\         \begin{cases}            x^2y-3=0\\            x-y-3=0        \end{cases}](https://www.zhihu.com/equation?tex=%0A%20%20%20%20min%5C%20x%5E2%2By%5E2%5C%5C%0A%20%20%20%20s.t.%5C%20%0A%20%20%20%20%20%20%20%20%5Cbegin%7Bcases%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20x%5E2y-3%3D0%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20x-y-3%3D0%0A%20%20%20%20%20%20%20%20%5Cend%7Bcases%7D%0A)
从图上看约束条件是这样的：
![](https://img-blog.csdn.net/20180801104758902?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
很显然所求的距离是这样的：
![](https://img-blog.csdn.net/2018080110475929?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
那这三者的法线又有什么关系呢？![x^2+y^2](https://www.zhihu.com/equation?tex=x%5E2%2By%5E2) 的法线是![x^2y-3](https://www.zhihu.com/equation?tex=x%5E2y-3) 和![x-y-3](https://www.zhihu.com/equation?tex=x-y-3) 的法线的线性组合：
![](https://img-blog.csdn.net/20180801104759212?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
假设：
![\begin{cases}    f(x,y)=x^2+y^2\\    \\    g(x,y)=x^2y-3\\    \\    h(x,y)=x-y-3\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20f(x%2Cy)%3Dx%5E2%2By%5E2%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20g(x%2Cy)%3Dx%5E2y-3%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20h(x%2Cy)%3Dx-y-3%0A%5Cend%7Bcases%7D%0A)
那么线性组合就表示为：
![\nabla f=\lambda\nabla g+\mu\nabla h](https://www.zhihu.com/equation?tex=%5Cnabla%20f%3D%5Clambda%5Cnabla%20g%2B%5Cmu%5Cnabla%20h)
联立方程：
![\begin{cases}    \nabla f=\lambda\nabla g+\mu\nabla h\\    \\    g(x,y)=0\\    \\    h(x,y)=0\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cnabla%20f%3D%5Clambda%5Cnabla%20g%2B%5Cmu%5Cnabla%20h%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20g(x%2Cy)%3D0%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20h(x%2Cy)%3D0%0A%5Cend%7Bcases%7D%0A)
即可求解。
往更高纬度走的话，多约束条件的情况下，问题变为了![g_1,g_2](https://www.zhihu.com/equation?tex=g_1%2Cg_2) 围成的曲线![C](https://www.zhihu.com/equation?tex=C) 和![f](https://www.zhihu.com/equation?tex=f) 相切，直观上看![\nabla f](https://www.zhihu.com/equation?tex=%5Cnabla%20f) 必然在![\nabla g_1,\nabla g_2](https://www.zhihu.com/equation?tex=%5Cnabla%20g_1%2C%5Cnabla%20g_2) 张成的空间中：
![](https://img-blog.csdn.net/20180801104759291?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
这点的严格性这里就不证明了。
文章最新版本在（有可能会有后续更新）：[如何通俗地理解拉格朗日乘子法？](https://www.matongxue.com/madocs/939.html)
