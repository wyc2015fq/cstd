# 如何理解主元分析（PCA）？ - 马同学 - CSDN博客
置顶2018年08月31日 12:14:03[马同学高等数学](https://me.csdn.net/ccnt_2012)阅读数：1518
主元分析也就是PCA，主要用于数据降维。
**1 什么是降维？**
比如说有如下的房价数据：
![\begin{array}{c|c}     \qquad\qquad&\qquad房价(百万元)\qquad\\    \hline \color{SkyBlue}{a}& 10 \\    \hline \color{Goldenrod}{b}&2\\    \hline \color{orange}{c}&1\\    \hline \color{blue}{d}& 7 \\    \hline \color{green}{e}&3\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%20%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%2010%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%262%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%261%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%207%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%263%5C%5C%0A%5Cend%7Barray%7D%0A)
这种一维数据可以直接放在实数轴上：
![](https://img-blog.csdn.net/20180831120540925?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
不过数据还需要处理下，假设房价样本用![X](https://www.zhihu.com/equation?tex=X) 表示，那么均值为：
![\overline{X}=\frac{X_1+X_2+X_3+X_4+X_5}{5}=\frac{10+2+1+7+3}{5}=4.6](https://www.zhihu.com/equation?tex=%5Coverline%7BX%7D%3D%5Cfrac%7BX_1%2BX_2%2BX_3%2BX_4%2BX_5%7D%7B5%7D%3D%5Cfrac%7B10%2B2%2B1%2B7%2B3%7D%7B5%7D%3D4.6)
然后以均值![\overline{X}](https://www.zhihu.com/equation?tex=%5Coverline%7BX%7D) 为原点：
![](https://img-blog.csdn.net/20180831120543595?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
以![\overline{X}](https://www.zhihu.com/equation?tex=%5Coverline%7BX%7D) 为原点的意思是，以![\overline{X}](https://www.zhihu.com/equation?tex=%5Coverline%7BX%7D) 为0，那么上述表格的数字就需要修改下：
![\begin{array}{c|c}     \qquad\qquad&\qquad房价(百万元)\qquad\\    \hline \color{SkyBlue}{a}& 10-\overline{X}=5.4 \\    \hline \color{Goldenrod}{b}&2-\overline{X}=-2.6\\    \hline \color{orange}{c}&1-\overline{X}=-3.6\\    \hline \color{blue}{d}& 7-\overline{X}=2.4 \\    \hline \color{green}{e}&3-\overline{X}=-1.6\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%20%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%2010-%5Coverline%7BX%7D%3D5.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%262-%5Coverline%7BX%7D%3D-2.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%261-%5Coverline%7BX%7D%3D-3.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%207-%5Coverline%7BX%7D%3D2.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%263-%5Coverline%7BX%7D%3D-1.6%5C%5C%0A%5Cend%7Barray%7D%0A)
这个过程称为“中心化”。“中心化”处理的原因是，这些数字后继会参与统计运算，比如求样本方差，中间就包含了![X_i-\overline{X}](https://www.zhihu.com/equation?tex=X_i-%5Coverline%7BX%7D) ：
![Var(X)=\frac{1}{n}\sum _{i=1}^{n}(\color{Salmon}{X_i-\overline{X}})^2](https://www.zhihu.com/equation?tex=Var(X)%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum%20_%7Bi%3D1%7D%5E%7Bn%7D(%5Ccolor%7BSalmon%7D%7BX_i-%5Coverline%7BX%7D%7D)%5E2)
说明下，虽然[样本方差的分母是应该为n-1](https://www.matongxue.com/madocs/607.html)，这里分母采用![n](https://www.zhihu.com/equation?tex=n) 是因为这样算出来的样本方差![Var(X)](https://www.zhihu.com/equation?tex=Var(X)) 为[一致估计量](https://www.matongxue.com/madocs/808.html)，不会太影响计算结果并且可以减小运算负担。
用“中心化”的数据就可以直接算出“房价”的样本方差：
![Var(X)=\frac{1}{n}\left(5.4^2+(-2.6)^2+(-3.6)^2+2.4^2+(-1.6)^2\right)](https://www.zhihu.com/equation?tex=Var(X)%3D%5Cfrac%7B1%7D%7Bn%7D%5Cleft(5.4%5E2%2B(-2.6)%5E2%2B(-3.6)%5E2%2B2.4%5E2%2B(-1.6)%5E2%5Cright))
“中心化”之后可以看出数据大概可以分为两类：
![](https://img-blog.csdn.net/2018083112054266?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
现在新采集了房屋的面积，可以看出两者完全正相关，有一列其实是多余的：
![\begin{array}{c|c}     \qquad\qquad&\qquad房价(百万元)\qquad&\qquad面积(百平米)\qquad\\    \hline \color{SkyBlue}{a}& 10& 10 \\    \hline \color{Goldenrod}{b}& 2&2\\    \hline \color{orange}{c}& 1&1\\    \hline \color{blue}{d}& 7& 7 \\    \hline \color{green}{e}& 3&3\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%20%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%5Cqquad%26%5Cqquad%E9%9D%A2%E7%A7%AF(%E7%99%BE%E5%B9%B3%E7%B1%B3)%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%2010%26%2010%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%202%262%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%201%261%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%207%26%207%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%203%263%5C%5C%0A%5Cend%7Barray%7D%0A)
求出房屋样本、面积样本的均值，分别对房屋样本、面积样本进行“中心化”后得到：
![\begin{array}{c|c}     \qquad\qquad&\qquad房价(百万元)\qquad&\qquad面积(百平米)\qquad\\    \hline \color{SkyBlue}{a}& 5.4& 5.4 \\    \hline \color{Goldenrod}{b}& -2.6&-2.6\\    \hline \color{orange}{c}& -3.6&-3.6\\    \hline \color{blue}{d}& 2.4& 2.4 \\    \hline \color{green}{e}& -1.6&-1.6\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%20%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%5Cqquad%26%5Cqquad%E9%9D%A2%E7%A7%AF(%E7%99%BE%E5%B9%B3%E7%B1%B3)%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%205.4%26%205.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20-2.6%26-2.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%20-3.6%26-3.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%202.4%26%202.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%20-1.6%26-1.6%5C%5C%0A%5Cend%7Barray%7D%0A)
房价（![X](https://www.zhihu.com/equation?tex=X) ）和面积（![Y](https://www.zhihu.com/equation?tex=Y) ）的样本协方差是这样的（这里也是用的一致估计量）：
![Cov(X,Y)=\frac{1}{n}\sum_{i=1}^{n}(\color{Salmon}{X_i-\overline{X}})(\color{ForestGreen}{Y_i-\overline{Y}})](https://www.zhihu.com/equation?tex=Cov(X%2CY)%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D(%5Ccolor%7BSalmon%7D%7BX_i-%5Coverline%7BX%7D%7D)(%5Ccolor%7BForestGreen%7D%7BY_i-%5Coverline%7BY%7D%7D))
可见“中心化”后的数据可以简化上面这个公式，这点后面还会看到具体应用。
把这个二维数据画在坐标轴上，横纵坐标分别为“房价”、“面积”，可以看出它们排列为一条直线：
![](https://img-blog.csdn.net/2018083112054280?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
如果旋转坐标系，让横坐标和这条直线重合：
![](https://img-blog.csdn.net/20180831120543506?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
旋转后的坐标系，横纵坐标不再代表“房价”、“面积”了，而是两者的混合（术语是线性组合），这里把它们称作“主元1”、“主元2”，坐标值很容易用勾股定理计算出来，比如![a](https://www.zhihu.com/equation?tex=a)在“主元1”的坐标值为：
![](https://img-blog.csdn.net/20180831120542158?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
很显然![a](https://www.zhihu.com/equation?tex=a) 在“主元2”上的坐标为0，把所有的房间换算到新的坐标系上：
![\begin{array}{c|c}     \qquad\qquad&\qquad主元1\qquad&\qquad主元2\qquad\\    \hline \color{SkyBlue}{a}& 7.64 & 0 \\    \hline \color{Goldenrod}{b}& -3.68&0\\    \hline \color{orange}{c}& -5.09&0\\    \hline \color{blue}{d}& 3.39& 0\\    \hline \color{green}{e}& -2.26&0\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%20%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E4%B8%BB%E5%85%831%5Cqquad%26%5Cqquad%E4%B8%BB%E5%85%832%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%207.64%20%26%200%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20-3.68%260%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%20-5.09%260%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%203.39%26%200%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%20-2.26%260%5C%5C%0A%5Cend%7Barray%7D%0A)
因为“主元2”全都为0，完全是多余的，我们只需要“主元1”就够了，这样就又把数据降为了一维，而且没有丢失任何信息：
![](https://img-blog.csdn.net/201808311205423?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
**2 非理想情况如何降维？**
上面是比较极端的情况，就是房价和面积完全正比，所以二维数据会在一条直线上。
现实中虽然正比，但总会有些出入：
![\begin{array}{c|c}    \quad&房价(百万元)&面积(百平米)\\    \hline \color{SkyBlue}{a}& 10 & 9 \\    \hline \color{Goldenrod}{b}& 2 & 3\\    \hline \color{orange}{c}& 1 & 2\\    \hline \color{blue}{d}& 7 & 6.5\\    \hline \color{green}{e}& 3 & 2.5\\\end{array}\xrightarrow{中心化}\begin{array}{c|c}    \quad&房价(百万元)&面积(百平米)\\    \hline \color{SkyBlue}{a}& 5.4& 4.4 \\    \hline \color{Goldenrod}{b}& -2.6& -1.6\\    \hline \color{orange}{c}& -3.6& -2.6\\    \hline \color{blue}{d}& 2.4& 1.9 \\    \hline \color{green}{e}& -1.6& -2.1\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cquad%26%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%26%E9%9D%A2%E7%A7%AF(%E7%99%BE%E5%B9%B3%E7%B1%B3)%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%2010%20%26%209%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%202%20%26%203%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%201%20%26%202%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%207%20%26%206.5%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%203%20%26%202.5%5C%5C%0A%5Cend%7Barray%7D%0A%5Cxrightarrow%7B%E4%B8%AD%E5%BF%83%E5%8C%96%7D%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cquad%26%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%26%E9%9D%A2%E7%A7%AF(%E7%99%BE%E5%B9%B3%E7%B1%B3)%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%205.4%26%204.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20-2.6%26%20-1.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%20-3.6%26%20-2.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%202.4%26%201.9%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%20-1.6%26%20-2.1%5C%5C%0A%5Cend%7Barray%7D%0A)
把这个二维数据画在坐标轴上，横纵坐标分别为“房价”、“面积”，虽然数据看起来很接近一条直线，但是终究不在一条直线上：
![](https://img-blog.csdn.net/20180831120542692?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
那么应该怎么降维呢？分析一下，从线性代数的角度来看，二维坐标系总有各自的标准正交基（也就是两两正交、模长为1的基），![\boldsymbol{e_1},\boldsymbol{e_2}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Be_1%7D%2C%5Cboldsymbol%7Be_2%7D) ：
![](https://img-blog.csdn.net/20180831120542772?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
在某坐标系有一个点，![\boldsymbol{a}=\begin{pmatrix}x\\y\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%3D%5Cbegin%7Bpmatrix%7Dx%5C%5Cy%5Cend%7Bpmatrix%7D) ，它表示在该坐标系下标准正交基![\boldsymbol{e_1},\boldsymbol{e_2}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Be_1%7D%2C%5Cboldsymbol%7Be_2%7D) 的线性组合：
![\boldsymbol{a}=\begin{pmatrix}x\\y\end{pmatrix}=x\boldsymbol{e_1}+y\boldsymbol{e_2}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%3D%5Cbegin%7Bpmatrix%7Dx%5C%5Cy%5Cend%7Bpmatrix%7D%3Dx%5Cboldsymbol%7Be_1%7D%2By%5Cboldsymbol%7Be_2%7D)
只是在不同坐标系中，![x,y](https://www.zhihu.com/equation?tex=x%2Cy) 的值会有所不同（旋转的坐标表示不同的坐标系）：
![](https://img-blog.csdn.net/20180831120543718?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
因为![\boldsymbol{a}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D) 到原点的距离![d](https://www.zhihu.com/equation?tex=d) 不会因为坐标系改变而改变：
![](https://img-blog.csdn.net/20180831120543813?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
而：
![d^2=x^2+y^2](https://www.zhihu.com/equation?tex=d%5E2%3Dx%5E2%2By%5E2)
所以，在某坐标系下分配给![x](https://www.zhihu.com/equation?tex=x) 较多，那么分配给![y](https://www.zhihu.com/equation?tex=y) 的就必然较少，反之亦然。最极端的情况是，在某个坐标系下，全部分配给了![x](https://www.zhihu.com/equation?tex=x) ，使得![y=0](https://www.zhihu.com/equation?tex=y%3D0) ：
![](https://img-blog.csdn.net/20180831120543327?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
那么在这个坐标系中，就可以降维了，去掉![\boldsymbol{e_2}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Be_2%7D) 并不会丢失信息：
![](https://img-blog.csdn.net/20180831120543412?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
如果是两个点![\boldsymbol{a}=\begin{pmatrix}x_1\\y_1\end{pmatrix},\boldsymbol{b}=\begin{pmatrix}x_2\\y_2\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%3D%5Cbegin%7Bpmatrix%7Dx_1%5C%5Cy_1%5Cend%7Bpmatrix%7D%2C%5Cboldsymbol%7Bb%7D%3D%5Cbegin%7Bpmatrix%7Dx_2%5C%5Cy_2%5Cend%7Bpmatrix%7D) ，情况就复杂一些：
![](https://img-blog.csdn.net/20180831120544725?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
为了降维，应该选择尽量多分配给![x_1,x_2](https://www.zhihu.com/equation?tex=x_1%2Cx_2) ，少分配给![y_1,y_2](https://www.zhihu.com/equation?tex=y_1%2Cy_2) 的坐标系。
**3 主元分析（PCA）**
怎么做呢？假设有如下数据：
![\begin{array}{c|c}    \quad&\quad X\quad&\quad Y\quad\\    \hline \color{SkyBlue}{a}& a_1& b_1 \\    \hline \color{Goldenrod}{b}& a_2& b_2\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cquad%26%5Cquad%20X%5Cquad%26%5Cquad%20Y%5Cquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%20a_1%26%20b_1%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20a_2%26%20b_2%5C%5C%0A%5Cend%7Barray%7D%0A)
上面的数据这么解读，表示有两个点：
![\boldsymbol{a}=\begin{pmatrix}X_1\\Y_1\end{pmatrix}\quad\boldsymbol{b}=\begin{pmatrix}X_2\\Y_2\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%3D%5Cbegin%7Bpmatrix%7DX_1%5C%5CY_1%5Cend%7Bpmatrix%7D%5Cquad%5Cboldsymbol%7Bb%7D%3D%5Cbegin%7Bpmatrix%7DX_2%5C%5CY_2%5Cend%7Bpmatrix%7D)
这两个点在初始坐标系下（也就是自然基![\boldsymbol{e_1}=\begin{pmatrix}1\\0\end{pmatrix},\boldsymbol{e_2}=\begin{pmatrix}0\\1\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bpmatrix%7D1%5C%5C0%5Cend%7Bpmatrix%7D%2C%5Cboldsymbol%7Be_2%7D%3D%5Cbegin%7Bpmatrix%7D0%5C%5C1%5Cend%7Bpmatrix%7D) ）下坐标值为：
![\boldsymbol{a}=\begin{pmatrix}X_1\\Y_1\end{pmatrix}=\begin{pmatrix}a_1\\b_1\end{pmatrix}\quad \boldsymbol{b}=\begin{pmatrix}X_2\\Y_2\end{pmatrix}=\begin{pmatrix}a_2\\b_2\end{pmatrix}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7Ba%7D%3D%5Cbegin%7Bpmatrix%7DX_1%5C%5CY_1%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7Da_1%5C%5Cb_1%5Cend%7Bpmatrix%7D%5Cquad%20%5Cboldsymbol%7Bb%7D%3D%5Cbegin%7Bpmatrix%7DX_2%5C%5CY_2%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7Da_2%5C%5Cb_2%5Cend%7Bpmatrix%7D%0A)
图示如下：
![](https://img-blog.csdn.net/20180831120543739?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
随着坐标系的不同，![X_1,X_2](https://www.zhihu.com/equation?tex=X_1%2CX_2) 的值会不断变化：
![](https://img-blog.csdn.net/20180831120544689?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
要想尽量多分配给![X_1,X_2](https://www.zhihu.com/equation?tex=X_1%2CX_2) ，借鉴最小二乘法（请参考[如何理解最小二乘法](https://www.matongxue.com/madocs/818.html)）的思想，就是让：
![X_1^2+X_2^2=\sum_{i=0}^2 X_i^2\ \ 最大](https://www.zhihu.com/equation?tex=X_1%5E2%2BX_2%5E2%3D%5Csum_%7Bi%3D0%7D%5E2%20X_i%5E2%5C%20%5C%20%E6%9C%80%E5%A4%A7)
要求这个问题，先看看![X_1,X_2](https://www.zhihu.com/equation?tex=X_1%2CX_2) 怎么表示，假设：
![\boldsymbol{e_1}=\begin{pmatrix}e_{11}\\e_{12}\end{pmatrix}\quad \boldsymbol{e_2}=\begin{pmatrix}e_{21}\\e_{22}\end{pmatrix}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bpmatrix%7De_%7B11%7D%5C%5Ce_%7B12%7D%5Cend%7Bpmatrix%7D%5Cquad%20%5Cboldsymbol%7Be_2%7D%3D%5Cbegin%7Bpmatrix%7De_%7B21%7D%5C%5Ce_%7B22%7D%5Cend%7Bpmatrix%7D%0A)
根据点积的几何意义（[如何通俗地理解协方差和点积](https://www.matongxue.com/madocs/568.html)）有：
![X_1=\boldsymbol{a}\cdot\boldsymbol{e_1}=\begin{pmatrix}a_1\\b_1\end{pmatrix}\cdot\begin{pmatrix}e_{11}\\e_{12}\end{pmatrix}=a_1e_{11}+b_1e_{12}](https://www.zhihu.com/equation?tex=X_1%3D%5Cboldsymbol%7Ba%7D%5Ccdot%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bpmatrix%7Da_1%5C%5Cb_1%5Cend%7Bpmatrix%7D%5Ccdot%5Cbegin%7Bpmatrix%7De_%7B11%7D%5C%5Ce_%7B12%7D%5Cend%7Bpmatrix%7D%3Da_1e_%7B11%7D%2Bb_1e_%7B12%7D)
![X_2=\boldsymbol{b}\cdot\boldsymbol{e_1}=\begin{pmatrix}a_2\\b_2\end{pmatrix}\cdot\begin{pmatrix}e_{11}\\e_{12}\end{pmatrix}=a_2e_{11}+b_2e_{12}](https://www.zhihu.com/equation?tex=X_2%3D%5Cboldsymbol%7Bb%7D%5Ccdot%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bpmatrix%7Da_2%5C%5Cb_2%5Cend%7Bpmatrix%7D%5Ccdot%5Cbegin%7Bpmatrix%7De_%7B11%7D%5C%5Ce_%7B12%7D%5Cend%7Bpmatrix%7D%3Da_2e_%7B11%7D%2Bb_2e_%7B12%7D)
那么：
![\begin{aligned}    X_1^2+X_2^2        &=(a_1e_{11}+b_1e_{12})^2+(a_2e_{11}+b_2e_{12})^2\\        \\        &=a_1^2e_{11}^2+2a_1b_1e_{11}e_{12}+b_1^2e_{12}^2+a_2^2e_{11}^2+2a_2b_2e_{11}e_{12}+b_2^2e_{12}^2\\        \\        &=(a_1^2+a_2^2)e_{11}^2+2(a_1b_1+a_2b_2)e_{11}e_{12}+(b_1^2+b_2^2)e_{12}^2\end{aligned}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20X_1%5E2%2BX_2%5E2%0A%20%20%20%20%20%20%20%20%26%3D(a_1e_%7B11%7D%2Bb_1e_%7B12%7D)%5E2%2B(a_2e_%7B11%7D%2Bb_2e_%7B12%7D)%5E2%5C%5C%0A%20%20%20%20%20%20%20%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%3Da_1%5E2e_%7B11%7D%5E2%2B2a_1b_1e_%7B11%7De_%7B12%7D%2Bb_1%5E2e_%7B12%7D%5E2%2Ba_2%5E2e_%7B11%7D%5E2%2B2a_2b_2e_%7B11%7De_%7B12%7D%2Bb_2%5E2e_%7B12%7D%5E2%5C%5C%0A%20%20%20%20%20%20%20%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%3D(a_1%5E2%2Ba_2%5E2)e_%7B11%7D%5E2%2B2(a_1b_1%2Ba_2b_2)e_%7B11%7De_%7B12%7D%2B(b_1%5E2%2Bb_2%5E2)e_%7B12%7D%5E2%0A%5Cend%7Baligned%7D)
上式其实是一个二次型（可以参看[如何通俗地理解二次型](https://www.matongxue.com/madocs/271.html)）：
![X_1^2+X_2^2=\boldsymbol{e_1}^\mathrm{T}\underbrace{\begin{pmatrix}a_1^2+a_2^2&a_1b_1+a_2b_2\\a_1b_1+a_2b_2&b_1^2+b_2^2\end{pmatrix}}_{P}\boldsymbol{e_1}=\boldsymbol{e_1}^\mathrm{T}P\boldsymbol{e_1}](https://www.zhihu.com/equation?tex=%0AX_1%5E2%2BX_2%5E2%3D%5Cboldsymbol%7Be_1%7D%5E%5Cmathrm%7BT%7D%5Cunderbrace%7B%5Cbegin%7Bpmatrix%7Da_1%5E2%2Ba_2%5E2%26a_1b_1%2Ba_2b_2%5C%5Ca_1b_1%2Ba_2b_2%26b_1%5E2%2Bb_2%5E2%5Cend%7Bpmatrix%7D%7D_%7BP%7D%5Cboldsymbol%7Be_1%7D%3D%5Cboldsymbol%7Be_1%7D%5E%5Cmathrm%7BT%7DP%5Cboldsymbol%7Be_1%7D%0A)
这里矩阵![P](https://www.zhihu.com/equation?tex=P) 就是二次型，是一个对称矩阵，可以进行如下的奇异值分解（可以参看[如何通俗地理解奇异值分解](https://www.matongxue.com/madocs/306.html)）：
![P=U\Sigma U^\mathrm{T}](https://www.zhihu.com/equation?tex=P%3DU%5CSigma%20U%5E%5Cmathrm%7BT%7D)
其中，![U](https://www.zhihu.com/equation?tex=U) 为正交矩阵，即![UU^\mathrm{T}=I](https://www.zhihu.com/equation?tex=UU%5E%5Cmathrm%7BT%7D%3DI) 。
而![\Sigma](https://www.zhihu.com/equation?tex=%5CSigma) 是对角矩阵：
![\Sigma=\begin{pmatrix}\sigma_1&0\\0&\sigma_2\end{pmatrix}](https://www.zhihu.com/equation?tex=%5CSigma%3D%5Cbegin%7Bpmatrix%7D%5Csigma_1%260%5C%5C0%26%5Csigma_2%5Cend%7Bpmatrix%7D)
其中，![\sigma_1,\sigma_2](https://www.zhihu.com/equation?tex=%5Csigma_1%2C%5Csigma_2) 是奇异值，![\sigma_1 > \sigma_2](https://www.zhihu.com/equation?tex=%5Csigma_1%20%3E%20%5Csigma_2) 。
将![P](https://www.zhihu.com/equation?tex=P) 代回去：
![\begin{aligned}X_1^2+X_2^2    &=\boldsymbol{e_1}^\mathrm{T}P\boldsymbol{e_1}\\    \\    &=\boldsymbol{e_1}^\mathrm{T}U\Sigma U^\mathrm{T}\boldsymbol{e_1}\\    \\    &=(U^\mathrm{T}\boldsymbol{e_1})^\mathrm{T}\Sigma(U^\mathrm{T}\boldsymbol{e_1})\end{aligned}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Baligned%7D%0AX_1%5E2%2BX_2%5E2%0A%20%20%20%20%26%3D%5Cboldsymbol%7Be_1%7D%5E%5Cmathrm%7BT%7DP%5Cboldsymbol%7Be_1%7D%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%26%3D%5Cboldsymbol%7Be_1%7D%5E%5Cmathrm%7BT%7DU%5CSigma%20U%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%26%3D(U%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D)%5E%5Cmathrm%7BT%7D%5CSigma(U%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D)%0A%5Cend%7Baligned%7D%0A)
因为![U](https://www.zhihu.com/equation?tex=U) 是正交矩阵，所以令：
![\boldsymbol{n}=U^\mathrm{T}\boldsymbol{e_1}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bn%7D%3DU%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D)
所得的![\boldsymbol{n}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bn%7D) 也是单位向量，即：
![\boldsymbol{n}=\begin{pmatrix}n_1\\n_2\end{pmatrix}\implies n_1^2+n_2^2=1](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bn%7D%3D%5Cbegin%7Bpmatrix%7Dn_1%5C%5Cn_2%5Cend%7Bpmatrix%7D%5Cimplies%20n_1%5E2%2Bn_2%5E2%3D1)
继续回代：
![\begin{aligned}X_1^2+X_2^2    &=(U^\mathrm{T}\boldsymbol{e_1})^\mathrm{T}\Sigma(U^\mathrm{T}\boldsymbol{e_1})\\    \\    &=\boldsymbol{n}^\mathrm{T}\Sigma\boldsymbol{n}\\    \\    &=\begin{pmatrix}n_1&n_2\end{pmatrix}\begin{pmatrix}\sigma_1&0\\0&\sigma_2\end{pmatrix}\begin{pmatrix}n_1\\n_2\end{pmatrix}\\    \\    &=\sigma_1^2n_1^2+\sigma_2^2n_2^2\end{aligned}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Baligned%7D%0AX_1%5E2%2BX_2%5E2%0A%20%20%20%20%26%3D(U%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D)%5E%5Cmathrm%7BT%7D%5CSigma(U%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D)%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%26%3D%5Cboldsymbol%7Bn%7D%5E%5Cmathrm%7BT%7D%5CSigma%5Cboldsymbol%7Bn%7D%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%26%3D%5Cbegin%7Bpmatrix%7Dn_1%26n_2%5Cend%7Bpmatrix%7D%5Cbegin%7Bpmatrix%7D%5Csigma_1%260%5C%5C0%26%5Csigma_2%5Cend%7Bpmatrix%7D%5Cbegin%7Bpmatrix%7Dn_1%5C%5Cn_2%5Cend%7Bpmatrix%7D%5C%5C%0A%20%20%20%20%5C%5C%0A%20%20%20%20%26%3D%5Csigma_1%5E2n_1%5E2%2B%5Csigma_2%5E2n_2%5E2%0A%5Cend%7Baligned%7D%0A)
最初求最大值的问题就转化为了：
![X_1^2+X_2^2=\sum_{i=0}^2 X_i^2\ \ 最大\iff\begin{cases}\sigma_1^2n_1^2+\sigma_2^2n_2^2\ \ 最大\\\\n_1^2+n_2^2=1\\\\\sigma_1 > \sigma_2\end{cases}](https://www.zhihu.com/equation?tex=%0AX_1%5E2%2BX_2%5E2%3D%5Csum_%7Bi%3D0%7D%5E2%20X_i%5E2%5C%20%5C%20%E6%9C%80%E5%A4%A7%5Ciff%0A%5Cbegin%7Bcases%7D%0A%5Csigma_1%5E2n_1%5E2%2B%5Csigma_2%5E2n_2%5E2%5C%20%5C%20%E6%9C%80%E5%A4%A7%5C%5C%0A%5C%5C%0An_1%5E2%2Bn_2%5E2%3D1%5C%5C%0A%5C%5C%0A%5Csigma_1%20%3E%20%5Csigma_2%0A%5Cend%7Bcases%7D%0A)
感兴趣可以用拉格朗日乘子法计算上述条件极值（参看[如何通俗地理解拉格朗日乘子法以及KKT条件](https://www.matongxue.com/madocs/987.html)），结果是当![n_1=1,n_2=0](https://www.zhihu.com/equation?tex=n_1%3D1%2Cn_2%3D0) 时取到极值。
因此可以推出要寻找的主元1，即：
![\boldsymbol{n}=\begin{pmatrix}1\\0\end{pmatrix}=U^\mathrm{T}\boldsymbol{e_1}\implies \boldsymbol{e_1}=U\begin{pmatrix}1\\0\end{pmatrix}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bn%7D%3D%5Cbegin%7Bpmatrix%7D1%5C%5C0%5Cend%7Bpmatrix%7D%3DU%5E%5Cmathrm%7BT%7D%5Cboldsymbol%7Be_1%7D%5Cimplies%20%5Cboldsymbol%7Be_1%7D%3DU%5Cbegin%7Bpmatrix%7D1%5C%5C0%5Cend%7Bpmatrix%7D)
总结下：
![\boldsymbol{e_1}=\begin{cases}P=U\Sigma U^\mathrm{T}\\\\最大奇异值\sigma_1对应的奇异向量\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bcases%7D%0AP%3DU%5CSigma%20U%5E%5Cmathrm%7BT%7D%5C%5C%0A%5C%5C%0A%E6%9C%80%E5%A4%A7%E5%A5%87%E5%BC%82%E5%80%BC%5Csigma_1%E5%AF%B9%E5%BA%94%E7%9A%84%E5%A5%87%E5%BC%82%E5%90%91%E9%87%8F%0A%5Cend%7Bcases%7D%0A)
同样的思路可以求出：
![\boldsymbol{e_2}=\begin{cases}P=U\Sigma U^\mathrm{T}\\\\最小奇异值\sigma_2对应的奇异向量\end{cases}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7Be_2%7D%3D%5Cbegin%7Bcases%7D%0AP%3DU%5CSigma%20U%5E%5Cmathrm%7BT%7D%5C%5C%0A%5C%5C%0A%E6%9C%80%E5%B0%8F%E5%A5%87%E5%BC%82%E5%80%BC%5Csigma_2%E5%AF%B9%E5%BA%94%E7%9A%84%E5%A5%87%E5%BC%82%E5%90%91%E9%87%8F%0A%5Cend%7Bcases%7D%0A)
**4 协方差矩阵**
上一节的数据：
![\begin{array}{c|c}    \quad&\quad X\quad&\quad Y\quad\\    \hline \color{SkyBlue}{a}& a_1& b_1 \\    \hline \color{Goldenrod}{b}& a_2& b_2\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cquad%26%5Cquad%20X%5Cquad%26%5Cquad%20Y%5Cquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%20a_1%26%20b_1%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20a_2%26%20b_2%5C%5C%0A%5Cend%7Barray%7D%0A)
我们按行来解读，得到了两个向量![\boldsymbol{a},\boldsymbol{b}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%2C%5Cboldsymbol%7Bb%7D) ：
![](https://img-blog.csdn.net/20180831120544429?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
在这个基础上推出了矩阵：
![P=\begin{pmatrix}a_1^2+a_2^2&a_1b_1+a_2b_2\\a_1b_1+a_2b_2&b_1^2+b_2^2\end{pmatrix}](https://www.zhihu.com/equation?tex=%0AP%3D%5Cbegin%7Bpmatrix%7Da_1%5E2%2Ba_2%5E2%26a_1b_1%2Ba_2b_2%5C%5Ca_1b_1%2Ba_2b_2%26b_1%5E2%2Bb_2%5E2%5Cend%7Bpmatrix%7D%0A)
这个矩阵是求解主元1、主元2的关键。
如果我们按列来解读，可以得到两个向量![\boldsymbol{X},\boldsymbol{Y}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7BX%7D%2C%5Cboldsymbol%7BY%7D) ：
![](https://img-blog.csdn.net/20180831120544448?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
即：
![\boldsymbol{X}=\begin{pmatrix}a_1\\a_2\end{pmatrix}\quad \boldsymbol{Y}=\begin{pmatrix}b_1\\b_2\end{pmatrix}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7BX%7D%3D%5Cbegin%7Bpmatrix%7Da_1%5C%5Ca_2%5Cend%7Bpmatrix%7D%5Cquad%20%5Cboldsymbol%7BY%7D%3D%5Cbegin%7Bpmatrix%7Db_1%5C%5Cb_2%5Cend%7Bpmatrix%7D%0A)
那么刚才求出来的矩阵就可以表示为：
![P=\begin{pmatrix}a_1^2+a_2^2&a_1b_1+a_2b_2\\a_1b_1+a_2b_2&b_1^2+b_2^2\end{pmatrix}=\begin{pmatrix}X\cdot X&X\cdot Y\\X\cdot Y&Y\cdot Y\end{pmatrix}](https://www.zhihu.com/equation?tex=%0AP%3D%5Cbegin%7Bpmatrix%7Da_1%5E2%2Ba_2%5E2%26a_1b_1%2Ba_2b_2%5C%5Ca_1b_1%2Ba_2b_2%26b_1%5E2%2Bb_2%5E2%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7DX%5Ccdot%20X%26X%5Ccdot%20Y%5C%5CX%5Ccdot%20Y%26Y%5Ccdot%20Y%5Cend%7Bpmatrix%7D%0A)
之前说过“中心化”后的样本方差（关于样本方差、协方差可以参看这篇文章：[如何通俗地理解协方差和点积](https://www.matongxue.com/madocs/568.html)）：
![Var(X)=\frac{1}{n}\sum_{i=1}^{n}X_i^2=\frac{1}{n}X\cdot X](https://www.zhihu.com/equation?tex=Var(X)%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7DX_i%5E2%3D%5Cfrac%7B1%7D%7Bn%7DX%5Ccdot%20X)
样本协方差为：
![Cov(X,Y)=\frac{1}{n}\sum_{i=1}^{n}X_iY_i=\frac{1}{n}X\cdot Y](https://www.zhihu.com/equation?tex=Cov(X%2CY)%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7DX_iY_i%3D%5Cfrac%7B1%7D%7Bn%7DX%5Ccdot%20Y)
两相比较可以得到一个新的矩阵，也就是协方差矩阵：
![Q=\frac{1}{n}P=\begin{pmatrix}Var(X)&Cov(X,Y)\\Cov(X,Y)&Var(Y)\end{pmatrix}](https://www.zhihu.com/equation?tex=%0AQ%3D%5Cfrac%7B1%7D%7Bn%7DP%3D%5Cbegin%7Bpmatrix%7DVar(X)%26Cov(X%2CY)%5C%5CCov(X%2CY)%26Var(Y)%5Cend%7Bpmatrix%7D%0A)
![P,Q](https://www.zhihu.com/equation?tex=P%2CQ) 都可以进行奇异值分解：
![P=U\begin{pmatrix}\sigma_1&0\\0&\sigma_2\end{pmatrix} U^\mathrm{T}\quadQ=\frac{1}{n}P=U\begin{pmatrix}\frac{\sigma_1}{n}&0\\0&\frac{\sigma_2}{n}\end{pmatrix} U^\mathrm{T}](https://www.zhihu.com/equation?tex=%0AP%3DU%5Cbegin%7Bpmatrix%7D%5Csigma_1%260%5C%5C0%26%5Csigma_2%5Cend%7Bpmatrix%7D%20U%5E%5Cmathrm%7BT%7D%5Cquad%0AQ%3D%5Cfrac%7B1%7D%7Bn%7DP%3DU%5Cbegin%7Bpmatrix%7D%5Cfrac%7B%5Csigma_1%7D%7Bn%7D%260%5C%5C0%26%5Cfrac%7B%5Csigma_2%7D%7Bn%7D%5Cend%7Bpmatrix%7D%20U%5E%5Cmathrm%7BT%7D%0A)
可见，协方差矩阵![Q](https://www.zhihu.com/equation?tex=Q) 的奇异值分解和![P](https://www.zhihu.com/equation?tex=P) 相差无几，只是奇异值缩小了![n](https://www.zhihu.com/equation?tex=n) 倍，但是不妨碍奇异值之间的大小关系，所以在实际问题中，往往都是直接分解协方差矩阵![Q](https://www.zhihu.com/equation?tex=Q) 。
**5 实战**
回到使用之前“中心化”了的数据：
![\begin{array}{c|c}    \quad&房价(百万元)&面积(百平米)\\    \hline \color{SkyBlue}{a}& 5.4& 4.4 \\    \hline \color{Goldenrod}{b}& -2.6& -1.6\\    \hline \color{orange}{c}& -3.6& -2.6\\    \hline \color{blue}{d}& 2.4& 1.9 \\    \hline \color{green}{e}& -1.6& -2.1\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cquad%26%E6%88%BF%E4%BB%B7(%E7%99%BE%E4%B8%87%E5%85%83)%26%E9%9D%A2%E7%A7%AF(%E7%99%BE%E5%B9%B3%E7%B1%B3)%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%205.4%26%204.4%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%20-2.6%26%20-1.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%20-3.6%26%20-2.6%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%202.4%26%201.9%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%20-1.6%26%20-2.1%5C%5C%0A%5Cend%7Barray%7D%0A)
这些数据按行，在自然基下画出来就是：
![](https://img-blog.csdn.net/20180831120544469?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
按列解读得到两个向量：
![\boldsymbol{X}=\begin{pmatrix}5.4\\-2.6\\-3.6\\2.4\\-1.6\end{pmatrix}\quad \boldsymbol{Y}=\begin{pmatrix}4.4\\-1.6\\-2.6\\1.9\\-2.1\end{pmatrix}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7BX%7D%3D%5Cbegin%7Bpmatrix%7D5.4%5C%5C-2.6%5C%5C-3.6%5C%5C2.4%5C%5C-1.6%5Cend%7Bpmatrix%7D%5Cquad%20%5Cboldsymbol%7BY%7D%3D%5Cbegin%7Bpmatrix%7D4.4%5C%5C-1.6%5C%5C-2.6%5C%5C1.9%5C%5C-2.1%5Cend%7Bpmatrix%7D%0A)
组成协方差矩阵：
![Q=\begin{pmatrix}Var(X)&Cov(X,Y)\\Cov(X,Y)&Var(Y)\end{pmatrix}=\frac{1}{5}\begin{pmatrix}X\cdot X&X\cdot Y\\X\cdot Y&Y\cdot Y\end{pmatrix}=\frac{1}{5}\begin{pmatrix}57.2&45.2\\45.2&36.7\end{pmatrix}](https://www.zhihu.com/equation?tex=%0AQ%3D%5Cbegin%7Bpmatrix%7DVar(X)%26Cov(X%2CY)%5C%5CCov(X%2CY)%26Var(Y)%5Cend%7Bpmatrix%7D%3D%5Cfrac%7B1%7D%7B5%7D%5Cbegin%7Bpmatrix%7DX%5Ccdot%20X%26X%5Ccdot%20Y%5C%5CX%5Ccdot%20Y%26Y%5Ccdot%20Y%5Cend%7Bpmatrix%7D%3D%5Cfrac%7B1%7D%7B5%7D%5Cbegin%7Bpmatrix%7D57.2%2645.2%5C%5C45.2%2636.7%5Cend%7Bpmatrix%7D%0A)
进行奇异值分解：
![Q\approx \begin{pmatrix}-0.78&-0.62\\-0.62&0.78\end{pmatrix}\begin{pmatrix}18.66&0\\0&0.12\end{pmatrix}\begin{pmatrix}-0.78&-0.62\\-0.62&0.78\end{pmatrix}](https://www.zhihu.com/equation?tex=%0AQ%5Capprox%20%5Cbegin%7Bpmatrix%7D-0.78%26-0.62%5C%5C-0.62%260.78%5Cend%7Bpmatrix%7D%5Cbegin%7Bpmatrix%7D18.66%260%5C%5C0%260.12%5Cend%7Bpmatrix%7D%5Cbegin%7Bpmatrix%7D-0.78%26-0.62%5C%5C-0.62%260.78%5Cend%7Bpmatrix%7D%0A)
根据之前的分析，主元1应该匹配最大奇异值对应的奇异向量，主元2匹配最小奇异值对应的奇异向量，即：
![\boldsymbol{e_1}=\begin{pmatrix}-0.78\\-0.62\end{pmatrix}\quad \boldsymbol{e_2}=\begin{pmatrix}-0.62\\0.78\end{pmatrix}](https://www.zhihu.com/equation?tex=%0A%5Cboldsymbol%7Be_1%7D%3D%5Cbegin%7Bpmatrix%7D-0.78%5C%5C-0.62%5Cend%7Bpmatrix%7D%5Cquad%20%5Cboldsymbol%7Be_2%7D%3D%5Cbegin%7Bpmatrix%7D-0.62%5C%5C0.78%5Cend%7Bpmatrix%7D%0A)
以这两个为主元画出来的坐标系就是这样的：
![](https://img-blog.csdn.net/20180831120544605?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NjbnRfMjAxMg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
如下算出新坐标，比如对于![\boldsymbol{a}](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D) ：
![X_1=\boldsymbol{a}\cdot\boldsymbol{e_1}=-6.94\quad X_2=\boldsymbol{a}\cdot\boldsymbol{e_2}=0.084](https://www.zhihu.com/equation?tex=X_1%3D%5Cboldsymbol%7Ba%7D%5Ccdot%5Cboldsymbol%7Be_1%7D%3D-6.94%5Cquad%20X_2%3D%5Cboldsymbol%7Ba%7D%5Ccdot%5Cboldsymbol%7Be_2%7D%3D0.084)
以此类推，得到新的数据表：
![\begin{array}{c|c}    \qquad\qquad&\qquad主元1\qquad&\qquad主元2\qquad\\    \hline \color{SkyBlue}{a}& -6.94& 0.084 \\    \hline \color{Goldenrod}{b}& 3.02& 0.364\\    \hline \color{orange}{c}& 4.42& 0.204\\    \hline \color{blue}{d}& -3.05& -0.006 \\    \hline \color{green}{e}& 2.55& -0.646\\\end{array}](https://www.zhihu.com/equation?tex=%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7D%0A%20%20%20%20%5Cqquad%5Cqquad%26%5Cqquad%E4%B8%BB%E5%85%831%5Cqquad%26%5Cqquad%E4%B8%BB%E5%85%832%5Cqquad%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BSkyBlue%7D%7Ba%7D%26%20-6.94%26%200.084%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7BGoldenrod%7D%7Bb%7D%26%203.02%26%200.364%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Borange%7D%7Bc%7D%26%204.42%26%200.204%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bblue%7D%7Bd%7D%26%20-3.05%26%20-0.006%20%5C%5C%0A%20%20%20%20%5Chline%20%5Ccolor%7Bgreen%7D%7Be%7D%26%202.55%26%20-0.646%5C%5C%0A%5Cend%7Barray%7D%0A)
主元2整体来看，数值很小，丢掉损失的信息也非常少，这样就实现了非理想情况下的降维。
文章的最新版本在（可能会不定期更新）：[如何理解主元分析（PCA）？](https://www.matongxue.com/madocs/1025.html)
