# 监控集群的状态 - sxf_123456的博客 - CSDN博客
2017年05月01日 21:36:06[sxf_0123](https://me.csdn.net/sxf_123456)阅读数：195
                
#!/bin/sh
#node_stat.sh
rm -rf t1.txt
node_num=`sed '/^$/d' /etc/hosts|wc -l`
for node in `cat /etc/hosts|awk '(NR>=3&&NR<=7){print $2}'`
do
#       echo "node="$node
        ping -c 1 $node &> /dev/null
        if [ $? = 0 ];then
                echo "$node is up" &> /dev/null
        else
                sleep 1
                ping -c 1  $node &> /dev/null
                if [ $? = 0 ];then
                        echo "$node is up"  &> /dev/null
                else
                        #touch t1.txt
                        echo "$node is down\n" >> t1.txt
                fi
        fi
done
str=`cat t1.txt`
#echo $str"\n"
echo $str|mail -s 'cluster network stat' mpi@mpi.com
exit 0
            
