# RTSP请求详解及RTP 基于UDP和TCP协议传输数据的对比 - 建建的博客 - CSDN博客
2017年10月14日 18:33:24[纪建](https://me.csdn.net/u013898698)阅读数：200
个人分类：[Rtsp协议](https://blog.csdn.net/u013898698/article/category/6698534)

最近一段时间一直在研究rtsp和rtp,现在写博客总结一下，也是对知识的一种巩固吧。
rtsp的协议的请求流程及格式请参考一下链接：[http://blog.csdn.net/u010425035/article/details/10410851](http://blog.csdn.net/u010425035/article/details/10410851)
下面是我用VLC播放器获取海康NVR视频的截图（此次获取是基于TCP的）：
![](https://img-blog.csdn.net/20160813111347926?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
下面来看一下针对每一条消息的详细截图：
客户端发送的OPTION消息：
![](https://img-blog.csdn.net/20160813111829511?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器对OPTION回复的200OK消息：
![](https://img-blog.csdn.net/20160813112131624?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
客户端发送的DESCRIBE不带鉴权的消息：
![](https://img-blog.csdn.net/20160813112448518?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器回复的401消息：
![](https://img-blog.csdn.net/20160813113018317?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
客户端请求带鉴权的DESCRIBE消息：
![](https://img-blog.csdn.net/20160813113235514?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器回复200OK消息带SDP消息体：
![](https://img-blog.csdn.net/20160813114241652?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
客户端请求的SETUP消息：
![](https://img-blog.csdn.net/20160813115127196?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器对SETUP回复的200OK消息：
![](https://img-blog.csdn.net/20160813115904785?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
客户端发起PLAY消息：
![](https://img-blog.csdn.net/20160813120139272?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器针对PLAY回复的200OK消息：
![](https://img-blog.csdn.net/20160813120305630?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
服务器发送完PLAY的200OK消息以后就开始发送数据，RTP基于TCP的数据传输截图如下：
![](https://img-blog.csdn.net/20160813121215208?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
![](https://img-blog.csdn.net/20160813121336116?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
客户端发送的TEARDOWN消息：
![](https://img-blog.csdn.net/20160813122422592?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
VLC停止播放时没有收到服务器针对TEARDOWN消息发送的200OK消息，不知道是什么原因，初步怀疑是海康NVR没有发送这个消息。
以上是基于TCP的截图，下面是针对UDP的截图，只截取和TCP不同的部分，相同的部分不再截图，请参考TCP截图：
第一个不同点是SETUP消息及回复部分：
![](https://img-blog.csdn.net/20160813123128093?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
![](https://img-blog.csdn.net/20160813123258079?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
数据传输部分：
![](https://img-blog.csdn.net/20160813123532942?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
总结：以上是RTP基于TCP和UDP传输数据不同的地方，关于RTCP的部分还没有研究，带以后有时间再补上相应的部分截图，有什么不对的地址还希望大家指正。
针对RTP
下面是我写的一个RTSP请求客户端：[http://download.csdn.net/detail/xiaoyafang123/9602383](http://download.csdn.net/detail/xiaoyafang123/9602383)
