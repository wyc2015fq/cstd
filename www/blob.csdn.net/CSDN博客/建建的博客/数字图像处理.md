# 数字图像处理 - 建建的博客 - CSDN博客
2017年02月23日 18:10:16[纪建](https://me.csdn.net/u013898698)阅读数：517
**第十二章 小波变换**
**目录**
1         [引言](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#a1)
2         [连续小波变换](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#b1)
3         [二进小波变换](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#c1)
3.1      Haar变换
4         [离散小波变换](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#d1)
4.1      多分辨率分析
4.2      快速小波变换[算法](http://lib.csdn.net/base/datastructure)
4.3      离散小波变换的设计
4.4      二维离散小波变换
4.5      双正交小波变换
5         [Gabor变换](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#e1)
[作业](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#homework)
**1.  引言**
   小波变换是近年来在图象处理中受到十分重视的新技术，面向图象压缩、特征检测以及纹理分析的许多新方法，如多分辨率分析、时频域分析、金字塔算法等，都最终归于小波变换（wavelet transforms）的范畴中。
   线性系统理论中的傅立叶变换是以在两个方向上都无限伸展的正弦曲线波作为正交基函数的。对于瞬态信号或高度局部化的信号（例如边缘），由于这些成分并不类似于任何一个傅立叶基函数，它们的变换系数（频谱）不是紧凑的，频谱上呈现出一幅相当混乱的构成。这种情况下，傅立叶变换是通过复杂的安排，以抵消一些正弦波的方式构造出在大部分区间都为零的函数而实现的。
   为了克服上述缺陷，使用有限宽度基函数的变换方法逐步发展起来了。这些基函数不仅在频率上而且在位置上是变化的，它们是有限宽度的波并被称为小波（wavelet）。基于它们的变换就是小波变换。
**2.  连续小波变换（CWT）**
   所有小波是通过对基本小波进行尺度伸缩和位移得到的。基本小波是一具有特殊性质的实值函数，它是震荡衰减的，而且通常衰减得很快，在数学上满足积分为零的条件：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image004.gif)
即基本小波在频域也具有好的衰减性质。有些基本小波实际上在某个区间外是零，这是一类衰减最快的小波。
一组小波基函数是通过尺度因子和位移因子由基本小波来产生：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image006.gif)
连续小波变换定义为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image008.gif)
连续小波变换也称为积分小波变换。
连续小波逆变换为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image010.gif)
二维连续小波定义为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image012.gif)
二维连续小波变换是：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image014.gif)
二维连续小波逆变换为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image016.gif)
**2.1 滤波器族解释**
    这里将小波变换与一族带通线性（卷积）滤波器相联系，作为小波变换的一种解释。
首先定义尺度a上的一般小波基函数为
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image018.gif)
这是用a做尺度因子，并用a-1/2将模规范了的基本小波。若记其翻转共轭为
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image020.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image022.gif)
小波变换就可以表示成滤波器族
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image024.gif)
而且每个滤波器的输出分量再次滤波并适当伸缩后组合在一起可重构f(x)。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image257.gif)
**2.2 二维滤波器族**
    在二维情况下，每一滤波器都是一个二维冲激响应，输入是图象上的带通滤波器，滤波后的图象的叠层组成了小波变换。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image258.gif)
**3.  二进小波变换**
    通常在数值计算中，采用离散化的尺度及位移因子，特别地当取二进伸缩（以2的因子伸缩）和二进位移（每次移动k/2j）时，就形成二进小波。
正交小波定义为满足下列条件的小波：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image026.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image028.gif)
上式是小波级数展开公式。
当进一步把f(x)和基本小波限制为在[0，1]区间外为零的函数时，上述正交小波函数族就成为**紧致二进小波**函数族**，它**可以用单一的索引n来确定：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image030.gif)
**3.1 Haar变换**
  Haar基本小波函数定义在区间[0，1]上，如图所示：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image262.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image032.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image034.gif)
该基本小波定义的小波变换称为Haar小波变换，是常用的小波变换中最简单的一种。
**4.  离散小波变换（DWT）**
    在数值计算中，需要对小波变换的尺度因子、位移因子进行离散化，一般采用如下的离散化方式：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image036.gif)
**4.1 多分辨率分析**
    基本小波通过伸缩构成一组基函数，在大尺度上，膨胀的基函数搜索大的特征，而在较小的尺度上，它们则寻找细节信息。
**4.1.1. 金字塔算法**
    对于数字图象（以512x512为例），通过连续平均2x2的象素块并丢掉隔行隔列的象素，将得到缩小四倍的图象（256x256）（行列各缩小2倍）。这样迭代进行，直到得到1x1的图象为止。如果利用同样尺寸的边缘检测算子（如3x3的Sobel），在原始图象上则会得到小边缘，在256x256及更小的图象上会得到稍大及更大的边缘。
**4.1.2. 拉普拉斯金字塔编码**
    对原始图象f0(i,j)（NxN, N=2n）做高斯滤波，将图象分解为半分辨率的低频分量和整分辨率的高频分量。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image038.gif)
这一过程在间隔抽样后的图象上迭代进行，经过n次迭代得到一组hk(i,j)和最终的低频图象fn(i,j)(一个点)组成一个编码图象金字塔。
    图象的解码过程以相反的次序进行。从最后一幅fn(i,j)开始，对每一幅抽样图象fk(i,j)都进行一个增频采样并与g(i,j)卷积进行内插。增频采样是在采样点之间插入零的过程，所得结果被添加到下一幅（前一幅）图象fk-1(i,j)上，再对所得图象重复执行这一过程。这个过程能无误差地重建出原始图象。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image267.gif)
    由于hk(i,j)图象在很大程度上降低了相关性和动态范围，因此可以使用较粗的量化等级，因而可以实现一个很大程度的图象压缩。
**4.1.3. 子带编码和解码**
    对于有限带宽信号，若将其分解为窄带分量，特别地当采用双通道子带时，对应带宽划分为两个分量（子带），例如低半带和高半带，构造子带编码，是一种时频域技术。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image268.gif)
    双通道子带编码和解码具有如下形式：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image040.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image270.gif)![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image271.gif)
**4.2 快速小波变换算法（FWT, ****Mallat算法）**
    利用双带子带编码迭代地自底向上建立小波变换。
    首先按照低半带和高半带进行子带编码后，对低半带再一次进行子带编码，得到一个N/2点的高半带信号和对应于区间[0,![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image042.gif)]的第一和第二个1/4区域的两个N/4点的子带信号。
    然后，连续进行上述过程，每一步都保留高半带信号并进一步编码低半带信号直到得到了一个仅有一个点的低半带信号为止。这样，小波变换系数就是这个低半带点再加上全部用子带编码的高半带信号。如下图所示。最前面的N/2个系数来自于F(s)的高半带，接下来的N/4个点来自于第二个四分之一带，依次类推。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image272.gif)
　  上述算法被称为快速小波变换（FastWavelet Transform），也因其形状而被称为Mallat的“鱼骨型算法”。其逆变换如下图所示。　![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image273.gif)
**4.3 离散小波变换的设计**
    根据4.1节的子带编码重构公式，在频率域上有：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image044.gif)
可见，设计一个离散小波变换的任务就是精心挑选低通滤波器。我们称符合这一条件的离散低通滤波器脉冲响应h0(k)为尺度向量，由它产生一个有关的函数称为尺度函数。尺度向量和尺度函数彼此互相确定。
例如，由尺度向量h0(k)到尺度函数的定义如下：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image046.gif)
即它可以通过自身半尺度复制后的加权和来构造。另外它也能用带尺度的矩形脉冲函数卷积h0(k)利用数值计算方法得到：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image048.gif)
    相反，由尺度函数开始，在它满足单位平移下正交归一条件时，尺度向量的计算方法如下：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image050.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image052.gif)
**4.4 二维离散小波变换**
    为了将一维离散小波变换推广到二维，只考虑尺度函数是可分离的情况，即
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image054.gif)
**4.4.1 正变换**
    从一幅NxN的图象f1(x,y)开始，其中上标指示尺度并且N是2的幂。对于j=0, 尺度2j=20=1，也就是原图象的尺度。j值的每一次增大都使尺度加倍，而使分辨率减半。
    在变换的每一层次，图象都被分解为四个四分之一大小的图象，它们都是由原图与一个小波基图象的内积后，再经过在行和列方向进行2倍的间隔抽样而生成的。对于第一个层次(j=1)，可写成
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image056.gif)
后续的层次(j>1)，依次类推，形成如图所示的形式。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image280.gif)
    若将内积改写成卷积形式则有：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image058.gif)
    因为尺度函数和小波函数都是可分离的，所以每个卷积都可分解成行和列的一维卷积。例如，在第一层，首先用h0(-x)和h1(-x)分别与图象f1(x,y)的每行作卷积并丢弃奇数列（以最左列为第0列）。接着这个NxN/2阵列的每列再和h0(-x)和h1(-x)相卷积，丢弃奇数行（以最上行为第0行）。结果就是该层变换所要求的四个(N/2)x(N/2)的数组。
如下图所示：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image282.gif)
**4.4.2 逆变换**
    逆变换与上述过程相似，在每一层，通过在每一列的左边插入一列零来增频采样前一层的四个阵列；接着用h0(x)和h1(x)来卷积各行，再成对地把这几个N/2xN的阵列加起来；然后通过在每行上面插入一行零来将刚才所得的两个阵列的增频采样为NxN；再用h0(x)和h1(x)与这两个阵列的每列卷积。这两个阵列的和就是这一层重建的结果。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image283.gif)
**4.5 双正交小波变换**
    使用两个不同的小波基，一个用来分解（分析），另一个用来重建（合成），构成彼此对偶的双正交的小波基：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image060.gif)
一维双正交小波变换通过四个离散滤波器实现，需要选择两个低通滤波器即尺度向量，使它们的传递函数满足
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image062.gif)
双正交小波变换的一个分解步骤和一个重建步骤如下图所示。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/Image286.gif)
双正交小波为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image064.gif)
二维双正交小波变换由对应的小波基确定：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image066.gif)
**（演示：Matlab -->Examples and demos -->toolboxes-->Wavelets-->Wavelet2-D and GUI Wavlet2-D）**
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/wavelet.gif)
(图片来自Matlabdemo)
**5.Gabor变换**
（本节摘自[GaborFilters.htm](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/GaborFilters.htm)）
    Gabor滤波在图象处理中的特征提取、纹理分析和立体视差估计等方面有许多应用。它对应的冲激响应是将复指数振荡函数乘以高斯包络函数所得的结果。有研究说明神经细胞的感受野可以用Gabor 函数来表示。
    设图象坐标为 ***x***=[*x*1*x*2]T，则Gabor滤波的冲激响应为.
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image068.gif)
其中矩阵 ***A*** 确定该滤波器的带宽和方向选择性。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image070.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image072.gif)
当调制频率向量 ***k***0与包络的轴同方向时，则冲激响应的实部和虚部有如下的形状：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/gabrea.gif)![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/gabimg.gif)
Gabor滤波的传递函数 *G*(***k***) 为：
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image074.gif)
其中 ***k ***= [*k*1*k*2]T 是空间频率。为了建立多分辨率分析框架，图象可以用一组*N*个不同带宽和调制频率的Gabor 滤波来处理。假设调制频率为
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image076.gif)
且相应的所有滤波器取相同的带宽，图象被分解为8部分
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/gabset.gif)
Magnitude of a Gabor filter set for *N*=4 in direction of themodulation frequency
在上图中，滤波器的传递函数被选择在0.5处重叠。在这样的条件下，图象的直流分量（DCcomponent）和频域分量（frequency components）在两倍于调制频率外至少衰减-54dB。因此滤波输出信号可以按如下的比例重采样（sub-sampled），其走样影响（aliasing effects）可以忽略不计。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image078.gif)
进一步，图象可以用调制成不同角度的Gabor滤波器分解为M通道的不同方向的分量。
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.files/image080.gif)
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/gab2dk.gif)
Half-value plot ofthe Gabor filters in the frequency plane tuned todifferent frequencies and orientations (30 degree resolution)
    下图给出原始图片Lenna 和Gabor 滤波在不同采样因子下的结果。图片的左侧是原图（sub）和所有方向滤波的重叠结果，右侧是每个方向重采样的结果。
s = 4
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna4.gif)![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna4_gf.gif)
s = 2
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna2.gif)![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna2_bf.gif)
　s = 1
![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna1d2.gif)![](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/lenna1_bf.gif)
Subimages of the Lenna-picture and magnitudes of thecorresponding filter results
**其它参考资料：**
1.   网上小波资料：[链接目录](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/Wavelet%20Resources.htm)
[Introductionto wavelets](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/Book%20Wavelets%20and%20Subband%20Coding.files/wavelet_introduction.ps),
[Wavelets](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/Book%20Wavelets%20and%20Subband%20Coding.files/wavelet.pdf),
[DiscreteWavelet Transform](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/Book%20Wavelets%20and%20Subband%20Coding.files/DisWaveTrans..pdf)
[Gabor filtering](http://media.cs.tsinghua.edu.cn/~ahz/download_IPCVPR/wavelet/GaborFilters.htm)
[MathLab小波工具Wavlab](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/Software&SourceCode/wavelet/WaveLab802.htm)
2.   [美]崔锦泰 （程正兴 译），小波分析导论，西安交通大学出版社，1995。
最新推荐的书籍：[StéphaneMallat](http://www.cmap.polytechnique.fr/~mallat/), Wavelet Tour of Signal Processing, 2nd Edition, Academic Press,1998
## [ASHORT PRESENTATION BY F. CHAPLAIS](http://cas.ensmp.fr/~chaplais/Wavetour_presentation/Wavetour_presentation_US.html)
**Stéphane Mallat著 (杨力华 **等译), 信号处理的小波导引（原书第２版）,2003, 机械工业出版社　
本书以十分直观的近于谈话式的方法讲述了小波理论的问题和方法以及相关的数学证明及理论，使读者可以透过复杂的数学公式样来了解小波的精髓，又不会将小波带入纯数学的迷宫。本书是按研究生教材的要求编写的。对于应用数学系的的学生，本书可以让他们了解数学公式的工程意义，而对于电子工程系的学生，本书又会让他们了解工程问题的数学描述。
**作业**
1.   阅读并使用Matlab小波变换工具，观察小波变换的效果。
2.   用MS-VC编写图象的小波变换程序。
[返回主目录](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/CourseImageProcess.html)[返回本章目录](http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/chapter12/chapt12_ahz.htm#content)
清华大学计算机系 艾海舟
最近修改时间：2003年7月31日
出处：http://media.cs.tsinghua.edu.cn/~ahz/digitalimageprocess/CourseImageProcess.html
