# 【未试】VS2008 修改模板自动添加版权信息与添加宏注释方法 - 三少GG - CSDN博客
2013年01月23日 19:44:15[三少GG](https://me.csdn.net/scut1135)阅读数：1898
个人分类：[重构C/C++](https://blog.csdn.net/scut1135/article/category/621651)

**一·。**
http://blog.csdn.net/dragonpeng2008/article/details/6644020
今天研究了一下如何为Visual Studio 2008的类添加版权信息。
1. 打开路径 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplatesCache\CSharp\Code\2052(虽然我的VS安装在E盘，但是模板文件却是在C盘)。
在2052文件夹，会看到很多模板
![](http://hi.csdn.net/attachment/201107/29/0_13119215988TJX.gif)
其中Class.zip是类模板，InterFace.zip是接口模板，下面我们以类模板为例修改模板。
我不知道其他人VS2008下面的Class.zip是以文件夹形式存在，还是以压缩文件的形式存在的？
我的是以文件夹形式存在的，如果你的是以压缩文件形式存在，请参考下面的文章。
[http://www.cnblogs.com/zhangqqshuo/archive/2011/03/24/1994045.html](http://www.cnblogs.com/zhangqqshuo/archive/2011/03/24/1994045.html)
然后，你需要双击里面的Class.cs文件。
![](http://hi.csdn.net/attachment/201107/29/0_1311920896Xp34.gif)
这时Class.cs会自动被VS2008打开。
（注意：不要用其他编辑器打开编辑，我在这里就遇到过问题，我开始是用UltraEdit打开编辑的，但是保存后却没有效果，后来发现用VS2008打开的时候，UltraEdit编辑的内容无法显示出来，才知道问题出在这儿了！）
在你想加入版权信息的地方加入版权信息，然后保存。
![](http://hi.csdn.net/attachment/201107/29/0_1311921175CczG.gif)
但是你会发现弹出一个“另存为"的对话框，不能直接保存原文件。
![](http://hi.csdn.net/attachment/201107/29/0_1311921432RMwb.gif)
这时你可以将修改的Class.cs文件保存在硬盘的其他地方，如桌面，然后再将桌面上的Class.cs文件复制到2052文件夹下替换原有的文件。
替换成功后，你再用VS2008新建类时，就会在新类里自动添加版权信息了，截图如下：
![](http://hi.csdn.net/attachment/201107/29/0_1311921875aFnz.gif)

在添加页面时候让文件自动添加版权信息
注意，在运行注册命令的时候需要关闭所有打开的VS2010开发工具，否则可能会有意想不到的效果。
进入模板目录C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\。
C#的模板是CSharp\Code\1033\Class.zip和Interface.zip这2个压缩包，1033是英文版，中文版是2052；
可以根据需要对此文件夹下对应模板进行修改.
我需要该的是Web项目 所以吧WebForm.zip下面的Default.aspx.cs
或
C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplatesCache\CSharp\Windows Forms\2052\Form.zip
改的是Windows Forms
插入版权信息,代码如下
//======================================================================
//
//        Copyright (C) 2008-2009 CUIT-408. All rights reserved.
//
//        CLR Version: $clrversion$
//        NameSpace: $rootnamespace$
//        FileName: $safeitemname$
//
//        Created by Benjamin at $time$
//        http://blog.csdn.com/TBenjamin
//
//======================================================================
using System;
using System.Collections;
using System.Configuration;
using System.Data;
$if$ ($targetframeworkversion$ == 3.5)using System.Linq;
$endif$using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
$if$ ($targetframeworkversion$ == 3.5)using System.Xml.Linq;
$endif$
namespace $rootnamespace$
{
    public partial class $classname$ : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
        }
    }
}
完成后保存.以后在Web项目添加新页面时候，页面后台代码最前端都会出现一下添加的版权信息，呵呵
//====================================================================== 
// 
// Copyright (C) 2008-2009 CUIT-408. All rights reserved. 
// 
// CLR Version: 2.0.50727.1433 
// NameSpace: WebApplication
// FileName: WebForm
// 
// Created by ZYD at 2011-9-6 15:29:05 
// [http://hi.baidu.com/zydpc](http://hi.baidu.com/zydpc)
//====================================================================== 
//======================================================================
//
// Copyright (C) 2008-2009 CUIT-408. All rights reserved.
//
// CLR Version: 2.0.50727.1433
// NameSpace: WebApplication
// FileName: WebForm
//
// Created by ZYD at 2011-9-6 15:29:05
//[http://hi.baidu.com/zydpc](http://hi.baidu.com/zydpc)
//
//======================================================================
**参数**描述
|Parameter|说明|
|----|----|
|clrversion|公共语言运行时 (CLR) 的当前版本。|
|GUID [1-10]|用于替换项目文件中的项目 GUID 的 GUID。 <span id="mt20" class="sentence" data-guid="496e67ee5856defb304ddf191ba41dba" data-source="You can specify up to 10 unique GUIDs (for example, <span>最多可以指定 10 个唯一的 GUID（例如，<span xmlns=" http:="" www.w3.="" org="" 1999="" xhtml"="" style="margin: 0px; padding: 0px; font-family: monospace, 'Courier New', Courier; font-size: 14px; color: rgb(0, 0, 102);">guid1)）。|
|itemname|用户在添加新项对话框中提供的名称。|
|machinename|当前的计算机名称（例如，Computer01）。|
|projectname|用户在新建项目对话框中提供的名称。|
|registeredorganization|HKLM\Software\Microsoft\Windows NT\CurrentVersion\RegisteredOrganization 中的注册表项值。|
|rootnamespace|当前项目的根命名空间。此参数用于仅在要添加到项目中的项中替换命名空间。|
|safeitemname|用户在“添加新项”对话框中提供的名称，名称中移除了所有不安全的字符和空格。|
|safeprojectname|用户在“新建项目”对话框中提供的名称，名称中移除了所有不安全的字符和空格。|
|time|以 DD/MM/YYYY 00:00:00 格式表示的当前时间。|
|userdomain|当前的用户域。|
|username|当前的用户名。|
|webnamespace|当前网站的名称。在 Web 窗体模板中使用此参数以确保类名称是唯一的。如果网站位于 Web 服务器的根目录下，则此模板参数将解析为 Web 服务器的根目录。|
|year|以 YYYY 格式表示的当前年份。|
注意：模板参数是大小写敏感的！ 
===========================================================================
**二。**
程序注释的重要性毋庸置疑，一个大型的项目通常情况下都是几个软件工程师合作出来的成果，假如该项目中的代码注释不全，那会给将来的维护者带来无穷无尽的隐患。
通用的办法是给自己工程里面的函数添加注释——使用宏。
1.打开Visual Studio 2008(2005一样适用)开发工具，单击“工具→宏→新建宏项目”，然后按照步骤建立注释宏，添加如下代码并保存。
2.打开 菜单 –> 工具–>选项 –> 键盘 ，在列表框中选择刚才添加的Macro，然后在 按快捷键中输入快捷键，点击”分配” 。
注释宏的代码如下：
Sub AddFunComment()
Dim DocSel As EnvDTE.TextSelection
DocSel = DTE.ActiveDocument.Selection
DocSel.NewLine()
DocSel.Text ="/*******************************************************************"
DocSel.NewLine()
DocSel.Text ="* 函数名称："
DocSel.NewLine()
DocSel.Text ="* 功 能："
DocSel.NewLine()
DocSel.Text ="* 参 数："
DocSel.NewLine()
DocSel.Text ="* 返 回 值："
DocSel.NewLine()
DocSel.Text ="* 作 者： ZYD"
DocSel.NewLine()
DocSel.Text ="* 博 客： [www.baidu.com](http://www.baidu.com/)"
DocSel.NewLine()
DocSel.Text ="* 电子邮箱："
DocSel.NewLine()
DocSel.Text ="* 日 期："+ System.DateTime.Now.ToLongDateString()
DocSel.NewLine()
DocSel.Text ="*******************************************************************/"
End Sub
很简单的就完成了。大家也快点去把自己的编辑器添加注释模板吧！
