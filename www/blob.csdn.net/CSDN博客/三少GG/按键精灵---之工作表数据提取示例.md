# 按键精灵---之工作表数据提取示例 - 三少GG - CSDN博客
2010年05月08日 14:35:00[三少GG](https://me.csdn.net/scut1135)阅读数：4337
# 1.[http://bbs.yyvcr.cn/read.php?tid=29](http://bbs.yyvcr.cn/read.php?tid=29)
# 工作表数据提取示例(按键精灵版) 条件是这样的：在d:/盘下有工作表"1.xls"，里面记录了一些用户的资料：姓名和密码。现在我，我们需要在软件或者网页上提交登陆。用途：可以把你所有的QQ号码登陆一遍，或者邮箱等等。如果在加上对应的验证码识别脚本，就可以成为网页注册机，暴力破解帐户的工具。
复制代码
-  //建立对象 
- Set xlApp=CreateObject("Excel.Application") 
- //这里是前台运行，不可见用False 
- xlApp.Visible = True 
- Set xlBook = xlApp.Workbooks.Open("d:/1.xls") 
- Set xlSheet = xlBook.ActiveSheet 
- //最小化 
- xlApp.WindowState = -4140 
- Delay 2000 
- VBS dim i,j,a,b 
- VBS i=1:j=1 
- Rem [循环提交] 
- //*下面开始读一行,2个单元格(第一次就是1A,1B) 
- If Len(xlSheet.cells(j,i).value)=0 
-      //判断有无数据,没就退出 
-      Goto [没数据了] 
- EndIf 
- VBS a=xlSheet.cells(j,i).value 
- VBS b=xlSheet.cells(j,i+1).value 
- //如果你要C格的数据,就是xlSheet.cells(j,i+2).value 再多同理 
-   Delay 10 
- VBS j=j+1 
- //*一行的两个数据读完,a是姓名,b是密码。下面你可以直接用输入变量：a b 
- //------这里接你需要到网页提交的身份证和姓名，如果想示范结果就是下面这句 
- MessageBox "a"&j&":"&a&"   b"&j&":"&b 
- //交完后,下面的语句就又开始下一个数据读取再输出 
- Goto [循环提交] 
- Rem [没数据了] 
- VBS xlApp.quit 
- //关闭工作表 
- VBS Set xlApp=Nothing 
- //释放对象 
网上参照VBS的代码基本有以下这些，如遗漏请跟帖指正！谢谢
> 
Set oExcel= CreateObject("excel.application") 
oExcel.Visible = True  //Excel是否可视，若赋值为True则可视，但速度会慢得多 
oExcel.Workbooks.Add 
Set oSheet = oExcel.Workbooks(1).Worksheets("sheet1") 
oSheet.Activate 
  oSheet.Cells(1, 1) = 1 
  oSheet.Cells(1, 2) = 2 
  oSheet.Cells(1, 3) = "=SUM(A1:B1)" 
  oSheet.Cells(1, 4) = "=AVERAGE(A1:B1)" 
Set oExcel = Nothing
VBS控制Excel的一些常见方法：
(一) 使用动态创建的方法
首先创建 Excel 对象，使用ComObj:
oExcel = CreateObject( "Excel.Application" )
1) 显示当前窗口： 
oExcel.Visible = True
2) 更改 Excel 标题栏： 
oExcel.Caption = "应用程序调用 Microsoft Excel"
3) 添加新工作簿： 
oExcel.WorkBooks.Add
4) 打开已存在的工作簿： 
oExcel.WorkBooks.Open( "C:/Excel/Demo.xls" )
5) 设置第2个工作表为活动工作表： 
oExcel.WorkSheets(2).Activate 
或 
oExcel.WorksSheets( "Sheet2" ).Activate
6) 给单元格赋值： 
oExcel.Cells(1,4).Value = "第一行第四列"
7) 设置指定列的宽度（单位：字符个数），以第一列为例： 
oExcel.ActiveSheet.Columns(1).ColumnsWidth = 5
8) 设置指定行的高度（单位：磅）（1磅＝0.035厘米），以第二行为例： 
oExcel.ActiveSheet.Rows(2).RowHeight = 1/0.035 ' 1厘米
9) 在第8行之前插入分页符： 
oExcel.WorkSheets(1).Rows(8).PageBreak = 1
10) 在第8列之前删除分页符： 
oExcel.ActiveSheet.Columns(4).PageBreak = 0
11) 指定边框线宽度： 
oExcel.ActiveSheet.Range( "B3:D4" ).Borders(2).Weight = 3 
1-左 2-右 3-顶 4-底 5-斜( / ) 6-斜( / )
12) 清除第一行第四列单元格公式： 
oExcel.ActiveSheet.Cells(1,4).ClearContents
13) 设置第一行字体属性： 
oExcel.ActiveSheet.Rows(1).Font.Name = "隶书" 
oExcel.ActiveSheet.Rows(1).Font.Color = clBlue 
oExcel.ActiveSheet.Rows(1).Font.Bold = True 
oExcel.ActiveSheet.Rows(1).Font.UnderLine = True
14) 进行页面设置：
a.页眉： 
oExcel.ActiveSheet.PageSetup.CenterHeader = "报表演示" 
b.页脚： 
oExcel.ActiveSheet.PageSetup.CenterFooter = "第&P页" 
c.页眉到顶端边距2cm： 
oExcel.ActiveSheet.PageSetup.HeaderMargin = 2/0.035 
d.页脚到底端边距3cm： 
oExcel.ActiveSheet.PageSetup.HeaderMargin = 3/0.035 
e.顶边距2cm： 
oExcel.ActiveSheet.PageSetup.TopMargin = 2/0.035 
f.底边距2cm： 
oExcel.ActiveSheet.PageSetup.BottomMargin = 2/0.035 
g.左边距2cm： 
oExcel.ActiveSheet.PageSetup.LeftMargin = 2/0.035 
h.右边距2cm： 
oExcel.ActiveSheet.PageSetup.RightMargin = 2/0.035 
i.页面水平居中： 
oExcel.ActiveSheet.PageSetup.CenterHorizontally = 2/0.035 
j.页面垂直居中： 
oExcel.ActiveSheet.PageSetup.CenterVertically = 2/0.035 
k.打印单元格网线： 
oExcel.ActiveSheet.PageSetup.PrintGridLines = True
15) 拷贝操作：
a.拷贝整个工作表： 
oExcel.ActiveSheet.Used.Range.Copy 
b.拷贝指定区域： 
oExcel.ActiveSheet.Range( "A1:E2" ).Copy 
c.从A1位置开始粘贴： 
oExcel.ActiveSheet.Range.( "A1" ).PasteSpecial 
d.从文件尾部开始粘贴： 
oExcel.ActiveSheet.Range.PasteSpecial 
e.复制 
oExcel.cells(1,2).copy 
f.粘贴 
oExcel.cells(1,4).PasteSpecial
16) 插入一行或一列： 
a. oExcel.ActiveSheet.Rows(2).Insert 
b. oExcel.ActiveSheet.Columns(1).Insert
17) 删除一行或一列： 
a. oExcel.ActiveSheet.Rows(2).Delete 
b. oExcel.ActiveSheet.Columns(1).Delete
18) 打印预览工作表： 
oExcel.ActiveSheet.PrintPreview
19) 打印输出工作表： 
oExcel.ActiveSheet.PrintOut
20) 工作表保存： 
if not oExcel.ActiveWorkBook.Saved then 
oExcel.ActiveSheet.PrintPreview
21) 工作表另存为： 
oExcel.SaveAs( "C:/Excel/Demo1.xls" )
22) 放弃存盘： 
oExcel.ActiveWorkBook.Saved = True
23) 关闭工作簿： 
oExcel.WorkBooks.Close
24) 退出 Excel： 
oExcel.Quit
(二) 使用VBS 控制Excle二维图
1）选择当第一个工作薄第一个工作表 
set oSheet=oExcel.Workbooks(1).Worksheets(1)
2）增加一个二维图 
achart=oSheet.chartobjects.add(100,100,200,200)
3）选择二维图的形态 
achart.chart.charttype=4
4）给二维图赋值 
set series=achart.chart.seriescollection 
range="sheet1!r2c3:r3c9" 
series.add range,true
5）加上二维图的标题 
achart.Chart.HasTitle=True 
achart.Chart.ChartTitle.Characters.Text=" Excle二维图"
6）改变二维图的标题字体大小 
achart.Chart.ChartTitle.Font.size=18
7）给二维图加下标说明 
achart.Chart.Axes(xlCategory, xlPrimary).HasTitle = True 
achart.Chart.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = "下标说明"
8）给二维图加左标说明 
achart.Chart.Axes(xlValue, xlPrimary).HasTitle = True 
achart.Chart.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = "左标说明"
9）给二维图加右标说明 
achart.Chart.Axes(xlValue, xlSecondary).HasTitle = True 
achart.Chart.Axes(xlValue, xlSecondary).AxisTitle.Characters.Text = "右标说明"
10）改变二维图的显示区大小 
achart.Chart.PlotArea.Left = 5 
achart.Chart.PlotArea.Width = 223 
achart.Chart.PlotArea.Height = 108
**2. [http://www.wentiku.net/k4662547/](http://www.wentiku.net/k4662547/)**
### 网页按键精灵怎么获取网页上的文本
### 小弟初学按键精灵 想获取百度mp3中那一列的歌曲名 图片已标注（地址是：[http://list.mp3.baidu.com/list/bangping.html?id=1](http://list.mp3.baidu.com/list/bangping.html?id=1) ） 不知道怎么写代码能获取 请好心大侠帮助小弟写一下 小弟不胜感激
###  答案1 
//得到WQM进程句柄Plugin
PID=Web.Bind("wqm.exe")//打开一个网页地址连接Plugin
Web.Go([http://list.mp3.baidu.com/list/bangping.html?id=1](http://list.mp3.baidu.com/list/bangping.html?id=1))
Rem zpd
Delay 300
Plugin gs=Web.HtmlExists("tag:A&txt:MP3首页")
If gs=0
Goto zpd
Else
EndIf
//获得一个网页元素信息内容
Plugin t1=Web.HtmlGet("html","tag:A&txt:闪闪惹人爱")//获得一个网页元素信息内容
Plugin t2=Web.HtmlGet("html","tag:A&txt:白白的")//获得一个网页元素信息内容
Plugin t3=Web.HtmlGet("html","tag:A&txt:敢不敢爱")//获得一个网页元素信息内容
Plugin t4=Web.HtmlGet("html","tag:A&txt:看得最远的地方")//获得一个网页元素信息内容
Plugin t5=Web.HtmlGet("html","tag:A&txt:风声")//获得一个网页元素信息内容Plugin t6=Web.HtmlGet("html","tag:A&txt:木兰星")//获得一个网页元素信息内容
Plugin t7=Web.HtmlGet("html","tag:A&txt:只需要一首歌")//获得一个网页元素信息内容
Plugin t8=Web.HtmlGet("html","tag:A&txt:心的距离")//获得一个网页元素信息内容
Plugin t9=Web.HtmlGet("html","tag:A&txt:满满")//获得一个网页元素信息内容Plugin t10=Web.HtmlGet("html","tag:A&txt:我在桥上看风景")
msgbox
"第一首歌为→"&T1&Vbcrlf&"第二首歌为→"&T2&Vbcrlf&"第三首歌为→"&T3&Vbcrlf&"第四首歌为→"&T4&Vbcrlf&"第五首歌为→"&T5&Vbcrlf&"第六首歌为→"&T6&Vbcrlf&"第七首歌为→"&T7&Vbcrlf&"第八首歌为→"&T8&Vbcrlf&"第九首歌为→"&T9&Vbcrlf&"第十首歌为→"&T10
//我可以告诉你
只要例表更新也许就不可以用了
3. [http://wenwen.soso.com/z/q161142292.htm](http://wenwen.soso.com/z/q161142292.htm)
### 按键精灵发送信息 为何TEXT接收不到消息
//--------------------Script Start--------------------
Delay 1500
Plugin a=Window.MousePoint()
//-- 运行前先指定要接收文本的窗口,
//-- 因为打开"联系方式"的时候 鼠标指向激活窗体会改变.
Plugin Web.Bind("wqm.exe")
Plugin Web.Tips("Script Start.")
Plugin Web.Go("page.china.alibaba.com/cp/cp1.html")
//* Delay 3000
//-- Web.Go 是阻塞超过.网页打开完成才会继续执行.
//-- 所以不需要延时.
Plugin Web.HtmlInput("五金","id:search-input")
Delay 1000
Plugin Web.HtmlClick("id:s-gs")
Delay 6000
Plugin Href=Web.HtmlGet("href","tag:A&txt:联系方式")
Plugin Web.Go(Href)
//-- 这里获取链接.用Web.Go 因为HtmlClick 的需要延时.
Plugin Text=Web.HtmlGet("text","id:contact_column")
Delay 1000
//-- HtmlInput HtmlGet 在数据量小的时候延时1秒足够了.
Text=Replace(Text,"?","") : Text=Replace(Text,"联系方式","") : Text=Replace(Text,"查看更多资料","")
Text=Replace(Text,"手机在线","") : Textx=Replace(Text,"在线洽谈","") : Text=Replace(Text,"旺旺留言 ","")
Text=Trim(Text)
//-- 如上.还可以用VBS的字符串函数格式化输出.
Plugin Window.SendString(a,Text&Chr(13))
//-- Chr(13)表示换行符.可以和文本连接发送.不需要Window.SendKeyPress.
Plugin Web.Tips(" End Script.")
Plugin Window.Active(a)
//-------------------- End Script -----------紫枫-----
//-- WinXP SP3 按键精灵7.12.5013(免费版)
