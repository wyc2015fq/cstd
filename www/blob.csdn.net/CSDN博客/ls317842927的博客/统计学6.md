# 统计学6 - ls317842927的博客 - CSDN博客





2017年02月09日 15:42:39[ls317842927](https://me.csdn.net/ls317842927)阅读数：298








假设检验

统计推断的基本问题可以分为两大类，一类是**参数估计**问题，另一类是**假设检验**问题。

精神学家用老鼠测试一种药物的反应时间的效果，已知没有注射药物的老鼠平均反应时间是1.2秒，100只注射了药物的老鼠平均反应时间是1.05秒，样本标准差是0.5秒，你认为药物对反应时间有效果吗？

这里需要建立两个假设，第一个假设是零假设$H_{0}$：药物对反应时间无效果，也就是注射了药物的老鼠平均反应时间$\mu$=1.2秒。第二个是备择假设$H_{1}$：药物有效果，$\mu \neq$1.2秒。假设零假设是正确的，我们得到这个样本（均值1.05，标准差0.5）的概率是多少，如果该概率非常非常小，就可以认为零假设不对，拒绝零假设，选择备择假设。

首先考虑抽样分布，是一个正态分布。假设零假设是正确的，则抽样分布的均值$\mu_{\bar{x}}$将等于总体均值1.2秒，抽样分布标准差$\sigma_{\bar{x}}=\frac{\sigma}{\sqrt{100}} \approx \frac{S}{\sqrt{100}} =0.05$。 

再想得到1.05秒的概率是多少或者说1.05秒离抽样分布均值$\mu_{\bar{x}}$有多少个标准差远，z=(1.2-1.05)/0.05=3。 

得到距离抽样分布均值有3个标准差远甚至更远的极端情况，概率有多少，1-99.7%=0.3%。 

假设零假设是正确的，得到的这种极端情况的概率只有0.3%，因此虽然不是100%确信，也选择备择假设。
很多论文中，**得到零假设中这种极端情况的概率称作p值**。在这里p值是0.003。p值非常非常小，所以拒绝零假设。通常人们会制定一个门槛，比如门槛设在5%，如果p值小于5%，就拒绝假设。

单侧检验和双侧检验

零假设表示用药前后没有区别，备择假设说明用药有效，不管是增加还是减少反应时间都认为有效，这称作**双侧检验**。就算很高的反应时间，比如超过3个标准差的响应时间，也会导致拒绝零假设。

![这里写图片描述](https://img-blog.csdn.net/20170209192024577?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHMzMTc4NDI5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

类似地，可以进行一个单侧检验。零假设$H_{0}$：药物对反应时间无效果，$\mu$=1.2秒。备择假设$H_{1}$：药物有减少时间效果，$\mu $<1.2秒。 

考虑抽样分布，1.05秒在抽样分布均值$\mu_{\bar{x}}$左侧3个标准差远。假设零假设是正确的，得到的结果低于1.05秒的概率是0.15%。p值是0.0015，接受备择假设。

z统计量 vs t统计量

考虑样本均值的抽样分布 
![这里写图片描述](https://img-blog.csdn.net/20170209202109999?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHMzMTc4NDI5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

z统计量由样本均值统计量推导而出，$z=\frac{\bar{x}-\mu _{\bar{x}}}{\sigma_{\bar{x}} }=\frac{\bar{x}-\mu _{\bar{x}}}{\frac{\sigma}{\sqrt{n}} } \approx \frac{\bar{x}-\mu _{\bar{x}}}{\frac{S}{\sqrt{n}} }$(n> 30)。然后我们可以查z表格或者说正态分布表格。可以认为n> 30时，样本均值的抽样分布服从正态分布。z统计量服从标准正态分布N(0，1)。
但如果样本容量小于30，样本标准差S不是总体标准差$\sigma$的很好估计，样本均值的抽样分布就服从t分布。$t= \frac{\bar{x}-\mu _{\bar{x}}}{\frac{S}{\sqrt{n}} }$(n< 30)。t统计量服从标准t分布，均值是0。此时查t表格。

第一型错误

第一型错误是说，拒绝了正确的零假设。一般而言，假设检验从零假设成立出发，那么均值等于某个值，然后有一个z或t统计量来检验零假设是否成立。假设我们的门槛是1%，而样本均值处在0.5%，也就是说零假设成立只有0.5%的几率，p值=0.5%。因为0.5%<1%，所以我们拒绝零假设。

![这里写图片描述](https://img-blog.csdn.net/20170209214422476?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHMzMTc4NDI5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

可以理解为，拒绝零假设有0.5%的几率犯第一型错误（实际零假设正确），因为零假设仍有0.5%的几率确实成立。 
**显著性水平**相当于是给事件假设检验中设立一个“门槛”，一般有1%，5%，10%，数值的升高会让犯第一类错误的概率有变动。

小样本假设检验

根据新排放要求，引擎排放均值应低于百万分之20。10台引擎制造出来供测试使用，每台排放水平如下 15.6，16.2，22.5，20.5，16.4，19.4，16.6，17.9，12.7，13.9。问这些数据能否支撑该型引擎满足新标准的结论，假设愿意冒0.01的概率犯第一型错误的风险。

计算出10台引擎的均值$\bar{X}$=17.17，标准差是S=2.98。 

定义零假设$H_{0}$：刚好不满足标准，$\mu$=20 

备择假设$H_{1}$：满足标准，$\mu$<20 

假设零假设成立，如果样本均值为17.17的概率小于1%，我们就拒绝零假设。此时得到第一型错误（拒绝正确的零假设）的概率小于1%。 

只有10个样本(n= 10)，考虑使用t分布和t统计量。$t= \frac{17.17-20}{\frac{2.98}{\sqrt{10}} }=-3$。 

想知道t统计量小于等于-3的概率是否小于1%，t统计量服从标准t分布，我们可以找概率为1%的t统计量是多少，查t表格，得到-2.821，也就是说t值小于-2.821的概率是1%。-3<-2.821，所以拒绝零假设，而且犯第一型错误的概率小于1%。 
![这里写图片描述](https://img-blog.csdn.net/20170210094314833?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHMzMTc4NDI5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
还是上述的题设，求95%置信区间。 

求95%的t值所落区间,考虑t统计量服从标准t分布，查t表格求出临界t值为2.262。 
![这里写图片描述](https://img-blog.csdn.net/20170210100138637?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHMzMTc4NDI5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
-2.262< t =$ \frac{17.17-\mu}{\frac{2.98}{\sqrt{10}} }$ <2.262。

所以95%置信区间是$17.17\pm2.262 \times \frac{2.98}{\sqrt{10}} $，即19.3>$\mu$>15.04。

大样本占比假设检验

我们要检验一个假设，即超过30%的美国家庭拥有互联网，显著性水平5%。采集了150个家庭作为样本，结果57家有互联网。 

定义零假设：检验不正确，$p\leq  30 $% 

定义备择假设：$p> 30$% 

这里要求的是样本占比达到$\bar{p}$=57/150=0.38的概率，如果低于5%，则拒绝零假设。
假设零假设是正确的，总体均值$\mu$或者总体占比p（伯努利分布中$\mu$=p）使得到$\bar{p}$=0.38的概率最大，所以零假设是正确的条件下，总体均值=p=0.3，总体标准差=$\sqrt{0.3*0.7}$。——**原分布是伯努利分布**

任意多次取得150容量的样本，其接入互联网的样本占比可以得到二项分布，如果样本数量很多，达到np>5，则可以近似为正态分布（中心极限定理）。此正态分布的样本占比均值$\mu_{\bar{p}}$等于总体均值0.3，样本占比标准差$\sigma_{\bar{p}}$=零假设下的总体标准差$\sigma$/$\sqrt{150}$=$\frac{\sqrt{0.3*0.7}}{\sqrt{150}}$=0.037。——**样本占比的抽样分布近似于正态分布**

z=$\frac{\bar{p}-\mu_{\bar{p}}}{\sigma_{\bar{p}}}$=$\frac{0.38-0.3}{0.037}$=2.14，这里是单侧检验，查表得右侧尾部概率是5%的z值是1.65，因为2.14>1.65，所以2.14处的概率小于5%，拒绝零假设。根据z=2.14还可以求得p值。








