# (provider: Named Pipes Provider, error: 40 - 无法打开到 SQL Server 的连接)？----本人备注 - xqhrs232的专栏 - CSDN博客
2017年10月18日 17:24:37[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：1392
原文地址::[https://zhidao.baidu.com/question/1864689364603118267.html](https://zhidao.baidu.com/question/1864689364603118267.html)
相关文章
1、解决：provider:Named Pipes Provider error:40无法打开SQL Server的连接----[http://blog.csdn.net/qb164070/article/details/8155429](http://blog.csdn.net/qb164070/article/details/8155429)
2、SQL2005 provider: 命名管道提供程序
 error: 40 无法打开到 SQL Server 的连接----[http://www.jb51.net/article/59311.htm](http://www.jb51.net/article/59311.htm)
3、[请验证实例名称是否正确并且
 SQL Server 已配置为允许远程连接。 (provider: Named Pipes Provider, error: 40 - 无法打开到 SQL Server 的连接)](http://www.cnblogs.com/sdusrz/p/3965020.html)----[http://www.cnblogs.com/sdusrz/p/3965020.html](http://www.cnblogs.com/sdusrz/p/3965020.html)
4、连接sql server2008报错:(provider:命名管道提供程序,error:40-无法打开到SQL Server的连接)----[http://bbs.csdn.net/topics/390319794](http://bbs.csdn.net/topics/390319794)
[SQL](https://www.baidu.com/s?wd=SQL&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)[Server](https://www.baidu.com/s?wd=Server&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs) Configuration Manager  里
[TCP/IP](https://www.baidu.com/s?wd=TCP%2FIP&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs) 开启   →  启用
还不行，参照 来自[博客园](https://www.baidu.com/s?wd=%E5%8D%9A%E5%AE%A2%E5%9B%AD&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)qingshansima的文章：
1. 确保[服务器端](https://www.baidu.com/s?wd=%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)的数据库中存在sa,并支持混合登录模式.默认安装的时候,可能会忽略建立sa. 
    2. 确保[服务器端](https://www.baidu.com/s?wd=%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)的数据库是支持[远程调用](https://www.baidu.com/s?wd=%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)的.打开[SQL](https://www.baidu.com/s?wd=SQL&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)[Server](https://www.baidu.com/s?wd=Server&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs) Management Studio,选择该数据库,右键菜单"Properties",在打开的对话框中选择Connections,把Allow remote connections to this [server](https://www.baidu.com/s?wd=server&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)选上. 
    3. 确保[服务器端](https://www.baidu.com/s?wd=%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)的[SQL](https://www.baidu.com/s?wd=SQL&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)服务的[TCP/IP](https://www.baidu.com/s?wd=TCP%2FIP&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)是Enable的.打开SQL Server Configuration Manager. 选择SQL Server [2005](https://www.baidu.com/s?wd=2005&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs) Network Configuration下的Protocols for SQL[2005](https://www.baidu.com/s?wd=2005&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)( 我安装的SQL示例名为SQL[2005](https://www.baidu.com/s?wd=2005&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)), 把Named Pipes和[TCP/IP](https://www.baidu.com/s?wd=TCP%2FIP&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)都修改为Enabled,默认是Disabled.     
    4. 确保服务器端的SQL实例的[远程调用](https://www.baidu.com/s?wd=%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)是支持TIP/IP和named pipes的. 打开SQL Server Surface Area Configuration Manager,在打开的页面中选择Surface Area Configuration for Services and Connections.选中实例的Remote Connections,把Using both TCP/IP and named pipes选中.     
    5. 重启服务器端的SQL Server 2005服务,确保SQL Server Agent和SQL Server Browser的服务也启动了. 默认都是需要手动启动,可以改成Automatic.   
    6. 因为服务器端的[操作系统](https://www.baidu.com/s?wd=%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)是WinXp+SP2,所以还需要检查防火墙.确保防火墙中的[1433端口](https://www.baidu.com/s?wd=1433%E7%AB%AF%E5%8F%A3&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)打开了. 
    另外, SQL Server 2005的默认端口可能不是1433. 我们需要手动修改一下. 打开SQL Server Configuration Manager. 选择SQL Server 2005 Network Configuration下的Protocols for SQL2005( 我安装的SQL示例名为SQL2005), 查看TCP/IP的属性.在打开的对话框中选择IP Address, 把到IPAll下的TCP Dymanic Ports改为0,TCP Port的值修改为1433. 
    在[Windows防火墙](https://www.baidu.com/s?wd=Windows%E9%98%B2%E7%81%AB%E5%A2%99&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PAPhnj6sPj9hmvckPhnk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnH6vPjm3rHnvPjmsn1DkrjcvPs)中的Exceptions中Add Port:TCP 1433和UDP 1434, 同时还需要Add Program.先打开SQL Server Configuration Manager,在SQL Server 2005 Services中选中SQL Server,查看属性,在Advanced中记下Instance ID.如(MSSQL.1) 
    在防火墙的Exceptions中Add Program,找到诸如.../Microsoft SQL Server/MSSQL.1/MSSQL/Binn/sqlservr.exe,添加. 
    所有这些都做完了,客户端应该就可以访问了,最好客户端也在自己的Configration Manager的Client Configuration中设置TCP/IP为Enabled.
//==============================================================================================
备注::
1、SQL Server Configuration Manager通过127.0.0.1访问不了数据
    //1111----修改数据库实例协议的端口-----TCP/IP----属性----IPALL----TCP端口指定1433
----SQL Native Client 10.0配置----客户端协议----tcp/ip----属性----默认端口1433
    //2222----SQL Server Configuration Manager里面重新启动数据库实例
    //3333----再使用SQL Server Management Studio重连----指定使用127.0.0.1

