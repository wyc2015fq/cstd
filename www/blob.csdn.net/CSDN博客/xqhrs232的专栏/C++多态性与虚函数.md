# C++多态性与虚函数 - xqhrs232的专栏 - CSDN博客
2010年02月22日 16:59:00[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：795标签：[c++																[table																[class																[2010																[c](https://so.csdn.net/so/search/s.do?q=c&t=blog)](https://so.csdn.net/so/search/s.do?q=2010&t=blog)](https://so.csdn.net/so/search/s.do?q=class&t=blog)](https://so.csdn.net/so/search/s.do?q=table&t=blog)](https://so.csdn.net/so/search/s.do?q=c++&t=blog)
个人分类：[C/C++/VC++/VS](https://blog.csdn.net/xqhrs232/article/category/906934)
原文地址::http://blog.21ic.com/user1/6121/archives/2010/66771.html
多态性与虚函数
1.多态性polymorphism:在C++中多态性是指具有不同功能的函数可以用同一个函数名,这样就可以用一个函数名调用不同内容的函数。
2.在面向对象方法中一般是这样表述多态性的:向不同的对象发送同一个消息,不同的对象在接收时会产生不同的行为(即方法).也就是说,每个对象可以用自己的方式去响应共同的消息。
3.所谓消息,就是调用函数。
4.不同的行为:就是指不同的实现,即执行不同的函数。
5.从系统实现的角度看,多态性分为两类:静态多态性和动态多态性。
6.静态多态性:是通过函数的重载实现的(如函数重载和运算符重载的实现)。
7.动态多态性:是通过虚函数(virtual )实现的。
8.多态性是"一个接口,多种方法"。
9.虚函数的作用:是允许在派生类中重新定义与基类同名的函数,并且可以通过基类指针或引用来访问基类和派生类中的同名函数。
10.虚函数的使用方法：
10.1:在基类用virtual声明为成员函数为虚函数。这样就可以在派生类中重新定义此函数,为它赋予新的功能,并能方便地被调用。在类外定义虚函数时,不必再加virtual.
10.2:在派生类中重新定义此函数,要求函数名、函数类型、函数参数个数和类型全部与基类的虚函数相同,并根据派生类的需要重新定义函数体。(C++规定,当一个成员函数被声明为虚函数后,其派生类中的同名函数都自动为虚函数。因此在派生类重新声明该虚函数时,可以加virtual,也可以不加,但习惯上一般在每一层声明该函数时都加virtual,使程序更加清晰)。
10.3定义一个指向基类对象的指针变量,并使它指向同一类族中需要调用该函数的对象。
10.4通过该指针变量调用些虚函数,此时调用的就是指针变量指赂的对象的同名函数。(通过虚函数与指向基类对象的指针变量的配合使用,就可以方便地调用同一类族中不同类的同名函数,只要先用基类指名指向即可).
11.有时在基类中定义的非虚函数会在派生中被重新定义:
11.1如果用基类指针调用该成员函数,则系统会调用对象中基类部分的成员函数;
11.2如果用派生类指针调用该成员函数,则系统会调用派生类对象中的成员函数;
11.3这并不是多态性行为(使用的是不同类型的指针),没有用到虚函数的功能.
12.函数重载处理与虚函数处理的不同点:
12.1函数理载处理的是同一层次的同名函数;横向重载.
12.2虚函数处理的是不同派生层次上的同名函数问题;纵赂重载.
12.3同一类族的虚函数的首部是相同的.
12.3函数重载时函数的首部是不同的(参数个娄或类型不同).
13.虚函数,系统有一定的空间开销.当一个类带有虚函数时,编译系统会为该类构造一个虚函数表(virtual table,简称vtable),它是一个指针数组,存放每个虚函数的入口地址.系统在进行动态关联时的时间开销是很少的,因此,多态性是高效的.
14.虚析构函数:解决撤销对象进,同时执行基类的析构函数及派生类的析构函数。
14.1 定义方法:将基类的析构函数声明为虚析构函数.这样派生类的析构函数也都自动成为虚函数。即使派生类的析构函数与基类的析构函数名字不相同。
14.2 专业人员一般都习惯声明虚析构函数,即使基类并不需要析构函数,也显示地定义一个函数体为空的虚析构函数,以保证在撤销动态分配窨时能得到下确的处理。
15.构造函数不能声明为虚函数。
16.声明纯函数的一般形式是: virtual 函数类型 函数名(参数表列) =0;
16.1:纯虚函数没有函数体;
16.2:最后面的"=0"并不表示函数返回值为0,它只起形式上的作用,告诉编译系统"这是纯虚函数";
16.3:这是一个声明语句,最后应有分号。
16.4:纯虚函数只有函数的名字而不具备函数的功能,不能被调用。
16.5:纯虚数的作用是在基类中为其派生类保留一个函数的名字，以便派生类根据需要对它进行定义。
17:抽象类:不用来定义对象而只作为一种基本类型用作继承的类。由于它常用作基类,通常称为抽象基类(abstract base class)。
17.1:凡是包含纯虚函数的类都是抽象类。包含纯虚函数的类是无法建立对象的。
17.2:抽象类的作用是作为一个类族的共同基类,或者说,为一个类族提供一个公共接口。
17.3:如果在派生类中没有对所有纯虚函数进行定义,则此派生类仍然是抽象类,不能用来定义对象。
17.4:虽然抽象类不能定义对象,但是可以定义指向抽象类数据的指针变量。当派生类成为具体类之后,就可以用这种指针指向派生类对象,然后通过该指针调用虚函数,实现多态性的操作。
