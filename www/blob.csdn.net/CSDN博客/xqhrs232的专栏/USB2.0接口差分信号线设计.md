# USB2.0接口差分信号线设计 - xqhrs232的专栏 - CSDN博客
2011年11月02日 16:43:52[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：1436
原文地址::[http://www.cnblogs.com/jiansiming/archive/2011/10/29/2228459.html](http://www.cnblogs.com/jiansiming/archive/2011/10/29/2228459.html)
[【转】USB2.0接口差分信号线设计](http://www.cnblogs.com/jiansiming/archive/2011/10/29/2228459.html)

**引 言 **通用串行总线(Universal Serial Bus)从诞生发展到今天，USB协议已从1.1过渡到2.0，作为其重要指标的设备传输速度，从1.5 Mbps；的低速和12 Mbps的全速，提高到如今的480 Mbps的高速。USB接口以其速度快、功耗低、支持即插即用、使用安装方便等优点得到了广泛的应用。目前，市场上以USB2.0为接口的产品越来越多，绘制满足USB2.0协议高速数据传输要求的PCB板对产品的性能、可靠性起着极为重要的作用，并能带来明显的经济效益。
USB2．0接口是目前许多高速数据传输设备的首选接口，实践表明：在高速USB主、从设备的研发过程中，正确设计PCB板能充分发挥USB2.0高速性能。但是，若PCB板设计不当，则传输速率可能根本达不到预期目的，甚至会导致高速USB2．0设备只能工作在全速状态。
下面介绍USB2．0设备高速数据传输PCB板设计。
**1 USB2．0接口差分信号线设计**USB2．0协议定义由两根差分信号线(D 、D-)传输高速数字信号，最高的传输速率为480 Mbps。**差分信号线上的差分电压为400 mV**，**差分阻抗(Zdiff)为90(1±O．1)Ω**。在设计PCB板时，控制差分信号线的差分阻抗对高速数字信号的完整性是非常重要的，因为差分阻抗影响差分信号的眼图、信号带宽、信号抖动和信号线上的干扰电压。差分线2D模型如图1所示。
![](http://pic002.cnblogs.com/images/2011/180168/2011102912011217.jpg)
差分线由两根平行绘制在PCB板表层(顶层或底层)发生边缘耦合效应的**微带线(Microstrip)**组成的，其阻抗由两根微带线的阻抗及其和决定，而微带线的阻抗(Zo)由微带线线宽(W)、微带线走线的铜皮厚度(T)、微带线到最近参考平面的距离(H)以及PCB板材料的介电常数(Er)决定，其计算公式为：Zo={87/sqrt(Er 1．41)]}ln[5．98H/(0．8W T)]。影响差分线阻抗的主要参数为微带线阻抗和两根微带线的线间距(S)。**当两根微带线的线间距增加时，差分线的耦合效应减弱，差分阻抗增大；线间距减少时，差分线的耦合效应增强，差分阻抗减小。**差分线阻抗的计算公式为：Zdiff=2Zo（1-0.48exp(-0.96S/H))。**微带线和差分线的计算公式在0.1<W/H<2．0以及0．2<S/H<3．0的情况下成立。**为了获得比较理想的信号质量和传输特性，**高速USB2．0设备要求PCB板的叠层数至少为4层，可以选择的叠层方案为：顶层(信号层)、地层、电源层和底层(信号层)。不推荐在中间层走信号线，以免分割地层和电源层的完整性。**普通PCB板的板厚为1．6
 mm，**信号层上的差分线到最近参考平面的距离H大约为11mil**，**走线的铜皮厚度T大约为O．65mil**，填充材料一般为FR-4，介电常数Er为4．2。在H、T和Er已确定的条件下，由差分线2D阻抗模型以及微带线和差分线阻抗计算公式可以得到合适的线宽W和线间距S。当W=16mil，S=7mil时，Zdiff=87Ω。但通过上述公式来推导合适的走线尺寸的计算过程比较复杂，借助**PCB阻抗控制设计软件Polar**可以很方便的得到合适的结果，由Polar可以得到当W=11mil，S=5mil时，Zdiff=92.2Ω。
在绘制USB2.0设备接口差分线时，应注意以下几点要求：
①在元件布局时，**应将USB2.0芯片放置在离地层最近的信号层，并尽量靠近USB插座，缩短差分线走线距离**。
②**差分线上不应加磁珠或者电容等滤波措施，否则会严重影响差分线的阻抗**。
> 
**看到有USB1.1差分线上串电阻，这合理吗，不解呀！**
③**如果USB2.0接口芯片需串联端电阻或者D 线接上拉电阻时．务必将这些电阻尽可能的靠近芯片放置**。
④将**USB2.0差分信号线布在离地层最近的信号层**。
⑤**在绘制PCB板上其他信号线之前，应完成USB2．0差分线和其他差分线的布线**。
⑥**保持USB2.0差分线下端地层完整性**，如果分割差分线下端的地层，会造成差分线阻抗的不连续性，并会增加外部噪声对差分线的影响。
⑦在USB2．0差分线的布线过程中，应**避免在差分线上放置过孔(via)**，过孔会造成差分线阻抗失调。如果必须要通过放置过孔才能完成差分线的布线，那么应尽量使用小尺寸的过孔，并保持USB2．0差分线在一个信号层上。
⑧保证差分线的线间距在走线过程中的一致性，使用Cadence绘图时可以用shove保证，但在使用Protel绘图时要特别注意。如果在走**线过程中差分线的间距发生改变，会造成差分线阻抗的不连续性**。
⑨在绘制差分线的过程中，使用45°弯角或圆弧弯角来代替90°弯角，并尽量在差分线周围的150 mil范围内不要走其他的信号线，特别是边沿比较陡峭的数字信号线更加要注意其走线不能影响USB差分线。
⑩**差分线要尽量等长，如果两根线长度相差较大时，可以绘制蛇行线增加短线长度**。
> 
**要达成既等长又不让间距发生改变，怎么实现啊？我走蛇形线时只能走一根啊，这一来间距就不等了，郁闷。**
**2 USB2.0总线接口端电源线和地线设计**USB接口有5个端点，分别为：USB电源(VBUS)、D-、D 、信号地(GND)和保护地(SHIELD)。上面已经介绍过如何设计D 、D-差分信号了，正确设计USB总线电源、信号地和保护地对USB系统的正常工作也是同样重要的。
**USB电源线电压为5 V，提供的最大电流为500mA，应将电源线布置在靠近电源层的信号层上，而不是布置在与USB差分线所在的相同层上，线宽应在30 mil以上，以减少它对差分信号线的干扰。**现在很多厂家的USB从控制芯片工作电压为3．3 V，当其工作在总线供电模式时，需要3．3～5 V的电源转换芯片，电源转换芯片的输出端应尽量靠近USB芯片的电压输入端，并且电源转换芯片的输入和输出端都应加大容量电容并联小容量电容进行滤波。当USB从控制芯片工作在自供电的模式时，USB电源线可以串联一个大电阻接到地。
USB接口的信号地应与PCB板上的信号地接触良好，保护地可以放置在PCB板的任何一层上，它和信号地分割开，两个地之间可以用一个大电阻并联一个耐压值较高的电容，如图2所示。
![](http://pic002.cnblogs.com/images/2011/180168/2011102912012845.jpg)
**保护地和信号地之间的间距不应小于25mil，以减少两个地之间的边缘耦合作用。保护地不要大面积覆铜，一根100mli宽度的铜箔线就已能满足保护地的功能需要了**。
在绘制USB电源线、信号地和保护地时，应注意以下几点：
①USB插座的1、2、3、4脚应在信号地的包围范围内，而不是在保护地的包围范围内。
②USB差分信号线和其他信号线在走线的时候不应与保护地层出现交叠。
③电源层和信号地层在覆铜的时候要注意不应与保护地层出现交叠。
④**电源层要比信号地层内缩20D，D为电源层与信号地层之间的距离**。 
⑤如果差分线所在层的信号地需要大面积覆铜，注意信号地与差分线之间要保证35 mil以上的间距，以免覆铜后降低差分线的阻抗。
⑥在其他信号层可以放置一些具有信号地属性的过孔，增加信号地的连接性，缩短信号电流回流路径。
⑦在USB总线的电源线和PCB板的电源线上，可以加磁珠增加电源的抗干扰能力。
**3 USB2．0其他信号的拓扑结构设计**USB2.0提供高达480 Mbps的传输速率，因此芯片需要外接一个较高频率的晶振，例如Cypress公司的CY7C68013需要外接1个24 MHz的晶振。晶振应尽量靠近USB芯片的时钟输入脚，时钟线不能跨越USB2．0的差分线，**晶振下不要布置任何信号线**，**并且在时钟线周围应覆有完整的信号地，以降低时钟线对其他信号线的干扰**，特别是对差分线的干扰。在绘制USB芯片与其他芯片相连的数据线时，应保证线间距不小于8mil。
**结语**按EMC、EMI原理和信号完整性要求设计的USB2．0设备PCB板，传输速率可以达到300 Mbps以上。高速数字信号传输PCB板设计是一个比较复杂的领域，对设计人员的要求比较高，设计周期也比较长

