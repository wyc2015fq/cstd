# WinCE6.0补丁包的恢复与再更新 - xqhrs232的专栏 - CSDN博客
2013年02月03日 16:42:41[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：1108
原文地址::[http://www.cnblogs.com/we-hjb/archive/2010/08/20/1805015.html](http://www.cnblogs.com/we-hjb/archive/2010/08/20/1805015.html)
 怪事经常有，最近特别多。这两周接二连三的碰到了很多奇怪的问题。刚开始都是百思不得其解，不过后来大多都找到了合理的解释，唯独今天这个，折腾了一天，最后还是不得不暂时放下。
      先说说现象吧，使用原厂提供的最新的USBHOST驱动编译出来的系统，读写U盘不正常。准确的说，当写入的文件大于3600字节时就会失败，而小于3580字节就不会有问题，读U盘是正常的。使用上一版发布的驱动编译出的系统没有这个问题。由于这部分的代码原厂没有提供，只有相应的LIB和DLL，所以自己也无法进一步跟踪，只能寻求原厂的支持。
      原厂工程师ZSZ提了很多建议，换OTG的线、换U盘、格式化U盘、使用原厂的BSP在Demo板上验证……，结果都一样。最后的结论是，这是个例，因为没有别的客户反应这个问题，他们自己也没有碰到，而我也无法让他们重现。后来，从他们提供的FTP上下载了一个韩文版的系统固化到Demo板上，也是一样。ZSZ开始还有些怀疑，后来亲自测试并确认上述问题确实存在，但还是说这个不能说明问题。因为这个系统只是他们做应用程序的工程师编译出来测试应用的。到这里，我不得不投降了。花了一天的时间，证明了我们的板子、OTG线、U盘应该不会有问题。那还有什么可以去怀疑的呢。大概只剩下编译环境了，难道是微软补丁包惹得祸？ZSZ说他只打到了6月份的，而我前两天刚打了7月份的补丁包。可能是病急乱投医吧，虽然知道不太可能，但也只好再试一试。
      恢复PB6.0的补丁包之前没有做过，所以特地记录了一下。在安装补丁包时默认创建了备份，恢复的方法很简单，直接复制备份目录下的所有文件及目录，粘贴到WINCE600的目录下。做完恢复的操作后，必须使用Clean Sysgen重新生成系统。
      用CEUpdateCheck工具检查了一下补丁包的状态，如下图所示。
![image](http://images.cnblogs.com/cnblogs_com/we-hjb/WindowsLiveWriter/WinCE6.0_12B7C/image_thumb.png)
![image](http://images.cnblogs.com/cnblogs_com/we-hjb/WindowsLiveWriter/WinCE6.0_12B7C/image_thumb_1.png)
      可以看到，7月份补丁的状态为Corrupted，说明恢复生效了。但问题依然存在。又一次冤枉人家微软了。既然与补丁无关，那就再恢复回来吧。恢复的方式也很简单，重新安装一次7月份的补丁包就可以。安装完成后，用CEUpdateCheck工具检查了一下，如下图所示。
![image](http://images.cnblogs.com/cnblogs_com/we-hjb/WindowsLiveWriter/WinCE6.0_12B7C/image_thumb_2.png)
      7月份的补丁状态显示正常了。
      整整折腾一天，虽然问题没有解决，但也不能说毫无收获，至少缩小了问题的范围，而且第一次用了补丁包的恢复功能，也许以后还会派上用场。
//========================================
备注：：
1、我公司的电脑装完后怎么全是红色感叹号啊！！！-----全部装了有问题？？？全部崩溃了？！哦，我的出现红色感叹号全部是在COMMON部分，ARMV4I的地方都没有！
不过这样也编译可以跑起来了，只打到2010年的年包！！！并且是装完R3再打补丁包。有一个2009 R3的补丁包要打，特别注意的地方！！！不过我家的电脑显示COMMON也是安装正确的，看来又是加密系统的问题啊！
2、WINCE的更新不知道能不能这样来回的恢复与安装，得好好试一下！只装2012年年包用CEUPDATECHECK看了一下，怎么显示2009/2010/2011/2012全部装好的样子？难道真的只需要打最后一年的年包就可以？不过2009还是有一个COMMON补丁没打上，不知道要不要紧，编译试一下看了。
  试了一下还真的是可以啊！----只装了WinCEPB60-R3-2009-Update-Rollup-Armv4I.msi++++WinCEPB60-121231-Product-Update-Rollup-Armv4I.msi，我怀疑只装WinCEPB60-121231-Product-Update-Rollup-Armv4I.msi也是可以的。
3、网上已经很难下载到2006/2007/2008/2009/2010年的年包了，MS也不提供下载了，这还真的是一个问题来着，如果想用过去的年包怎么办？难道最后的一个年包包括了所有？这个还真没考证啊！看其文档应该可以确认最后的年包已经包括了所有。特别注意补丁的时间戳与编号，对一下就可以明白了。
