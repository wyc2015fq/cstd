# 串口标准，说说流控制（RTS/CTS/DTR/DSR 你都明白了吗？） - xqhrs232的专栏 - CSDN博客
2013年01月26日 10:30:21[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：3956
原文地址::[http://blog.chinaunix.net/uid-20579900-id-1920346.html](http://blog.chinaunix.net/uid-20579900-id-1920346.html)
先引用一篇网文，作者不详，因几个地方都说自己是原创，我昏了，不知道是谁原创的 ![流汗](http://img3.pp.sohu.com/ppp/blog/images/emotion/20.gif)
**RS232中RTS和CTS的作用 **
问：
以前挺明白的，今天一下子觉得以前的理解都不对了，以下三种解释哪个对呢？
解释一：
RTS：终端我已经准备就绪，有数据就发过来吧
CTS：来了，接招
解释二：
RTS：终端我准备发数据给你，快用CTS应答，准备好没？
CTS：好了，来吧
解释三：
CTS：主机，我有数据，请求接收
RTS：我是主机，就绪，请求发送。
我今天弄了个SIM100模块，我将RTS设置无效之后，凡是要发往主机的数据都没有发过来（包括主动 数据RING），指令和指令返回结果都没有返回，都缓存在模块之中，等我将RTS设置有效后，缓存的数据全发来了，包括一大堆指令的执行结果，由此，我觉 得上面的“解释一”应该正确，而“解释二”应该是错的，但“解释三”是否正确呢？就是说CTS和RTS哪个是发起者呢？
答：
一是错的
二是RS232标准
三是MODEM的硬件流控
SIMCOM公司的解释完全正确
    很久很久以前，计算机还没有出现，那时就已经存在了(计算机)史前的串口设备(电传打字机，工控测量设备，通信调制解调器)，为了连接这些串口，EIA制 定了RS232标准，采用DB25接插件，支持同步和异步串口，D型的接口可以有效防止插反。标准化给使用带来了便利。
    时光荏苒，个人计算机出现了，这些已有的串口设备毫无疑问地成为了最初的外设，自然而然地RS232标准被个人计算机采纳。但是设备制造商倾向于体积更 小，成本更低的接口，因此，将DB25中未使用的和支持同步模式的引脚去掉，形成DB9。最初的情况相当混乱，因为DB9只定义了信号，却没有指定信号和 引脚的对应关系，各个制造商只能自行定义。幸运的是，IBM的PC成了工业标准，DB9逐渐统一到IBM的定义上来。
    DB9只有9根线，遵循RS232标准。定义如下：
    DTR,DSR------DTE设备准备好/DCE设备准备好。主流控信号。
    RTS,CTS------请求发送/清除发送。用于半双工时，收发切换。属于辅助流控信号。半双工的意思是说，发的时候不收，收的时候不发。那么怎么区 分收发呢？缺省时是DCE向DTE发送数据，当DTE决定向DCE发数据时，先有效RTS，表示DTE希望向DCE发送，一般DCE不能马上转换收发状 态，DTE就通过监测CTS是否有效来判断可否发送，这样避免了DTE在DCE未准备好时发送所导致的数据丢失。
    全双工时，这两个信号一直有效即可。
    随着计算机的日益普及，很多非RS232的串口也要接入PC机，如果为每一种新出现的串口都增加一个新的I/O口显然不现实，因为PC后面板位置有限，因 此，将RS232串口和非RS232串口都通过RS232口接入是最佳方案。UART的U(通用)指的就是这个意思。早期ROM BIOS和DOS里的通信软件都是为RS232设计的，在没有检测到DCD有效前不会发送数据，因此，就连发送一个字符这样朴素的应用也要给出DCD、 DTR、DSR等控制信号。因此，串口接头上要将一些控制线短接，或者干脆绕过系统软件自己写通信程序。
    到此，UART的涵义就总结为：通用的 异步 (串行) I/O口。
    就在UART冠以通用二字，准备一统江湖的时候，制造商们不满于它的速度、体积和灵活性(软件可配置)，推出了USB和1394串口。目前，笔记本上的 UART串口有被取消的趋势，因而有网友发出了“没有串口，吾谁与归”的慨叹，古今多少事，都付笑谈中，USB取代UART是后话，暂且不表。
    话说自从贺氏(Hayes)公司推出了聪明猫(SmartModem)，他们制定的MODEM接口就成了业界标准，自此以后，所有公司制造的兼容猫都符合贺氏标准(连AT指令也兼容，大家一起抄他呗)。
    细观贺氏制定的MODEM串口，与RS232标准大不相同。DTR在整个通信过程中一直保持有效，DSR在MODEM上电后/可以拨号前有效(取决于软件 对DSR的理解)，在通信过程的任意时刻，只要DTR/DSR无效，通信过程立即终止。在某种意义上，这也可以算是流控，但肯定不是RS232所指的那种 主流控。如果拘泥于RS232，你是不会理解DTR和DSR的用途的。
    贺氏不但改了DTR和DSR，竟然连RTS和CTS的涵义也重新定义了。因此，RTS和CTS已经不具有最开始的意义了。从字面理解RTS和CTS，是用 于半双工通信的，当DTE想从收模式改为发模式时，就有效RTS请求发送，DCE收到RTS请求后不能立即完成转换，需要一段时间，然后有效CTS通知 DTE：DCE已经转到发模式，DTE可以开始发送了。在全双工时，RTS和CTS都缺省置为有效即可。然而，在贺氏的MODEM串口定义中，RTS和 CTS用于硬件流控，和什么劳什子的全双工/半双工一点关系也没有。
    注意，硬件流控是靠软件实现的，之所以强调“硬件”二字，仅仅是因为硬件流控提供了用于流量情况指示的硬件连线，并不是说，你只要把线连上，硬件就能自己流控。如果软件不支持，光连上RTS和CTS是没有用的。
    RTS和CTS硬件流控的软件算法如下：(RTS有效表示PC机可以收，CTS有效表示MODEM可以收，这两个信号互相独立，分别指示一个方向的流量情况。
**========== 我是分隔线 ==========**
以下是我的几句胡言乱语
最近在捣鼓一个GSM模块，正好也要用到这东西，就baidu了一把，可以帮助我理解Datasheet的内容。看了上面的内容，我不知道各位明白了几分，如果觉得都明白了，就不用看我废话了。
还是先引用一些文字，来自Telit公司GM862 QUAD/PY的数据手册
Pin Signal    I/O Function
20 C103/TXD I Serial data input (TXD) from DTE
29 C106/CTS O Output for Clear to send signal (CTS) to DTE
33 C107/DSR O Output for Data set ready signal (DSR) to DTE
37 C104/RXD O Serial data output to DTE
43 C108/DTR I Input for Data terminal ready signal (DTR) from DTE
45 C105/RTS I Input for Request to send signal (RTS) from DTE
注意上面各个功能的I/O的方向，看到这些缩写的全称，结合信号流向，是不是更容易理解呢 ![大笑](http://img3.pp.sohu.com/ppp/blog/images/emotion/3.gif)
DTE是数据发送的主动方，DCE是数据的接受方。
CTS是让DTE明白的，也就是说DCE需要把自己的CTS给DTE看，让他知道DEC已经准备好接受数据了。
RTS是DTE给DCE看的，告诉DCE，DTE有数据要发。
好啦，这个话题就到这里~~ ![调皮](http://img3.pp.sohu.com/ppp/blog/images/emotion/5.gif) 还没看懂的同学继续.....
