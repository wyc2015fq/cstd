# Modem/Com协议中的rts,cts,dtr,dsr,xon,xoff信号 - xqhrs232的专栏 - CSDN博客
2013年01月26日 10:39:00[xqhrs232](https://me.csdn.net/xqhrs232)阅读数：1591
原文地址::[http://blog.sina.com.cn/s/blog_4bab7f3f01000a0c.html](http://blog.sina.com.cn/s/blog_4bab7f3f01000a0c.html)
当电压为正的时候为逻辑“0”状态，当电压为负的时候为逻辑“1”状态，
串口通信可以连接两个设备， 当使用9芯线路时，
1) 地(GND)  2)接受数据(RX data) 3)传输数据 (TX data)
4) 数据终端准备(DTR) 5) GND   6)数据准备 (DSR)
7) 请求发送(RTS)  8)允许发送(CTS) 9)振铃指示(RI)
我举 PC 和Modem之间的通信为例子：
RTS/CTS 提供的是一种PC 和Modem 之间控制数据流的方法，当Modem 准备接收
数据时， 使CTS为ON(1), 当Modem 不能接收更多数据时， 使CTS为OFF(0), 类似的，当PC 可以接收数据时，RTS 为ON (1),  不能接收数据时，RTS 为OFF(0).
DTR/DSR : PC开启DSR信号告诉MODEN, PC 机已经准备通信, Modem通常开启DSR来应答，让PC机知道 Modem 准备应答.
RTS/CTS 属于是硬件流量控制， 而XON/XOFF则是软件流量控制。
XON/XOFF分别对应于(Ctrl-q)和(Crtl-s)字符，如果你选择软件流量控制，
你的Modem 将不能传递Ctrl-q 和 Crtl-s字符，因为这些字符被解释成为
流控请求。
希望这些能满足你的要求。
在RS-232标准中，字符是以一系列位元来一个接一个的传输。最长用的编码格式是异步起停asynchronous start-stop格式，它使用一个起始位后面紧跟7或8 个数据比特，这个可能是奇偶位，然后是两个停止位。所以发送一个字符需要10比特，带来的一个好的效果是使全部的传输速率，发送信号的速率以10分划。一个最平常的代替异步起停方式的是使用[高级数据链路控制](http://www.wiki.cn/wiki/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E6%8E%A7%E5%88%B6)协议(HDLC)。
在RS-232标准中定义了逻辑一和逻辑零电压级数，以及标准的传输速率和连接器类型。信号大小在正的和负的3－15v之间。RS-232规定接近零的电平是无效的，逻辑一规定为负电平，有效负电平的信号状态称为传号marking，它的功能意义为OFF，逻辑零规定为正电平，有效正电平的信号状态称为空号spacing，它的功能意义为ON。根据设备供电电源的不同，+-5、+-10、+-12和+-15这样的电平都是可能的。 mark和space是从电传打字机中来的术语。电传打字机原始的通信是一个简单的中断直流电路模式，类似与圆转盘电话拨号的中的信号。Marking状态是指电路是断开的，spacing状态就是指电路是接通的。一个space就表明有一个字符要开始发送了，相应的停止的时候，停止位就是marking。当线路中断的时候，电传打字机不打印任何有效字符，周期性的连续收到全零信号。
### 连接器
RS-232的设备可以分为数据终端设备（DTE）和数据通信设备（DCE）两类，这种分类定义了不同的线路用来发送和接受信号。一般来说，计算机和终端设备有DTE连接器，调制解调器和打印机有DCE连接器。但是这么说并不是总是严格正确的，用配线分接器测试连接，或者用试误法来判断电缆是否工作，常常需要参考相关的文件说明。
RS-232指定了20个不同的信号连接，由25个D-sub（微型D类）管脚构成的DB-25连接器。很多设备只是用了其中的一小部分管脚，出于节省资金和空间的考虑不少机器采用较小的连接器，特别是9管脚的D-sub或者是DB-9型连接器被广泛使用绝大多数自IBM的AT机之后的PC机和其他许多设备上。DB-25和DB-9型连接器的在大部分设备上是雌型，但不是所有的都是这样。最近，8管脚的RJ-45型连接器变得越来越普遍，尽管它的管脚分配相差很大。EIA/TIA 561标准规定了一种管脚分配的方法，但是由Dave Yost发明的被广泛使用在Unix计算机上的Yost串连设备配线标准
 （"Yost Serial Device Wiring Standard"）以及其他很多设备都没有采用上述任一种连线标准。
下表中列出的是被较多使用的RS-232中的信号和管脚分配：
|信号|DB-25|DB-9|EIA/TIA 561|Yost|
|----|----|----|----|----|
|公共地|7|5|4|4,5|
|发送数据(TD)|2|3|6|3|
|接受数据(RD)|3|2|5|6|
|数据终端准备(DTR)|20|4|3|2|
|数据设备准备好(DSR)|6|6|1|7|
|请求发送(RTS)|4|7|8|1|
|允许发送(CTS)|5|8|7|8|
|数据载波检测(DCD)|8|1|2|7|
|振铃指示(RI)|22|9|1|－|
以上信号的标注是从DTE设备的角度出发的，TD、DTR和RTS信号是由DTE产生的，RD、DSR、CTS、DCD和RI信号是由DCE产生的。接地信号是所有连接都公共的，在Yost的标准中接地信号外部有两个管脚事实上是同一个信号。如果两个通信设备的距离相差的很远或者是有两个不同的供电系统供电，那么地信号在两个设备间会不一样，从而导致通信失败，跟踪描述这样的情形是很困难的。以下是以DCE设备的角度标注的信号
### 电缆
由于RS-232实现中的各种不同和矛盾，要决定使用哪个合适的电缆来连接两个通信设备不是一件非常容易的事。用同一种类型的连接器来连接DCE和DTE设备需要直接的电缆还要有合适的终点。凹凸转换器被用于电缆和连接器间解决性别失配问题。用不同连接器来连接设备需要根据上表，用不同的电缆来连接相应的管脚。电缆一端9管脚，另一端25管脚是很普通的，生产以RJ-45型为连接器的设备厂家通常都会提供DB-25 或者DB-9型接头的电缆（有时候则是接头可交换的电缆，可供多种设备工作）。连接两个DTE设备需要一个虚拟调制解调器来充当DCE交换相应的信号(TD-RD,
 DTR-DSR, and RTS-CTS)。这个可以由单独的设备加上两根电缆或者用一根电缆来完成。Yost标准里虚拟调制解调器是一个全反线，它把一个端口的1到8号管脚翻转和另一个端口的8到1号管脚相连接（不要和以太网的反绞线混淆，以太网反绞线接线是非常不同的）。
为了配置和诊断RS-232电缆，可以采用配线分接器。配线分接器有凹凸RS-232连接器，可以内嵌式的连接线路，而且提供对应每个管脚的显示灯，还可以各种配置方式连接管脚。
RS-232电缆和很多连接器都可以在电子产品的商店找到-，电缆可能是3到25个管脚的，典型应用的是4到6个管脚的。平RJ（电话线类型）电缆可以和专门的RJ-RS-232连接器一起使用，后者是最容易配置的连接器。
双向接口能够只需要3根线制作是因为RS-232的所有信号都共享一个公共接地。非平衡电路使得RS-232非常的容易受两设备间基点电压偏移的影响。对于信号的上升期和下降期，RS-232也只有相对较差的控制能力，很容易发生串话的问题。RS-232被推荐在短距离（15m以内）间通信。由于非对称电路的关系，RS-232接口电缆通常不是由双绞线制作的。
有些设备也需要“[握手](http://www.wiki.cn/wiki/%E6%8F%A1%E6%89%8B_%28%E6%8A%80%E6%9C%AF%29)”协议，例如，20号管脚一般用于指示“设备就绪”。管脚也可是跳过的或者从连接器接回。例如设备A的一个管脚发送信号询问对方“你准备好了吗？” 假如设备B没有发送这样的指示信号。公共的握手管脚为20、8、4和6。
### 设置
串行通信在软件设置里需要做多项设置，最常见的设置包括波特率、奇偶校验和停止位。
波特率是指从一设备发到另一设备的波特率，即每秒钟多少比特bits per second (bit/s)。典型的波特率是300, 1200, 2400, 9600, 19200等bit/s。一般通信两端设备都要设为相同的波特率，但有些设备也可以设置为自动检测波特率。
奇偶校验Parity是用来验证数据的正确性。奇偶校验一般不用，如果使用，那么既可以做奇校验也可以做偶校验。奇偶校验是通过修改每一发送字节（也可以限制发送的字节）来工作的。如果不作奇偶校验，那么数据是不会被改变的。在偶校验中，因为奇偶校验位会被相应的置1或0（一般是最高位或最低位），所以数据会被改变以使得所有传送的数位（含字符的各数位和校验位）中“1”的个数为偶数；在奇校验中，所有传送的数位（含字符的各数位和校验位）中“1”的个数为奇数。奇偶校验可以用于接受方检查传输是否发送生错误——如果某一字节中“1”的个数发生了错误，那么这个字节在传输中一定有错误发生。如果奇偶校验是正确的，那么要么没有发生错误要么发生了偶数个的错误。
停止位是在每个字节传输之后发送的，它用来帮助接受信号方硬件重同步。
在串行通信软件设置中D/P/S是常规的符号表示。8/N/1（非常普遍）表明8bit数据，没有奇偶校验，1bit停止位。数据位可以设置为7、8或者9，奇偶校验位可以设置为无（N）、奇（O）或者偶（E），奇偶校验位可以使用数据中的比特位，所以8/E/1就表示一共8位数据位，其中一位用来做奇偶校验位。停止位可以是1、1.5或者2位的（1.5是用在波特率为60wpm的电传打字机上的）。
当需要发送握手信号或数据完整性检测时需要制定其他设置。公用的组合有RTS/CTS, DTR/DSR或者XON/XOFF（实际中不使用连接器管脚而在数据流内插入特殊字符）。
接受方把XON/XOFF信号发给发送方来控制发送方何时发送数据，这些信号是与发送数据的传输方向相反的。XON信号告诉发送方接受方准备好接受更多的数据，XOFF信号告诉发送方停止发送数据直到知道接受方再次准备好。XON/XOFF一般不赞成使用，推荐用RTS/CTS控制流来代替它们。
XON/XOFF是一种工作在终端间的带内方法，但是必须两端都支持这个协议，而且在突然启动的时候会有混淆的可能。
XON/XOFF可以工作于3线的接口。RTS/CTS最初是设计为电传打字机和调制解调器半双工协作通信的，每次它只能一方调制解调器发送数据。终端必须发送请求发送信号然后等到调制解调器回应清除发送信号。尽管RTS/CTS是通过硬件达到握手，但它有自己的优势。
ASR（Automatic Send Receive）电传打字机有一个纸带读卡机。当读卡机读数据的时候字符被发送出去。ASR电传打字机里收到一个XOFF字符就关掉纸带读卡机收到一个XON字符就启动纸带读卡机。当远端系统有必要降低发送放的速率时就发出XOFF。在原始的系统中，消息要用纸带事先准备好，那样传送的时间才能被缩短。那时的带宽非常有限并且昂贵，有时候传输不得不推迟到晚上进行，这也正推动了简明电报表达的发展。在有些早期的小型机中，ASR纸带读卡机和纸带穿孔器也是唯一的恢复程序的方法
http://www.wiki.cn/w/index.php?title=RS-232&diff=prev&oldid=471278
