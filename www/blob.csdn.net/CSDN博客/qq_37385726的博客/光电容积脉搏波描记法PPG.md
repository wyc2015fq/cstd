# 光电容积脉搏波描记法PPG - qq_37385726的博客 - CSDN博客





2019年04月05日 11:49:22[啧啧啧biubiu](https://me.csdn.net/qq_37385726)阅读数：33








# PPG

实时心率值可以反映一个人当时的心脏活动能力,进而从侧面衡量人体的健康状态。医院中测心率多采用心电图的方式,这在日常活动以及运动中是不便测量的,PRG( photoplethysmographic,光电描记法)脉搏波信号采用ILED光源和探测器为基础,测量经过人体血管和组织反射、吸收后的衰减光,描记出血管的搏动状态并测量脉搏波。由于PG信号获得简单,测量装置易于佩戴等特点逐渐成为非医院条件下测量血氧、脉搏及心率的主要方法。

光学心率传感器，如果带过上述那些智能手表或者智能手环的朋友来说也不算稀奇的事情。就拿AppleWatch来说，测量心率时底部的表盘会发出绿色的灯光，并且测量的时候手腕最好保持不动否侧会影响测量结果。接下来将详细介绍光学心率测量的原理。

如下两张图是光学心率传感器。图a是LED没有发光的时候中间是一个光敏二极管，图b是传感器的LED发光的时候。
![](https://imgsa.baidu.com/forum/w%3D580/sign=1597a98c48a98226b8c12b2fba83b97a/e3156ddbb6fd52662e4517eda018972bd507363f.jpg)![](https://imgsa.baidu.com/forum/w%3D580/sign=5e2ca6c770ec54e741ec1a1689399bfd/b7e7e2003af33a8796432be3cd5c10385243b57f.jpg)

图a                                                图b

那么为什么通过LED灯发光就能测量心率呢？

当LED光射向皮肤，透过皮肤组织反射回的光被光敏传感器接受并转换成电信号再经过AD转换成数字信号，简化过程：光--> 电 --> 数字信号
![](https://imgsa.baidu.com/forum/w%3D580/sign=4cf8e8ca788da9774e2f86238050f872/b6d961fae6cd7b899839117a042442a7db330ecb.jpg)

为什么大多数传感器都是采用的绿光呢？

我们先看看光谱的特点，从紫外线到红外线的波长是越来越长的。
![](https://imgsa.baidu.com/forum/w%3D580/sign=5bc430ba80d4b31cf03c94b3b7d7276f/cf95851373f082024b86bac640fbfbedaa641b14.jpg)

之所以选择绿光作为光源是考虑到一下·几个特点：

1. 皮肤的黑色素会吸收大量波长较短的波

2. 皮肤上的水份也会吸收大量的UV和IR部分的光

3. 进入皮肤组织的绿光(500nm)-- 黄光(600nm)大部分会被红细胞吸收

4. 红光和接近IR的光相比其他波长的光更容易穿过皮肤组织

5. 血液要比其他组织吸收更多的光

6. 相比红光，绿（绿-黄）光能被氧合血红蛋白和脱氧血红蛋白吸收

总体来说，绿光-- 红光能作为测量光源。早起多数采用红光为光源，随着进一步的研究和对比，绿光作为光源得到的信号更好，信噪比也比其他光源好些，所以现在大部分穿戴设备采用绿光为光源。但是考虑到皮肤情况的不用（肤色、汗水），高端产品会根据情况自动使用换绿光、红光和IR多种光源。

虽然知道了上面的几个特点，但是还不足以弄清楚为什么通过光照就能测出心率、血氧等参数呢？

下图就解释了核心原理
![](https://imgsa.baidu.com/forum/w%3D580/sign=90ff39b6952f07085f052a08d925b865/2925afedab64034f6fd9e9ffa4c379310b551d14.jpg)

当光照透过皮肤组织然后再反射到光敏传感器时光照有一定的衰减的。像肌肉、骨骼、静脉和其他连接组织等等对光的吸收是基本不变的（前提是测量部位没有大幅度的运动），但是血液不同，由于动脉里有血液的流动，那么对光的吸收自然也有所变化。当我们把光转换成电信号时，正是由于动脉对光的吸收有变化而其他组织对光的吸收基本不变，得到的信号就可以分为直流DC信号和交流AC信号。提取其中的AC信号，就能反应出血液流动的特点。我们把这种技术叫做光电容积脉搏波描记法PPG。

下图是PPG信号和ECG信号的对比
![](https://imgsa.baidu.com/forum/w%3D580/sign=b40ca0c06063f6241c5d390bb745eb32/68a556087bf40ad124caec1a5c2c11dfa8ecce7f.jpg)



实际测量手指的PPG信号如下：
![](https://imgsa.baidu.com/forum/w%3D580/sign=669a25e026f5e0feee1889096c6134e5/53739fef76094b363a2a3114a8cc7cd98f109de9.jpg)

所以，只要测得到的PPG信号比较理想算出心率也不算什么难事。但是事实总是残酷的，由于测量部位的移动、自然光、日光灯等等其他的干扰，最终测到的信号可能是下面的这种，所以要通过很多方法进行滤波处理
![](https://imgsa.baidu.com/forum/w%3D580/sign=a94accd205f41bd5da53e8fc61db81a0/5124d68ba61ea8d3294b5ffd9c0a304e241f5838.jpg)

对于PPG信号的处理，目前我知道的有两种方法。一种是时域分析，即算出一定时间内PPG信号的波峰个数，另一种是通过对PPG信号进行FFT变换得到频域的特点。

时域方法：


通过对原始的{PPG信号进行滤波处理，得到一定时间内的波峰个数，然后既可算出心率值
![](https://imgsa.baidu.com/forum/w%3D580/sign=214912fa8c44ebf86d716437e9f8d736/0007a6d3572c11dfe3c594da682762d0f603c215.jpg)

假设连续采样5秒的时间，在5s内的波峰个数为N，那么心率就是N*12 （这个相信大家都懂，就跟把脉一样~）



频域分析：


上面分析过，我们把血液流动对光吸收转变成了AC信号，如果对于进行FFT变换，那么就能看到频域的特点。如下图就是对PPG信号的FFT转变
![](https://imgsa.baidu.com/forum/w%3D580/sign=b66952c165061d957d4637304bf50a5d/688be719ebc4b7455cc19cefc4fc1e17888215cb.jpg)

上图中的频域图，0Hz的信号很强，这部分是骨骼、肌肉等组织的DC信号，在1Hz附近有个相对比较突出的信号就是血液流动转变的AC信号。假设测得到的频率f = 1.2Hz

那么心率HeartRate HR = f x60 = 1.2 x 60 = 72

最后再简单提一下血氧的测量，相比心率血氧测量难度较大而且精度不算太高。测量血氧的原理图下图所示
![](https://imgsa.baidu.com/forum/w%3D580/sign=4e0e7c19fc03918fd7d13dc2613c264b/5bcce71bb051f819ab3128b3d1b44aed2f73e715.jpg)

由于血液中含有的氧合血红蛋白HbO2和血红蛋白Hb存在一定的比例，简单说也就是含氧量吧。上面的图表示了氧合血红蛋白HbO2和血红蛋白Hb对波长600~1000nm的光吸收特性，从图中可以看出上600~800nm间Hb的吸收系数更高，800~1000之间HbO2的吸收系数更高。所以可以利用红光（600~800nm）和接近IR（800~1000nm）的光分别检测HbO2和Hb的PPG信号，然后通过程序处理算出相应的比值，这样就得到了血氧值。

但是由于光源不同，直接利用红光和接近IR的光进行信号对比是不可靠的，因为红光和IR透过皮肤组织也会产生不同的吸收。下图是红光和IR透过皮肤的原始信号示意图
![](https://imgsa.baidu.com/forum/w%3D580/sign=732b4d8af0f2b211e42e8546fa816511/fafc260e0cf3d7ca18d8148ff91fbe096a63a97f.jpg)

上面分析说过，DC部分是光透过皮肤组织转换成的直流信号，AC是血液流动产生转换成的交流信号。由于皮肤组织对红光和IR的吸收程度不同，DC部分自然也就不一样。为了能共“公平对待”两种光源的PPG信号，所以需要对原始信号处理一下。下图示意了处理后的信号（DC部分相等）
![](https://imgsa.baidu.com/forum/w%3D580/sign=0b444b32b9fb43161a1f7a7210a54642/e90ae71c8701a18bb1ff39b6952f07082938fe15.jpg)

通过一定的比例计算，公平对待Red和IR的PPG信号。这样计算出来的Hb和HbO2比例才可靠。



