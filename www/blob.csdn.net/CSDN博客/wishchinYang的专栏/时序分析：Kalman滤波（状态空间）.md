# 时序分析：Kalman滤波（状态空间） - wishchinYang的专栏 - CSDN博客
2015年12月18日 14:16:41[wishchin](https://me.csdn.net/wishchin)阅读数：4233
                
        在现实生活中, 数据的出现大多数是以非平稳形式, 这就涉及到了动态数据所构成的时间序列的分解.关于时间序列的分解, PeterJ.Brochwell&RichardA.Davis在其著作《timeSerieS:TheoryandMethodS》中己指出:分解时间序列的目的旨在估计和抽取确定性成分Tt,St,Ct,以使残量再即随机项是一平稳过程.进而求得关于随机项的合适概率模型,分析它的性质,并连同Tt,St,Ct达到拟合和预测的目的。
       实际上,对于时间序列的分解预测问题,主要问题是对前三项的分离和预测,而随机项即平稳序列的拟合现今理论己相当成熟。
       若对经济序列等暗含周期序列进行深入的分析研究时,**将周期分离出来**是十分必要的.而用状态空间方法对时间序列进行分解就能解决这个问题.用状态空间方法对时间序列进行分解,其效果与Bayes方法相仿,但计算量较小。
       转自于百度百科......
**一、时序的空间状态描述**
### 状态空间模型概述
状态空间模型
       状态空间模型是动态时域模型，以隐含着的时间为自变量。状态空间模型在经济[时间序列分析](http://baike.baidu.com/view/479624.htm)中的应用正在迅速增加。其中应用较为普遍的状态空间模型是由Akaike提出并由Mehra进一步发展而成的典型相关(canonical correlation)方法。由Aoki等人提出的估计向量值状态空间模型的新方法能得到所谓内部平衡的状态空间模型，只要去掉系统矩阵中的相应元素就可以得到任何低阶近似模型而不必重新估计，而且只要原来的模型是稳定的，则得到的低阶近似模型也是稳定的。
### 状态空间模型分类
状态空间模型按所受影响因素的不同分为：
（1）确定性状态空间模型
（2）随机性状态空间模型
状态空间模型按数值形式分为：
（1）离散空间状态模型
（2）连续空间状态模型
### 状态空间模型意义
      状态空间模型起源于平稳时间序列分析。当用于非平稳时间序列分析时需要将非平稳时间序列分解为[随机游走](http://baike.baidu.com/view/3606415.htm)成分(趋势)和弱平稳成分两个部分分别建模。 含有随机游走成分的时间序列又称积分时间序列，因为随机游走成分是弱平稳成分的和或积分。当一个向量值积分序列中的某些序列的[线性组合](http://baike.baidu.com/view/476001.htm)变成弱平稳时就称这些序列构成了协调积分(cointegrated)过程。
 非平稳时间序列的线性组合可能产生平稳时间序列这一思想可以追溯到回归分析，Granger提出的协调积分概念使这一思想得到了科学的论证。 Aoki和[Cochrane](http://baike.baidu.com/view/1440744.htm)等人的研究表明：很多非平稳多变量时间序列中的随机游走成分比以前人们认为的要小得多，有时甚至完全消失。
协调积分概念的提出具有两方面的意义： 
① 如果一组非平稳[时间序列](http://baike.baidu.com/view/76878.htm)是协调积分过程，就有可能同时考察他们之间的长期稳定关系和短期关系的变化；
② 如果一组非平稳时间序列是协调积分过程，则只要将协调回归误差代入系统[状态方程](http://baike.baidu.com/view/1603802.htm)即可纠正系统下一时刻状态的[估计值](http://baike.baidu.com/view/962834.htm)，形成所谓误差纠正模型。
       Aoki的[向量](http://baike.baidu.com/view/77260.htm)值状态空间模型在处理积分时间序列时，引入了**协调积分**概念和与之相关的误差纠正方法，因此向量值状态空间模型也是误差纠正模型。 一个向量值时间序列是否为积分序列需判断其是否含有[单位根](http://baike.baidu.com/view/652962.htm)，即状态空间模型的动态矩阵是否含有量值为1的特征值。
       根据动态矩阵的特征值即可将[时间序列](http://baike.baidu.com/view/76878.htm)分解成两个部分，其中特征值为1的部分(包括接近1的“近积分”部分)表示[随机游走](http://baike.baidu.com/view/3606415.htm)趋势，其余为弱平稳部分，两部分分别建模就得到了两步建模法中的趋势模型和周期模型。
       状态空间模型的假设条件是动态系统符合马尔科夫特性，即给定系统的现在状态，则系统的将来与其过去独立
### 状态空间模型的特点
状态空间模型具有如下特点： 
1、状态空间模型不仅能反映系统内部状态，而且能揭示系统内部状态与外部的输入和输出变量的联系。 
2、状态空间模型将多个变量[时间序列](http://baike.baidu.com/view/76878.htm)处理为向量时间序列，这种从变量到向量的转变更适合解决多输入输出变量情况下的建模问题。
3、状态空间模型能够用现在和过去的最小心信息形式描述系统的状态，因此，它不需要大量的历史数据资料，既省时又省力
## 状态空间模型的时间序列预测的优点

空间模型
基于状态空间模型的时间序列预测的优点是：
优点一
状态空间模型是一种结构模型，基于状态空间分解模型的[时间序列预测](http://baike.baidu.com/view/8196523.htm)，便于分析者利用存在的统计理论对模型进行[统计检验](http://baike.baidu.com/view/3472383.htm)。
优点二
状态空间模型求解算法的核心是Kalman滤波，Kalman滤波是在时刻t基于所有可得到的信息计算[状态向量](http://baike.baidu.com/view/3810402.htm)的最理想的递推过程。当扰动项和初始状态向量服从正态分布时，Kalman滤波能够通过预测误差分解计算[似然函数](http://baike.baidu.com/view/1864828.htm)，从而可以对模型中的所有未知参数进行估计，并且当新的观测值一旦得到，就可以利用Kalman滤波连续地修正状态向量的估计

## 状态空间模型的建立和预测的步骤
为了避免由于状态空间模型的不可控制性而导致的错误的分解形式，当对一个[单整](http://baike.baidu.com/view/6419074.htm)[时间序列](http://baike.baidu.com/view/76878.htm)建立状态空间分解模型并进行预测，应按下面的步骤执行：
(1) 对相关的时间序列进行季节调整，并将季节要素序列外推；
(2) 对季节调整后的时间序列进行单位根检验，确定单整阶数，然后在ARIMA过程中选择最接近的模型；
(3) 求出ARIMA模型的系数；
(4) 用ARIMA模型的系数准确表示正规状态空间模型，检验状态空间模型的可控制性；
(5) 利用Kalman滤波公式估计[状态向量](http://baike.baidu.com/view/3810402.htm)，并对时间序列进行预测。
(6) 把外推的季节要素与相应的预测值合并，就得到经济时间序列的预测结果。
**Code:**
.................................................
