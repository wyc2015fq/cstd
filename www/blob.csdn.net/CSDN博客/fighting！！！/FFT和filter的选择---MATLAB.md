# FFT和filter的选择---MATLAB - fighting！！！ - CSDN博客
2019年01月08日 11:49:33[dujiahei](https://me.csdn.net/dujiahei)阅读数：124
转自[http://blog.sina.com.cn/s/blog_710391f70102v8gq.html](http://blog.sina.com.cn/s/blog_710391f70102v8gq.html)
五种类型模拟滤波器的比较：
巴特沃斯、切比雪夫I型、切比雪夫II型、椭圆滤波器主要考虑逼近幅度响应指标的滤波器；贝塞尔滤波器主要考虑逼近线性相位的滤波器。
下面比较相同阶数的归一化滤波器频率响应特性：
相同阶数相同的通带最大衰减和阻带最小衰减：
巴特沃夫有单调下降的幅频特性，过渡带最宽。2种类型的切比雪夫过渡带相等且比巴特沃夫窄比椭圆宽。切比雪夫I型在通带有等条纹幅频特性，过渡带和阻带单调下降。切比雪夫II型通带幅频响应几乎与巴特沃夫相同，阻带是等波纹幅频特性。椭圆filter的过渡带最窄，通带和阻带均是等波纹幅频特性。
<相位逼近状况>巴特沃夫和切比雪夫大约在3/4的通带上是非常接近线性相位特性。椭圆filter大约在1/2个通带上接近。贝塞尔在整个通带上逼近线性相位特性，且其幅频特性的过渡带比其他4种宽得多。
<复杂性>在满足相同的幅频特性指标下，巴特沃夫阶数最高，椭圆阶数最低，且阶数差别大。so在满足滤波器频响指标而言，椭圆filter的性能最高，应用广泛。
IIR和FIR数字滤波器的比较：
<性能>IIR系统函数的极点可以位于单位圆的任何地方，零点和极点的结合可以用较低的阶数获得较高的选择性，阶数低意味着存储单元少计算量少经济高效，但这种高效以相位的非线性为代价。FIR可以达到线性相位，但FIR系统函数的极点固定在原点，只能用较高阶数达到高的选择性。
<结构>IIR必须是递归结构，极点位置必须在单位圆内，否则系统不稳定。在递归结构中，运算过程对序列的舍入处理，有限字长效应有时会引起寄生振荡。FIR主要采用非递归结构，有限精度运算中不存在稳定性问题。FIR可以采用FFT算法实现，运算速度可以大大提高。
<设计工具>IIR可以借助成熟的模拟滤波器设计，间接设计法主要有脉冲响应不变法和双线性变换法。FIR的设计不能用间接法，常用方法有窗函数法、频率采样法和契比雪夫等条纹逼近法。计算通带阻带衰减等仍无显示表达式，其边界频率也不易精确控制。但IIR脱离不了几种典型的模拟滤波器的频响特性约束。FIR相比之灵活些。
总之：对相位不敏感的场合如语音通讯等，用IIR较合适；对图像信号处理，数据传输等以波形携带信号的系统，对线性相位要求较高，用FIR较好。
稳定性和线性相位特性是FIRfilter最突出的优点。
Reference：
数字信号处理（第三版），高西全，丁玉美编著，西安电子科技大学出版社
~~~~~~~~~~~~~~~~
    对于N阶fir滤波器，因为是用差分方程实现它，它有N/2的时延。在MATLAB中，用filter或fftfilt实现滤波后，前N/2个数据应该舍弃，因为它们是滤波器从瞬态转向稳态过程中出现的振荡波纹。也就是说，fir滤波器可以做到零相位，但是时延是不可避免的。
    应用filtfilt命令可以部分解决时延问题，但是，在滤出波形左右两端的波形都会出现畸变（边界效应）。用fftfilter和filter滤波器仅在左端出边因瞬态转稳态出现的波纹，在信号右端没有畸变。
    为了实现滤波器的相位补偿，实现实时信号滤波（实现无相位损失滤波，消除相位延迟），可以对原信号进行延拓。经过信号延拓后，可以有效地消除边界效应。基本的延拓方法有：镜像延拓，ar延拓等。
    AR延拓（请查看EMD分解，《数字信号处理-理论、算法与实现（第二版），胡广书，清华大学出版社，第12章》）
Reference：
信号FIR数字滤波后相位延迟的消除。[伏燕军](http://wap.cnki.net/acasearch.aspx?q=%E4%BC%8F%E7%87%95%E5%86%9B&place=author);[程强强](http://wap.cnki.net/acasearch.aspx?q=%E7%A8%8B%E5%BC%BA%E5%BC%BA&place=author);[于润桥](http://wap.cnki.net/acasearch.aspx?q=%E4%BA%8E%E6%B6%A6%E6%A1%A5&place=author);[江光裕](http://wap.cnki.net/acasearch.aspx?q=%E6%B1%9F%E5%85%89%E8%A3%95&place=author)。《[计算机工程与应用](http://wap.cnki.net/qikan-I-I2-JSGG-2012-07.html)》 2012.07
滤波函数
* filter：利用递归滤波器(IIR)或非递归滤波器(FIR)对数据进行数字滤波；
* fftfilt：利用基于FFT的重叠相加法对数据进行滤波，只适用于非递归滤波器(FIR)；
* filter2：二维FIR数字滤波；
* filtfilt：零相位滤波（IIR与FIR均可）。
滤波器特性分析
* 脉冲响应Impz
    等价于使用函数filter输入一个脉冲信号x=[1;zero(N-1,1)]。
* 频率响应freqz与freqs
    Freqz：求解数字滤波器的频率响应
    Freqs：求解模拟滤波器的频率响应
* 幅频和相频abs与angle、unwrap
    Unwrap：解卷绕
* 群延迟grpdelay
    群延迟即为滤波器相位响应的负一阶导数，是滤波器平均延迟的度量。
* 零极点分析zplane
