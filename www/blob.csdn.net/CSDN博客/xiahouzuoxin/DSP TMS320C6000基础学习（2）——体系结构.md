# DSP TMS320C6000基础学习（2）——体系结构 - xiahouzuoxin - CSDN博客





2013年07月25日 16:58:54[xiahouzuoxin](https://me.csdn.net/xiahouzuoxin)阅读数：6297








***主要内容***

![](https://img-blog.csdn.net/20130725155105843?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)


***1. CPU架构***

一幅图片搞定

![](https://img-blog.csdn.net/20130725155309390?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)





***2. C6000基本指令集***


在“DSP TMS320C6000基础学习（1）”中已经说过：SOP是大部分DSP算法的关键单元。C6000的寄存器包括A,B两组。

我们将看看下面的表达式通过DSP指令是怎么一步步实现的，

***Y=∑an*xn **with**n = 1...N***



**（1）an*xn乘法实现**，DSP中有专门的硬件乘法模块，因此只需要一个指令就能完成乘法操作，而且指令周期为1。


`MPY .M a1,x1,Y1`其中MPY为乘法指令，.M表示DSP的乘法单元，上面指令执行Y1=a1*x1。





**（2）加法实现**，ADD指令，加法单元用.L表示，下面指令执行Y=Y+Y1


`ADD .L Y,Y1,Y`



（3）**内存数据装载**（上面的操作其实是有问题的，MPY和ADD不能直接操作内存），只能使用如下命令：
LDB *Rn, Rm：转载一个字节（8bits）

LDH *Rn, Rm：装载一个半字（16bits）

LDW *Rn, Rm：装载一个字（32bits）

LDDW *Rn, Rm：装载一个double字（64bits）

其中Rn包含要装载操作数内存地址（32bits）的寄存器，Rm为目标寄存器。装载的DSP执行单元称为.D。



**（4）将常量装入寄存器指令——MVKL和MVKH**

MVKL const, Rn（低16bits）

MVKH const Rn（高16bits）

const是一个常量或标签值，只能先装低位再装高位。

比如（3）中，先要将操作数内存地址载入Rn中，因为地址长度为32bits，必须依次使用上面的2条指令完成地址到寄存器的载入工作，



```
MVKL Addr_low8 Rn
MVKL Addr_high8 Rn
```





**（5）综合（1）~（4）指令完成a1*x1的过程**

![](https://img-blog.csdn.net/20130725161759625?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)



其中pt1和pt2分别为a与x地址。




**（6）循环指令**

        为完成***Y=∑an*xn ****with****n = 1...N，***还有一个循环求和的过程，与其它平台类似，DSP中通过跳转指令和计数器实现循环，实现循环的步骤为：

========================================================

添加一个标签（下一次要跳转到何处）；

添加跳转指令（B）；

创建一个循环计数器；

添加一条指令用于对循环计数器更新；

使跳转指令根据计数器的值做相应的跳转；

=========================================================

下面为一个示例，



```
MVKL .S count, B0        ; 计数器寄存器B0初始化为count
loop:      .....
           SUB .S B0,1B0            ; 计数器减1                    
      [B0] B .S loop                ; 当B0不为0时跳转
```

上面用到了条件指令[Reg]，还有取反的条件指令[! Reg]。条件寄存器可以为A0,A1,B0,B1,B2。




**到此，我们已经在DSP上使用指令完全实现了***Y=∑an*xn ****with****n = 1...N*****

![](https://img-blog.csdn.net/20130725163139859?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)





这里考虑一个问题，如果我们要提高DSP的处理能力，有什么方法么？很容易想到，一方面可以提高时钟频率，从而减小单周期的时间；另一方面是增加处理单元的个数（指上面提到的.D .M .L .S等）。

![](https://img-blog.csdn.net/20130725163755640?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)


![](https://img-blog.csdn.net/20130725163904843?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)





另外，针对高性能的处理器还有更高处理性能的指令。




***3. 内存映射***


![](https://img-blog.csdn.net/20130725164134812?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhaG91enVveGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)





***4. DSP C6000外设***


C6000的外设主要包括：

—— 并口

—— 普通GPIO

—— EMIF：外部存储器接口

—— 串口：McBSP（多通道缓冲串口），McASP（多通道音频串口）

—— DMA（EDMA）：直接存储器访问（内部，外部）

—— 定时器（Timers）

—— 以太网接口（Ethernet）

—— 视频接口（Video Ports）

—— VCP/TCP接口：实现3G网络

—— PLL锁相环




本文最后记录下C6000系列产型号的命名方法，比如




## TMS320C6713B-200



320：表示TI的DSP系列产品  （另 430：MCU    470：ARM）

C：ROM          （另 F：Flash EEROM）         ** 此处有误，改：在6000系列中C表示CMOS，而2000系列中C表示ROM**

6713：产品型号

-200：主频为200MHz









