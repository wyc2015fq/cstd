# 矩阵特征值分解与奇异值分解含义解析及应用 - xiahouzuoxin - CSDN博客





2014年11月14日 14:28:10[xiahouzuoxin](https://me.csdn.net/xiahouzuoxin)阅读数：90614
个人分类：[Image/Audio/ML...](https://blog.csdn.net/xiahouzuoxin/article/category/1203619)









此文有一半转载自他出，主要在这进行个整理，具体内容文中都有相关的转载链接。



## 特征值与特征向量的几何意义

矩阵的乘法是什么，别只告诉我只是“前一个矩阵的行乘以后一个矩阵的列”，还会一点的可能还会说“前一个矩阵的列数等于后一个矩阵的行数才能相乘”，然而，这里却会和你说——那都是表象。

矩阵乘法真正的含义是变换，我们学《线性代数》一开始就学行变换列变换，那才是线代的核心——别会了点猫腻就忘了本——对，矩阵乘法 ![](http://www.forkosh.com/mathtex.cgi?%20%5CSmall%20Y=AB)就是线性变换，若以其中一个向量A为中心，则B的作用主要是使A发生如下变化：
- 
伸缩

```
clf;
A = [0, 1, 1, 0, 0;...
    1, 1, 0, 0, 1];  % 原空间
B = [3 0; 0 2];      % 线性变换矩阵

plot(A(1,:),A(2,:), '-*');hold on
grid on;axis([0 3 0 3]); gtext('变换前');

Y = B * A;

plot(Y(1,:),Y(2,:), '-r*');
grid on;axis([0 3 0 3]); gtext('变换后');
```

![1](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/1.png)
1


从上图可知，y方向进行了2倍的拉伸，x方向进行了3倍的拉伸，这就是B=[3 0; 0 2]的功劳,3和2就是伸缩比例。请注意，这时B除了对角线元素为各个维度的倍数外，非正对角线元素都为0，因为下面将要看到，对角线元素非0则将会发生切变及旋转的效果。

- 
切变

```
clf;
A = [0, 1, 1, 0, 0;...
     1, 1, 0, 0, 1];  % 原空间
B1 = [1 0; 1 1];       % 线性变换矩阵
B2 = [1 0; -1 1];       % 线性变换矩阵
B3 = [1 1; 0 1];       % 线性变换矩阵
B4 = [1 -1; 0 1];       % 线性变换矩阵

Y1 = B1 * A;
Y2 = B2 * A;
Y3 = B3 * A;
Y4 = B4 * A;

subplot(2,2,1);
plot(A(1,:),A(2,:), '-*'); hold on;plot(Y1(1,:),Y1(2,:), '-r*');
grid on;axis([-1 3 -1 3]);
subplot(2,2,2);
plot(A(1,:),A(2,:), '-*'); hold on;plot(Y2(1,:),Y2(2,:), '-r*');
grid on;axis([-1 3 -1 3]);
subplot(2,2,3);
plot(A(1,:),A(2,:), '-*'); hold on;plot(Y3(1,:),Y3(2,:), '-r*');
grid on;axis([-1 3 -1 3]);
subplot(2,2,4);
plot(A(1,:),A(2,:), '-*'); hold on;plot(Y4(1,:),Y4(2,:), '-r*');
grid on;axis([-1 3 -1 3]);
```

![2](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/2.png)
2


- 
旋转

所有的变换其实都可以通过上面的伸缩和切变变换的到，如果合理地对变换矩阵B取值，能得到图形旋转的效果，如下，

```
clf;
A = [0, 1, 1, 0, 0;...
     1, 1, 0, 0, 1];  % 原空间
theta = pi/6;
B = [cos(theta) sin(theta); -sin(theta) cos(theta)];
Y = B * A;
figure;
plot(A(1,:),A(2,:), '-*'); hold on;plot(Y(1,:),Y(2,:), '-r*');
grid on;axis([-1 3 -1 3]);
```

![3](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/3.png)
3



好，关于矩阵乘就这些了。那么，我们接着就进入主题了，对特定的向量，经过一种方阵变换，经过该变换后，向量的方向不变（或只是反向），而只是进行伸缩变化（伸缩值可以是负值，相当于向量的方向反向）？这个时候我们不妨将书上对特征向量的定义对照一遍：

> 
数学教材定义： 设A是n阶方阵，如果存在 λ 和n维非零向量X，使 ![](http://www.forkosh.com/mathtex.cgi?%20Ax=%5Clambda%7Bx%7D) ，则 λ 称为方阵A的一个特征值，X为方阵A对应于或属于特征值 λ 的一个特征向量。


上面特定的向量不就是特征向量吗？ λ 不就是那个伸缩的倍数吗？因此，特征向量的代数上含义是：将矩阵乘法转换为数乘操作；特征向量的几何含义是：特征向量通过方阵A变换只进行伸缩，而保持特征向量的方向不变。特征值表示的是这个特征到底有多重要，类似于权重，而特征向量在几何上就是一个点，从原点到该点的方向表示向量的方向。

特征向量有一个重要的性质：同一特征值的任意多个特征向量的线性组合仍然是A属于同一特征值的特征向量。关于特征值，网上有一段关于“特征值是震动的谱”的解释：

戏说在朝代宋的时候，我国就与发现矩阵特征值理论的机会擦肩而过。话说没有出息的秦少游在往池塘里扔了一颗小石头后，刚得到一句“投石冲开水底天”的泡妞诗对之后，就猴急猴急地去洞房了，全然没有想到水波中隐含着矩阵的特征值及特征向量的科学大道理。大概地说，水面附近的任一点水珠在原处上下振动（实际上在做近似圆周运动），并没有随着波浪向外圈移动，同时这些上下振动的水珠的幅度在渐渐变小，直至趋于平静。在由某块有着特定质量和形状的石头被以某种角度和速度投入某个面积和深度特定的水池中所决定的某个矩阵中，纹波荡漾中水珠的渐变过程中其特征值起着决定性的作用，它决定着水珠振动的频率和幅度减弱的衰退率。

在理解关于振动的特征值和特征向量的过程中，需要加入复向量和复矩阵的概念，因为在实际应用中，实向量和实矩阵是干不了多少事的。机械振动和电振动有频谱，振动的某个频率具有某个幅度；那么矩阵也有矩阵的谱，矩阵的谱就是矩阵特征值的概念，是矩阵所固有的特性，所有的特征值形成了矩阵的一个频谱，每个特征值是矩阵的一个“谐振频点”。

美国数学家斯特让（G..Strang）在其经典教材《线性代数及其应用》中这样介绍了特征值作为频率的物理意义，他说：

> 
大概最简单的例子（我从不相信其真实性，虽然据说1831年有一桥梁毁于此因）是一对士兵通过桥梁的例子。传统上，他们要停止齐步前进而要散步通过。这个理由是因为他们可能以等于桥的特征值之一的频率齐步行进，从而将发生共振。就像孩子的秋千那样，你一旦注意到一个秋千的频率，和此频率相配，你就使频率荡得更高。一个工程师总是试图使他的桥梁或他的火箭的自然频率远离风的频率或液体燃料的频率；而在另一种极端情况，一个证券经纪人则尽毕生精力于努力到达市场的自然频率线。特征值是几乎任何一个动力系统的最重要的特征。


其实，这个矩阵之所以能形成“频率的谱”，就是因为矩阵在特征向量所指的方向上具有对向量产生恒定的变换作用：增强（或减弱）特征向量的作用。进一步的，如果矩阵持续地叠代作用于向量，那么特征向量的就会凸现出来。

更多关于特征向量及特征值的实际例子参见Wikipedia： [http://zh.wikipedia.org/wiki/特征向量](http://zh.wikipedia.org/wiki/%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F) 。

## 特征值分解

设A有n个特征值及特征向量，则：

![](http://www.forkosh.com/mathtex.cgi?%20A*x_1=%5Clambda_1*x_1%20%5C%5C%20A*x_2=%5Clambda_2*x_2%20%5C%5C%20...%20%5C%5C%20A*x_n=%5Clambda_n*x_n)

将上面的写到一起成矩阵形式：

![](http://www.forkosh.com/mathtex.cgi?%20%20A*%5Cbegin%7Bpmatrix%7Dx_1%20&%20x_2%20&%20...%20&%20x_n%5Cend%7Bpmatrix%7D%20=%20%5Cbegin%7Bpmatrix%7Dx_1%20&%20x_2%20&%20...%20&%20x_n%5Cend%7Bpmatrix%7D%20*%20%5Cbegin%7Bpmatrix%7D%5Clambda_1%20&%200%20&%20...%20&%200%20%5C%5C0%20&%20%5Clambda_2%20&%20...%20&%200%20%5C%5C.......................%20%5C%5C0%20&%200%20&%20...%20&%20%5Clambda_n%5Cend%7Bpmatrix%7D)

若(x1,x2,...,xn)可逆，则左右两边都求逆，则方阵A可直接通过特征值和特征向量进行唯一的表示，令

Q=(x1,x2,...,xn)

Σ = diag(λ1, λ2, ..., λn)

则 ![](http://www.forkosh.com/mathtex.cgi?%20%20A=Q%5CSigma%7BQ%5E%7B-1%7D%7D) ，该表达式称为方阵的特征值分解，这样方阵A就被特征值和特征向量唯一表示。

一个变换方阵的所有特征向量组成了这个变换矩阵的一组基。所谓基，可以理解为坐标系的轴。我们平常用到的大多是直角坐标系，在线性代数中可以把这个坐标系扭曲、拉伸、旋转，称为基变换。我们可以按需求去设定基，但是基的轴之间必须是线性无关的，也就是保证坐标系的不同轴不要指向同一个方向或可以被别的轴组合而成，否则的话原来的空间就“撑”不起来了。从线性空间的角度看，在一个定义了内积的线性空间里，对一个N阶对称方阵进行特征分解，就是产生了该空间的N个标准正交基，然后把矩阵投影到这N个基上。N个特征向量就是N个标准正交基，而特征值的模则代表矩阵在每个基上的投影长度。特征值越大，说明矩阵在对应的特征向量上的方差越大，功率越大，信息量越多。不过，特征值分解也有很多的局限，比如说变换的矩阵必须是方阵。

在机器学习特征提取中，意思就是最大特征值对应的特征向量方向上包含最多的信息量，如果某几个特征值很小，说明这几个方向信息量很小，可以用来降维，也就是删除小特征值对应方向的数据，只保留大特征值方向对应的数据，这样做以后数据量减小，但有用信息量变化不大，PCA降维就是基于这种思路。

Matlab中通过eig函数就可求得特征值和特征向量矩阵。

```
>> B = [ 3     -2      -.9    2*eps
     -2      4       1    -eps
     -eps/4  eps/2  -1     0
     -.5    -.5      .1    1   ]
B =
    3.0000   -2.0000   -0.9000    0.0000
   -2.0000    4.0000    1.0000   -0.0000
   -0.0000    0.0000   -1.0000         0
   -0.5000   -0.5000    0.1000    1.0000

>> [V D] = eig(B)
V =
    0.6153   -0.4176   -0.0000   -0.1437
   -0.7881   -0.3261   -0.0000    0.1264
   -0.0000   -0.0000   -0.0000   -0.9196
    0.0189    0.8481    1.0000    0.3432
D =
    5.5616         0         0         0
         0    1.4384         0         0
         0         0    1.0000         0
         0         0         0   -1.0000
```

D对角线的元素即为特征值（表示了伸缩的比例），D就是特征值分解公式中的Q，V的每一列与D没列对应，表示对应的特征向量，即特征值分解中的Σ。

## 奇异值分解

特征值分解是一个提取矩阵特征很不错的方法，但是它只适用于方阵。而在现实的世界中，我们看到的大部分矩阵都不是方阵，比如说有M个学生，每个学生有N科成绩，这样形成的一个M * N的矩阵就可能不是方阵，我们怎样才能像描述特征值一样描述这样一般矩阵呢的重要特征呢？奇异值分解就是用来干这个事的，奇异值分解是一个能适用于任意的矩阵的一种分解的方法。我们有必要先说说特征值和奇异值之间的关系。

对于特征值分解公式， ATA 是方阵，我们求 ATA 的特征值，即 ![](http://www.forkosh.com/mathtex.cgi?%20(A%5ETA)x=%5Clambda%7Bx%7D) ，此时求得的特征值就对应奇异值的平方，求得的特征向量v称为右奇异向量，另外还可以得到：

![](http://www.forkosh.com/mathtex.cgi?%20%5Csigma_i=%5Csqrt%7B%5Clambda_i%7D)

![](http://www.forkosh.com/mathtex.cgi?%20u_i=%5Cfrac%7BAv_i%7D%7B%5Csigma_i%7D)

所求的ui就是左奇异向量， σi 就是奇异值。已有人对SVD的几何机理做了清晰的分析，非常受用，就不重复造轮子，下文为转载自[http://blog.sciencenet.cn/blog-696950-699432.html](http://blog.sciencenet.cn/blog-696950-699432.html) 。

![SVD分解](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/SVD%E5%88%86%E8%A7%A3.png)
SVD分解


SVD之所以很有效，是因为：在很多情况下，前10%甚至1%的奇异值的和就占了全部的奇异值之和的99%以上了。在这里，我们用图像简单的实践一下SVD的大妙处，下面是matlab对图像进行SVD分解的例子，

```matlab
I = imread('lena_gray.bmp');                  % 512x512的Lena图像
im = double(I);
[s,v,d]=svd(im);                              % svd分解，svd分解后特征值v对角线按从大到小排列，因此可以选择特征值大的进行恢复
recv1=s(:,1:20)*v(1:20,1:50)*d(:,1:50)';      % svd取最高的100个特征值进行恢复
recv2=s(:,1:50)*v(1:50,1:100)*d(:,1:100)';    % svd取最高的100个特征值进行恢复
recv3=s(:,1:200)*v(1:200,1:200)*d(:,1:200)';  % svd取最高的100个特征值进行恢复

subplot(221);imshow(I);
title('原图');
subplot(222);imshow(mat2gray(recv1));
title('恢复：左奇异20、右奇异50');
subplot(223);imshow(mat2gray(recv2));
title('恢复：左奇异50、右奇异100');
subplot(224);imshow(mat2gray(recv3));
title('恢复：左奇异200、右奇异200');
```

![图注：SVD二维图像压缩恢复](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/SVD%E4%BA%8C%E7%BB%B4%E5%9B%BE%E5%83%8F%E5%8E%8B%E7%BC%A9%E6%81%A2%E5%A4%8D.png)
图注：SVD二维图像压缩恢复


如果按左下角的方式压缩原图，则存储量变为：50x50+100x100+50=12500，而存储原图像的存储量为512x512=262144，则压缩比为262144/12500=20.97，这里没有考虑存储数据类型的差异。

SVD分解相对于特征值分解的优势就是：
- 分解的矩阵可以是任意矩阵
- 在恢复信号的时候左右奇异值可以选择不同的维度

另外值得注意的一点：不论是奇异值分解还是特征值分解，分解出来的特征向量都是正交的。

## 奇异值分解与PCA

关于奇异值与PCA的关系， [http://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html](http://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html) 给了很好的解释，也直接整理过来，感谢原作者：

![图注：SVD与PCA](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/SVD%E4%B8%8EPCA.png)
图注：SVD与PCA


PCA就是一种用于对数据进行降维的方法（降维肯定会丢失数据，只不过能在减少大量存储量的同时损失尽可能少），参见之前matlab对图像进行SVD分解的例子，更容易理解：实现了SVD就实现了PCA，PCA仅是SVD的包装。

PCA的应用很广，主要用在机器学习中对特征进行降维，还能用于去噪，下面两图是PCA降维和PCA去噪的例子（图片来自邹博PPT：北京9月秋季班·机器学习初步）

![图注：PCA降维](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/PCA%E9%99%8D%E7%BB%B4.png)
图注：PCA降维


降维说白了就是将信息通过投影到更低得多维度，这样必然会带来信息的丢失，但就如上图，这种信息的丢失却有时对分类没有影响，反而能降低识别算法的维度，提高速度，缓解所谓的维度灾难。

![图注：PCA去噪](http://xiahouzuoxin.github.io/notes/images/%E7%9F%A9%E9%98%B5%E7%89%B9%E5%BE%81%E5%80%BC%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3%E5%90%AB%E4%B9%89%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%BA%94%E7%94%A8/PCA%E5%8E%BB%E5%99%AA.png)
图注：PCA去噪


PCA去噪的前提是噪声的特征值会比信号的特征值小，即信噪比高的情况，否则PCA去噪会产生逆效果——把信号去掉了而噪声没去掉。

## SVD其它

SVD还有其它很多方面的应用，通过查找资料，这里先做个简单的罗列，有机会再一个个研究：
- 求伪逆。我们知道，矩阵求逆要求矩阵必须是方阵，SVD可以用来求任意矩阵的逆运算，求任意矩阵的逆矩阵称为求伪逆
- 最小二乘法求解。凭着对《矩阵论》的零星的记忆，SVD算法就是因为能求伪逆所以用来求解最小二乘法。
- 基于SVD的文本分类。首先接触是从吴军老师的《数学之美》一书上看到的，大致是：通过TF/IDF(term frequency/inverse document frequency)构建“一百万篇文章和五十万词的关联性”的矩阵 A1000000x500000 ，然后对A矩阵使用SVD分解之后，存储量减小，而且左奇异值矩阵和右奇异值矩阵以及奇异值矩阵的物理含义将非常明晰，[http://blog.csdn.net/wangzhiqing3/article/details/7431276](http://blog.csdn.net/wangzhiqing3/article/details/7431276) 有简单介绍，更多参见吴军老师的《数学之美》

另外，开源视觉库OpenCV中也提供SVD分解的算法。

## 参考
- [强大的矩阵奇异值分解(SVD)及其应用](http://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html)
- [http://blog.sciencenet.cn/blog-696950-699432.html](http://blog.sciencenet.cn/blog-696950-699432.html) ，关于SVD部分的讲解即出自此处。
- [http://www.cise.ufl.edu/~srajaman/Rajamanickam_S.pdf](http://www.cise.ufl.edu/~srajaman/Rajamanickam_S.pdf)
- July培训班PPT：“北京9月秋季班：贝叶斯、PCA、SVD”.
- 戴华编著《矩阵论》 教材，科学出版社. 有时候明白一点之后再回头参考数学教材要比网上大把的抓好得多，豁然开朗。




