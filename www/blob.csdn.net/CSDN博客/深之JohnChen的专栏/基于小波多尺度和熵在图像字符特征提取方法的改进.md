# 基于小波多尺度和熵在图像字符特征提取方法的改进 - 深之JohnChen的专栏 - CSDN博客

2006年03月16日 13:26:00[byxdaz](https://me.csdn.net/byxdaz)阅读数：3127


**基于小波多尺度和熵在图像字符特征提取方法的改进**

来源：电子技术应用  作者：周 莉 郑建彬 颜 琬 

**摘要：**提出了一种基于小波和熵提取图像字符特征的方法。该方法利用小波变换对图像字符进行多尺度分解，用marr零交叉边缘检测算子提取边缘；用基于判别熵最小化提取每一尺度图像的边界特征，小波的“数字显微镜”的优点与熵能确切地表达各类的交叠状况且能直接表达错误率的特征相结合。与其它方法相比，该方法提取的特征向量稳定、识别率高、算法快，非常有利于分类，且特征提取的方法有人类视觉的特点。 

**关键词：**多尺度分析 Marr边缘检测算子 判别熵 特征提取

在线签名验证是通过计算机采集和验证个人签名，从而实现无纸化办公的一种技术[1]。其中，从采集到的视频图像中提取有效的字符特片是在线签名验证系统的核心步骤。

随着计算机和模式识别技术的迅速发展，出现了很多提取字符特征的方案，最具代表性的有边缘描述法和矩描述法[2]。描述边缘形状的方法可用曲线拟合和傅立叶描述子方法。傅立叶描述子虽较好地描述了一封闭的图像轮廓，但其特征很多，噪声和量化误差对具有较低幅值的系数影响较大。当用FFT计算傅立叶系数，必须将其边界点的长度修成2的整数次幂，且其描述不具有三个（方向、位置、大小）不变性，不能直接用于目标识别，必须进行复杂的变换。这些都影响了它的使用。矩描述法就是利用图像灰度分布的各阶矩描述图像灰度分布的特征。矩特征是定义在整个图像空间上的一个二重积分，它同样不具有三个不变性，使用时必须进行归一化处理。不变矩只是一种旋转归一化方法，必须结合大小，位置归一化处理才有三个不变性。

**[图1](http://www.21ic.com/news/html/info/images/aet/200407/3h.gif)**

虽然用这些特征进行图像识别取得了较为满意的效果，但是，这些特征的定义都是相当复杂的，运算量很大，并且与人类认知的机理也是完全不同的，不能直观地理解。本文提出了一种将统计特征与结构特征相结合的新思路，对字符图像进行小波多尺度分解，有效地抑制了图像中的噪声，充分反映了图像结构的精细特征；用基于判别熵最小化进行特征提取能确切地表达各类的交叠状况，且能直接表达错误率，从而有效地提高识别率。

**1 小波多尺度分解**

为了寻找空间的L2的基，先从L2的某个子空间出发，在这个子空间中先建立基底，然后利用简单变换，把这个基底扩充到空间L2上，以形成一组基。这就是多尺度分析方法[3][4]。

对于二维的情况，设{V2J}jez是一个可分离的MRA：V2J=VjVj,其中{V2j}jez是L2（R2）的一个MRA，其尺度函数为￠是一维MRA{V2j}jez的实值尺度函数，小波母函数采用Dabuechies[6]小波；相应于二维尺度函数V2j=VjVj,定义三个函数：

![](http://www.21ic.com/info/images/aet/200407/3a.gif)

构成子空间W2j的正交标准基，而它们的伸缩平移系（简写）为：

![](http://www.21ic.com/info/images/aet/200407/3b.gif)

是L2（R2）的一个标准正交基。

在本系统中，通过与计算机相连的手写板及电子笔将签名采集到计算机并显示在屏幕上。采集并输入到计算机中的图像是二维，本文中设要分解的图像为f (x,y)ΕL2(R2)。为方便，设L2（R2）-V2N，即令fN是f在V2N的正交投影。这样关于f的有限小波分解就是对fN的分解。由于:

![](http://www.21ic.com/info/images/aet/200407/3c.gif)

假定{V2j}jez上的尺度函数Φj,Φj(x,y)=2jΦ(2jx,2jy)为二维MAR{V2j}jez的尺度函数，小波函数ψ(α)j, α=1,2,3已分别由式(1)和式(2)给出，并由阵列{CNk1,k2},(k1,k1ΕZ2)，使得：

![](http://www.21ic.com/info/images/aet/200407/3d.gif)

其中，Cn,k1,k2=<fN,N,k1,k2>

同样，有：

![](http://www.21ic.com/info/images/aet/200407/3e.gif)

式中（6），j=N-1,Λ,N-M。fj是fN在f2j上的低通滤波信号，而gαj, α=1,2,3是fN在W2j上的三个高通滤波细节。再设有限长序列{Pk1}、{Pk2}分别是平面(x,y)上x方向与y方向的高通滤波系数，{gk1}与{gk2}分别是x方向与y方向的低通滤波系数，则由式（6）得到：

![](http://www.21ic.com/info/images/aet/200407/3f.gif)

上式中箭头右部分是左部分的矩阵表示，其中CN是原始信号f(x,y)的分布阵列，Pr、Pc是分别对CN的行与列作低通滤波的算子，而Qr、Qc是分别对CN的行与列作高通滤波的算子。而进一步地第j次分解应为：

![](http://www.21ic.com/info/images/aet/200407/3g.gif)

式(7)中，j=N-2, Λ,N-M。式(7)便是二维信号fN或CN的有限正交小波分解的Mallat塔式算法[5]。通过实验，选用Daubechies 8小波能达到较好的分解效果。对采集进入计算机的真实签名与伪造签名进行小波分解，限于遍幅，本文只给出了真实签名的一次分解图，如图书1所示。

通常在实验中，借助Matlab6.5将真假签名的字符图像通过两个互补滤波器即低通滤波器和高通滤波器分别得到图像的相似和细节部分。相似子图主要是原始图像的全局、低频成分，而细节子图通常是原始图像的局部、高频成分。细节子图又包括水平子图、斜向子图和垂直子图三部分。其中细节子图经过两次滤波：水平方向允许低频分量通过，而沿垂直方向允许高频分量通过。这对横向笔划（灰度变化沿水平方向为低频，沿垂直方向为高频）是增强，而对竖笔划（灰度变化沿水平方向为高频，沿垂直方向为低频）是平滑。垂直方向和斜方向的像素按同样的道理分别在垂直子图和斜子图中被突出表示。这种方向选择性与人眼视觉特性相吻合，使建立在此基础上的特征提以算法具有类视觉特性。**[图2](http://www.21ic.com/news/html/info/images/aet/200407/3k.gif)2 零交叉边缘算子**

经典的边缘检测算子有Sobel算子、Laplace算子、Marr算子等，近年来又有学者提出了广义模糊算子[7]、形态学边缘算[8]等。而Marr边缘检测算子▽2G被誉为最佳边缘监测器之一，所以本文采Marr算子。该算子的特点是利用高斯滤波器对图像进行平滑。二维高斯滤波器的响应函数![](http://www.21ic.com/info/images/aet/200407/3i.gif)。设f(x,y)为二值图像函数，由线性系统中卷积和微分的可交换性，得▽2{G(x,y)хI(x,y)}={ ▽2G (x,y)} хI(x,y)，即：对图像的高斯平滑滤波与拉普拉斯微分运算可结合成一个卷积子如下：

![](http://www.21ic.com/info/images/aet/200407/3j.gif)

用上述算子卷积图像，通过判断符号的变化确定出零交叉点的位置，就是边缘点。对小波一次分解后的真实签名的处理结果如图2所示。

通过图2可以看出，Marr零交叉边缘算子同时提取了强、弱边缘，并且边缘相对干净，噪声干扰少，连续性好。

**3 基于判别熵最小化的特征提取**

不同的类样本占有不同的特征空间的区域，只要这些区域不相交叠，它们就可以分开。经常用样本间的平均距离作为特征提取的判据函数。重要的距离有Minkowski度量ΔM、欧氏距离δE、Chebychev距离δr、平方距离δQ和非线性度量δN等。在不考虑各类的概率分布时，不能确切地表达各类的交叠状况，且不能直接表达错误率。为此，应考虑概率距离，利用不确定性最小的分征进行分类是最有利的，故可用熵来度量后验证概率分布的集中程序。

某此概率分布密度偏离给定标准分布的程度的度量，叫相对熵。本文假定经小波和Marr算子处理后的图像函数?(xi,yj)的概率分布为P(xi,yj)，给定标准分布ω(xi,yj)，则两者之间的相对熵为：

求和应在该特征所有可能的取值上进行。

相对熵越小，这两类概率分布的差别就越大，当两类概率分别完全相同时，相对熵达最大值（等于零）。因此可以定义判别熵W（p,q）来表征两类分布p(xi,yj)和q(xi,yi)的差别大小。

![](http://www.21ic.com/info/images/aet/200407/3l.gif)

在多类情况下，可以用ΣnΣmW(p(n),q(m))表示各类分布之间的分离程度。这里n,m代表类别号。

对特征提取来说，在给定维数d的条件下，求得这样d个特征，它使上述判别熵最小。为了计算方便，本文用下列函数-U(p,q)= ΣiΣj(pi,j-qij)2≤0代替W(p,q)，而不影响选取d个最优特征的结果。

在不对概率分布作估计的情况下，可以用经过归一化处理的样本特征值代替上式中的概率分布。

![](http://www.21ic.com/info/images/aet/200407/3m.gif)

K是第一类样本集中的样本号，N1是第一类的样本总数，i是特征号。由于![](http://www.21ic.com/info/images/aet/200407/3n.gif)，这样做是合理的。而U取最小值的坐标系统工程是由矩阵A=G(1)-G(2)满足一定条件的d个本征值相应的本征向量组成的。这里G(1)和G(2)分别是第一类样本集和第二类本集的协方差矩阵。即将矩阵A的本征向量uk对应的本征值λk,k=1,2,ΛD排队：![](http://www.21ic.com/info/images/aet/200407/3o.gif)选取本征值对应的本征向量为所要求的坐标轴系统，在这个坐标系统中判别熵最小。在实验中选取Shannon熵。表1和表2分别列出了真实签名和伪造签名分解后的各尺度图像的最小判别熵。

由表1和表2的计算数据可以看出，通过小波一次分解后的最小判别熵的数据可以很明显地对真假签名进行鉴别。并且，相似图形与细节图形的最小判别熵相差甚远，区别较大；而细节图形中的水平子图、斜向子图和垂直子图三部分的最小判别熵却相差较小。因此，这样提取的特征向量稳定性好、区别性大、正确性高。**表1 真实签名最小判别熵**

||相似图形|水平子图|斜线子图|垂直子图|
|----|----|----|----|----|
|相似图形|0.0000|56.7827|58.371|60.5942|
|水平子图|58.371|0.0000|1.5883|3.8115|
|斜线子图|56.7827|1.5883|0.0000|2.2232|
|垂直子图|60.5942|3.8115|2.2232|0.0000|

**表2 伪造签名最小判别熵**

||相似图形|水平子图|斜线子图|垂直子图|
|----|----|----|----|----|
|相似图形|0.0000|101.5640|126.6594|149.2631|
|水平子图|101.5640|0.0000|25.0954|47.6991|
|斜线子图|126.6594|25.0954|0.0000|22.6037|
|垂直子图|149.25631|47.6991|22.6037|0.0000|

**4 实验结论**

对120个不同的真实签名进行了实验，且每份真实签名对应20个不同的伪造签名，用小波分别对这些签名图像进行6次分解，各选取其中的256幅图像，分别进行边缘连接及最小化判别熵特征提取，鉴别率达到了98.7%，取得了令人满意的结果。通过以上的理论分析和实验验证说明，用小波分解使原来单一的时域信号分解为不同频率尺度下的信号不仅能获得图像在各尺度上的细节信息，且噪声干扰少，边缘清晰；在特征提取时用熵函数的期望值表征类别的分离程度，可以作为分类有效性的评价。该方法的优越性对提高在线签名验证的精确性具有重要的意义。

