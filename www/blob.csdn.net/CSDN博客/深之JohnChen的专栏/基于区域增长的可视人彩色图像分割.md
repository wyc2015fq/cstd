# 基于区域增长的可视人彩色图像分割 - 深之JohnChen的专栏 - CSDN博客

2006年03月16日 13:02:00[byxdaz](https://me.csdn.net/byxdaz)阅读数：3253


**                                                          基于区域增长的可视人彩色图像分割**

来源：电子技术应用  作者：张 雯 郝重阳
**摘要：**提出了一种基于区域生长的彩色图像分割算法，以提取可视人数据集中真彩解剖切片的组织器官。通过对彩色图像颜色特片空间RGB和HSV的分析，选择出适合可视人数据中肺部器官特征的颜色分量作为生长算法中分割合并的特征度量法则。实验表明，该方法能较好地分割出可视人真彩胸部图像中的肺癌器官。

**关键词：**区域生长 可视人 彩色图像分割

人体可视化研究是20世纪后期兴起的一项信息技术与医学学科相互交叉、综合发展盐业的世界前沿性研究领域，是将成千上万个人体断面数据信息在计算机里整合、重建成人体的三维立体结构图像，构成人体形态学信息研究的实验平台，为开展各种人体相关研究提供形象而真的模型，具有重大的社会应用价值。可视人计划（Visible Human Project）由美国国家医学图书馆在1989年率先提出，1994年和1995年相继推出世界首例一男一女两具冰冻解剖尸体的高精度、高分辨率的真彩组织切片光学照片并伴有相应的CT和MRI图像作为辅助数据集。中国可见化人体计划于2001年正式启动，由第三军医大学可视人体计划研究目组在2002年和2003年推出了中国首例男女尸体数据集。该数据集较之美国具有更小切片间距、更高分辨率以及更大容量的优点。目前人体可视化研究进入到对人体及组织器官的重建和理解阶段，其中对真彩图像的组织器官的成功分割是该项目能否顺利进行的核心环节，同时也是目前最挑战性的问题。

彩色图像的分割方法主要包括彩色特片聚类（clustering）、边缘检测（edge-based）、区域生成（region growing）等。其中彩色特片聚类是基于灰度阈值分割的多维扩展，通常对每一颜色分量上的直方图分别采用阈值分割，再将结果组合起来。但由于彩色直方图阈值难于确定以及色彩映射导致信息耗散，采用这种方法通常出现聚类相互重叠。基于边缘的方法主要是利用图像中梯度或曲率行等特征的突变来检测边界，但对功节明显的复杂医学图像，其边缘有连续性较难保证。区域生成的方法是目前采用较多、效果较好的一类方法；缺点是对种子点的选取会影响结果的好坏，但对于完全采用自动分割目前尚属不易的医学解剖图像，人工交互选取子点是可行的方法。

本文选取了第三军医大学可视人数据集妇女性尸体胸部数据20张，分析了脉冲的颜色和纹理特征。采取了区域增长的方法，初始种子点由手工选取，并以肺部彩色特征作为增长算法的分割准则。实验结果表明，该方法能较好地分割出肺部区域。

**1 分析**

1．1 区域增长

区域生长的基本思想是将具有相似性质的像素集合起来构成区域。首先在待分割的每个区域中选择一个种子点作为生长的起始点，然后在种子点的领域中搜索那些与种子点的相似特征度满足指定生长准则的像素，并与种子点所在区域合并。此时将新合并的像素作为新的种子点，继续以上搜索和合并过程，直到没有可以合并的像素为止。

令F表示衡量像素相似程度的特征函数，Rk代表第k步时生长的区域，则Rk的区域特征函数为F（Rk）。同样，令当前像素为s(i,j)，其特征向量为F（s），区域增长算法的核心就是比较F（Rk）与F(s)的特征距离是否满足一定的阈值T。如果|F（Rk）-F(s)|<T，则像素s被合并至Rk+1=Rk+s，否则跳过像素s，搜索下一个相邻像素。

1．2 彩色特征空间

彩色图像分割面临的最大问题，是需要处理五维信息，其中两维是几何信息，三维是彩色信息。一个像素的颜色分布可以用彩色空间中三维向量来表示。在计算机硬件中，彩色图像用RGB颜色空间来存储及显示，而经过变化可以得到HSV、XYZ、YIQ等多种颜色空间。其中HSV是面向用户的一种符合主观感觉的色彩模型，更接近于人眼对颜色的感知，Hue表示色度，Saturation表示饱和度，Value表示强度。在对肺部数据的分析处理中，发现真彩图像中肺部区别于胸部其它器官的主要特征表现在V=（R+G+B）/3分量均值和方差都相对较小，说明肺部区域具有V分量较大相似度。因此将用像素的强度特征分量作为判断法则，RGB颜色空间向SHV颜色空间转换公式如下：

![](http://www.21ic.com/info/images/aet/200503/14a.gif)

s=1-{3×[min(R,G,B)]/(R+B+G)

V=(R+B+G)/3

**2 实现**

2．1 降低分辨率

对可视人数据进行处理的一个很大挑战，就是其超大的数据量。即使是身体上很小的一部分，要想保持完全分辨率，也将占用很大的硬盘空间和内存。例如，一张真彩胸部切片是18MB，分辨率为3072×2048，颜色深度为24位。因此，在分割之前，必须降低分辨率。笔者通过每3×3个像素采样，将之降到1024×683。当然分辨率的降低可能导致或增强局部体效应。

2．2 自适应区域生长算法

本文采用了自适应区域增长算法，首先操作者在感兴趣区域（ROI）居中位置选择一种子点s(i,j)作为初始点，然后搜索其5×5领域φ，计算该领域V分量的均值和方差，并将阈值Thd和方差σ作为判断准则，计算公式如下：

均值![](http://www.21ic.com/info/images/aet/200503/14b.gif)，其中v为φ中像素的v分量值，pv为分量值等于v的概率

![](http://www.21ic.com/info/images/aet/200503/14c.gif)

阈值Thd=Raver-sv,其中sv表示种子点的v的分量值。

算法中定义了三个操作集合，集合Cur_Set用于存放分割区域的像素点；Ready_Set集合存放待检验的像素点，由于每次都检验四个相邻像素点，所以该集合中元素个数始终为4；临时集合Temp_Set用于存放新的候选中心点。初始化时，Cur_Set中仅有初始种子点s，Ready_Set中有s的四个领域点s(i,j-1)、s(i,j+1)、s(i-1,j)、s(i+1,j，Temp_Set集合为空。程序首先搜索Ready_Set集合中的点，如果与种子点的分量差值小于阈值且方差小于0.02，则将该点放入Cur_Set集合中，并将该点的四个相邻像素点放入集合Temp_Set中，等待下一步处理；否则，该点将从Ready_Set中去除。依次计算，直到Ready_Set集合为空，然后再分别以临时集合Temp_Set中元素为种子点，建立新的四领域点，要新Ready_Set集合，程序重复以上步骤，直到Teady_Set集合为空。
![](http://www.21ic.com/info/images/aet/200503/14d.gif)
2．3 实验结果

实验中，选取上胸部直彩图像。

由于数据量很大，完成整个胸部的分割，必须在工作站上进行。为了提高运算速度并能在PC机上运行，在左、右肺分别进行分割。在Matlab6.5上分别用时4分56秒和3分40秒。实验结果如图1（a）～（d）所示。由图1可知，该算法能比较好的地分割出肺部区域，但边界的平滑性还需要进一步处理。

本文针对可视人真彩解剖图像的待分割器官的颜色特征，采用了基于人工选取种子点的区域增长算法进行初步研究。实验结果表明，该方法对可见人肺部区域的分割能较好达到精度要求。但是还有一些问题需要进一步探索和解决，包括肺部血管的提取，如何在提高运算速度的同时不牺牲图像分辨率和精度，如何将算法有效推广到其他器官部位等。 

