# 在一个程序中打开另一个应用程序 - 深之JohnChen的专栏 - CSDN博客

2006年02月07日 10:28:00[byxdaz](https://me.csdn.net/byxdaz)阅读数：3823


如何在一个程序中打开另一个应用程序 常用以下这几个函数:

spawnl()
system()
exec()
shellexecute()

示例:
   spawnl(P_OVERLAY,"c://command.com","command.com","/calc.exe",NULL); 

   system("c:/calc.exe");能调试出来计算器。

    exec("c:/calc.exe");

如何打开一个应用程序？
ShellExecute(this->m_hWnd,"open","calc.exe","","", SW_SHOW );
或
ShellExecute(this->m_hWnd,"open","notepad.exe",
"c://MyLog.log","",SW_SHOW );
As you can see, I havent passed the full path of the programs. 

如何打开一个同系统程序相关连的文档？
ShellExecute(this->m_hWnd,"open",
"c://abc.txt","","",SW_SHOW );

如何打开一个网页？
ShellExecute(this->m_hWnd,"open",
" <a href="http://www.google.com","","",/" target="_blank">http://www.google.com","","", SW_SHOW );

如何激活相关程序，发送EMAIL？
ShellExecute(this->m_hWnd,"open",
"mailto:nishinapp@yahoo.com","","", SW_SHOW );

如何用系统打印机打印文档？
ShellExecute(this->m_hWnd,"print",
"c://abc.txt","","", SW_HIDE);

 如何用系统查找功能来查找指定文件？
ShellExecute(m_hWnd,"find","d://nish",
NULL,NULL,SW_SHOW);

如何启动一个程序，直到它运行结束？
SHELLEXECUTEINFO ShExecInfo = {0};
ShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);
ShExecInfo.fMask = SEE_MASK_NOCLOSEPROCESS;
ShExecInfo.hwnd = NULL;
ShExecInfo.lpVerb = NULL;
ShExecInfo.lpFile = "c://MyProgram.exe"; 
ShExecInfo.lpParameters = ""; 
ShExecInfo.lpDirectory = NULL;
ShExecInfo.nShow = SW_SHOW;
ShExecInfo.hInstApp = NULL; 
ShellExecuteEx(&ShExecInfo);
WaitForSingleObject(ShExecInfo.hProcess,INFINITE);
或：
PROCESS_INFORMATION ProcessInfo; 
STARTUPINFO StartupInfo; //This is an [in] parameter
ZeroMemory(&StartupInfo, sizeof(StartupInfo));
StartupInfo.cb = sizeof StartupInfo ; //Only compulsory field
if(CreateProcess("c://winnt//notepad.exe", NULL, 
NULL,NULL,FALSE,0,NULL,
NULL,&StartupInfo,&ProcessInfo))
{ 
WaitForSingleObject(ProcessInfo.hProcess,INFINITE);
CloseHandle(ProcessInfo.hThread);
CloseHandle(ProcessInfo.hProcess);
} 
else
{
MessageBox("The process could not be started...");
}

如何显示文件或文件夹的属性？
SHELLEXECUTEINFO ShExecInfo ={0};
ShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);
ShExecInfo.fMask = SEE_MASK_INVOKEIDLIST ;
ShExecInfo.hwnd = NULL;
ShExecInfo.lpVerb = "properties";
ShExecInfo.lpFile = "c://"; //can be a file as well
ShExecInfo.lpParameters = ""; 
ShExecInfo.lpDirectory = NULL;
ShExecInfo.nShow = SW_SHOW;
ShExecInfo.hInstApp = NULL; 
ShellExecuteEx(&ShExecInfo);

出处：

[http://www.vchelp.net/cndevforum/subject_view.asp?subject_id=155815&forum_id=59](http://www.vchelp.net/cndevforum/subject_view.asp?subject_id=155815&forum_id=59)

