# 机器学习方法总结（十）：条件随机场 - qq_38593211的博客 - CSDN博客





2018年08月02日 20:33:23[小屁猴多看书](https://me.csdn.net/qq_38593211)阅读数：77








# 条件随机场（CRF）

> 
这里只做理论总结，至于它用于NLP中的序列标注会另讲。


## 1.马尔科夫随机场

   马尔可夫性质：它指的是一个随机变量序列按时间先后关系依次排开的时候，第N+1时刻的分布特性，与N时刻以前的随机变量的取值无关。马尔科夫随机场中：一个无向图组成，图的顶点u在状态a的概率只依赖顶点u的最近临界点，并且顶点u对途中的其他任何节点都是条件独立的，由此构成了顶点u的最近邻节点集合Nu，称为马尔科夫链。

    概率无向图：设联合概率分布P(Y),由无向图G=(V,E)表示，图G中，节点表示随机变量，边表示随机变量之间的依赖关系，如果P(Y)满足马尔可夫性质，则此联合概率称为概率无向图模型。

    团：无向图G中任何两个结点均有边连接的结点子集称为团（即互通）。

## 2.CRF的定义和形式

    给定一组输入随机变量条件下另一组输出随机变量的条件概率分布模型，在条件概率分布模型P(Y|X)中,Y是输出变量，表示标记序列，X是输入变量，表示观测序列，在做预测问题时:训练时利用数据集通过极大似然估计得到条件概率模型，在学习时，给定输入序列X，求出条件概率最大的输出序列Y。这里说的CRF时线性CRF，即满足：

![P(Y_{i}|X,Y_{1}...Y_{i-1},Y_{i+1}...Y_{n}])=P(Y_{i}|X,Y_{i-1},Y_{i+1})](https://private.codecogs.com/gif.latex?P%28Y_%7Bi%7D%7CX%2CY_%7B1%7D...Y_%7Bi-1%7D%2CY_%7Bi&plus;1%7D...Y_%7Bn%7D%5D%29%3DP%28Y_%7Bi%7D%7CX%2CY_%7Bi-1%7D%2CY_%7Bi&plus;1%7D%29)

    参数化形式：设X=x，Y=y时的条件概率为：

![P(y|x)=\frac{1}{Z(x)}exp(\sum _{i,k}\lambda _{k}t_{k}(y_{i-1},y_{i},x,i)+\sum _{i,l}\mu _{l}s_{l}(y_{i},x,i))](https://private.codecogs.com/gif.latex?P%28y%7Cx%29%3D%5Cfrac%7B1%7D%7BZ%28x%29%7Dexp%28%5Csum%20_%7Bi%2Ck%7D%5Clambda%20_%7Bk%7Dt_%7Bk%7D%28y_%7Bi-1%7D%2Cy_%7Bi%7D%2Cx%2Ci%29&plus;%5Csum%20_%7Bi%2Cl%7D%5Cmu%20_%7Bl%7Ds_%7Bl%7D%28y_%7Bi%7D%2Cx%2Ci%29%29)

![Z(x)=\sum _{y}exp(\sum _{i,k}\lambda _{k}t_{k}(y_{i-1},y_{i},x,i)+\sum _{i,l}\mu _{l}s_{l}(y_{i},x,i))](https://private.codecogs.com/gif.latex?Z%28x%29%3D%5Csum%20_%7By%7Dexp%28%5Csum%20_%7Bi%2Ck%7D%5Clambda%20_%7Bk%7Dt_%7Bk%7D%28y_%7Bi-1%7D%2Cy_%7Bi%7D%2Cx%2Ci%29&plus;%5Csum%20_%7Bi%2Cl%7D%5Cmu%20_%7Bl%7Ds_%7Bl%7D%28y_%7Bi%7D%2Cx%2Ci%29%29)

    tk是对应边上的转移函数，sl结点上的是特征函数，![\lambda _{k},\mu _{l}](https://private.codecogs.com/gif.latex?%5Clambda%20_%7Bk%7D%2C%5Cmu%20_%7Bl%7D)是对应的权值，求和是在所有可能的输出序列上进行的。

## 3.优势
- 没有HMM的两个独立假设条件，特征设计灵活。
- 计算全局最优输出节点的概率，克服了MEMM的标志偏执缺点。





