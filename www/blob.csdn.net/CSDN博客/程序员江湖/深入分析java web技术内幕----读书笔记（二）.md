# 深入分析java web技术内幕----读书笔记（二） - 程序员江湖 - CSDN博客





2017年03月13日 13:26:03[黄小斜](https://me.csdn.net/a724888)阅读数：826











# [深入分析 Java I/O 的工作机制](http://blog.csdn.net/jiafu1115/article/details/6937785)









# 总结：

1 I/O接口分为字节型和字符型，通过inputstreamreader进行转换。




2I/O访问方式

2.1 磁盘I/O：标准访问文件方式：从用户地址空间经过内核空间物理磁盘再到。

2.2 直接I/O：不经过内核空间直接访问磁盘，但是不经过缓存，速度较慢。

2.3 内存映射方式访问，内存某一块区域与磁盘关联，数据共享





2.4 同步、异步、阻塞、非阻塞：
**同步异步注重调用的方式，**

**同步在调用时会等待调用返回结果。**




**异步会直接返回，并等所调用的对象进行回调。**

**阻塞非阻塞注重结果的返回**




**阻塞会一直挂起等待返回值。**

**非阻塞可以在等待时做其他事，隔一段时间再来查看结果。**



**3、java序列化技术（java io）：实现serializable接口。与cloneable接口的区别是浅拷贝和深拷贝的区别。**

**要点有：**

**3.1父类实现serializable接口，子类可序列化**

**3.2、子类实现serializable接口，父类没有，父类属性不能序列化**

**3.3、若序列化的对象持有其他对象引用，其他对象也要序列化。**

**3.4、反序列化时id若被修改则会失败。**

**3.5transient关键字指定某属性不被序列化。**





**4、网络I/O基于socket**

**4.1基础是tcp协议**

**4.2影响传输的因素：带宽、传输距离、tcp拥塞控制**

**4.3socket包含本地地址，远程地址，端口号。**

**4.4socket创建时，操作系统为其分配一个缓冲区，用于数据读取与写入。**

**sendq队列用于写入数据到outputstream，recvq队列用于读取数据到inputstream。**

**队列满时会阻塞，队列空时会等待，即生产消费者的阻塞队列模式。**



**5NIO：解决BIO的困境，采用非阻塞io，**

**1使用selector静态工厂创建一个选择器。**

**2创建一个服务端的channel绑定到一个socket对象，把他注册到选择器上，selector可以监听channel中所有通信信道的事件。**

**3将通信信道设为非阻塞，使线程可以在信道之间切换。**

**4通过selectedkey来检查已注册选择器上的信道是否有事件发生，如果有事件发生，返回所有selectedkey，通过channel方法得到通信信道对象，通过buffer进行数据读取。**

**5、tomcat和jetty使用一个线程监听客户端请求，是阻塞的，另一个线程负责处理请求，是非阻塞的。**

**6、线程在得知事件发生后，找到对应的buffer进行数据交互，并且可以与多个buffer交互，是非阻塞的。**

**7、buffer的数据访问方式：经过socket缓冲再复制到buffer，或者直接操作系统缓冲区（通过directbuffer操作非jvm堆内存）每次创建或释放需要调用一次system.gc。可能引起内存泄漏。**



**6、IO调优**

**1磁盘优化**

**2tcp参数优化**

**3网络io优化：减少交互、减少数据返回、减少编码。**



**适配器和装饰者：**

**适配器把一个接口转接成另一个接口。**

**而装饰者只是扩展原接口功能。**








# 原文链接：http://blog.csdn.net/a724888/article/details/61916885








