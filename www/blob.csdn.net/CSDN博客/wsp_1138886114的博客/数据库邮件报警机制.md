# 数据库邮件报警机制 - wsp_1138886114的博客 - CSDN博客





2019年03月26日 16:37:22[SongpingWang](https://me.csdn.net/wsp_1138886114)阅读数：423标签：[数据库邮件报警机制](https://so.csdn.net/so/search/s.do?q=数据库邮件报警机制&t=blog)
个人分类：[MySQL-MongoDB-Oracle数据库](https://blog.csdn.net/wsp_1138886114/article/category/7678647)









数据库报警邮件

```python
#!/usr/bin/python
# -*- encoding: utf-8 -*-
import re
import time
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart


def alarm_mail(text):
    now_time = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime())
    mag = str(now_time) + text
    smtp_server = '10.0.100.202'
    fromaddr = 'your_email_name@qq.com'
    password = 'email_password'
    toaddrs = ['zhangsan@qq.com','lisi@163.com','wangwu@other.com']

    message = MIMEText('数据库:'+str(ip)+'，出现异常，敬请关注！时间：'+ str(mag))
    message['Subject'] = '据库运行异常状态'
    message['From'] = 'company_email@name.com'
    message['To'] = ",".join(toaddrs)

    try:
        server = smtplib.SMTP(smtp_server, 25)
        server.set_debuglevel(1)
        server.login(fromaddr, password)
        server.sendmail(fromaddr, toaddrs, message.as_string())
        
        print("email send OK!")
        server.quit()

    except smtplib.SMTPException as e:
        print (e)


if __name__ == '__main__':
    text = '传入数据异常'
    alarm_mail(text)
```



