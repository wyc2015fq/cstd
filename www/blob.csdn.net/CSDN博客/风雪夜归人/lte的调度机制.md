# lte的调度机制 - 风雪夜归人 - CSDN博客
2017年08月18日 09:37:05[cdjccio](https://me.csdn.net/qq_34624951)阅读数：545
1      概述
   LTE的无线资源调度功能位于eNodeB的MAC子层。无线资源调度时eNodeB的一项核心功能，目的是决定哪些用户可以得到何种资源，即决定每个用户使用的时频资源、NCS、SISO/MIMO等。
无线资源调度由eNodeB中的动态资源调度器实现。动态资源调度器为下行共享信道（DL-SCH）和上行共享信道（UL-SCH）分配物理层资源。DL-SCH和UL-SCH分别使用不同的调度器进行调度操作。
对UL-SCH上的传输进行授权时，其授权时针对每个UE的，而没有针对每个UE的每个RB的资源授权（Only
 "per UE" grants are used to grant the right totransmit on the UL-SCH. There are no "per UE per RB" grants）。
动态资源调度器需要根据上下行信道的无线链路状态来进行资源分配，而无限链路状态是根据eNodeB和UE上报的测量结果进行判定的。分配的无线资源包含物理资源块的数量、物理资源块的位置以及调制编码方案MCS。
2      基本的调度操作
   LTE可以实现时域、频域和码域资源的动态调度和分配。动态调度带来的一个重要变化是LTE不再使用3******MA系统中“专用信道”来传送数据，而代之以“共享信道”，即不再为特定用户长时间地保留固定的资源，而是将用户的数据都分割成小块，然后依赖高效的调度机制将来自多个用户的“数据块”复用在一个共享的大的数据信道中。因此，LTE的性能能否充分发挥，很大程度上取决于调度机制的效率。一方面要根据无线信道的特性进行灵活地调度，另一方面又不能大幅度增加系统的信令开销。
频域资源调度是LTE系统资源调度的重要方法。在频域资源调度中，eNodeB上的调度器根据上下行信道的CQI（信道质量指示）、QoS参数和测量、eNodeB缓存中等待调度的负载量、在队列中等待的重传任务、UE能力（Capability）、UE睡眠周期和测量间隔/测量周期、系统参数（如系统带宽/干扰水平/干扰结构）等信息，动态地为UE选择适合的RB进行上下行传输，并通过下行控制信令指示给UE。在上述信息中，CQI是资源调度最重要的考虑因素之一。
由于LTE系统中资源调度和链路自适应完全由eNodeB控制，因此上行信道CQI的测量值可以由eNodeB直接获取并使用，也不需要标准化；而下行信道的CQI值需要在UE侧获取，并由UE反馈给eNodeB。
2.1    下行链路调度
在下行链路，eNodeB可以在每个TTI上用以某个UE的C-RNTI加扰的PDCCH为这个UE分配资源。当UE能够进行下行链路数据接收时，为了得到可能分配给该UE的下行资源，UE需要一直监视PDCCH。
下行链路调度的具体执行落实在下行共享信道的物理层过程。
下行资源的分配方案通过PDCCH信道发下去，通知某个UE在什么时频资源块、以什么样的调制编码方案、什么样的MIMO工作模式向该UE发送下行数据；随后，下行数据通过PDSCH信道发送给该UE，UE则根据PDCCH信道上的指示找到eNodeB发给自己的数据，如下图所示。
下行资源调度相关的信令是上行的信道质量信息（CQI）报告，和下行资源调度控制指令。
   UE的CQI报告是下行资源调度的重要依据，但不是唯一的依据。eNodeB还有其它考虑，比如UE能力（Capability）、业务QoS要求、公平性等。CQI信息不仅仅用于下行资源调度，还用于干扰协调、功率控制、AMC等重要过程。UE测量eNodeB的导频信号，得到不同频域的资源块的信噪比，然后以CQI报告的形式上报eNodeB。CQI报告周期可以调整，如果周期过小，则信令开销太大；如果周期过大，则下行调度器就不能全面了解下行信道的质量信息。
下行调度控制指令指导UE对下行发送信号进行接收处理，包括三种指示（如下表）：
    1）资源分配信息：包括UE标识、分配的时频资源块位置、占用资源的时长。
    2）传输格式：包括多天线信息和调制方式。
    3）HARQ信令：包括异步HARQ和同步HARQ。异步HARQ信令包括HARQ流程编号、IR（增量冗余） HARQ的冗余版本、新数据制式等；同步HARQ信令包括重传序列号。
2.2    上行链路调度
在上行链路，eNodeB可以在每个TTI上用以某个UE的C-RNTI加扰的PDCCH为UE分配资源（PRB和MCS）。当UE能够进行下行链路接收时，为了得到可能分配给该UE的上行链路传输资源，UE需要一直监视PDCCH。
在上行方向，UE不能随时随意地发送自己的数据，必须服从eNodeB的安排。上行资源的调度由eNodeB的MAC层的上行调度器决定，执行单位则是上行共享信道的物理层过程。
由于无线资源调度由eNodeB完成，因此UE需要适时向eNodeB发送调度请求（SR），用于请求UL-SCH资源。UE发送调度请求的规则是：如果在当前TTI配置由PUCCH来发送调度请求，且没有可用的UL-SCH资源，则UE的MAC层将指示物理层在PUCCH上发送调度请求；如果UE在任何TTI都没有配置PUCCH来发送调度请求，则UE将发起随机接入过程；如果一个调度请求已经被触发，UE将在每个TTI进行请求，直到获得UL-SCH资源。
   UE还需要向eNodeB发送缓冲区状态报告（BSR），用于为eNodeB提供UE上行链路缓冲区中数据量的信息。触发BSR的事件包括以下几种：
    1）UE的传输缓冲区中有上行链路数据到达，并且数据所属的逻辑信道优先权比已经有数据存在的缓冲区所属的逻辑信道的优先权高，则触发“正常BSR”。
    2）UE拥有上行链路资源分配且填充比特数≥BSR MAC控制单元的大小，同时没有其他BSR等待传输，则触发“填充BSR”。
    3）服务小区发生变化，触发“正常BSR”。
    4）周期性BSR定时器超时，触发“周期性BSR”。
   eNodeB的上行调度器根据UE缓存状态报告BAR、上行调度请求SR、上行信道状况决定给UE调度什么样的无线资源，把调度结果通过PDCCH信道的上行调度准许（UL
 Grant）告知UE；UE根据eNodeB的指示，在PUSCH信道发送业务数据。
与上行无线资源调度有关的信令包括上行资源调度申请（以及缓存状态报告）、上行调度准许（UL Grant）。上行调度准许（ULGrant）用于确定UE的上行发送信号格式（如下表），包括：
    1）资源分配信息；
    2）传输格式；
3      资源调度的输入参数和输出结果
   LTE动态资源调度的主要结果是：
    1）下行子帧内资源分配（时域资源、频率资源、功率资源）；
    2）上行子帧内资源分配（时域资源、频率资源、功率资源）；
    3）子帧间负荷均衡（时域资源、功率资源）；
    4）MIMO模式选择和切换（空域资源调度）；
    5）调制编码方案（MCS）的选择；
    6）HARQ数据重传选择；
下行子帧内资源分配是指eNodeB动态资源调度器对PDSCH资源的使用分配。下行调度器根据缓存（Buffer）状态、业务承载的QoS等级（共9个）、信道测量报告等信息进行下行资源的分配。由于eNodeB可以准确知道每个无线承载（Radio
 Bearer，RB）的缓存（Buffer）状态，下行调度器可以基于无线承载（RadioBearer，RB）进行无线资源调度。
上行子帧内资源分配是指eNodeB的上行资源调度器对上行共享信道PUSCH资源的使用分配。每个UE可能同时进行多种业务，即一个用户同时存在多个无线承载的时候，由于缓冲区状态报告（BSR）的最小汇报单元是RBG（RB
 Group），eNodeB不可能准确知道一个UE的每个RB的具体信息，所以，上行资源调度时基于每个用户进行无线资源分配，即每次调度时，调度器给一个用户发一个调度命令，并不做业务上的区分，这一点和下行资源调度不同。上行一个用户内多业务之间的资源分配可以按照默认的原则进行。[#《LTE轻松进阶》
 元泉 电子工业出版社](http://bbs.c114.net/file:///C:/Users/TOPTJ/Desktop/LTE%E7%A0%94%E7%A9%B6/LTE%E8%B0%83%E5%BA%A6%E6%9C%BA%E5%88%B6.doc#_%E3%80%8ALTE%E8%BD%BB%E6%9D%BE%E8%BF%9B%E9%98%B6%E3%80%8B__%E5%85%83%E6%B3%89)
子帧间负载均衡用在TDD工作模式下，是为了避免瞬时同频干扰而采取的一种时域干扰协调机制。
   LTE协议规定了MIMO有七种工作模式，可以根据当前的信道条件、UE的速度变化选择MIMO的工作模式以及在MIMO工作模式之间切换。MIMO的默认工作模式是发射分集，它是一种首先保证可靠性、鲁棒性的工作模式，在信号较差、UE速度较高的场景下使用，可以克服无线环境的复杂性，减少传送误差。当无线信道的质量好起来以后，可以选用开环复用。当UE的速度降下来以后，可选用低阶（RANK=1）闭环复用。当UE速度不快且无线信道质量比较好时，可以选用高阶（RANK比较大）的闭环复用。
根据反馈的信道质量条件，调度器可以决定每一个调度周期内无线资源采取的调制编码方案（MCS）和混合自动重传（HARQ）方式。
调度算法有两个重要的设计参数：一个是吞吐量，另一个是公平性。调度算法是数据业务系统的一个特色，目的是充分利用信道的时变特性，得到多用户分集增益，提供系统的吞吐量。吞吐量用小区单位时间内传输的数据量来衡量。公平性指小区所有用户是否都获得一定的服务机会，最公平的算法是所有用户享有相同的服务机会。好的调度算法应该兼顾吞吐量和公平性。
根据算法的特点，调度算法可以分为：轮询（Round Robin, RR）算法、最大C/I算法（Max C/I）、比例公平算法（ProportionalFair，PF）等。
