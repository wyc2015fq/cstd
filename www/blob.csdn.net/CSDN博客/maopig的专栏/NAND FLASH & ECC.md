# NAND FLASH & ECC - maopig的专栏 - CSDN博客
2012年12月09日 23:20:01[maopig](https://me.csdn.net/maopig)阅读数：994
NAND需要ECC以确保数据完整性。NAND闪存的每一个页面上都包括额外的存储空间，它就是64个字节的空闲区(每512字节的扇区有16字节)。该区能存储ECC代码及其它像磨损评级或逻辑到物理块映射之类的信息。ECC能在硬件或软件中执行，但是，硬件执行有明显的性能优势。在编程操作期间，ECC单元根据扇区中存储的数据来计算误码校正代码。数据区的ECC代码然后被分别写入到各自的空闲区。当数据被读出时，ECC代码也被读出；运用反操作可以核查读出的数据是否正确。
　　有可能采用ECC算法来校正数据错误。能校正的错误的数量取决于所用算法的校正强度。在硬件或软件中包含ECC，就提供了强大的系统级解决方案。最简单的硬件实现方案是采用简单的汉明(Simple Hamming)码，但是，只能校正单一位错误。瑞德索罗门(Reed-Solomon)码提供更为强大的纠错，并被目前的控制器广为采用。此外，BCH码由于比瑞德索罗门方法的效率高，应用也日益普及。用软件执行NAND闪存的区块管理。该软件负责磨损评级或逻辑到物理映射。该软件还提供ECC码，如果处理器不包含ECC硬件的话。 
      要用软件执行NAND闪存的区块管理。该软件负责磨损评级或逻辑到物理映射。该软件还提供ECC码，如果处理器不包含ECC硬件的话。
编程或擦除操作之后，重要的是读状态寄存器，因为它确认是否成功地完成了编程或擦除操作。如果操作失败，要把该区块标记为损坏且不能再使用。以前已编写进去的数据要从损坏的区块中搬出，转移到新的(好的)存储块之中。2Gb NAND的规范规定，它可以最多有40个坏的区块，这个数字在器件的生命周期(额定寿命为10万次编程/擦除周期)内都适用。一些有坏块的NAND器件能够出厂，主要就归根于其裸片面积大。管理器件的软件负责映射坏块并由好的存储块取而代之。
利用工厂对这些区块的标记，软件通过扫描块可以确定区块的好坏。坏块标记被固定在空闲区的第一个位置(列地址2048)。如果在0或1页的列地址2048上的数据是“non-FF”，那么，该块要标记为坏，并映射出系统。初始化软件仅仅需要扫描所有区块确定以确定哪个为坏，然后建一个坏块表供将来参考。
　　小心不要擦除坏块标记，这一点很重要。工厂在宽温和宽电压范围内测试了NAND；一些由工厂标记为坏的区块可能在一定的温度或电压条件下仍然能工作，但是，将来可能会失效。如果坏块信息被擦除，就无法再恢复。
