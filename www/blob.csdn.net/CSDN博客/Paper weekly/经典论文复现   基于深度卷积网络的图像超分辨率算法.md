
# ç»å…¸è®ºæ–‡å¤ç° | åŸºäºæ·±åº¦å·ç§¯ç½‘ç»œçš„å›¾åƒè¶…åˆ†è¾¨ç‡ç®—æ³• - Paper weekly - CSDNåšå®¢


2018å¹´12æœˆ14æ—¥ 12:52:22[Paper_weekly](https://me.csdn.net/c9Yv2cf9I06K2A9E)é˜…è¯»æ•°ï¼š287


![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgm9RFr5icmiaj0bibJxUeIGdAFHNM4G6PJEiccw293RuVnOiadQ4zcdibdJa5FFfn0ZMgpbKib4AAKD8dm2w/640)

è¿‡å»å‡ å¹´å‘è¡¨äºå„å¤§ AI é¡¶ä¼šè®ºæ–‡æå‡ºçš„ 400 å¤šç§ç®—æ³•ä¸­ï¼Œå…¬å¼€ç®—æ³•ä»£ç çš„ä»…å  6%ï¼Œå…¶ä¸­ä¸‰åˆ†ä¹‹ä¸€çš„è®ºæ–‡ä½œè€…åˆ†äº«äº†æµ‹è¯•æ•°æ®ï¼Œçº¦ 54% çš„åˆ†äº«åŒ…å«â€œä¼ªä»£ç â€ã€‚è¿™æ˜¯ä»Šå¹´ AAAI ä¼šè®®ä¸Šä¸€ä¸ªä¸¥å³»çš„æŠ¥å‘Šã€‚äººå·¥æ™ºèƒ½è¿™ä¸ªè“¬å‹ƒå‘å±•çš„é¢†åŸŸæ­£é¢ä¸´ç€å®éªŒé‡ç°çš„å±æœºï¼Œå°±åƒå®éªŒé‡ç°é—®é¢˜è¿‡å»åå¹´æ¥ä¸€ç›´å›°æ‰°ç€å¿ƒç†å­¦ã€åŒ»å­¦ä»¥åŠå…¶ä»–é¢†åŸŸä¸€æ ·ã€‚**æœ€æ ¹æœ¬çš„é—®é¢˜æ˜¯ç ”ç©¶äººå‘˜é€šå¸¸ä¸å…±äº«ä»–ä»¬çš„æºä»£ç ã€‚**

å¯éªŒè¯çš„çŸ¥è¯†æ˜¯ç§‘å­¦çš„åŸºç¡€ï¼Œå®ƒäº‹å…³ç†è§£ã€‚éšç€äººå·¥æ™ºèƒ½é¢†åŸŸçš„å‘å±•ï¼Œæ‰“ç ´ä¸å¯å¤ç°æ€§å°†æ˜¯å¿…è¦çš„ã€‚ä¸ºæ­¤ï¼Œ**PaperWeekly è”æ‰‹ç™¾åº¦ PaddlePaddle å…±åŒå‘èµ·äº†****æœ¬æ¬¡è®ºæ–‡æœ‰å¥–å¤ç°**ï¼Œæˆ‘ä»¬å¸Œæœ›å’Œæ¥è‡ªå­¦ç•Œã€å·¥ä¸šç•Œçš„ç ”ç©¶è€…ä¸€èµ·æ¥åŠ›ï¼Œä¸º AI è¡Œä¸šå¸¦æ¥è‰¯æ€§å¾ªç¯ã€‚

ä½œè€…ä¸¨å¼ è£æˆ
å­¦æ ¡ä¸¨å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦ï¼ˆæ·±åœ³ï¼‰
ç ”ç©¶æ–¹å‘ä¸¨è®¡ç®—æ•°å­¦

**ç¬”è€…æœ¬æ¬¡é€‰æ‹©å¤ç°çš„æ˜¯æ±¤æ™“é¸¥æ•™æˆå’Œä½•æºæ˜å›¢é˜Ÿå‘è¡¨äº 2015 å¹´çš„ç»å…¸è®ºæ–‡â€”â€”****SRCNN****ã€‚**è¶…åˆ†è¾¨ç‡æŠ€æœ¯ï¼ˆSuper-Resolutionï¼‰æ˜¯æŒ‡ä»è§‚æµ‹åˆ°çš„ä½åˆ†è¾¨ç‡å›¾åƒé‡å»ºå‡ºç›¸åº”çš„é«˜åˆ†è¾¨ç‡å›¾åƒï¼Œåœ¨ç›‘æ§è®¾å¤‡ã€å«æ˜Ÿå›¾åƒå’ŒåŒ»å­¦å½±åƒç­‰é¢†åŸŸéƒ½æœ‰é‡è¦çš„åº”ç”¨ä»·å€¼ã€‚åœ¨æ·±åº¦å·ç§¯ç½‘ç»œçš„æµªæ½®ä¸‹ï¼Œ**æœ¬æ–‡****é¦–æ¬¡æå‡ºäº†åŸºäºæ·±åº¦å·ç§¯ç½‘ç»œçš„ç«¯åˆ°ç«¯è¶…åˆ†è¾¨ç‡ç®—æ³•ã€‚**

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoeMftXRibPNrxHh2NZeOz85uGQGRXK7jefbPH28ZwWHOAFWB6R3dQGtA/640)

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSo5LmvrbRLe8ibAicDrGfX2jiceFX44xNyicqxSVfTtoeKkzibRTVtcia4t8NQ/640)

**è®ºæ–‡å¤ç°ä»£ç ï¼š**

http://aistudio.baidu.com/aistudio/\#/projectdetail/24446

# SRCNNæµç¨‹

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoE5mDRsCcB4TqgbzxtORv8t3M1SMJsrKxeDe593QGmy9RWa8aZiasQRQ/640)
â–²SRCNNç®—æ³•æ¡†æ¶

SRCNN å°†æ·±åº¦å­¦ä¹ ä¸ä¼ ç»Ÿç¨€ç–ç¼–ç ä¹‹é—´çš„å…³ç³»ä½œä¸ºä¾æ®ï¼Œå°† 3 å±‚ç½‘ç»œåˆ’åˆ†ä¸º**å›¾åƒå—æå–**ï¼ˆPatch extraction and representationï¼‰ã€**éçº¿æ€§æ˜ å°„**ï¼ˆNon-linear mappingï¼‰ä»¥åŠæœ€ç»ˆçš„**é‡å»º**ï¼ˆReconstructionï¼‰ã€‚

**SRCNN å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š**

1.Â å…ˆå°†ä½åˆ†è¾¨ç‡å›¾åƒä½¿ç”¨åŒä¸‰æ¬¡å·®å€¼æ”¾å¤§è‡³ç›®æ ‡å°ºå¯¸ï¼ˆå¦‚æ”¾å¤§è‡³ 2 å€ã€3 å€ã€4 å€ï¼‰ï¼Œæ­¤æ—¶ä»ç„¶ç§°æ”¾å¤§è‡³ç›®æ ‡å°ºå¯¸åçš„å›¾åƒä¸ºä½åˆ†è¾¨ç‡å›¾åƒï¼ˆLow-resolution imageï¼‰ï¼Œå³å›¾ä¸­çš„è¾“å…¥ï¼ˆinputï¼‰ï¼›

2. å°†ä½åˆ†è¾¨ç‡å›¾åƒè¾“å…¥ä¸‰å±‚å·ç§¯ç¥ç»ç½‘ç»œã€‚ä¸¾ä¾‹ï¼šåœ¨è®ºæ–‡å…¶ä¸­ä¸€ä¸ªå®éªŒç›¸å…³è®¾ç½®ï¼Œå¯¹ YCrCb é¢œè‰²ç©ºé—´ä¸­çš„ Y é€šé“è¿›è¡Œé‡å»ºï¼Œç½‘ç»œå½¢å¼ä¸º (conv1+relu1)â€”(conv2+relu2)â€”(conv3+relu3)ï¼›ç¬¬ä¸€å±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 9Ã—9 (f1Ã—f1)ï¼Œå·ç§¯æ ¸æ•°ç›® 64 (n1)ï¼Œè¾“å‡º 64 å¼ ç‰¹å¾å›¾ï¼›ç¬¬äºŒå±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 1Ã—1 (f2Ã—f2)ï¼Œå·ç§¯æ ¸æ•°ç›® 32 (n2)ï¼Œè¾“å‡º 32 å¼ ç‰¹å¾å›¾ï¼›ç¬¬ä¸‰å±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 5Ã—5 (f3Ã—f3)ï¼Œå·ç§¯æ ¸æ•°ç›® 1 (n3)ï¼Œè¾“å‡º 1 å¼ ç‰¹å¾å›¾å³ä¸ºæœ€ç»ˆé‡å»ºé«˜åˆ†è¾¨ç‡å›¾åƒã€‚

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoMIoFq12S3KhkPVK0S90ickFrfzfbKFicfQkYib6GEb5gn6FxJNB3qkaTQ/640)

# è®­ç»ƒ

**è®­ç»ƒæ•°æ®é›†**

è®ºæ–‡ä¸­æŸä¸€å®éªŒé‡‡ç”¨ 91 å¼ è‡ªç„¶å›¾åƒä½œä¸ºè®­ç»ƒæ•°æ®é›†ï¼Œå¯¹è®­ç»ƒé›†ä¸­çš„å›¾åƒå…ˆä½¿ç”¨åŒä¸‰æ¬¡å·®å€¼ç¼©å°åˆ°ä½åˆ†è¾¨ç‡å°ºå¯¸ï¼Œå†å°†å…¶æ”¾å¤§åˆ°ç›®æ ‡æ”¾å¤§å°ºå¯¸ï¼Œæœ€ååˆ‡å‰²æˆè¯¸å¤š 33 Ã— 33 å›¾åƒå—ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œä½œä¸ºæ ‡ç­¾æ•°æ®çš„åˆ™ä¸ºå›¾åƒä¸­å¿ƒçš„ 21 Ã— 21 å›¾åƒå—ï¼ˆä¸å·ç§¯å±‚ç»†èŠ‚è®¾ç½®ç›¸å…³ï¼‰ã€‚

**æŸå¤±å‡½æ•°**

é‡‡ç”¨ MSE å‡½æ•°ä½œä¸ºå·ç§¯ç¥ç»ç½‘ç»œæŸå¤±å‡½æ•°ã€‚

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSohia4XoljkKbpz0cCuUa0UPzFzATxvPiaK071Eq4Q1cDZnuZ9tYvO69xA/640)

**å·ç§¯å±‚ç»†èŠ‚è®¾ç½®**

ç¬¬ä¸€å±‚å·ç§¯æ ¸ 9 Ã— 9ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸º (33-9)/1+1=25ï¼Œç¬¬äºŒå±‚å·ç§¯æ ¸ 1 Ã— 1ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸å˜ï¼Œç¬¬ä¸‰å±‚å·ç§¯æ ¸ 5 Ã— 5ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸º (25-5)/1+1=21ã€‚è®­ç»ƒæ—¶å¾—åˆ°çš„å°ºå¯¸ä¸º 21 Ã— 21ï¼Œå› æ­¤å›¾åƒä¸­å¿ƒçš„ 21 Ã— 21 å›¾åƒå—ä½œä¸ºæ ‡ç­¾æ•°æ®ï¼ˆå·ç§¯è®­ç»ƒæ—¶ä¸è¿›è¡Œ paddingï¼‰ã€‚

```python
#Â æŸ¥çœ‹ä¸ªäººæŒä¹…åŒ–å·¥ä½œåŒºæ–‡ä»¶
```

```python
!lsÂ /home/aistudio/work/
```

```python
#Â coding=utf
```
```python
-8
```

```python
import
```
```python
os
```

```python
import
```
```python
paddle.fluid
```
```python
as
```
```python
fluid
```

```python
import
```
```python
paddle.v2
```
```python
as
```
```python
paddle
```

```python
from
```
```python
PIL
```
```python
import
```
```python
Image
```

```python
import
```
```python
numpy
```
```python
as
```
```python
np
```

```python
import
```
```python
scipy.misc
```

```python
import
```
```python
scipy.ndimage
```

```python
import
```
```python
h5py
```

```python
import
```
```python
glob
```

```python
FLAGS={
```
```python
"epoch"
```
```python
:
```
```python
10
```
```python
,
```
```python
"batch_size"
```
```python
:
```
```python
128
```
```python
,
```
```python
"image_size"
```
```python
:
```
```python
33
```
```python
,
```
```python
"label_size"
```
```python
:
```
```python
21
```
```python
,
```

```python
"learning_rate"
```
```python
:
```
```python
1e-4
```
```python
,
```
```python
"c_dim"
```
```python
:
```
```python
1
```
```python
,
```
```python
"scale"
```
```python
:
```
```python
3
```
```python
,
```
```python
"stride"
```
```python
:
```
```python
14
```
```python
,
```

```python
"checkpoint_dir"
```
```python
:
```
```python
"checkpoint"
```
```python
,
```
```python
"sample_dir"
```
```python
:
```
```python
"sample"
```
```python
,
```
```python
"is_train"
```
```python
:Â True}
```

```python
#utils
```

```python
defÂ read_data(path):
```

```python
with
```
```python
h5py.File(path,
```
```python
'r'
```
```python
)
```
```python
as
```
```python
hf:
```

```python
dataÂ =Â np.array(hf.get(
```
```python
'data'
```
```python
))
```

```python
labelÂ =Â np.array(hf.get(
```
```python
'label'
```
```python
))
```

```python
return
```
```python
data,Â label
```

```python
defÂ preprocess(path,Â scale=
```
```python
3
```
```python
):
```

```python
imageÂ =Â imread(path,Â is_grayscale=True)
```

```python
label_Â =Â modcrop(image,Â scale)
```

```python
label_Â =Â label_Â /
```
```python
255.
```

```python
input_Â =Â scipy.ndimage.interpolation.zoom(label_,Â zoom=(
```
```python
1.
```
```python
/Â scale),Â prefilter=False)Â Â #Â ä¸€æ¬¡
```

```python
input_Â =Â scipy.ndimage.interpolation.zoom(input_,Â zoom=(scaleÂ /
```
```python
1.
```
```python
),Â prefilter=False)Â Â #Â äºŒæ¬¡ï¼Œbicubic
```

```python
return
```
```python
input_,Â label_
```

```python
defÂ prepare_data(dataset):
```

```python
if
```
```python
FLAGS[
```
```python
'is_train'
```
```python
]:
```

```python
data_dirÂ =Â os.path.join(os.getcwd(),Â dataset)
```

```python
dataÂ =Â glob.glob(os.path.join(data_dir,
```
```python
"*.bmp"
```
```python
))
```

```python
else
```
```python
:
```

```python
data_dirÂ =Â os.path.join(os.sep,Â (os.path.join(os.getcwd(),Â dataset)),
```
```python
"Set5"
```
```python
)
```

```python
dataÂ =Â glob.glob(os.path.join(data_dir,
```
```python
"*.bmp"
```
```python
))
```

```python
return
```
```python
data
```

```python
defÂ make_data(data,Â label):
```

```python
if
```
```python
notÂ os.path.exists(
```
```python
'data/checkpoint'
```
```python
):
```

```python
os.makedirs(
```
```python
'data/checkpoint'
```
```python
)
```

```python
if
```
```python
FLAGS[
```
```python
'is_train'
```
```python
]:
```

```python
savepathÂ =Â os.path.join(os.getcwd(),
```
```python
'data/checkpoint/train.h5'
```
```python
)
```

```python
#
```
```python
else
```
```python
:
```

```python
#Â Â Â Â Â savepathÂ =Â os.path.join(os.getcwd(),
```
```python
'data/checkpoint/test.h5'
```
```python
)
```

```python
with
```
```python
h5py.File(savepath,
```
```python
'w'
```
```python
)
```
```python
as
```
```python
hf:
```

```python
hf.create_dataset(
```
```python
'data'
```
```python
,Â data=data)
```

```python
hf.create_dataset(
```
```python
'label'
```
```python
,Â data=label)
```

```python
defÂ imread(path,Â is_grayscale=True):
```

```python
if
```
```python
is_grayscale:
```

```python
return
```
```python
scipy.misc.imread(path,Â flatten=True,Â mode=
```
```python
'YCbCr'
```
```python
).astype(np.float)Â Â #Â å°†å›¾åƒè½¬ç°åº¦
```

```python
else
```
```python
:
```

```python
return
```
```python
scipy.misc.imread(path,Â mode=
```
```python
'YCbCr'
```
```python
).astype(np.float)Â Â #Â é»˜è®¤ä¸º
```
```python
false
```

```python
defÂ modcrop(image,Â scale=
```
```python
3
```
```python
):
```

```python
if
```
```python
len(image.shape)Â ==
```
```python
3
```
```python
:Â Â #Â å½©è‰²
```
```python
800
```
```python
*
```
```python
600
```
```python
*
```
```python
3
```

```python
h,Â w,Â _Â =Â image.shape
```

```python
hÂ =Â hÂ -Â np.mod(h,Â scale)
```

```python
wÂ =Â wÂ -Â np.mod(w,Â scale)
```

```python
imageÂ =Â image[
```
```python
0
```
```python
:h,
```
```python
0
```
```python
:w,Â :]
```

```python
else
```
```python
:Â Â #Â ç°åº¦
```
```python
800
```
```python
*
```
```python
600
```

```python
h,Â wÂ =Â image.shape
```

```python
hÂ =Â hÂ -Â np.mod(h,Â scale)
```

```python
wÂ =Â wÂ -Â np.mod(w,Â scale)
```

```python
imageÂ =Â image[
```
```python
0
```
```python
:h,
```
```python
0
```
```python
:w]
```

```python
return
```
```python
image
```

```python
defÂ input_setup(config):
```

```python
if
```
```python
config[
```
```python
'is_train'
```
```python
]:
```

```python
dataÂ =Â prepare_data(dataset=
```
```python
"data/data899/Train.zip_files/Train"
```
```python
)
```

```python
else
```
```python
:
```

```python
dataÂ =Â prepare_data(dataset=
```
```python
"Test"
```
```python
)
```

```python
sub_input_sequenceÂ =Â []
```

```python
sub_label_sequenceÂ =Â []
```

```python
paddingÂ =Â abs(config[
```
```python
'image_size'
```
```python
]Â -Â config[
```
```python
'label_size'
```
```python
])
```
```python
//Â 2Â Â #Â 6Â å¡«å……
```

```python
if
```
```python
config[
```
```python
'is_train'
```
```python
]:
```

```python
for
```
```python
i
```
```python
in
```
```python
range(len(data)):
```

```python
input_,Â label_Â =Â preprocess(data[i],Â config[
```
```python
'scale'
```
```python
])Â Â #Â data[i]ä¸ºæ•°æ®ç›®å½•
```

```python
if
```
```python
len(input_.shape)Â ==
```
```python
3
```
```python
:
```

```python
h,Â w,Â _Â =Â input_.shape
```

```python
else
```
```python
:
```

```python
h,Â wÂ =Â input_.shape
```

```python
for
```
```python
x
```
```python
in
```
```python
range(
```
```python
0
```
```python
,Â hÂ -Â config[
```
```python
'image_size'
```
```python
]Â +
```
```python
1
```
```python
,Â config[
```
```python
'stride'
```
```python
]):
```

```python
for
```
```python
y
```
```python
in
```
```python
range(
```
```python
0
```
```python
,Â wÂ -Â config[
```
```python
'image_size'
```
```python
]Â +
```
```python
1
```
```python
,Â config[
```
```python
'stride'
```
```python
]):
```

```python
sub_inputÂ =Â input_[x:xÂ +Â config[
```
```python
'image_size'
```
```python
],
```
```python
y
```
```python
:yÂ +Â config[
```
```python
'image_size'
```
```python
]]Â Â #Â [
```
```python
33
```
```python
x
```
```python
33
```
```python
]
```

```python
sub_labelÂ =Â label_[xÂ +Â padding:xÂ +Â paddingÂ +Â config[
```
```python
'label_size'
```
```python
],
```

```python
yÂ +Â padding:yÂ +Â paddingÂ +Â config[
```
```python
'label_size'
```
```python
]]Â Â #Â [
```
```python
21
```
```python
x
```
```python
21
```
```python
]
```

```python
#Â MakeÂ channelÂ value,é¢œè‰²é€šé“
```
```python
1
```

```python
sub_inputÂ =Â sub_input.reshape([config[
```
```python
'image_size'
```
```python
],Â config[
```
```python
'image_size'
```
```python
],
```
```python
1
```
```python
])
```

```python
sub_labelÂ =Â sub_label.reshape([config[
```
```python
'label_size'
```
```python
],Â config[
```
```python
'label_size'
```
```python
],
```
```python
1
```
```python
])
```

```python
sub_input_sequence.append(sub_input)
```

```python
sub_label_sequence.append(sub_label)
```

```python
arrdataÂ =Â np.asarray(sub_input_sequence)Â Â #Â [?,
```
```python
33
```
```python
,
```
```python
33
```
```python
,
```
```python
1
```
```python
]
```

```python
arrlabelÂ =Â np.asarray(sub_label_sequence)Â Â #Â [?,
```
```python
21
```
```python
,
```
```python
21
```
```python
,
```
```python
1
```
```python
]
```

```python
make_data(arrdata,Â arrlabel)Â Â #Â æŠŠå¤„ç†å¥½çš„æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œè·¯å¾„ä¸ºcheckpoint/..
```

```python
else:
```

```python
input_,Â label_Â =Â preprocess(data[
```
```python
4
```
```python
],Â config[
```
```python
'scale'
```
```python
])
```

```python
if
```
```python
len(input_.shape)Â ==
```
```python
3
```
```python
:
```

```python
h,Â w,Â _Â =Â input_.shape
```

```python
else
```
```python
:
```

```python
h,Â wÂ =Â input_.shape
```

```python
inputÂ =Â input_.reshape([h,Â w,
```
```python
1
```
```python
])
```

```python
labelÂ =Â label_[
```
```python
6
```
```python
:hÂ -
```
```python
6
```
```python
,
```
```python
6
```
```python
:wÂ -
```
```python
6
```
```python
]
```

```python
labelÂ =Â label.reshape([hÂ -
```
```python
12
```
```python
,Â wÂ -
```
```python
12
```
```python
,
```
```python
1
```
```python
])
```

```python
sub_input_sequence.append(input)
```

```python
sub_label_sequence.append(label)
```

```python
input1Â =Â np.asarray(sub_input_sequence)
```

```python
label1Â =Â np.asarray(sub_label_sequence)
```

```python
return
```
```python
input1,Â label1,Â h,Â w
```

```python
defÂ imsave(image,Â path):
```

```python
return
```
```python
scipy.misc.imsave(path,Â image)
```

```python
#train
```

```python
defÂ reader_creator_image_and_label():
```

```python
input_setup(FLAGS)
```

```python
data_dir=Â os.path.join(
```
```python
'./data/{}'
```
```python
.format(FLAGS[
```
```python
'checkpoint_dir'
```
```python
]),
```
```python
"train.h5"
```
```python
)
```

```python
images,labels=read_data(data_dir)
```

```python
defÂ reader():
```

```python
for
```
```python
i
```
```python
in
```
```python
range(len(images)):
```

```python
yield
```
```python
images,Â labels
```

```python
return
```
```python
reader
```

```python
defÂ train(use_cuda,Â num_passes,BATCH_SIZEÂ =
```
```python
128
```
```python
,Â model_save_dir=
```
```python
'../models'
```
```python
):
```

```python
if
```
```python
FLAGS[
```
```python
'is_train'
```
```python
]:
```

```python
imagesÂ =Â fluid.layers.data(name=
```
```python
'images'
```
```python
,Â shape=[
```
```python
1
```
```python
,Â FLAGS[
```
```python
'image_size'
```
```python
],Â FLAGS[
```
```python
'image_size'
```
```python
]],Â dtype=
```
```python
'float32'
```
```python
)
```

```python
labelsÂ =Â fluid.layers.data(name=
```
```python
'labels'
```
```python
,Â shape=[
```
```python
1
```
```python
,Â FLAGS[
```
```python
'label_size'
```
```python
],Â FLAGS[
```
```python
'label_size'
```
```python
]],Â dtype=
```
```python
'float32'
```
```python
)
```

```python
else
```
```python
:
```

```python
_,_,FLAGS[
```
```python
'image_size'
```
```python
],FLAGS[
```
```python
'label_size'
```
```python
]=input_setup(FLAGS)
```

```python
imagesÂ =Â fluid.layers.data(name=
```
```python
'images'
```
```python
,Â shape=[
```
```python
1
```
```python
,Â FLAGS[
```
```python
'image_size'
```
```python
],Â FLAGS[
```
```python
'label_size'
```
```python
]],Â dtype=
```
```python
'float32'
```
```python
)
```

```python
labelsÂ =Â fluid.layers.data(name=
```
```python
'labels'
```
```python
,Â shape=[
```
```python
1
```
```python
,Â FLAGS[
```
```python
'image_size'
```
```python
]
```
```python
-12
```
```python
,Â FLAGS[
```
```python
'label_size'
```
```python
]
```
```python
-12
```
```python
],Â dtype=
```
```python
'float32'
```
```python
)
```

```python
#feed_order=[
```
```python
'images'
```
```python
,
```
```python
'labels'
```
```python
]
```

```python
#Â è·å–ç¥ç»ç½‘ç»œçš„è®­ç»ƒç»“æœ
```

```python
predictÂ =Â model(images)
```

```python
#Â è·å–æŸå¤±å‡½æ•°
```

```python
costÂ =Â fluid.layers.square_error_cost(input=predict,Â label=labels)
```

```python
#Â å®šä¹‰å¹³å‡æŸå¤±å‡½æ•°
```

```python
avg_costÂ =Â fluid.layers.mean(cost)
```

```python
#Â å®šä¹‰ä¼˜åŒ–æ–¹æ³•
```

```python
optimizerÂ =Â fluid.optimizer.Momentum(learning_rate=
```
```python
1e-4
```
```python
,momentum=
```
```python
0.9
```
```python
)
```

```python
optsÂ =optimizer.minimize(avg_cost)
```

```python
#Â æ˜¯å¦ä½¿ç”¨GPU
```

```python
placeÂ =Â fluid.CUDAPlace(
```
```python
0
```
```python
)
```
```python
if
```
```python
use_cuda
```
```python
else
```
```python
fluid.CPUPlace()
```

```python
#Â åˆå§‹åŒ–æ‰§è¡Œå™¨
```

```python
exe=fluid.Executor(place)
```

```python
exe.run(fluid.default_startup_program())
```

```python
#Â è·å–è®­ç»ƒæ•°æ®
```

```python
train_readerÂ =Â paddle.batch(
```

```python
reader_creator_image_and_label(),Â batch_size=BATCH_SIZE)
```

```python
#Â è·å–æµ‹è¯•æ•°æ®
```

```python
#Â test_readerÂ =Â paddle.batch(
```

```python
#Â Â Â Â Â read_data(),Â batch_size=BATCH_SIZE)
```

```python
#print(len(next(train_reader())))
```

```python
feederÂ =Â fluid.DataFeeder(place=place,Â feed_list=[images,Â labels])
```

```python
for
```
```python
pass_id
```
```python
in
```
```python
range(num_passes):
```

```python
for
```
```python
batch_id,Â data
```
```python
in
```
```python
enumerate(train_reader()):
```

```python
avg_cost_valueÂ =Â exe.run(fluid.default_main_program(),
```

```python
feed=feeder.feed(data),
```

```python
fetch_list=[avg_cost])
```

```python
if
```
```python
batch_id%
```
```python
100
```
```python
==
```
```python
0
```
```python
:
```

```python
print(
```
```python
"loss="
```
```python
+avg_cost_value[
```
```python
0
```
```python
])
```

```python
defÂ model(images):
```

```python
conv1=fluid.layers.conv2d(input=images,Â num_filters=
```
```python
64
```
```python
,Â filter_size=
```
```python
9
```
```python
,Â act=
```
```python
'relu'
```
```python
)
```

```python
conv2=fluid.layers.conv2d(input=conv1,Â num_filters=
```
```python
32
```
```python
,Â filter_size=
```
```python
1
```
```python
,act=
```
```python
'relu'
```
```python
)
```

```python
conv3=fluid.layers.conv2d(input=conv2,Â num_filters=
```
```python
1
```
```python
,Â filter_size=
```
```python
5
```
```python
)
```

```python
return
```
```python
conv3
```

```python
if
```
```python
__name__Â ==
```
```python
'__main__'
```
```python
:
```

```python
#Â å¼€å§‹è®­ç»ƒ
```

```python
train(use_cuda=False,Â num_passes=
```
```python
10
```
```python
)
```

# æµ‹è¯•

**å…¨å·ç§¯ç½‘ç»œ**

æ‰€ç”¨ç½‘ç»œä¸ºå…¨å·ç§¯ç½‘ç»œï¼Œå› æ­¤ä½œä¸ºå®é™…æµ‹è¯•æ—¶ï¼Œç›´æ¥è¾“å…¥å®Œæ•´å›¾åƒå³å¯ã€‚

**Padding**

è®­ç»ƒæ—¶å¾—åˆ°çš„å®é™…ä¸Šæ˜¯é™¤å»å››å‘¨ (33-21)/2=6 åƒç´ å¤–çš„å›¾åƒï¼Œè‹¥ç›´æ¥é‡‡ç”¨è®­ç»ƒæ—¶çš„è®¾ç½®ï¼ˆæ—  paddingï¼‰ï¼Œå¾—åˆ°çš„å›¾åƒæœ€åä¼šå‡å°‘å››å‘¨å„ 6 åƒç´ ï¼ˆå¦‚æ’å€¼æ”¾å¤§åè¾“å…¥ 512 Ã— 512ï¼Œè¾“å‡º 500 Ã— 500ï¼‰ã€‚

å› æ­¤åœ¨æµ‹è¯•æ—¶æ¯ä¸€å±‚å·ç§¯éƒ½è¿›è¡Œäº† paddingï¼ˆå·ç§¯æ ¸å°ºå¯¸ä¸º 1 Ã— 1çš„ä¸éœ€è¦è¿› è¡Œ paddingï¼‰ï¼Œè¿™æ ·ä¿è¯æ’å€¼æ”¾å¤§åè¾“å…¥ä¸è¾“å‡ºå°ºå¯¸çš„ä¸€è‡´æ€§ã€‚

# é‡å»ºç»“æœ

**å®¢è§‚è¯„ä»·æŒ‡æ ‡ PSNR ä¸ SSIMï¼š**ç›¸æ¯”å…¶ä»–ä¼ ç»Ÿæ–¹æ³•ï¼ŒSRCNN å–å¾—æ›´å¥½çš„é‡å»ºæ•ˆæœã€‚

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoURhlicTZB4FG3EyTx1q0amyIKf5aDkMs9IyfRicGLFPevQCLX9pufw2g/640)

**ä¸»è§‚æ•ˆæœï¼š**ç›¸æ¯”å…¶ä»–ä¼ ç»Ÿæ–¹æ³•ï¼ŒSRCNN é‡å»ºæ•ˆæœæ›´å…·ä¼˜åŠ¿ã€‚

![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoJLa6S4GqjIgll6OicKeCHF2kLL2WQ755XUV9BjTasiasQABAScwB9bFA/640)

# å…³äºPaddlePaddle

PaddlePaddle åœ¨æˆ‘çœ‹æ¥ä¸ TensorFlow æœ‰ç‚¹ç±»ä¼¼ï¼ŒAPI éƒ½éå¸¸å¥½ç”¨ï¼Œç”¨æˆ·ç¾¤ä½“è¶Šæ¥è¶Šå¤§ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹å°å»ºè®®ï¼Œå°±æ˜¯åœ¨æˆ‘ä½¿ç”¨çš„æ—¶å€™ï¼Œå‘ç°æ•°æ®å¤„ç†çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼ˆæ¯”è¾ƒèœï¼‰ï¼Œæ¯”å¦‚ TensorFlowä¸­æœ‰ TFRecordsï¼ŒåŒæ—¶æœ‰è‡ªå¸¦çš„æ•°æ®é›†è¿­ä»£å™¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¼å…¥æ•°æ®ï¼Œæ‰€ä»¥å¸Œæœ›å‡ºä¸€ä¸ªå®˜æ–¹çš„æ•°æ®è½¬æ¢æ ¼å¼ï¼Œç”¨æ¥è¯»å–æ•°æ®ï¼Œå¹¶æä¾›è¿­ä»£å™¨æ–¹æ³•ã€‚

![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmPEF4lW0pL5weJia5y4xhJbog2pIZZ3ZCgVUDynvus6rCzNKGAAAI6R8jaXTpYPISCMicpFegVdG0g/640?)


**ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹æ›´å¤šè®ºæ–‡å¤ç°ï¼š**

ç»å…¸è®ºæ–‡å¤ç° | LSGANï¼šæœ€å°äºŒä¹˜ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ
PyraNetï¼šåŸºäºç‰¹å¾é‡‘å­—å¡”ç½‘ç»œçš„äººä½“å§¿æ€ä¼°è®¡
[ç»å…¸è®ºæ–‡å¤ç° | InfoGANï¼šä¸€ç§æ— ç›‘ç£ç”Ÿæˆæ–¹æ³•](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247492415&idx=1&sn=a359e72ee99555f7a2fb4e21b2ad51db&chksm=96ea3cbfa19db5a913b9ed01490df6e902abfeb36856bb5be946527a070d399ee37a3ff6c750&scene=21#wechat_redirect)
ç»å…¸è®ºæ–‡å¤ç° | åŸºäºæ ‡æ³¨ç­–ç•¥çš„å®ä½“å’Œå…³ç³»è”åˆæŠ½å–




![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/xuKyIMVqtF2cO2WSmiccOqL8YlIwp5Xv2cqdDp6ANbUt8yibCc1cgQQrPHLKhf73icQGHves57M2XMZLJxIhF0e7g/640?)**\#****æŠ• ç¨¿ é€š é“****\#**
**è®©ä½ çš„è®ºæ–‡è¢«æ›´å¤šäººçœ‹åˆ°**

å¦‚ä½•æ‰èƒ½è®©æ›´å¤šçš„ä¼˜è´¨å†…å®¹ä»¥æ›´çŸ­è·¯å¾„åˆ°è¾¾è¯»è€…ç¾¤ä½“ï¼Œç¼©çŸ­è¯»è€…å¯»æ‰¾ä¼˜è´¨å†…å®¹çš„æˆæœ¬å‘¢ï¼Ÿ**ç­”æ¡ˆå°±æ˜¯ï¼šä½ ä¸è®¤è¯†çš„äººã€‚**

æ€»æœ‰ä¸€äº›ä½ ä¸è®¤è¯†çš„äººï¼ŒçŸ¥é“ä½ æƒ³çŸ¥é“çš„ä¸œè¥¿ã€‚PaperWeekly æˆ–è®¸å¯ä»¥æˆä¸ºä¸€åº§æ¡¥æ¢ï¼Œä¿ƒä½¿ä¸åŒèƒŒæ™¯ã€ä¸åŒæ–¹å‘çš„å­¦è€…å’Œå­¦æœ¯çµæ„Ÿç›¸äº’ç¢°æ’ï¼Œè¿¸å‘å‡ºæ›´å¤šçš„å¯èƒ½æ€§ã€‚

PaperWeekly é¼“åŠ±é«˜æ ¡å®éªŒå®¤æˆ–ä¸ªäººï¼Œåœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šåˆ†äº«å„ç±»ä¼˜è´¨å†…å®¹ï¼Œå¯ä»¥æ˜¯**æœ€æ–°è®ºæ–‡è§£è¯»**ï¼Œä¹Ÿå¯ä»¥æ˜¯**å­¦ä¹ å¿ƒå¾—**æˆ–**æŠ€æœ¯å¹²è´§**ã€‚æˆ‘ä»¬çš„ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œè®©çŸ¥è¯†çœŸæ­£æµåŠ¨èµ·æ¥ã€‚

ğŸ“**æ¥ç¨¿æ ‡å‡†ï¼š**
â€¢ ç¨¿ä»¶ç¡®ç³»ä¸ªäºº**åŸåˆ›ä½œå“**ï¼Œæ¥ç¨¿éœ€æ³¨æ˜ä½œè€…ä¸ªäººä¿¡æ¯ï¼ˆå§“å+å­¦æ ¡/å·¥ä½œå•ä½+å­¦å†/èŒä½+ç ”ç©¶æ–¹å‘ï¼‰
â€¢ å¦‚æœæ–‡ç« å¹¶éé¦–å‘ï¼Œè¯·åœ¨æŠ•ç¨¿æ—¶æé†’å¹¶é™„ä¸Šæ‰€æœ‰å·²å‘å¸ƒé“¾æ¥
â€¢ PaperWeekly é»˜è®¤æ¯ç¯‡æ–‡ç« éƒ½æ˜¯é¦–å‘ï¼Œå‡ä¼šæ·»åŠ â€œåŸåˆ›â€æ ‡å¿—

**ğŸ“¬ æŠ•ç¨¿é‚®ç®±ï¼š**
â€¢ æŠ•ç¨¿é‚®ç®±ï¼šhr@paperweekly.site
â€¢ æ‰€æœ‰æ–‡ç« é…å›¾ï¼Œè¯·å•ç‹¬åœ¨é™„ä»¶ä¸­å‘é€
â€¢ è¯·ç•™ä¸‹å³æ—¶è”ç³»æ–¹å¼ï¼ˆå¾®ä¿¡æˆ–æ‰‹æœºï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨ç¼–è¾‘å‘å¸ƒæ—¶å’Œä½œè€…æ²Ÿé€š



ğŸ”

ç°åœ¨ï¼Œåœ¨**ã€ŒçŸ¥ä¹ã€**ä¹Ÿèƒ½æ‰¾åˆ°æˆ‘ä»¬äº†
è¿›å…¥çŸ¥ä¹é¦–é¡µæœç´¢**ã€ŒPaperWeeklyã€**
ç‚¹å‡»**ã€Œå…³æ³¨ã€**è®¢é˜…æˆ‘ä»¬çš„ä¸“æ å§


**å…³äºPaperWeekly**

PaperWeekly æ˜¯ä¸€ä¸ªæ¨èã€è§£è¯»ã€è®¨è®ºã€æŠ¥é“äººå·¥æ™ºèƒ½å‰æ²¿è®ºæ–‡æˆæœçš„å­¦æœ¯å¹³å°ã€‚å¦‚æœä½ ç ”ç©¶æˆ–ä»äº‹ AI é¢†åŸŸï¼Œæ¬¢è¿åœ¨å…¬ä¼—å·åå°ç‚¹å‡»**ã€Œäº¤æµç¾¤ã€**ï¼Œå°åŠ©æ‰‹å°†æŠŠä½ å¸¦å…¥ PaperWeekly çš„äº¤æµç¾¤é‡Œã€‚

![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgkXb8A1kiafKxib8NXiaPMU8mQvRWVBtFNic4G5b5GDD7YdwrsCAicOc8kp5tdEOU3x7ufnleSbKkiaj5Dg/640?)
â–½ ç‚¹å‡» |é˜…è¯»åŸæ–‡| æ”¶è—å¤ç°ä»£ç 


