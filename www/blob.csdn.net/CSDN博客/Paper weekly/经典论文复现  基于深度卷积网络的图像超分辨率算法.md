# ç»å…¸è®ºæ–‡å¤ç° | åŸºäºæ·±åº¦å·ç§¯ç½‘ç»œçš„å›¾åƒè¶…åˆ†è¾¨ç‡ç®—æ³• - Paper weekly - CSDNåšå®¢





2018å¹´12æœˆ14æ—¥ 12:52:22[Paper_weekly](https://me.csdn.net/c9Yv2cf9I06K2A9E)é˜…è¯»æ•°ï¼š301









![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgm9RFr5icmiaj0bibJxUeIGdAFHNM4G6PJEiccw293RuVnOiadQ4zcdibdJa5FFfn0ZMgpbKib4AAKD8dm2w/640)




è¿‡å»å‡ å¹´å‘è¡¨äºå„å¤§ AI é¡¶ä¼šè®ºæ–‡æå‡ºçš„ 400 å¤šç§ç®—æ³•ä¸­ï¼Œå…¬å¼€ç®—æ³•ä»£ç çš„ä»…å  6%ï¼Œå…¶ä¸­ä¸‰åˆ†ä¹‹ä¸€çš„è®ºæ–‡ä½œè€…åˆ†äº«äº†æµ‹è¯•æ•°æ®ï¼Œçº¦ 54% çš„åˆ†äº«åŒ…å«â€œä¼ªä»£ç â€ã€‚è¿™æ˜¯ä»Šå¹´ AAAI ä¼šè®®ä¸Šä¸€ä¸ªä¸¥å³»çš„æŠ¥å‘Šã€‚Â äººå·¥æ™ºèƒ½è¿™ä¸ªè“¬å‹ƒå‘å±•çš„é¢†åŸŸæ­£é¢ä¸´ç€å®éªŒé‡ç°çš„å±æœºï¼Œå°±åƒå®éªŒé‡ç°é—®é¢˜è¿‡å»åå¹´æ¥ä¸€ç›´å›°æ‰°ç€å¿ƒç†å­¦ã€åŒ»å­¦ä»¥åŠå…¶ä»–é¢†åŸŸä¸€æ ·ã€‚**æœ€æ ¹æœ¬çš„é—®é¢˜æ˜¯ç ”ç©¶äººå‘˜é€šå¸¸ä¸å…±äº«ä»–ä»¬çš„æºä»£ç ã€‚**




å¯éªŒè¯çš„çŸ¥è¯†æ˜¯ç§‘å­¦çš„åŸºç¡€ï¼Œå®ƒäº‹å…³ç†è§£ã€‚éšç€äººå·¥æ™ºèƒ½é¢†åŸŸçš„å‘å±•ï¼Œæ‰“ç ´ä¸å¯å¤ç°æ€§å°†æ˜¯å¿…è¦çš„ã€‚ä¸ºæ­¤ï¼Œ**PaperWeekly è”æ‰‹ç™¾åº¦ PaddlePaddle å…±åŒå‘èµ·äº†**[**æœ¬æ¬¡è®ºæ–‡æœ‰å¥–å¤ç°**](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247490664&idx=1&sn=c716049d2a63a4ffef0d25e35f3168fb&chksm=96e9c3e8a19e4afe04f844dc25fee0adbae5345eefe177c611e18b37761d8d9a8aed1769a943&scene=21#wechat_redirect)ï¼Œæˆ‘ä»¬å¸Œæœ›å’Œæ¥è‡ªå­¦ç•Œã€å·¥ä¸šç•Œçš„ç ”ç©¶è€…ä¸€èµ·æ¥åŠ›ï¼Œä¸º AI è¡Œä¸šå¸¦æ¥è‰¯æ€§å¾ªç¯ã€‚




ä½œè€…ä¸¨å¼ è£æˆÂ 

å­¦æ ¡ä¸¨å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦ï¼ˆæ·±åœ³ï¼‰

ç ”ç©¶æ–¹å‘ä¸¨è®¡ç®—æ•°å­¦




**ç¬”è€…æœ¬æ¬¡é€‰æ‹©å¤ç°çš„æ˜¯æ±¤æ™“é¸¥æ•™æˆå’Œä½•æºæ˜å›¢é˜Ÿå‘è¡¨äº 2015 å¹´çš„ç»å…¸è®ºæ–‡â€”â€”*SRCNN*ã€‚**è¶…åˆ†è¾¨ç‡æŠ€æœ¯ï¼ˆSuper-Resolutionï¼‰æ˜¯æŒ‡ä»è§‚æµ‹åˆ°çš„ä½åˆ†è¾¨ç‡å›¾åƒé‡å»ºå‡ºç›¸åº”çš„é«˜åˆ†è¾¨ç‡å›¾åƒï¼Œåœ¨ç›‘æ§è®¾å¤‡ã€å«æ˜Ÿå›¾åƒå’ŒåŒ»å­¦å½±åƒç­‰é¢†åŸŸéƒ½æœ‰é‡è¦çš„åº”ç”¨ä»·å€¼ã€‚åœ¨æ·±åº¦å·ç§¯ç½‘ç»œçš„æµªæ½®ä¸‹ï¼Œ**æœ¬æ–‡****é¦–æ¬¡æå‡ºäº†åŸºäºæ·±åº¦å·ç§¯ç½‘ç»œçš„ç«¯åˆ°ç«¯è¶…åˆ†è¾¨ç‡ç®—æ³•ã€‚**




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoeMftXRibPNrxHh2NZeOz85uGQGRXK7jefbPH28ZwWHOAFWB6R3dQGtA/640)




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSo5LmvrbRLe8ibAicDrGfX2jiceFX44xNyicqxSVfTtoeKkzibRTVtcia4t8NQ/640)




**è®ºæ–‡å¤ç°ä»£ç ï¼š**




http://aistudio.baidu.com/aistudio/#/projectdetail/24446




# SRCNNæµç¨‹




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoE5mDRsCcB4TqgbzxtORv8t3M1SMJsrKxeDe593QGmy9RWa8aZiasQRQ/640)

â–²Â SRCNNç®—æ³•æ¡†æ¶




SRCNN å°†æ·±åº¦å­¦ä¹ ä¸ä¼ ç»Ÿç¨€ç–ç¼–ç ä¹‹é—´çš„å…³ç³»ä½œä¸ºä¾æ®ï¼Œå°† 3 å±‚ç½‘ç»œåˆ’åˆ†ä¸º**å›¾åƒå—æå–**ï¼ˆPatch extraction and representationï¼‰ã€**éçº¿æ€§æ˜ å°„**ï¼ˆNon-linear mappingï¼‰ä»¥åŠæœ€ç»ˆçš„**é‡å»º**ï¼ˆReconstructionï¼‰ã€‚




**SRCNN å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š**




1.Â å…ˆå°†ä½åˆ†è¾¨ç‡å›¾åƒä½¿ç”¨åŒä¸‰æ¬¡å·®å€¼æ”¾å¤§è‡³ç›®æ ‡å°ºå¯¸ï¼ˆå¦‚æ”¾å¤§è‡³ 2 å€ã€3 å€ã€4 å€ï¼‰ï¼Œæ­¤æ—¶ä»ç„¶ç§°æ”¾å¤§è‡³ç›®æ ‡å°ºå¯¸åçš„å›¾åƒä¸ºä½åˆ†è¾¨ç‡å›¾åƒï¼ˆLow-resolution imageï¼‰ï¼Œå³å›¾ä¸­çš„è¾“å…¥ï¼ˆinputï¼‰ï¼›Â 




2. å°†ä½åˆ†è¾¨ç‡å›¾åƒè¾“å…¥ä¸‰å±‚å·ç§¯ç¥ç»ç½‘ç»œã€‚ä¸¾ä¾‹ï¼šåœ¨è®ºæ–‡å…¶ä¸­ä¸€ä¸ªå®éªŒç›¸å…³è®¾ç½®ï¼Œå¯¹ YCrCb é¢œè‰²ç©ºé—´ä¸­çš„ Y é€šé“è¿›è¡Œé‡å»ºï¼Œç½‘ç»œå½¢å¼ä¸º (conv1+relu1)â€”(conv2+relu2)â€”(conv3+relu3)ï¼›ç¬¬ä¸€å±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 9Ã—9 (f1Ã—f1)ï¼Œå·ç§¯æ ¸æ•°ç›® 64 (n1)ï¼Œè¾“å‡º 64 å¼ ç‰¹å¾å›¾ï¼›ç¬¬äºŒå±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 1Ã—1 (f2Ã—f2)ï¼Œå·ç§¯æ ¸æ•°ç›® 32 (n2)ï¼Œè¾“å‡º 32 å¼ ç‰¹å¾å›¾ï¼›ç¬¬ä¸‰å±‚å·ç§¯ï¼šå·ç§¯æ ¸å°ºå¯¸ 5Ã—5 (f3Ã—f3)ï¼Œå·ç§¯æ ¸æ•°ç›® 1 (n3)ï¼Œè¾“å‡º 1 å¼ ç‰¹å¾å›¾å³ä¸ºæœ€ç»ˆé‡å»ºé«˜åˆ†è¾¨ç‡å›¾åƒã€‚




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoMIoFq12S3KhkPVK0S90ickFrfzfbKFicfQkYib6GEb5gn6FxJNB3qkaTQ/640)




# è®­ç»ƒ




**è®­ç»ƒæ•°æ®é›†**




è®ºæ–‡ä¸­æŸä¸€å®éªŒé‡‡ç”¨ 91 å¼ è‡ªç„¶å›¾åƒä½œä¸ºè®­ç»ƒæ•°æ®é›†ï¼Œå¯¹è®­ç»ƒé›†ä¸­çš„å›¾åƒå…ˆä½¿ç”¨åŒä¸‰æ¬¡å·®å€¼ç¼©å°åˆ°ä½åˆ†è¾¨ç‡å°ºå¯¸ï¼Œå†å°†å…¶æ”¾å¤§åˆ°ç›®æ ‡æ”¾å¤§å°ºå¯¸ï¼Œæœ€ååˆ‡å‰²æˆè¯¸å¤š 33 Ã— 33 å›¾åƒå—ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œä½œä¸ºæ ‡ç­¾æ•°æ®çš„åˆ™ä¸ºå›¾åƒä¸­å¿ƒçš„ 21 Ã— 21 å›¾åƒå—ï¼ˆä¸å·ç§¯å±‚ç»†èŠ‚è®¾ç½®ç›¸å…³ï¼‰ã€‚




**æŸå¤±å‡½æ•°**




é‡‡ç”¨ MSE å‡½æ•°ä½œä¸ºå·ç§¯ç¥ç»ç½‘ç»œæŸå¤±å‡½æ•°ã€‚




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSohia4XoljkKbpz0cCuUa0UPzFzATxvPiaK071Eq4Q1cDZnuZ9tYvO69xA/640)




**å·ç§¯å±‚ç»†èŠ‚è®¾ç½®**




ç¬¬ä¸€å±‚å·ç§¯æ ¸ 9 Ã— 9ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸º (33-9)/1+1=25ï¼Œç¬¬äºŒå±‚å·ç§¯æ ¸ 1 Ã— 1ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸å˜ï¼Œç¬¬ä¸‰å±‚å·ç§¯æ ¸ 5 Ã— 5ï¼Œå¾—åˆ°ç‰¹å¾å›¾å°ºå¯¸ä¸º (25-5)/1+1=21ã€‚è®­ç»ƒæ—¶å¾—åˆ°çš„å°ºå¯¸ä¸º 21 Ã— 21ï¼Œå› æ­¤å›¾åƒä¸­å¿ƒçš„ 21 Ã— 21 å›¾åƒå—ä½œä¸ºæ ‡ç­¾æ•°æ®ï¼ˆå·ç§¯è®­ç»ƒæ—¶ä¸è¿›è¡Œ paddingï¼‰ã€‚




```java
#Â æŸ¥çœ‹ä¸ªäººæŒä¹…åŒ–å·¥ä½œåŒºæ–‡ä»¶
!lsÂ /home/aistudio/work/
#Â coding=utf-8
importÂ os
importÂ paddle.fluidÂ asÂ fluid
importÂ paddle.v2Â asÂ paddle
fromÂ PILÂ importÂ Image
importÂ numpyÂ asÂ np
importÂ scipy.misc
importÂ scipy.ndimage
importÂ h5py
importÂ glob

FLAGS={"epoch":Â 10,"batch_size":Â 128,"image_size":Â 33,"label_size":Â 21,
Â Â Â Â Â Â "learning_rate":Â 1e-4,"c_dim":Â 1,"scale":Â 3,"stride":Â 14,
Â Â Â Â Â Â "checkpoint_dir":Â "checkpoint","sample_dir":Â "sample","is_train":Â True}

#utils
defÂ read_data(path):
Â Â Â Â withÂ h5py.File(path,Â 'r')Â asÂ hf:
Â Â Â Â Â Â Â Â dataÂ =Â np.array(hf.get('data'))
Â Â Â Â Â Â Â Â labelÂ =Â np.array(hf.get('label'))
Â Â Â Â Â Â Â Â returnÂ data,Â label

defÂ preprocess(path,Â scale=3):

Â Â Â Â imageÂ =Â imread(path,Â is_grayscale=True)
Â Â Â Â label_Â =Â modcrop(image,Â scale)

Â Â Â Â label_Â =Â label_Â /Â 255.
Â Â Â Â input_Â =Â scipy.ndimage.interpolation.zoom(label_,Â zoom=(1.Â /Â scale),Â prefilter=False)Â Â #Â ä¸€æ¬¡
Â Â Â Â input_Â =Â scipy.ndimage.interpolation.zoom(input_,Â zoom=(scaleÂ /Â 1.),Â prefilter=False)Â Â #Â äºŒæ¬¡ï¼Œbicubic

Â Â Â Â returnÂ input_,Â label_

defÂ prepare_data(dataset):
Â Â Â Â ifÂ FLAGS['is_train']:
Â Â Â Â Â Â Â Â data_dirÂ =Â os.path.join(os.getcwd(),Â dataset)
Â Â Â Â Â Â Â Â dataÂ =Â glob.glob(os.path.join(data_dir,Â "*.bmp"))
Â Â Â Â else:
Â Â Â Â Â Â Â Â data_dirÂ =Â os.path.join(os.sep,Â (os.path.join(os.getcwd(),Â dataset)),Â "Set5")
Â Â Â Â Â Â Â Â dataÂ =Â glob.glob(os.path.join(data_dir,Â "*.bmp"))

Â Â Â Â returnÂ data

defÂ make_data(data,Â label):
Â Â Â Â ifÂ notÂ os.path.exists('data/checkpoint'):
Â Â Â Â Â Â Â Â os.makedirs('data/checkpoint')
Â Â Â Â ifÂ FLAGS['is_train']:
Â Â Â Â Â Â Â Â savepathÂ =Â os.path.join(os.getcwd(),Â 'data/checkpoint/train.h5')
Â Â Â Â #Â else:
Â Â Â Â #Â Â Â Â Â savepathÂ =Â os.path.join(os.getcwd(),Â 'data/checkpoint/test.h5')

Â Â Â Â withÂ h5py.File(savepath,Â 'w')Â asÂ hf:
Â Â Â Â Â Â Â Â hf.create_dataset('data',Â data=data)
Â Â Â Â Â Â Â Â hf.create_dataset('label',Â data=label)

defÂ imread(path,Â is_grayscale=True):
Â Â Â Â ifÂ is_grayscale:
Â Â Â Â Â Â Â Â returnÂ scipy.misc.imread(path,Â flatten=True,Â mode='YCbCr').astype(np.float)Â Â #Â å°†å›¾åƒè½¬ç°åº¦
Â Â Â Â else:
Â Â Â Â Â Â Â Â returnÂ scipy.misc.imread(path,Â mode='YCbCr').astype(np.float)Â Â #Â é»˜è®¤ä¸ºfalse

defÂ modcrop(image,Â scale=3):

Â Â Â Â ifÂ len(image.shape)Â ==Â 3:Â Â #Â å½©è‰²Â 800*600*3
Â Â Â Â Â Â Â Â h,Â w,Â _Â =Â image.shape
Â Â Â Â Â Â Â Â hÂ =Â hÂ -Â np.mod(h,Â scale)
Â Â Â Â Â Â Â Â wÂ =Â wÂ -Â np.mod(w,Â scale)
Â Â Â Â Â Â Â Â imageÂ =Â image[0:h,Â 0:w,Â :]
Â Â Â Â else:Â Â #Â ç°åº¦Â 800*600
Â Â Â Â Â Â Â Â h,Â wÂ =Â image.shape
Â Â Â Â Â Â Â Â hÂ =Â hÂ -Â np.mod(h,Â scale)
Â Â Â Â Â Â Â Â wÂ =Â wÂ -Â np.mod(w,Â scale)
Â Â Â Â Â Â Â Â imageÂ =Â image[0:h,Â 0:w]
Â Â Â Â returnÂ image

defÂ input_setup(config):
Â Â Â Â ifÂ config['is_train']:
Â Â Â Â Â Â Â Â dataÂ =Â prepare_data(dataset="data/data899/Train.zip_files/Train")
Â Â Â Â else:
Â Â Â Â Â Â Â Â dataÂ =Â prepare_data(dataset="Test")

Â Â Â Â sub_input_sequenceÂ =Â []
Â Â Â Â sub_label_sequenceÂ =Â []
Â Â Â Â paddingÂ =Â abs(config['image_size']Â -Â config['label_size'])Â //Â 2Â Â #Â 6Â å¡«å……

Â Â Â Â ifÂ config['is_train']:
Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(len(data)):
Â Â Â Â Â Â Â Â Â Â Â Â input_,Â label_Â =Â preprocess(data[i],Â config['scale'])Â Â #Â data[i]ä¸ºæ•°æ®ç›®å½•

Â Â Â Â Â Â Â Â Â Â Â Â ifÂ len(input_.shape)Â ==Â 3:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â h,Â w,Â _Â =Â input_.shape
Â Â Â Â Â Â Â Â Â Â Â Â else:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â h,Â wÂ =Â input_.shape
Â Â Â Â Â Â Â Â Â Â Â Â forÂ xÂ inÂ range(0,Â hÂ -Â config['image_size']Â +Â 1,Â config['stride']):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ yÂ inÂ range(0,Â wÂ -Â config['image_size']Â +Â 1,Â config['stride']):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_inputÂ =Â input_[x:xÂ +Â config['image_size'],Â y:yÂ +Â config['image_size']]Â Â #Â [33Â xÂ 33]
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_labelÂ =Â label_[xÂ +Â padding:xÂ +Â paddingÂ +Â config['label_size'],
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â yÂ +Â padding:yÂ +Â paddingÂ +Â config['label_size']]Â Â #Â [21Â xÂ 21]

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â MakeÂ channelÂ value,é¢œè‰²é€šé“1
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_inputÂ =Â sub_input.reshape([config['image_size'],Â config['image_size'],Â 1])
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_labelÂ =Â sub_label.reshape([config['label_size'],Â config['label_size'],Â 1])

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_input_sequence.append(sub_input)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sub_label_sequence.append(sub_label)
Â Â Â Â Â Â Â Â arrdataÂ =Â np.asarray(sub_input_sequence)Â Â #Â [?,Â 33,Â 33,Â 1]
Â Â Â Â Â Â Â Â arrlabelÂ =Â np.asarray(sub_label_sequence)Â Â #Â [?,Â 21,Â 21,Â 1]

Â Â Â Â Â Â Â Â make_data(arrdata,Â arrlabel)Â Â #Â æŠŠå¤„ç†å¥½çš„æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œè·¯å¾„ä¸ºcheckpoint/..
Â Â Â Â else:
Â Â Â Â Â Â Â Â input_,Â label_Â =Â preprocess(data[4],Â config['scale'])

Â Â Â Â Â Â Â Â ifÂ len(input_.shape)Â ==Â 3:
Â Â Â Â Â Â Â Â Â Â Â Â h,Â w,Â _Â =Â input_.shape
Â Â Â Â Â Â Â Â else:
Â Â Â Â Â Â Â Â Â Â Â Â h,Â wÂ =Â input_.shape
Â Â Â Â Â Â Â Â inputÂ =Â input_.reshape([h,Â w,Â 1])

Â Â Â Â Â Â Â Â labelÂ =Â label_[6:hÂ -Â 6,Â 6:wÂ -Â 6]
Â Â Â Â Â Â Â Â labelÂ =Â label.reshape([hÂ -Â 12,Â wÂ -Â 12,Â 1])

Â Â Â Â Â Â Â Â sub_input_sequence.append(input)
Â Â Â Â Â Â Â Â sub_label_sequence.append(label)

Â Â Â Â Â Â Â Â input1Â =Â np.asarray(sub_input_sequence)
Â Â Â Â Â Â Â Â label1Â =Â np.asarray(sub_label_sequence)
Â Â Â Â Â Â Â Â returnÂ input1,Â label1,Â h,Â w

defÂ imsave(image,Â path):
Â Â Â Â returnÂ scipy.misc.imsave(path,Â image)
#train
defÂ reader_creator_image_and_label():
Â Â Â Â input_setup(FLAGS)
Â Â Â Â data_dir=Â os.path.join('./data/{}'.format(FLAGS['checkpoint_dir']),Â "train.h5")
Â Â Â Â images,labels=read_data(data_dir)
Â Â Â Â defÂ reader():
Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(len(images)):
Â Â Â Â Â Â Â Â Â Â Â Â yieldÂ images,Â labels
Â Â Â Â returnÂ reader
defÂ train(use_cuda,Â num_passes,BATCH_SIZEÂ =Â 128,Â model_save_dir='../models'):
Â Â Â Â ifÂ FLAGS['is_train']:
Â Â Â Â Â Â imagesÂ =Â fluid.layers.data(name='images',Â shape=[1,Â FLAGS['image_size'],Â FLAGS['image_size']],Â dtype='float32')
Â Â Â Â Â Â labelsÂ =Â fluid.layers.data(name='labels',Â shape=[1,Â FLAGS['label_size'],Â FLAGS['label_size']],Â dtype='float32')
Â Â Â Â else:
Â Â Â Â Â Â _,_,FLAGS['image_size'],FLAGS['label_size']=input_setup(FLAGS)
Â Â Â Â Â Â imagesÂ =Â fluid.layers.data(name='images',Â shape=[1,Â FLAGS['image_size'],Â FLAGS['label_size']],Â dtype='float32')
Â Â Â Â Â Â labelsÂ =Â fluid.layers.data(name='labels',Â shape=[1,Â FLAGS['image_size']-12,Â FLAGS['label_size']-12],Â dtype='float32')

Â Â Â Â #feed_order=['images','labels']
Â Â Â Â #Â è·å–ç¥ç»ç½‘ç»œçš„è®­ç»ƒç»“æœ
Â Â Â Â predictÂ =Â model(images)
Â Â Â Â #Â è·å–æŸå¤±å‡½æ•°
Â Â Â Â costÂ =Â fluid.layers.square_error_cost(input=predict,Â label=labels)
Â Â Â Â #Â å®šä¹‰å¹³å‡æŸå¤±å‡½æ•°
Â Â Â Â avg_costÂ =Â fluid.layers.mean(cost)
Â Â Â Â #Â å®šä¹‰ä¼˜åŒ–æ–¹æ³•
Â Â Â Â optimizerÂ =Â fluid.optimizer.Momentum(learning_rate=1e-4,momentum=0.9)
Â Â Â Â optsÂ =optimizer.minimize(avg_cost)

Â Â Â Â #Â æ˜¯å¦ä½¿ç”¨GPU
Â Â Â Â placeÂ =Â fluid.CUDAPlace(0)Â ifÂ use_cudaÂ elseÂ fluid.CPUPlace()

Â Â Â Â #Â åˆå§‹åŒ–æ‰§è¡Œå™¨
Â Â Â Â exe=fluid.Executor(place)
Â Â Â Â exe.run(fluid.default_startup_program())
Â Â Â Â #Â è·å–è®­ç»ƒæ•°æ®
Â Â Â Â train_readerÂ =Â paddle.batch(
Â Â Â Â Â Â Â Â reader_creator_image_and_label(),Â batch_size=BATCH_SIZE)
Â Â Â Â #Â è·å–æµ‹è¯•æ•°æ®
Â Â Â Â #Â test_readerÂ =Â paddle.batch(
Â Â Â Â #Â Â Â Â Â read_data(),Â batch_size=BATCH_SIZE)
Â Â Â Â #print(len(next(train_reader())))
Â Â Â Â feederÂ =Â fluid.DataFeeder(place=place,Â feed_list=[images,Â labels])
Â Â Â Â forÂ pass_idÂ inÂ range(num_passes):
Â Â Â Â Â Â Â Â forÂ batch_id,Â dataÂ inÂ enumerate(train_reader()):
Â Â Â Â Â Â Â Â Â Â Â Â avg_cost_valueÂ =Â exe.run(fluid.default_main_program(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â feed=feeder.feed(data),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fetch_list=[avg_cost])

Â Â Â Â Â Â Â Â Â Â Â Â ifÂ batch_id%100Â ==Â 0:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â print("loss="+avg_cost_value[0])

defÂ model(images):
Â Â Â Â conv1=fluid.layers.conv2d(input=images,Â num_filters=64,Â filter_size=9,Â act='relu')
Â Â Â Â conv2=fluid.layers.conv2d(input=conv1,Â num_filters=32,Â filter_size=1,act='relu')
Â Â Â Â conv3=fluid.layers.conv2d(input=conv2,Â num_filters=1,Â filter_size=5)
Â Â Â Â returnÂ conv3

ifÂ __name__Â ==Â '__main__':
Â Â Â Â #Â å¼€å§‹è®­ç»ƒ
Â Â Â Â train(use_cuda=False,Â num_passes=10)
```




# æµ‹è¯•




**å…¨å·ç§¯ç½‘ç»œ**




æ‰€ç”¨ç½‘ç»œä¸ºå…¨å·ç§¯ç½‘ç»œï¼Œå› æ­¤ä½œä¸ºå®é™…æµ‹è¯•æ—¶ï¼Œç›´æ¥è¾“å…¥å®Œæ•´å›¾åƒå³å¯ã€‚




**Padding**




è®­ç»ƒæ—¶å¾—åˆ°çš„å®é™…ä¸Šæ˜¯é™¤å»å››å‘¨ (33-21)/2=6 åƒç´ å¤–çš„å›¾åƒï¼Œè‹¥ç›´æ¥é‡‡ç”¨è®­ç»ƒæ—¶çš„è®¾ç½®ï¼ˆæ—  paddingï¼‰ï¼Œå¾—åˆ°çš„å›¾åƒæœ€åä¼šå‡å°‘å››å‘¨å„ 6 åƒç´ ï¼ˆå¦‚æ’å€¼æ”¾å¤§åè¾“å…¥ 512 Ã— 512ï¼Œè¾“å‡º 500 Ã— 500ï¼‰ã€‚




å› æ­¤åœ¨æµ‹è¯•æ—¶æ¯ä¸€å±‚å·ç§¯éƒ½è¿›è¡Œäº† paddingï¼ˆå·ç§¯æ ¸å°ºå¯¸ä¸º 1 Ã— 1çš„ä¸éœ€è¦è¿› è¡Œ paddingï¼‰ï¼Œè¿™æ ·ä¿è¯æ’å€¼æ”¾å¤§åè¾“å…¥ä¸è¾“å‡ºå°ºå¯¸çš„ä¸€è‡´æ€§ã€‚




# é‡å»ºç»“æœ




**å®¢è§‚è¯„ä»·æŒ‡æ ‡ PSNR ä¸ SSIMï¼š**ç›¸æ¯”å…¶ä»–ä¼ ç»Ÿæ–¹æ³•ï¼ŒSRCNN å–å¾—æ›´å¥½çš„é‡å»ºæ•ˆæœã€‚




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoURhlicTZB4FG3EyTx1q0amyIKf5aDkMs9IyfRicGLFPevQCLX9pufw2g/640)




**ä¸»è§‚æ•ˆæœï¼š**ç›¸æ¯”å…¶ä»–ä¼ ç»Ÿæ–¹æ³•ï¼ŒSRCNN é‡å»ºæ•ˆæœæ›´å…·ä¼˜åŠ¿ã€‚




![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgk1gWUMjXtV8OdMqv1uoXSoJLa6S4GqjIgll6OicKeCHF2kLL2WQ755XUV9BjTasiasQABAScwB9bFA/640)




# å…³äºPaddlePaddle




PaddlePaddle åœ¨æˆ‘çœ‹æ¥ä¸ TensorFlow æœ‰ç‚¹ç±»ä¼¼ï¼ŒAPI éƒ½éå¸¸å¥½ç”¨ï¼Œç”¨æˆ·ç¾¤ä½“è¶Šæ¥è¶Šå¤§ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹å°å»ºè®®ï¼Œå°±æ˜¯åœ¨æˆ‘ä½¿ç”¨çš„æ—¶å€™ï¼Œå‘ç°æ•°æ®å¤„ç†çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼ˆæ¯”è¾ƒèœï¼‰ï¼Œæ¯”å¦‚ TensorFlowä¸­æœ‰ TFRecordsï¼ŒåŒæ—¶æœ‰è‡ªå¸¦çš„æ•°æ®é›†è¿­ä»£å™¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¼å…¥æ•°æ®ï¼Œæ‰€ä»¥å¸Œæœ›å‡ºä¸€ä¸ªå®˜æ–¹çš„æ•°æ®è½¬æ¢æ ¼å¼ï¼Œç”¨æ¥è¯»å–æ•°æ®ï¼Œå¹¶æä¾›è¿­ä»£å™¨æ–¹æ³•ã€‚




![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmPEF4lW0pL5weJia5y4xhJbog2pIZZ3ZCgVUDynvus6rCzNKGAAAI6R8jaXTpYPISCMicpFegVdG0g/640?)







**ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹æ›´å¤šè®ºæ–‡å¤ç°ï¼š**




- 
[ç»å…¸è®ºæ–‡å¤ç° | LSGANï¼šæœ€å°äºŒä¹˜ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247492002&idx=1&sn=2d2c8551cd44ee5506cac3ff38a438f3&chksm=96ea3e22a19db73404bc9af4de8b3c406cbc1097f305b63da82efd1d07915500f4042927ee22&scene=21#wechat_redirect)

- 
[PyraNetï¼šåŸºäºç‰¹å¾é‡‘å­—å¡”ç½‘ç»œçš„äººä½“å§¿æ€ä¼°è®¡](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247492226&idx=1&sn=eafb23c1658f487f47254128bcc6e1b2&chksm=96ea3d02a19db4149215378b7c18d6a92dcd6bbacbbeb73e9bfa2d1594073528adab03ccd031&scene=21#wechat_redirect)

- 
[ç»å…¸è®ºæ–‡å¤ç° | InfoGANï¼šä¸€ç§æ— ç›‘ç£ç”Ÿæˆæ–¹æ³•](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247492415&idx=1&sn=a359e72ee99555f7a2fb4e21b2ad51db&chksm=96ea3cbfa19db5a913b9ed01490df6e902abfeb36856bb5be946527a070d399ee37a3ff6c750&scene=21#wechat_redirect)

- 
[ç»å…¸è®ºæ–‡å¤ç° | åŸºäºæ ‡æ³¨ç­–ç•¥çš„å®ä½“å’Œå…³ç³»è”åˆæŠ½å–](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247493077&idx=1&sn=71dd19070ca03bb016849f091a03d3e5&chksm=96ea3a55a19db343e25f5b73cbe5b181e1f2001b83a78c5246aee2ace6df135aee35ac1fe55f&scene=21#wechat_redirect)












**![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/xuKyIMVqtF2cO2WSmiccOqL8YlIwp5Xv2cqdDp6ANbUt8yibCc1cgQQrPHLKhf73icQGHves57M2XMZLJxIhF0e7g/640?)****#****æŠ• ç¨¿ é€š é“#**

**Â è®©ä½ çš„è®ºæ–‡è¢«æ›´å¤šäººçœ‹åˆ°Â **





å¦‚ä½•æ‰èƒ½è®©æ›´å¤šçš„ä¼˜è´¨å†…å®¹ä»¥æ›´çŸ­è·¯å¾„åˆ°è¾¾è¯»è€…ç¾¤ä½“ï¼Œç¼©çŸ­è¯»è€…å¯»æ‰¾ä¼˜è´¨å†…å®¹çš„æˆæœ¬å‘¢ï¼ŸÂ **ç­”æ¡ˆå°±æ˜¯ï¼šä½ ä¸è®¤è¯†çš„äººã€‚**



æ€»æœ‰ä¸€äº›ä½ ä¸è®¤è¯†çš„äººï¼ŒçŸ¥é“ä½ æƒ³çŸ¥é“çš„ä¸œè¥¿ã€‚PaperWeekly æˆ–è®¸å¯ä»¥æˆä¸ºä¸€åº§æ¡¥æ¢ï¼Œä¿ƒä½¿ä¸åŒèƒŒæ™¯ã€ä¸åŒæ–¹å‘çš„å­¦è€…å’Œå­¦æœ¯çµæ„Ÿç›¸äº’ç¢°æ’ï¼Œè¿¸å‘å‡ºæ›´å¤šçš„å¯èƒ½æ€§ã€‚Â 




PaperWeekly é¼“åŠ±é«˜æ ¡å®éªŒå®¤æˆ–ä¸ªäººï¼Œåœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šåˆ†äº«å„ç±»ä¼˜è´¨å†…å®¹ï¼Œå¯ä»¥æ˜¯**æœ€æ–°è®ºæ–‡è§£è¯»**ï¼Œä¹Ÿå¯ä»¥æ˜¯**å­¦ä¹ å¿ƒå¾—**æˆ–**æŠ€æœ¯å¹²è´§**ã€‚æˆ‘ä»¬çš„ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œè®©çŸ¥è¯†çœŸæ­£æµåŠ¨èµ·æ¥ã€‚




ğŸ“Â **æ¥ç¨¿æ ‡å‡†ï¼š**

â€¢ ç¨¿ä»¶ç¡®ç³»ä¸ªäºº**åŸåˆ›ä½œå“**ï¼Œæ¥ç¨¿éœ€æ³¨æ˜ä½œè€…ä¸ªäººä¿¡æ¯ï¼ˆå§“å+å­¦æ ¡/å·¥ä½œå•ä½+å­¦å†/èŒä½+ç ”ç©¶æ–¹å‘ï¼‰Â 

â€¢ å¦‚æœæ–‡ç« å¹¶éé¦–å‘ï¼Œè¯·åœ¨æŠ•ç¨¿æ—¶æé†’å¹¶é™„ä¸Šæ‰€æœ‰å·²å‘å¸ƒé“¾æ¥Â 

â€¢ PaperWeekly é»˜è®¤æ¯ç¯‡æ–‡ç« éƒ½æ˜¯é¦–å‘ï¼Œå‡ä¼šæ·»åŠ â€œåŸåˆ›â€æ ‡å¿—



**ğŸ“¬ æŠ•ç¨¿é‚®ç®±ï¼š**

â€¢ æŠ•ç¨¿é‚®ç®±ï¼šhr@paperweekly.site

â€¢ æ‰€æœ‰æ–‡ç« é…å›¾ï¼Œè¯·å•ç‹¬åœ¨é™„ä»¶ä¸­å‘é€Â 

â€¢ è¯·ç•™ä¸‹å³æ—¶è”ç³»æ–¹å¼ï¼ˆå¾®ä¿¡æˆ–æ‰‹æœºï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨ç¼–è¾‘å‘å¸ƒæ—¶å’Œä½œè€…æ²Ÿé€š










ğŸ”




ç°åœ¨ï¼Œåœ¨**ã€ŒçŸ¥ä¹ã€**ä¹Ÿèƒ½æ‰¾åˆ°æˆ‘ä»¬äº†

è¿›å…¥çŸ¥ä¹é¦–é¡µæœç´¢**ã€ŒPaperWeeklyã€**

ç‚¹å‡»**ã€Œå…³æ³¨ã€**è®¢é˜…æˆ‘ä»¬çš„ä¸“æ å§







**å…³äºPaperWeekly**





PaperWeekly æ˜¯ä¸€ä¸ªæ¨èã€è§£è¯»ã€è®¨è®ºã€æŠ¥é“äººå·¥æ™ºèƒ½å‰æ²¿è®ºæ–‡æˆæœçš„å­¦æœ¯å¹³å°ã€‚å¦‚æœä½ ç ”ç©¶æˆ–ä»äº‹ AI é¢†åŸŸï¼Œæ¬¢è¿åœ¨å…¬ä¼—å·åå°ç‚¹å‡»**ã€Œäº¤æµç¾¤ã€**ï¼Œå°åŠ©æ‰‹å°†æŠŠä½ å¸¦å…¥ PaperWeekly çš„äº¤æµç¾¤é‡Œã€‚




![640?](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgkXb8A1kiafKxib8NXiaPMU8mQvRWVBtFNic4G5b5GDD7YdwrsCAicOc8kp5tdEOU3x7ufnleSbKkiaj5Dg/640?)

â–½ ç‚¹å‡» |Â é˜…è¯»åŸæ–‡| æ”¶è—å¤ç°ä»£ç 




