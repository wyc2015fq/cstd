# C#系列 ----- 3 值引用和对象引用 - 墨流觞的博客 - CSDN博客





2018年10月30日 21:45:38[墨氲](https://me.csdn.net/dss_dssssd)阅读数：56








## 值类型和引用类型（Value Types Versus Reference Types）

上一篇对于type的定义其实不准确，在此给出更准确的定义。

所有的C#类型包括：
- Value types
- Reference types
- Generic type parameters
- Pointer types

先看一下值类型和引用类型，其余的之后再看
- 值类型： 内建的 all `numeric` types, the `char` type, and the `bool` type和自定义的`struct`和`enum`类型
- 引用类型：class, array, delegate, and interface types 和内建的string type

两者的基本不同是在内存中的处理方式不同
- 
Value types

值类型的变量或常量仅仅是一个值，比如内建整型int的变量仅仅是一个32位的数据

```
public struct Point { public int X, Y; }
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20181030214144771.png)

对于值类型而言，实例赋值直接深拷贝一份，即创建另一份内存

```
static void Main()
{
Point p1 = new Point();
p1.X = 7;
Point p2 = p1; // Assignment causes copy
Console.WriteLine (p1.X); // 7
Console.WriteLine (p2.X); // 7
p1.X = 9; // Change p1.X
Console.WriteLine (p1.X); // 9
Console.WriteLine (p2.X); // 7
}
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20181030214156653.png)
- 引用类型

引用类型包含两部分： 对象和对象的引用。而引用类型的实例对象是包含值得对象的引用。简单的就是一个指向内存的指针，指向的内存中包含值。**和C++的指针一样**
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181030214205889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Rzc19kc3Nzc2Q=,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181030214217435.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Rzc19kc3Nzc2Q=,size_16,color_FFFFFF,t_70)

Null: 引用可以赋值为null， 表示没有指向任何对象

```
class Point {...}
...
Point p = null;
Console.WriteLine (p == null); // True
// The following line generates a runtime error
// (a NullReferenceException is thrown):
Console.WriteLine (p.X);
```

而值不可以赋值为null

```
struct Point {...}
...
Point p = null; // Compile-time error
int x = null; // Compile-time error
```

内存占用(Storage overhead)
- 值类型实例精确地占用了存储字段所需的内存

下面的Point占用8个字节

```
struct Point
{
int x; // 4 bytes
int y; // 4 bytes
}
```

而引用类型需要为对象和引用（指针）分配内存，需要的内存更大
- 
位操作符：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181030214229728.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Rzc19kc3Nzc2Q=,size_16,color_FFFFFF,t_70)- 
条件操作符

||  &&  !=  ==

res = q ?a : b   => if q{ res= a} else{res=b}








