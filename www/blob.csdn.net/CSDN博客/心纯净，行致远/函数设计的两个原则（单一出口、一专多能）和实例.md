# 函数设计的两个原则（单一出口、一专多能）和实例 - 心纯净，行致远 - CSDN博客





2018年06月21日 18:17:31[吉大秦少游](https://me.csdn.net/zhanshen112)阅读数：943








函数设计应该像模块设计一样，讲究接口和封装。函数的命名应该让使用函数的程序员见名知意，函数应该封装成简单易用的形式，而且当函数内部实现算法变化时，函数还能够保持接口的稳定性。

下面的例子来源于浙江大学翁恺老师的《C语言程序设计进阶》中的线性搜索算法。

首先看这样一个搜索算法，实现的功能是在一个数组中找出需要的数字，并且返回该数字在数组中的位置；找不到，则返回-1。

```cpp
int search(int key,int a[],int len)
{
int ret=-1;    //这个是函数的输出接口，返回-1则表示没有找到；返回非-1的数组则表示对应元素的下标
for(int i=0;i<len;i++){    //int i写在for语句中是C99的写法，编译器如果不支持C99，则需要写在for外面
	if(key==a[i]){
		ret=i;
		break;
	}
} 
return ret;
}
```

这里，ret就是程序的输出接口，无论内部函数算法如何变化，始终保证接口的易用性，对使用该函数的程序员封装其内部复杂性。这个函数是比较好的。

然后有人提出这样一种函数的写法：

```cpp
int search(int key,int a[],int len)
{
int ret=-1;    //这个是函数的输出接口，返回-1则表示没有找到；返回非-1的数组则表示对应元素的下标
for(int i=0;i<len;i++){
	if(key==a[i]){
		return i;
	}
} 
return -1;
}
```

当找到对应元素时，直接返回位置i；找不到，返回-1.

这里违反了函数或者模块设计的原则：**单一出口原则**。单一出口原则可以使得函数或者模块时非常清晰的，以后如果需要调整，只需要在函数内部调整即可，对于已经使用该函数的程序员来说会有极大的便利。

还有一种写法如下：

```cpp
int search(int key,int a[],int len)
{
int ret=-1;    //这个是函数的输出接口，返回-1则表示没有找到；返回非-1的数组则表示对应元素的下标
for(int i=0;i<len;i++){
	if(key==a[i]){
		break;
	}
} 
	if(i==len)
	{
		return -1;
	}
	else{
		return i;
	}
}
```

思路是首先看能否找到搜索的元素，找不到，则i=len，返回-1；找到的话，则会直接在第一个if语句进行break，然后转入下面的else语句，返回找到的位置。这个函数看起来好像也没有问题，但是违反了函数设计的另一个原则：不要一专多能。变量i承担了两个功能，不仅用来遍历，还用来表示到底有没有找到搜索元素。所以，一专多能是不好的代码。

这样回头来看，往往在函数里面可以单独设置函数的输出接口。



