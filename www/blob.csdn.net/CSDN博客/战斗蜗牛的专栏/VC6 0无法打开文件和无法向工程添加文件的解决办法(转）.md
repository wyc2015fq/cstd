# VC6.0无法打开文件和无法向工程添加文件的解决办法(转） - 战斗蜗牛的专栏 - CSDN博客





2010年01月02日 23:53:00[vbskj](https://me.csdn.net/vbskj)阅读数：1156








VC6.0和Visio两个软件有冲突,把Visio卸载掉即可，若卸载无效，可按下述方法添加一个宏程序补救。

## 概要

启动 @ @ OpenFile@@ @ 对话框中使用键盘快捷方式键 VisualC++ 中或从 文件 菜单导致以下错误：

0x5003eaed 上 DEVSHL.DLL 中访问冲突 (0xC0000005)。 
DevShl.Dll 引用 0x0000000 上内存。 无法读取内存。

当您从<项目>菜单中选择<添加到项目>， 单击<文件>会出现相同错误。 

FileTool.exe 是示例替换 VisualC++ 使用 Developer Studio 对象模型中 打开 和 添加到项目 菜单项。 
开发 VisualStudio 对象模型包含方法， 同时打开文件并向项目添加文件。 BuildProject 对象包含 AddFile 方法将文件添加到项目。 Documents 对象包含一个可打开到 DeveloperStudio 文件 打开 方法。 这些可用于宏或外接程序。

### 安装加载项

下载[FileTool.exe](http://download.microsoft.com/download/vc60ent/s1/6.0/w9xnt4/en-us/filetool.exe)


|1.|运行 FileTool.Exe 来提取 VisualC++6.0 项目。|
|----|----|
|2.|生成在 VisualC++ 项目 发布 或 调试 配置中。|
|3.|VisualC++, 中单击 工具 菜单中 自定义 。|
|4.|在 自定义 对话框中, 单击 Add - Ins and 宏文件 选项卡。|
|5.|单击 浏览 按钮并定位步骤 2 中生成 FileTool.dll 文件。|
|6.|单击 确定 以保存设置。|

对于两个命令工具栏出现。

### 删除快捷键

加载外接后, 可以删除为菜单项， 停止 VisualC++ 并将其分配给两外接命令按照下面步骤快捷键： 

|1.|从 VisualC++ 工具 菜单, 单击 自定义 。|
|----|----|
|2.|在 自定义 对话框中, 单击 键盘 选项卡。|
|3.|从 类别 中选择 文件 。|
|4.|在命令窗口, 选择 FileOpen 。|
|5.|当前密钥 窗口, 中选择 CTRL+O 项， 然后单击 删除 。|
|6.|从 类别 中选择 项目 。|
|7.|在命令窗口, 选择 InsertFilesIntoProject 。 如果没有与其, 关联快捷方式请按照步骤 5 来删除它。 有默认为没有快捷键对该项。|
|8.|从 类别 中选择 加载项 。|
|9.|两加载命令 AddFileToProject 和 OpenFile 命令窗口中显示。|
|10.|选择 OpenFile 然后 按新快捷键密钥 框放置光标、 按快捷键或组合键， 要, 并单击 指派 。|
|11.|对其他命令重复上述步骤。 对于两个命令分配快捷键当前密钥窗口中显示。|

您可能还希望删除菜单命令并插入其就地 AddIn 命令。 将新 AddIn 命令插入 MenuBar, 使用以下步骤： 
|1.|从 VisualC++ 工具 菜单, 单击 自定义 。|
|----|----|
|2.|单击 文件 菜单并拖动 Open 命令的 文件 弹出式注销， 然后释放它。|
|3.|单击 项目 菜单， 单击 添加到项目 和然后关闭的弹出 文件 命令拖释放它。|
|4.|在 自定义 对话框中, 选择 命令 选项卡。|
|5.|从 类别 列表框中选择 外接 。|
|6.|到 文件 菜单 OpenFile 命令拖放它由 Open 命令 vacated 空间中。|
|7.|AddFileToProject 命令拖 到 AddProject@@@ 项目到 项目 菜单上并放空间 vacated 由命令 文件 中。|




附：http://[hi.baidu.com/liuyanqiong/blog/item/83928353d6e92f080df3e35c.html](http://hi.baidu.com/liuyanqiong/blog/item/83928353d6e92f080df3e35c.html)



