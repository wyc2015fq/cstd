# ACID与ACID原则 - 纸上得来终觉浅，绝知此事要躬行 - CSDN博客





2016年09月26日 11:32:17[boonya](https://me.csdn.net/boonya)阅读数：2252








ACID，指数据库事务正确执行的四个基本要素的缩写。包含：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability）。一个支持事务（Transaction）的数据库，必需要具有这四种[特性](http://baike.baidu.com/view/884393.htm)，否则在事务过程（Transaction
 processing）当中无法保证数据的正确性，交易过程极可能达不到交易方的要求。

## 原子性

整个事务中的所有操作，要么全部完成，要么全部不完成，不可能停滞在中间某个环节。事务在执行过程中发生错误，会被[回滚](http://baike.baidu.com/view/688328.htm)（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样。




## 一致性


一个事务可以封装状态改变（除非它是一个只读的）。事务必须始终保持系统处于一致的状态，不管在任何给定的时间[**并发**](http://baike.baidu.com/view/684757.htm)事务有多少。

也就是说：如果事务是[**并发**](http://baike.baidu.com/view/684757.htm)多个，系统也必须如同串行事务一样操作。其主要特征是保护性和不变性(Preserving an Invariant)，以转账[案例](http://baike.baidu.com/view/395525.htm)为例，假设有五个账户，每个账户余额是100元，那么五个账户总额是500元，如果在这个5个账户之间同时发生多个转账，无论[**并发**](http://baike.baidu.com/view/684757.htm)多少个，比如在A与B账户之间转账5元，在C与D账户之间转账10元，在B与E之间转账15元，五个账户总额也应该还是500元，这就是保护性和不变性




## 隔离性


隔离状态执行事务，使它们好像是系统在给定时间内执行的唯一操作。如果有两个事务，运行在相同的时间内，执行相同的功能，事务的隔离性将确保每一事务在系统中认为只有该事务在使用系统。这种属性有时称为[串行](http://baike.baidu.com/view/196479.htm)化，为了防止事务操作间的混淆，必须串行化或序列化请求，使得在同一时间仅有一个请求用于同一数据。




## 持久性


在事务完成以后，该事务对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。

由于一项操作通常会包含许多子操作，而这些子操作可能会因为硬件的损坏或其他因素产生问题，要正确实现ACID并不容易。ACID建议数据库将所有需要更新以及修改的资料一次操作完毕，但实际上并不可行。

目前主要有两种方式实现ACID：第一种是Write ahead logging，也就是日志式的方式(现代数据库均基于这种方式)。第二种是Shadow paging。

相对于WAL（write ahead logging）技术，shadow paging技术实现起来比较简单，消除了写日志记录的开销恢复的速度也快(不需要redo和undo)。shadow paging的缺点就是事务提交时要输出多个块，这使得提交的开销很大，而且以块为单位，很难应用到允许多个事务并发执行的情况——这是它致命的缺点。

WAL 的中心思想是对数据文件 的修改（它们是表和索引的载体）必须是只能发生在这些修改已经 记录了日志之后 -- 也就是说，在日志记录冲刷到永久存储器之后． 如果我们遵循这个过程，那么我们就不需要在每次事务提交的时候 都把数据页冲刷到磁盘，因为我们知道在出现崩溃的情况下， 我们可以用日志来恢复数据库：任何尚未附加到数据页的记录 都将先从日志记录中重做（这叫向前滚动恢复，也叫做 REDO） 然后那些未提交的事务做的修改将被从数据页中删除 （这叫向后滚动恢复 - UNDO）。



# ACID原则

ACID原则是数据库事务正常执行的四个基本原则，分别指：原子性、[一致性](http://baike.baidu.com/view/552538.htm)、[独立性](http://baike.baidu.com/view/562176.htm)及[持久性](http://baike.baidu.com/view/3849641.htm)。




**事务的原子性(Atomicity)**是指一个事务要么全部执行,要么不执行.也就是说一个事务不可能只执行了一半就停止了.比如你从取款机取钱,这个事务可以分成两个步骤:1划卡,2出钱.不可能划了卡,而钱却没出来.这两步必须同时完成.要么就不完成.



[**事务**](http://baike.baidu.com/view/121511.htm)**的[一致性](http://baike.baidu.com/view/552538.htm)(Consistency)**是指事务的运行并不改变数据库中数据的一致性.例如,完整性约束了a+b=10,一个事务改变了a,那么b也应该随之改变.



**独立性(Isolation）:**事务的独立性也有称作隔离性,是指两个以上的事务不会出现交错执行的状态.因为这样可能会导致数据不一致.



**持久性(Durability）:**[事务](http://baike.baidu.com/view/121511.htm)的[持久性](http://baike.baidu.com/view/3849641.htm)是指事务执行成功以后,该事务所对数据库所作的更改便是持久的保存在数据库之中，不会无缘无故的[回滚](http://baike.baidu.com/view/688328.htm).




