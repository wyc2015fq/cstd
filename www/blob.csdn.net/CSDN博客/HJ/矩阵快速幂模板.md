# 矩阵快速幂模板 - HJ - CSDN博客
2018年05月08日 21:55:51[FZH_SYU](https://me.csdn.net/feizaoSYUACM)阅读数：99
个人分类：[ACM模板																[====ACM====](https://blog.csdn.net/feizaoSYUACM/article/category/6308070)](https://blog.csdn.net/feizaoSYUACM/article/category/6364160)
```
ll make[6][6]={      //构造矩阵 
1,1,1,1,1,1,  
1,0,0,0,0,0,
0,0,1,3,3,1,
0,0,0,1,2,1,
0,0,0,0,1,1,
0,0,0,0,0,1
};
struct Matrix{
    ll m[10][10];
    void init(){           //矩阵初始化 
        memset(m,0,sizeof(m)); 
    }
};
Matrix Mult(Matrix a,Matrix b)    //矩阵乘法 
{ 
    Matrix ans;
    ans.init();
    for(int i=0;i<6;i++)
      for(int j=0;j<6;j++)
        for(int k=0;k<6;k++)
          ans.m[i][j]=(ans.m[i][j]+(a.m[i][k]*b.m[k][j]+mod)%mod)%mod;
    return ans;
}
ll quick_mod(ll n)         //矩阵快速幂 
{
    Matrix ans,b,base;
    ans.init();
    for(int i=0;i<6;i++)
      ans.m[i][i]=1;
    for(int i=0;i<6;i++)
      for(int j=0;j<6;j++)
        b.m[i][j]=make[i][j];
    base.m[0][0]=1,base.m[1][0]=0,base.m[2][0]=8;
    base.m[3][0]=4,base.m[4][0]=2,base.m[5][0]=1;
    while(n)
    {
        if(n&1)
          ans=Mult(ans,b);
        b=Mult(b,b);
        n>>=1;
    }
    ans=Mult(ans,base);
    return ans.m[1][0];
}
```
