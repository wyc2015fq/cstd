# 最近邻 - PeterBishop - CSDN博客





2019年01月06日 22:23:27[PeterBishop0](https://me.csdn.net/qq_40061421)阅读数：20
个人分类：[TensorFlow](https://blog.csdn.net/qq_40061421/article/category/8461142)









### 使用TensorFlow库的最近邻学习算法示例。此示例使用手写数字的MNIST数据库(http://yann.lecun.com/exdb/mnist/)

### Author: Aymeric DamienProject: https://github.com/aymericdamien/TensorFlow-Examples/

```python
from __future__ import print_function

import numpy as np
import tensorflow as tf

# 导入 MNIST 数据
from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets("/tmp/data/", one_hot=True)

# 这个样例中我们只用部分数据
Xtr, Ytr = mnist.train.next_batch(5000) #5000 来训练 (nn candidates)
Xte, Yte = mnist.test.next_batch(200) #200 来训练

# tf Graph Input
xtr = tf.placeholder("float", [None, 784])
xte = tf.placeholder("float", [784])

# 最近邻的计算用L1的距离
#计算 L1 的距离
distance = tf.reduce_sum(tf.abs(tf.add(xtr, tf.negative(xte))), reduction_indices=1)
# 预计: 得到最小距离下标 (最近邻)
pred = tf.arg_min(distance, 0)

accuracy = 0.

# Initialize the variables (i.e. assign their default value)
init = tf.global_variables_initializer()

# Start training
with tf.Session() as sess:

    # Run the initializer
    sess.run(init)

    # loop over test data
    for i in range(len(Xte)):
        # 得到最近邻
        nn_index = sess.run(pred, feed_dict={xtr: Xtr, xte: Xte[i, :]})
        # 比较预测和真实值
        print("Test", i, "Prediction:", np.argmax(Ytr[nn_index]), \
            "True Class:", np.argmax(Yte[i]))
        # Calculate accuracy
        if np.argmax(Ytr[nn_index]) == np.argmax(Yte[i]):
            accuracy += 1./len(Xte)
    print("Done!")
    print("Accuracy:", accuracy)
```





