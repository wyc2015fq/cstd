# JXLS生成EXCEL并下载 - z69183787的专栏 - CSDN博客
2014年12月01日 13:39:29[OkidoGreen](https://me.csdn.net/z69183787)阅读数：1643
原文地址：http://www.cnblogs.com/yangy608/archive/2010/09/07/1820681.html
```java
jxl.jar
```
```java
```
```java
jxls-core-
```
```java
0.9
```
```java
.
```
```java
9
```
```java
.jar
```
```java
```
```java
jxls-reader-
```
```java
0.9
```
```java
.
```
```java
9
```
```java
.jar
```
```java
```
```java
poi-
```
```java
3.5
```
```java
-FINAL.jar(必须
```
```java
3.5
```
```java
以上的版本)
```
```java
```
```java
其他jar根据提示可以去 http:
```
```java
//jarvana.com/jarvana/ 查找
```
```java
```
```java
// 生成excel 传入模板文件 要生成的内容 生成文件 返回生成文件的完整路径
```
```java
```
```java
public
```
```java
static
```
```java
String doExcel(String from, Map beans, String to) {
```
```java
```
```java
ServletContext sc = (ServletContext) ActionContext.getContext().get(
```
```java
```
```java
ServletActionContext.SERVLET_CONTEXT);
```
```java
```
```java
String path = sc.getRealPath(
```
```java
"/model"
```
```java
);
```
```java
```
```java
XLSTransformer transformer =
```
```java
new
```
```java
XLSTransformer();
```
```java
```
```java
String sfrom = path +
```
```java
"\\"
```
```java
+ from;
```
```java
// 模板文件
```
```java
```
```java
String sto = path +
```
```java
"\\"
```
```java
+ to;
```
```java
// 要生成的文件
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
transformer.transformXLS(sfrom, beans, sto);
```
```java
```
```java
}
```
```java
catch
```
```java
(ParsePropertyException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
return
```
```java
sto;
```
```java
```
```java
}
```
```java
```
```java
// 下载
```
```java
```
```java
public
```
```java
static
```
```java
void
```
```java
doDownLoad(String path, String name,
```
```java
```
```java
HttpServletResponse response) {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
response.reset();
```
```java
```
```java
response.setHeader(
```
```java
"Content-disposition"
```
```java
,
```
```java
```
```java
"attachment;success=true;filename ="
```
```java
```
```java
+ URLEncoder.encode(name,
```
```java
"utf-8"
```
```java
));
```
```java
```
```java
BufferedInputStream bis =
```
```java
null
```
```java
;
```
```java
```
```java
BufferedOutputStream bos =
```
```java
null
```
```java
;
```
```java
```
```java
OutputStream fos =
```
```java
null
```
```java
;
```
```java
```
```java
InputStream fis =
```
```java
null
```
```java
;
```
```java
```
```java
File uploadFile =
```
```java
new
```
```java
File(path);
```
```java
```
```java
fis =
```
```java
new
```
```java
FileInputStream(uploadFile);
```
```java
```
```java
bis =
```
```java
new
```
```java
BufferedInputStream(fis);
```
```java
```
```java
fos = response.getOutputStream();
```
```java
```
```java
bos =
```
```java
new
```
```java
BufferedOutputStream(fos);
```
```java
```
```java
// 弹出下载对话框
```
```java
```
```java
int
```
```java
bytesRead =
```
```java
0
```
```java
;
```
```java
```
```java
byte
```
```java
[] buffer =
```
```java
new
```
```java
byte
```
```java
[
```
```java
8192
```
```java
];
```
```java
```
```java
while
```
```java
((bytesRead = bis.read(buffer,
```
```java
0
```
```java
,
```
```java
8192
```
```java
)) != -
```
```java
1
```
```java
) {
```
```java
```
```java
bos.write(buffer,
```
```java
0
```
```java
, bytesRead);
```
```java
```
```java
}
```
```java
```
```java
bos.flush();
```
```java
```
```java
fis.close();
```
```java
```
```java
bis.close();
```
```java
```
```java
fos.close();
```
```java
```
```java
bos.close();
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
调用：
```
```java
```
```java
List resultList=
```
```java
new
```
```java
ArrayList();
```
```java
```
```java
for
```
```java
(
```
```java
int
```
```java
i =
```
```java
0
```
```java
; i < list.size(); i++) {
```
```java
```
```java
。。。。。。
```
```java
```
```java
InspectionStisfaction vo=
```
```java
new
```
```java
InspectionStisfaction();
```
```java
```
```java
vo.setXjrq(SystemUtil.getTimeStr2Str(String.valueOf(map.get(
```
```java
"apply_date"
```
```java
))));
```
```java
```
```java
vo.setXjsl(lxjsl);
```
```java
```
```java
vo.setFcmy(lfcmy);
```
```java
```
```java
vo.setMy(lmy);
```
```java
```
```java
vo.setYb(lyb);
```
```java
```
```java
vo.setBmy(lbmy);
```
```java
```
```java
vo.setFcbmy(lfcbmy);
```
```java
```
```java
resultList.add(vo);
```
```java
```
```java
}
```
```java
```
```java
```
```java
//生成EXcel
```
```java
```
```java
Map beans =
```
```java
new
```
```java
HashMap();
```
```java
```
```java
beans.put(
```
```java
"resultList"
```
```java
,resultList);
```
```java
```
```java
String path=SystemUtil.doExcel(
```
```java
"巡检商户满意度报表模板.xls"
```
```java
, beans,
```
```java
"巡检商户满意度报表.xls"
```
```java
);
```
```java
```
```java
SystemUtil.doDownLoad(path,
```
```java
"巡检商户满意度报表.xls"
```
```java
,
```
```java
this
```
```java
.response);
```
```java
```
```java
return
```
```java
null
```
```java
;
```
```java
```
```java
模板样式：
```
```java
```
```java
巡检数量(个)   总体满意度 非常满意    满意     一般         不满意    非常不满意  合计
```
```java
```
```java
<jx:forEach items=
```
```java
"${resultList}"
```
```java
var=
```
```java
"l"
```
```java
>
```
```java
```
```java
${l.xjrq}         ${l.xjsl}     ${l.fcmy}   ${l.my}    ${l.yb}    ${l.bmy}   ${l.fcbmy}   $[B#+C#+D#]
```
```java
```
```java
</jx:forEach>
```
```java
```
```java
当月数量总计(个)  $[SUM(B4)]   $[SUM(D4)]  $[SUM(E4)] $[SUM(F4)] $[SUM(G4)] $[SUM(H4)]   $[SUM(I4)]
```
