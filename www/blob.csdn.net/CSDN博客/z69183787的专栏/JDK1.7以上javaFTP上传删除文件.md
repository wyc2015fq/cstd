# JDK1.7以上javaFTP上传删除文件 - z69183787的专栏 - CSDN博客
2016年01月08日 10:44:07[OkidoGreen](https://me.csdn.net/z69183787)阅读数：2003
```java
package
```
```java
com.itv.launcher.util;
```
```java
import
```
```java
java.io.File;
```
```java
import
```
```java
java.io.FileInputStream;
```
```java
import
```
```java
java.io.FileNotFoundException;
```
```java
import
```
```java
java.io.IOException;
```
```java
import
```
```java
java.net.InetSocketAddress;
```
```java
import
```
```java
java.util.Properties;
```
```java
import
```
```java
java.util.StringTokenizer;
```
```java
import
```
```java
sun.net.TelnetOutputStream;
```
```java
import
```
```java
sun.net.ftp.FtpClient;
```
```java
import
```
```java
sun.net.ftp.FtpProtocolException;
```
```java
/**
```
```java
```
```java
*
 FTP上传工具类
```
```java
```
```java
*
```
```java
```
```java
*
 @author yanzhou
```
```java
```
```java
*
 @version v1.0
```
```java
```
```java
*/
```
```java
public
```
```java
class
```
```java
FTPUtil {
```
```java
```
```java
private
```
```java
static
```
```java
FtpClient ftpClient =
```
```java
null
```
```java
;
```
```java
```
```java
private
```
```java
static
```
```java
final
```
```java
String url;
```
```java
```
```java
private
```
```java
static
```
```java
final
```
```java
int
```
```java
port;
```
```java
```
```java
private
```
```java
static
```
```java
final
```
```java
String user;
```
```java
```
```java
private
```
```java
static
```
```java
final
```
```java
String password;
```
```java
```
```java
private
```
```java
static
```
```java
final
```
```java
String remoteFilePath;
```
```java
```
```java
static
```
```java
{
```
```java
```
```java
Properties
 FTPPro = ReadFTPProperties.getMsgFromPro();
```
```java
```
```java
url
 = FTPPro.getProperty(
```
```java
"FTP_URL"
```
```java
);
```
```java
```
```java
port
 = Integer.parseInt(FTPPro.getProperty(
```
```java
"FTP_PORT"
```
```java
));
```
```java
```
```java
user
 = FTPPro.getProperty(
```
```java
"FTP_USER"
```
```java
);
```
```java
```
```java
password
 = FTPPro.getProperty(
```
```java
"FTP_PASSWORD"
```
```java
);
```
```java
```
```java
remoteFilePath
 = FTPPro.getProperty(
```
```java
"FTP_REMOTE_FILEPATH"
```
```java
);
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 链接FTP
```
```java
```
```java
*
 @throws FtpProtocolException
```
```java
```
```java
*/
```
```java
```
```java
private
```
```java
static
```
```java
void
```
```java
connectFTP()
```
```java
throws
```
```java
FtpProtocolException
 {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
ftpClient
 = FtpClient.create();
```
```java
```
```java
ftpClient.connect(
```
```java
new
```
```java
InetSocketAddress(url,
 port));
```
```java
```
```java
ftpClient.login(user,
 password.toCharArray());
```
```java
```
```java
ftpClient.setBinaryType();
```
```java
```
```java
if
```
```java
(!
```
```java
""
```
```java
.equals(remoteFilePath)
 && remoteFilePath !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
ftpClient.changeDirectory(remoteFilePath);
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException
 e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 关闭FTP链接
```
```java
```
```java
*/
```
```java
```
```java
public
```
```java
static
```
```java
void
```
```java
closeFTP() {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
if
```
```java
(ftpClient
 !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
ftpClient.close();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException
 e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 上传文件到FTP
```
```java
```
```java
*
 @param file file文件，struts2从页面得到的File类型
```
```java
```
```java
*
 @param filePath 要保存在FTP上的路径（文件夹）
```
```java
```
```java
*
 @param fileName 文件名（test001.jpg）
```
```java
```
```java
*
 @return 文件是否上传成功
```
```java
```
```java
*
 @throws Exception
```
```java
```
```java
*/
```
```java
```
```java
public
```
```java
static
```
```java
boolean
```
```java
upload(File file, String filePath, String fileName) {
```
```java
```
```java
TelnetOutputStream
 to =
```
```java
null
```
```java
;
```
```java
```
```java
FileInputStream
 fi =
```
```java
null
```
```java
;
```
```java
```
```java
filePath
 = remoteFilePath + Constants.FILE_SEPARATOR + filePath;
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
if
```
```java
(file
 !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
connectFTP();
```
```java
```
```java
if
```
```java
(!isDirExist(filePath.replace(
```
```java
"\\"
```
```java
,
```
```java
"/"
```
```java
)))
 {
```
```java
```
```java
createDir(filePath.replace(
```
```java
"\\"
```
```java
,
```
```java
"/"
```
```java
));
```
```java
```
```java
ftpClient.changeDirectory(filePath.replace(
```
```java
"\\"
```
```java
,
```
```java
"/"
```
```java
));
```
```java
```
```java
}
```
```java
```
```java
fi
 =
```
```java
new
```
```java
FileInputStream(file);
```
```java
```
```java
to
 = (TelnetOutputStream) ftpClient.putFileStream(fileName,
```
```java
true
```
```java
);
```
```java
```
```java
byte
```
```java
[]
 bytes =
```
```java
new
```
```java
byte
```
```java
[
```
```java
1024
```
```java
];
```
```java
```
```java
int
```
```java
i
 = fi.read(bytes);
```
```java
```
```java
while
```
```java
(i
 != -
```
```java
1
```
```java
)
 {
```
```java
```
```java
to.write(bytes);
```
```java
```
```java
i
 = fi.read(bytes);
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
return
```
```java
true
```
```java
;
```
```java
```
```java
}
```
```java
catch
```
```java
(FileNotFoundException
 e1) {
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException
 e2) {
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception
 e) {
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
finally
```
```java
{
```
```java
```
```java
if
```
```java
(fi
 !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
fi.close();
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException
 e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
if
```
```java
(to
 !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
to.flush();
```
```java
```
```java
to.close();
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException
 e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
closeFTP();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 删除FTP制定目录下的文件
```
```java
```
```java
*
 @param filePath 文件在FTP存储的路径
```
```java
```
```java
*
 @param fileName 要删除的文件名称
```
```java
```
```java
*
 @return 是否删除成功
```
```java
```
```java
*/
```
```java
```
```java
public
```
```java
static
```
```java
boolean
```
```java
deleteFileFtp(String filePath, String fileName){
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
connectFTP();
```
```java
```
```java
filePath
 = remoteFilePath + Constants.FILE_SEPARATOR + filePath + Constants.FILE_SEPARATOR;
```
```java
```
```java
if
```
```java
(!isDirExist(filePath.replace(
```
```java
"\\"
```
```java
,
```
```java
"/"
```
```java
)))
 {
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
```
```java
ftpClient.changeDirectory(filePath.replace(
```
```java
"\\"
```
```java
,
```
```java
"/"
```
```java
));
```
```java
```
```java
ftpClient.deleteFile(fileName);
```
```java
```
```java
return
```
```java
true
```
```java
;
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception
 e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
finally
```
```java
{
```
```java
```
```java
closeFTP();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 检查文件夹是否存在
```
```java
```
```java
*
```
```java
```
```java
*
 @param dir
```
```java
```
```java
*
 @param ftpClient
```
```java
```
```java
*
 @return
```
```java
```
```java
*/
```
```java
```
```java
private
```
```java
static
```
```java
Boolean isDirExist(String dir) {
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
ftpClient.changeDirectory(dir);
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception
 e) {
```
```java
```
```java
return
```
```java
false
```
```java
;
```
```java
```
```java
}
```
```java
```
```java
return
```
```java
true
```
```java
;
```
```java
```
```java
}
```
```java
```
```java
/**
```
```java
```
```java
*
 创建文件夹
```
```java
```
```java
*
```
```java
```
```java
*
 @param dir
```
```java
```
```java
*
 @param ftpClient
```
```java
```
```java
*
 @throws Exception
```
```java
```
```java
*/
```
```java
```
```java
private
```
```java
static
```
```java
void
```
```java
createDir(String dir)
```
```java
throws
```
```java
Exception
 {
```
```java
```
```java
ftpClient.setAsciiType();
```
```java
```
```java
StringTokenizer
 s =
```
```java
new
```
```java
StringTokenizer(dir,
```
```java
"/"
```
```java
);
```
```java
//
 sign
```
```java
```
```java
s.countTokens();
```
```java
```
```java
String
 pathName =
```
```java
""
```
```java
;
```
```java
```
```java
while
```
```java
(s.hasMoreElements())
 {
```
```java
```
```java
pathName
 = pathName +
```
```java
"/"
```
```java
+
 (String) s.nextElement();
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
ftpClient.makeDirectory(pathName);
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception
 e) {
```
```java
```
```java
e
 =
```
```java
null
```
```java
;
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
ftpClient.setBinaryType();
```
```java
```
```java
}
```
```java
}
```
### 2. [代码]常量类，系统的路径分隔符     [](http://www.oschina.net/code/snippet_1476308_37588#55413)[](http://www.oschina.net/code/snippet_1476308_37588#55414)[](http://www.oschina.net/code/snippet_1476308_37588#55421)[](http://www.oschina.net/code/piece_full?code=37588&piece=55414#55414)
[?](http://www.oschina.net/code/snippet_1476308_37588#)
```
```java
package
```
```java
com.itv.launcher.util;
```
```java
public
```
```java
interface
```
```java
Constants {
```
```java
```
```java
```
```java
//路径分隔符
```
```java
```
```java
public
```
```java
static
```
```java
String FILE_SEPARATOR = System.getProperty(
```
```java
"file.separator"
```
```java
);
```
```java
}
```
```
### 3. [代码]FTP链接的配置properties文件，包括用户名密码一些信息     [](http://www.oschina.net/code/snippet_1476308_37588#55413)[](http://www.oschina.net/code/snippet_1476308_37588#55414)[](http://www.oschina.net/code/snippet_1476308_37588#55421)[](http://www.oschina.net/code/piece_full?code=37588&piece=55421#55421)
[?](http://www.oschina.net/code/snippet_1476308_37588#)
```
```java
#FTP的IP地址
```
```java
FTP_URL=
```
```java
127.0
```
```java
.
```
```java
0.1
```
```java
#FTP端口号
```
```java
FTP_PORT=
```
```java
1234
```
```java
#用户名
```
```java
FTP_USER=yanzhou
```
```java
#密码
```
```java
FTP_PASSWORD=abcdefg12345
```
```java
#FTP账号目录
```
```java
FTP_REMOTE_FILEPATH=
```
```
