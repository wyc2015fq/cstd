# HTTPClient4.3的典型小例子 - z69183787的专栏 - CSDN博客
2015年09月11日 15:22:54[OkidoGreen](https://me.csdn.net/z69183787)阅读数：1802
 三个简单的HTTPClient4.3小例子
写三个httpclient的小例子，希望对刚开始学习httpclient的小伙伴们有一个参考↖(^ω^)↗
     1、简单的获取一个HTML页面的内容
[?](http://my.oschina.net/v5871314/blog/204812#)
```
```java
public
```
```java
void
```
```java
getHTML()
```
```java
throws
```
```java
Exception {
```
```java
```
```java
CloseableHttpClient httpclient = HttpClients.createDefault();
```
```java
```
```java
HttpGet httpget =
```
```java
new
```
```java
HttpGet(
```
```java
"http://www.baidu.com/"
```
```java
);
```
```java
```
```java
HttpResponse response = httpclient.execute(httpget);
```
```java
```
```java
HttpEntity entity = response.getEntity();
```
```java
```
```java
String html = EntityUtils.toString(entity);
```
```java
```
```java
httpclient.close();
```
```java
```
```java
}
```
```
    2、下载一个图片到本地
[?](http://my.oschina.net/v5871314/blog/204812#)
```
```java
```
```java
public
```
```java
class
```
```java
DownloadFile {
```
```java
```
```java
public
```
```java
static
```
```java
void
```
```java
main(String[] args)
```
```java
throws
```
```java
Exception {
```
```java
```
```java
//图片的网址
```
```java
```
```java
String url =
```
```java
"http://ww2.sinaimg.cn/large/9d57a855jw1dqpv9fp4yuj.jpg"
```
```java
;
```
```java
```
```java
```
```java
String destfilename =
```
```java
"D:\\TDDOWNLOAD\\cat.jpg"
```
```java
;
```
```java
```
```java
//生成一个httpclient对象
```
```java
```
```java
CloseableHttpClient httpclient = HttpClients.createDefault();
```
```java
```
```java
```
```java
HttpGet httpget =
```
```java
new
```
```java
HttpGet(url);
```
```java
```
```java
HttpResponse response = httpclient.execute(httpget);
```
```java
```
```java
HttpEntity entity = response.getEntity();
```
```java
```
```java
InputStream in = entity.getContent();
```
```java
```
```java
File file =
```
```java
new
```
```java
File(destfilename);
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
FileOutputStream fout =
```
```java
new
```
```java
FileOutputStream(file);
```
```java
```
```java
int
```
```java
l = -
```
```java
1
```
```java
;
```
```java
```
```java
byte
```
```java
[] tmp =
```
```java
new
```
```java
byte
```
```java
[
```
```java
1024
```
```java
];
```
```java
```
```java
while
```
```java
((l = in.read(tmp)) != -
```
```java
1
```
```java
) {
```
```java
```
```java
fout.write(tmp,
```
```java
0
```
```java
,l);
```
```java
```
```java
//注意这里如果用OutputStream.write(buff)的话，图片会失真，大家可以试试
```
```java
```
```java
}
```
```java
```
```java
fout.flush();
```
```java
```
```java
fout.close();
```
```java
```
```java
}
```
```java
finally
```
```java
{
```
```java
```
```java
// 关闭低层流。
```
```java
```
```java
in.close();
```
```java
```
```java
}
```
```java
```
```java
httpclient.close();
```
```java
```
```java
}
```
```java
```
```java
}
```
```
3.post模拟人人网登陆
[?](http://my.oschina.net/v5871314/blog/204812#)
```
```java
```
```java
import
```
```java
java.io.IOException;
```
```java
```
```java
import
```
```java
java.util.ArrayList;
```
```java
```
```java
import
```
```java
java.util.List;
```
```java
```
```java
import
```
```java
java.util.Scanner;
```
```java
```
```java
```
```java
import
```
```java
org.apache.http.Header;
```
```java
```
```java
import
```
```java
org.apache.http.HttpResponse;
```
```java
```
```java
import
```
```java
org.apache.http.NameValuePair;
```
```java
```
```java
import
```
```java
org.apache.http.client.ClientProtocolException;
```
```java
```
```java
import
```
```java
org.apache.http.client.entity.UrlEncodedFormEntity;
```
```java
```
```java
import
```
```java
org.apache.http.client.methods.HttpGet;
```
```java
```
```java
import
```
```java
org.apache.http.client.methods.HttpPost;
```
```java
```
```java
import
```
```java
org.apache.http.impl.client.CloseableHttpClient;
```
```java
```
```java
import
```
```java
org.apache.http.impl.client.HttpClients;
```
```java
```
```java
import
```
```java
org.apache.http.message.BasicNameValuePair;
```
```java
```
```java
import
```
```java
org.apache.http.util.EntityUtils;
```
```java
```
```java
```
```java
public
```
```java
class
```
```java
LoginRR {
```
```java
```
```java
private
```
```java
CloseableHttpClient httpclient;
```
```java
```
```java
private
```
```java
HttpPost httppost;
```
```java
//用于提交登陆数据
```
```java
```
```java
private
```
```java
HttpGet httpget;
```
```java
//用于获得登录后的页面
```
```java
```
```java
private
```
```java
String login_success;
```
```java
//用于构造上面的HttpGet
```
```java
```
```java
```
```java
public
```
```java
LoginRR()
```
```java
```
```java
{
```
```java
```
```java
httpclient = HttpClients.createDefault();
```
```java
```
```java
//人人的登陆界面网址
```
```java
```
```java
httppost =
```
```java
new
```
```java
HttpPost(
```
```java
"http://www.renren.com/PLogin.do"
```
```java
);
```
```java
```
```java
}
```
```java
```
```java
```
```java
public
```
```java
void
```
```java
logIn(String name, String password)
```
```java
throws
```
```java
Exception
```
```java
```
```java
{
```
```java
```
```java
//打包将要传入的参数
```
```java
```
```java
List<NameValuePair> params =
```
```java
new
```
```java
ArrayList<NameValuePair>();
```
```java
```
```java
params.add(
```
```java
new
```
```java
BasicNameValuePair(
```
```java
"email"
```
```java
, name));
```
```java
```
```java
params.add(
```
```java
new
```
```java
BasicNameValuePair(
```
```java
"password"
```
```java
,password));
```
```java
```
```java
httppost.setEntity(
```
```java
new
```
```java
UrlEncodedFormEntity(params));
```
```java
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
//提交登录数据
```
```java
```
```java
HttpResponse re = httpclient.execute(httppost);
```
```java
```
```java
//获得跳转的网址
```
```java
```
```java
Header locationHeader = re.getFirstHeader(
```
```java
"Location"
```
```java
);
```
```java
```
```java
//登陆不成功
```
```java
```
```java
if
```
```java
(locationHeader ==
```
```java
null
```
```java
)
```
```java
```
```java
{
```
```java
```
```java
System.out.println(
```
```java
"登陆不成功，请稍后再试!"
```
```java
);
```
```java
```
```java
return
```
```java
;
```
```java
```
```java
}
```
```java
```
```java
else
```
```java
//成功
```
```java
```
```java
{
```
```java
```
```java
login_success=locationHeader.getValue();
```
```java
//获取登陆成功之后跳转链接
```
```java
```
```java
System.out.println(
```
```java
"成功之后跳转到的网页网址："
```
```java
+login_success);
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
catch
```
```java
(ClientProtocolException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
```
```java
public
```
```java
void
```
```java
PrintText()
```
```java
throws
```
```java
IOException
```
```java
```
```java
{
```
```java
```
```java
httpget =
```
```java
new
```
```java
HttpGet(login_success);
```
```java
```
```java
HttpResponse re2 =
```
```java
null
```
```java
;
```
```java
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
re2 = httpclient.execute(httpget);
```
```java
```
```java
//输出登录成功后的页面
```
```java
```
```java
String  str=EntityUtils.toString(re2.getEntity());
```
```java
```
```java
System.out.println(str);
```
```java
```
```java
}
```
```java
catch
```
```java
(ClientProtocolException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
catch
```
```java
(IOException e) {
```
```java
```
```java
// TODO Auto-generated catch block
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
finally
```
```java
```
```java
{
```
```java
```
```java
httppost.abort();
```
```java
```
```java
httpget.abort();
```
```java
```
```java
httpclient.close();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
```
```java
public
```
```java
static
```
```java
void
```
```java
main(String[] args)
```
```java
throws
```
```java
Exception
```
```java
```
```java
{
```
```java
```
```java
String name =
```
```java
"username"
```
```java
, password =
```
```java
"password "
```
```java
;
```
```java
```
```java
//自己的账号，口令
```
```java
```
```java
LoginRR lr =
```
```java
new
```
```java
LoginRR();
```
```java
```
```java
lr.logIn(name, password);
```
```java
```
```java
lr.PrintText();
```
```java
```
```java
}
```
```java
```
```java
}
```
```

