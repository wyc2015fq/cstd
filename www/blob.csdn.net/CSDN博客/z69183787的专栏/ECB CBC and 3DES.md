# ECB CBC and 3DES - z69183787的专栏 - CSDN博客
2015年11月23日 14:34:27[OkidoGreen](https://me.csdn.net/z69183787)阅读数：959
个人分类：[工具-加解密](https://blog.csdn.net/z69183787/article/category/5974293)

从上一篇《DES 算法详述》文章中，已经知道了DES算法的详细过程，但上一篇文章主要解决的是一个八字节数据DES加密的问题，这一篇文章要解决数据加密——数据补位的问题、DES算法的两种模式ECB和CBC问题以及更加安全的算法——3DES算法。
一、数据补位
DES数据加解密就是将数据按照8个字节一段进行DES加密或解密得到一段8个字节的密文或者明文，最后一段不足8个字节，按照需求补足8个字节（通常补00或者FF，根据实际要求不同）进行计算，之后按照顺序将计算所得的数据连在一起即可。
这里有个问题就是为什么要进行数据补位？主要原因是DES算法加解密时要求数据必须为8个字节。
二、ECB模式
DES ECB（电子密本方式）其实非常简单，就是将数据按照8个字节一段进行DES加密或解密得到一段8个字节的密文或者明文，最后一段不足8个字节，按照需求补足8个字节进行计算，之后按照顺序将计算所得的数据连在一起即可，各段数据之间互不影响。
三、CBC模式
DES CBC（密文分组链接方式）有点麻烦，它的实现机制使加密的各段数据之间有了联系。其实现的机理如下：
加密步骤如下：
1）首先将数据按照8个字节一组进行分组得到D1D2......Dn（若数据不是8的整数倍，用指定的PADDING数据补位）
2）第一组数据D1与**初始化向量I*异或***后的结果进行DES加密得到第一组密文C1（初始化向量I为全零）
3）第二组数据D2与第一组的加密结果C1***异或***以后的结果进行DES加密，得到第二组密文C2
4）之后的数据以此类推，得到Cn
5）按顺序连为C1C2C3......Cn即为加密结果。
解密是加密的逆过程，步骤如下：
1）首先将数据按照8个字节一组进行分组得到C1C2C3......Cn
2）将第一组数据进行**解密后与初始化向量I进行*异或***得到第一组明文D1（注意：一定是先解密再异或）
3）将第二组数据C2进行**解密后与第一组密文数据进行*异或***得到第二组数据D2
4）之后依此类推，得到Dn
5）按顺序连为D1D2D3......Dn即为解密结果。
这里注意一点，解密的结果并不一定是我们原来的加密数据，可能还含有你补得位，一定要把补位去掉才是你的原来的数据。
四、3DES 算法
3DES算法顾名思义就是3次DES算法，其算法原理如下：
设Ek()和Dk()代表DES算法的加密和解密过程，K代表DES算法使用的密钥，P代表明文，C代表密表，这样，
      3DES加密过程为：C=Ek3(Dk2(Ek1(P))) 
      3DES解密过程为：P=Dk1((EK2(Dk3(C)))
这里可以K1=K3，但不能K1=K2=K3（如果相等的话就成了DES算法了）
3DES with 2 diffrent keys（K1=K3），可以是3DES-CBC，也可以是3DES-ECB，3DES-CBC整个算法的流程和DES-CBC一样，但是在原来的加密或者解密处增加了异或运算的步骤，使用的**密钥是16字节长度的密钥**，将密钥分成左8字节和右8字节的两部分，即k1=左8字节，k2=右8字节，然后进行加密运算和解密运算。
3DES with 3 different keys，和3DES-CBC的流程完全一样，**只是使用的密钥是24字节的**，但在每个加密解密加密时候用的密钥不一样，将密钥分为3段8字节的密钥分别为密钥1、密钥2、密钥3，在3DES加密时对加密解密加密依次使用密钥1、密钥2、密钥3，在3DES解密时对解密加密解密依次使用密钥3、密钥2、密钥1。
