# oracle 查询当前占用cpu及时间最长的sql语句 - z69183787的专栏 - CSDN博客
2014年07月23日 12:13:51[OkidoGreen](https://me.csdn.net/z69183787)阅读数：7012
SELECT
A.USERNAME, A.COMMAND, A.STATUS,
A.PROGRAM, A.MACHINE, A.CLIENT_IDENTIFIER,
B.SQL_TEXT,
B.CPU_TIME,
B.SHARABLE_MEM,
ROUND((B.DISK_READS + B.BUFFER_GETS)/B.EXECUTIONS)
AS RESOURCE_COST
FROM
V$SESSION A,
V$SQLSTATS B
WHERE
A.SQL_ID = B.SQL_ID
AND B.EXECUTIONS >0
AND A.WAIT_CLASS <> 'Idle'
ORDER BY
RESOURCE_COST DESC;
