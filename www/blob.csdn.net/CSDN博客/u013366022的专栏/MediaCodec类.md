# MediaCodec类 - u013366022的专栏 - CSDN博客
2014年05月14日 15:29:20[slitaz](https://me.csdn.net/u013366022)阅读数：1225
# 媒体编解码器
MediaCodec类是用来为低级别的媒体编码和解码的媒体编解码器提供访问。您可以实例化一个MediaCodec类通过调用createEncoderByType()方法来进行对媒体文件进行编码或者调用createDecoderByType()来对媒体文件进行解码。每一个方法都要采取一个MIME类型为你想要编码或者解码的媒体文件类型，例如“video/3gpp”或者“audio/vorbis”。
在MediaCodec实例创建之后，你可以调用configure()方法来指定例如媒体格式或者是否对内容加密的属性。
无论你是对你的媒体文件进行编码还是解码，在你创建MediaCodec实例后的其余进程都是一样的。首先通过getInputBuffers()的方法获得输入ByteBuffer对象的一个数组然后再通过getOutputBuffers()方法来获得一个输出的ByteBuffer的对象数组。
当你准备好进行编码或者解码的时候，调用dequeueInputBuffer()方法来获得这个用来作为媒体文件源码的ByteBuffer（从输入的buffers的数组中）的索引位置。在你使用带有媒体文件源码的ByteBuffer之后，通过调用queueInputBuffer()方法来释放缓存区的所有权。
对输出缓存区也是一样的，调用dequeueOutputBuffer()方法来获得你接收到结果的ByteBuffer的索引位置。在你从ByteBuffer读出输出之后，通过调用releaseOutputBuffer()方法来释放所有权。
你可以结合MediaCrypto APIs，而不是正常的queueInputBuffer()方法，通过调用queueSecureInputBuffer()的方法来处理媒体媒体编解码器的加密数据。
想要了解更多关于如何使用编解码器的信息，参见MediaCodec文档。
# 自定义录音
新方法startRecording()允许你可以在MediaSyncEvent的定义提示下的基础上开始录音。这个MediaSyncEvent指定一个当完成时就能自发触动录音机开始录音的音频对话（例如一个被MediaPlayer所定义的对话）。例如，您可以使用这个功能播放提示音来表示一段录音会话的开始，然后这个录音就自动开始，所以你没不必手动同步提示音和录音开始的操作。
# 定时文本轨道
MediaPlayer这个类现在可以处理带内和带外的文本轨道。带内文本轨道就是一个MP4或3GPP的媒体源的文本轨道。带外文本轨道可以通过addTimedTextSource()这个方法来本当作一个外部的文本进行添加。在所有的外部文本轨道添加之后，调用getTrackInfo()方法来对数据源中所有的可用的轨迹的列表进行刷新。
如果要用MediaPlayer这个类来设置轨道，你必须调用selectTrack()这个方法选择你想要设置的轨道的索引位置。
当得知到这个文本轨道准备开始时，实现MediaPlayer.OnTimedTextListener这个接口并且把它传到setOnTimedTextListener()方法中去。
# 音频效果
AudioEffect这个类现在支持当捕获到音频时额外的的音频预处理类型：
作为声学回声消除器（AEC）的AcousticEchoCanceler这个类消除了从远程捕捉到音频信号上的信号的作用。
作为自动增益控制（AGC）的AutomaticGainControl这个类自动恢复正常捕获的信号输出。
作为噪声抑制器的（NS）的NoiseSuppressor这个类可以消除被捕获信号的背景噪音。
您可以应用这些利用AudioEffect一个子类的AudioRecord类上的音频捕获预处理效果。
注意:并不能保证所有的设备都能支持这些效果的，所以你应该首先调用在对应音频效果类上的isAvailable()的方法来检测它的可用性。
# 无缝播放
现在您可以在两个完全独立的MediaPlayer类上执行无缝播放。在您第一个MediaPlayer类执行结束前的任何时间调用setNextMediaPlayer()这个方法，然后Android系统将会在您第一个停止的时候紧接着播放第二个文件。
媒体路由器。这个新的APIs MediaRouter，MediaRouteActionProvider和MediaRouteButton为您在播放文件的地方提供标准的机制和界面供您选择。
