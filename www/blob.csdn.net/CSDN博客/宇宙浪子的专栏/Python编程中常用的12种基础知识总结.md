# Python编程中常用的12种基础知识总结 - 宇宙浪子的专栏 - CSDN博客
2014年09月05日 15:33:16[_宇宙浪子_](https://me.csdn.net/bluehawksky)阅读数：541标签：[Python](https://so.csdn.net/so/search/s.do?q=Python&t=blog)
个人分类：[Python](https://blog.csdn.net/bluehawksky/article/category/2542577)
原文出处： [王伟的博客](http://wangwei007.blog.51cto.com/68019/1131610/)
Python编程中常用的12种基础知识总结：正则表达式替换，遍历目录方法，列表按列排序、去重，字典排序，字典、列表、字符串互转，时间对象操作，命令行参数解析(getopt)，print 格式化输出，进制转换，Python调用系统命令或者脚本，Python 读写文件。
1、正则表达式替换
目标: 将字符串line中的 overview.gif 替换成其他字符串
```
```python
>>>
 line
```
```python
=
```
```python
'<IMG
 ALIGN="middle" SRC=\'#\'
```
```python
"
```
```python
/
```
```python
span>
```
```python
>>>
 mo
```
```python
=
```
```python
re.
```
```python
compile
```
```python
(r
```
```python
'(?<=SRC=)"([\w+\.]+)"'
```
```python
,re.I)
```
```python
>>>
 mo.sub(r
```
```python
'"\1****"'
```
```python
,line)
```
```python
'<IMG
 ALIGN="middle" SRC=\'#\'
```
```python
"
```
```python
/
```
```python
span>
```
```python
>>>
 mo.sub(r
```
```python
'replace_str_\1'
```
```python
,line)
```
```python
'<IMG
 ALIGN="middle" replace_str_overview.gif BORDER="0" ALT="">'
```
```python
<
```
```python
/
```
```python
span>
```
```python
>>>
 mo.sub(r
```
```python
'"testetstset"'
```
```python
,line)
```
```python
'<IMG
 ALIGN="middle" SRC=\'#\'
```
```python
"
```
```python
/
```
```python
span>
```
```
注意: 其中 \1 是匹配到的数据，可以通过这样的方式直接引用
2、遍历目录方法
在某些时候，我们需要遍历某个目录找出特定的文件列表，可以通过os.walk方法来遍历，非常方便
```
```python
import
```
```python
os
```
```python
fileList
```
```python
=
```
```python
[]
```
```python
rootdir
```
```python
=
```
```python
"/data"
```
```python
for
```
```python
root,
 subFolders, files
```
```python
in
```
```python
os.walk(rootdir):
```
```python
if
```
```python
'.svn'
```
```python
in
```
```python
subFolders: subFolders.remove(
```
```python
'.svn'
```
```python
)
```
```python
#
 排除特定目录
```
```python
for
```
```python
file
```
```python
in
```
```python
files:
```
```python
```
```python
if
```
```python
file
```
```python
.find(
```
```python
".t2t"
```
```python
)
 !
```
```python
=
```
```python
-
```
```python
1
```
```python
:
```
```python
#
 查找特定扩展名的文件
```
```python
```
```python
file_dir_path
```
```python
=
```
```python
os.path.join(root,
```
```python
file
```
```python
)
```
```python
```
```python
fileList.append(file_dir_path)
```
```python
print
```
```python
fileList
```
```
3、列表按列排序(list sort)
如果列表的每个元素都是一个元组(tuple),我们要根据元组的某列来排序的化，可参考如下方法
下面例子我们是根据元组的第2列和第3列数据来排序的,而且是倒序(reverse=True)
```
```python
>>>
 a
```
```python
=
```
```python
[(
```
```python
'2011-03-17'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
6429600
```
```python
,
```
```python
'0.0'
```
```python
),
 (
```
```python
'2011-03-16'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
12036900
```
```python
,
```
```python
'-3.0'
```
```python
),
```
```python
```
```python
(
```
```python
'2011-03-15'
```
```python
,
```
```python
'2.33'
```
```python
,
```
```python
15615500
```
```python
,
```
```python
'-19.1'
```
```python
)]
```
```python
>>>
```
```python
print
```
```python
a[
```
```python
0
```
```python
][
```
```python
0
```
```python
]
```
```python
2011
```
```python
-
```
```python
03
```
```python
-
```
```python
17
```
```python
>>>
 b
```
```python
=
```
```python
sorted
```
```python
(a,
 key
```
```python
=
```
```python
lambda
```
```python
result:
 result[
```
```python
1
```
```python
],reverse
```
```python
=
```
```python
True
```
```python
)
```
```python
>>>
```
```python
print
```
```python
b
```
```python
[(
```
```python
'2011-03-15'
```
```python
,
```
```python
'2.33'
```
```python
,
```
```python
15615500
```
```python
,
```
```python
'-19.1'
```
```python
),
 (
```
```python
'2011-03-17'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
6429600
```
```python
,
```
```python
'0.0'
```
```python
),
```
```python
(
```
```python
'2011-03-16'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
12036900
```
```python
,
```
```python
'-3.0'
```
```python
)]
```
```python
>>>
 c
```
```python
=
```
```python
sorted
```
```python
(a,
 key
```
```python
=
```
```python
lambda
```
```python
result:
 result[
```
```python
2
```
```python
],reverse
```
```python
=
```
```python
True
```
```python
)
```
```python
>>>
```
```python
print
```
```python
c
```
```python
[(
```
```python
'2011-03-15'
```
```python
,
```
```python
'2.33'
```
```python
,
```
```python
15615500
```
```python
,
```
```python
'-19.1'
```
```python
),
 (
```
```python
'2011-03-16'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
12036900
```
```python
,
```
```python
'-3.0'
```
```python
),
```
```python
(
```
```python
'2011-03-17'
```
```python
,
```
```python
'2.26'
```
```python
,
```
```python
6429600
```
```python
,
```
```python
'0.0'
```
```python
)]
```
```
4、列表去重(list uniq)
有时候需要将list中重复的元素删除，就要使用如下方法
```
```python
>>>
 lst
```
```python
=
```
```python
[(
```
```python
1
```
```python
,
```
```python
'sss'
```
```python
),(
```
```python
2
```
```python
,
```
```python
'fsdf'
```
```python
),(
```
```python
1
```
```python
,
```
```python
'sss'
```
```python
),(
```
```python
3
```
```python
,
```
```python
'fd'
```
```python
)]
```
```python
>>>
```
```python
set
```
```python
(lst)
```
```python
set
```
```python
([(
```
```python
2
```
```python
,
```
```python
'fsdf'
```
```python
),
 (
```
```python
3
```
```python
,
```
```python
'fd'
```
```python
),
 (
```
```python
1
```
```python
,
```
```python
'sss'
```
```python
)])
```
```python
>>>
```
```python
>>>
 lst
```
```python
=
```
```python
[
```
```python
1
```
```python
,
```
```python
1
```
```python
,
```
```python
3
```
```python
,
```
```python
4
```
```python
,
```
```python
4
```
```python
,
```
```python
5
```
```python
,
```
```python
6
```
```python
,
```
```python
7
```
```python
,
```
```python
6
```
```python
]
```
```python
>>>
```
```python
set
```
```python
(lst)
```
```python
set
```
```python
([
```
```python
1
```
```python
,
```
```python
3
```
```python
,
```
```python
4
```
```python
,
```
```python
5
```
```python
,
```
```python
6
```
```python
,
```
```python
7
```
```python
])
```
```
5、字典排序(dict sort)
一般来说，我们都是根据字典的key来进行排序，但是我们如果想根据字典的value值来排序，就使用如下方法
```
```python
>>>
```
```python
from
```
```python
operator
```
```python
import
```
```python
itemgetter
```
```python
>>>
 aa
```
```python
=
```
```python
{
```
```python
"a"
```
```python
:
```
```python
"1"
```
```python
,
```
```python
"sss"
```
```python
:
```
```python
"2"
```
```python
,
```
```python
"ffdf"
```
```python
:
```
```python
'5'
```
```python
,
```
```python
"ffff2"
```
```python
:
```
```python
'3'
```
```python
}
```
```python
>>>
 sort_aa
```
```python
=
```
```python
sorted
```
```python
(aa.items(),key
```
```python
=
```
```python
itemgetter(
```
```python
1
```
```python
))
```
```python
>>>
 sort_aa
```
```python
[(
```
```python
'a'
```
```python
,
```
```python
'1'
```
```python
),
 (
```
```python
'sss'
```
```python
,
```
```python
'2'
```
```python
),
 (
```
```python
'ffff2'
```
```python
,
```
```python
'3'
```
```python
),
 (
```
```python
'ffdf'
```
```python
,
```
```python
'5'
```
```python
)]
```
```
从上面的运行结果看到，按照字典的value值进行排序的
6、字典,列表,字符串互转
以下是生成数据库连接字符串,从字典转换到字符串
```
```python
>>>
 params
```
```python
=
```
```python
{
```
```python
"server"
```
```python
:
```
```python
"mpilgrim"
```
```python
,
```
```python
"database"
```
```python
:
```
```python
"master"
```
```python
,
```
```python
"uid"
```
```python
:
```
```python
"sa"
```
```python
,
```
```python
"pwd"
```
```python
:
```
```python
"secret"
```
```python
}
```
```python
>>>
 [
```
```python
"%s=%s"
```
```python
%
```
```python
(k, v)
```
```python
for
```
```python
k,
 v
```
```python
in
```
```python
params.items()]
```
```python
[
```
```python
'server=mpilgrim'
```
```python
,
```
```python
'uid=sa'
```
```python
,
```
```python
'database=master'
```
```python
,
```
```python
'pwd=secret'
```
```python
]
```
```python
>>>
```
```python
";"
```
```python
.join([
```
```python
"%s=%s"
```
```python
%
```
```python
(k, v)
```
```python
for
```
```python
k,
 v
```
```python
in
```
```python
params.items()])
```
```python
'server=mpilgrim;uid=sa;database=master;pwd=secret'
```
```
下面的例子 是将字符串转化为字典
```
```python
>>>
 a
```
```python
=
```
```python
'server=mpilgrim;uid=sa;database=master;pwd=secret'
```
```python
>>>
 aa
```
```python
=
```
```python
{}
```
```python
>>>
```
```python
for
```
```python
i
```
```python
in
```
```python
a.split(
```
```python
';'
```
```python
):aa[i.split(
```
```python
'='
```
```python
,
```
```python
1
```
```python
)[
```
```python
0
```
```python
]]
```
```python
=
```
```python
i.split(
```
```python
'='
```
```python
,
```
```python
1
```
```python
)[
```
```python
1
```
```python
]
```
```python
...
```
```python
>>>
 aa
```
```python
{
```
```python
'pwd'
```
```python
:
```
```python
'secret'
```
```python
,
```
```python
'database'
```
```python
:
```
```python
'master'
```
```python
,
```
```python
'uid'
```
```python
:
```
```python
'sa'
```
```python
,
```
```python
'server'
```
```python
:
```
```python
'mpilgrim'
```
```python
}
```
```
7、时间对象操作
```
```python
将时间对象转换成字符串
```
```python
>>>
```
```python
import
```
```python
datetime
```
```python
>>>
 datetime.datetime.now().strftime(
```
```python
"%Y-%m-%d
 %H:%M"
```
```python
)
```
```python
```
```python
'2011-01-20
 14:05'
```
```python
时间大小比较
```
```python
>>>
```
```python
import
```
```python
time
```
```python
>>>
 t1
```
```python
=
```
```python
time.strptime(
```
```python
'2011-01-20
 14:05'
```
```python
,
```
```python
"%Y-%m-%d
 %H:%M"
```
```python
)
```
```python
>>>
 t2
```
```python
=
```
```python
time.strptime(
```
```python
'2011-01-20
 16:05'
```
```python
,
```
```python
"%Y-%m-%d
 %H:%M"
```
```python
)
```
```python
>>>
 t1 > t2
```
```python
```
```python
False
```
```python
>>>
 t1 < t2
```
```python
```
```python
True
```
```python
时间差值计算,计算
```
```python
8
```
```python
小时前的时间
```
```python
>>>
 datetime.datetime.now().strftime(
```
```python
"%Y-%m-%d
 %H:%M"
```
```python
)
```
```python
```
```python
'2011-01-20
 15:02'
```
```python
>>>
 (datetime.datetime.now()
```
```python
-
```
```python
datetime.timedelta(hours
```
```python
=
```
```python
8
```
```python
)).strftime(
```
```python
"%Y-%m-%d
 %H:%M"
```
```python
)
```
```python
```
```python
'2011-01-20
 07:03'
```
```python
将字符串转换成时间对象
```
```python
>>>
 endtime
```
```python
=
```
```python
datetime.datetime.strptime(
```
```python
'20100701'
```
```python
,
```
```python
"%Y%m%d"
```
```python
)
```
```python
>>>
```
```python
type
```
```python
(endtime)
```
```python
```
```python
<
```
```python
type
```
```python
'datetime.datetime'
```
```python
>
```
```python
>>>
```
```python
print
```
```python
endtime
```
```python
```
```python
2010
```
```python
-
```
```python
07
```
```python
-
```
```python
01
```
```python
00
```
```python
:
```
```python
00
```
```python
:
```
```python
00
```
```python
将从
```
```python
1970
```
```python
-
```
```python
01
```
```python
-
```
```python
01
```
```python
00
```
```python
:
```
```python
00
```
```python
:
```
```python
00
```
```python
UTC
 到现在的秒数，格式化输出
```
```python
>>>
```
```python
import
```
```python
time
```
```python
>>>
 a
```
```python
=
```
```python
1302153828
```
```python
>>>
 time.strftime(
```
```python
"%Y-%m-%d
 %H:%M:%S"
```
```python
,time.localtime(a))
```
```python
```
```python
'2011-04-07
 13:23:48'
```
```
8、命令行参数解析(getopt)
通常在编写一些日运维脚本时，需要根据不同的条件，输入不同的命令行选项来实现不同的功能 在Python中提供了getopt模块很好的实现了命令行参数的解析,下面距离说明。请看如下程序:
```
```python
#!/usr/bin/env
 python
```
```python
#
 -*- coding: utf-8 -*-
```
```python
import
```
```python
sys,os,getopt
```
```python
def
```
```python
usage():
```
```python
print
```
```python
'''''
```
```python
Usage:
 analyse_stock.py [options...]
```
```python
Options:
```
```python
-e
 : Exchange Name
```
```python
-c
 : User-Defined Category Name
```
```python
-f
 : Read stock info from file and save to db
```
```python
-d
 : delete from db by stock code
```
```python
-n
 : stock name
```
```python
-s
 : stock code
```
```python
-h
 : this help info
```
```python
test.py
 -s haha -n "HA Ha"
```
```python
'''
```
```python
try
```
```python
:
```
```python
opts,
 args
```
```python
=
```
```python
getopt.getopt(sys.argv[
```
```python
1
```
```python
:],
```
```python
'he:c:f:d:n:s:'
```
```python
)
```
```python
except
```
```python
getopt.GetoptError:
```
```python
usage()
```
```python
sys.exit()
```
```python
if
```
```python
len
```
```python
(opts)
```
```python
=
```
```python
=
```
```python
0
```
```python
:
```
```python
usage()
```
```python
sys.exit()
```
```python
for
```
```python
opt,
 arg
```
```python
in
```
```python
opts:
```
```python
if
```
```python
opt
```
```python
in
```
```python
(
```
```python
'-h'
```
```python
,
```
```python
'--help'
```
```python
):
```
```python
```
```python
usage()
```
```python
```
```python
sys.exit()
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-d'
```
```python
:
```
```python
```
```python
print
```
```python
"del
 stock %s"
```
```python
%
```
```python
arg
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-f'
```
```python
:
```
```python
```
```python
print
```
```python
"read
 file %s"
```
```python
%
```
```python
arg
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-c'
```
```python
:
```
```python
```
```python
print
```
```python
"user-defined
 %s "
```
```python
%
```
```python
arg
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-e'
```
```python
:
```
```python
```
```python
print
```
```python
"Exchange
 Name %s"
```
```python
%
```
```python
arg
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-s'
```
```python
:
```
```python
```
```python
print
```
```python
"Stock
 code %s"
```
```python
%
```
```python
arg
```
```python
elif
```
```python
opt
```
```python
=
```
```python
=
```
```python
'-n'
```
```python
:
```
```python
```
```python
print
```
```python
"Stock
 name %s"
```
```python
%
```
```python
arg
```
```python
sys.exit()
```
```
9、print 格式化输出
9.1、格式化输出字符串
```
```python
截取字符串输出,下面例子将只输出字符串的前
```
```python
3
```
```python
个字母
```
```python
>>>
```
```python
str
```
```python
=
```
```python
"abcdefg"
```
```python
>>>
```
```python
print
```
```python
"%.3s"
```
```python
%
```
```python
str
```
```python
```
```python
abc
```
```python
按固定宽度输出，不足使用空格补全,下面例子输出宽度为
```
```python
10
```
```python
>>>
```
```python
str
```
```python
=
```
```python
"abcdefg"
```
```python
>>>
```
```python
print
```
```python
"%10s"
```
```python
%
```
```python
str
```
```python
```
```python
abcdefg
```
```python
截取字符串，按照固定宽度输出
```
```python
>>>
```
```python
str
```
```python
=
```
```python
"abcdefg"
```
```python
>>>
```
```python
print
```
```python
"%10.3s"
```
```python
%
```
```python
str
```
```python
```
```python
abc
```
```python
浮点类型数据位数保留
```
```python
>>>
```
```python
import
```
```python
fpformat
```
```python
>>>
 a
```
```python
=
```
```python
0.0030000000005
```
```python
>>>
 b
```
```python
=
```
```python
fpformat.fix(a,
```
```python
6
```
```python
)
```
```python
>>>
```
```python
print
```
```python
b
```
```python
```
```python
0.003000
```
```python
对浮点数四舍五入,主要使用到
```
```python
round
```
```python
函数
```
```python
>>>
```
```python
from
```
```python
decimal
```
```python
import
```
```python
*
```
```python
>>>
 a
```
```python
=
```
```python
"2.26"
```
```python
>>>
 b
```
```python
=
```
```python
"2.29"
```
```python
>>>
 c
```
```python
=
```
```python
Decimal(a)
```
```python
-
```
```python
Decimal(b)
```
```python
>>>
```
```python
print
```
```python
c
```
```python
```
```python
-
```
```python
0.03
```
```python
>>>
 c
```
```python
/
```
```python
Decimal(a)
```
```python
*
```
```python
100
```
```python
```
```python
Decimal(
```
```python
'-1.327433628318584070796460177'
```
```python
)
```
```python
>>>
 Decimal(
```
```python
str
```
```python
(
```
```python
round
```
```python
(c
```
```python
/
```
```python
Decimal(a)
```
```python
*
```
```python
100
```
```python
,
```
```python
2
```
```python
)))
```
```python
```
```python
Decimal(
```
```python
'-1.33'
```
```python
)
```
```
9.2、进制转换
有些时候需要作不同进制转换，可以参考下面的例子(%x 十六进制,%d 十进制,%o 八进制)
```
```python
>>>
 num
```
```python
=
```
```python
10
```
```python
>>>
```
```python
print
```
```python
"Hex
 = %x,Dec = %d,Oct = %o"
```
```python
%
```
```python
(num,num,num)
```
```python
```
```python
Hex
```
```python
=
```
```python
a,Dec
```
```python
=
```
```python
10
```
```python
,
```
```python
Oct
```
```python
=
```
```python
12
```
```
10、Python调用系统命令或者脚本
```
```python
使用
 os.system() 调用系统命令 , 程序中无法获得到输出和返回值
```
```python
>>>
```
```python
import
```
```python
os
```
```python
>>>
 os.system(
```
```python
'ls
 -l /proc/cpuinfo'
```
```python
)
```
```python
>>>
 os.system(
```
```python
"ls
 -l /proc/cpuinfo"
```
```python
)
```
```python
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
1
```
```python
root root
```
```python
0
```
```python
3
```
```python
月
```
```python
29
```
```python
16
```
```python
:
```
```python
53
```
```python
/
```
```python
proc
```
```python
/
```
```python
cpuinfo
```
```python
```
```python
0
```
```python
使用
 os.popen() 调用系统命令, 程序中可以获得命令输出，但是不能得到执行的返回值
```
```python
>>>
 out
```
```python
=
```
```python
os.popen(
```
```python
"ls
 -l /proc/cpuinfo"
```
```python
)
```
```python
>>>
```
```python
print
```
```python
out.read()
```
```python
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
r
```
```python
-
```
```python
-
```
```python
1
```
```python
root root
```
```python
0
```
```python
3
```
```python
月
```
```python
29
```
```python
16
```
```python
:
```
```python
59
```
```python
/
```
```python
proc
```
```python
/
```
```python
cpuinfo
```
```python
使用
 commands.getstatusoutput() 调用系统命令, 程序中可以获得命令输出和执行的返回值
```
```python
>>>
```
```python
import
```
```python
commands
```
```python
>>>
 commands.getstatusoutput(
```
```python
'ls
 /bin/ls'
```
```python
)
```
```python
```
```python
(
```
```python
0
```
```python
,
```
```python
'/bin/ls'
```
```python
)
```
```
11、Python 捕获用户 Ctrl+C ,Ctrl+D 事件
有些时候，需要在程序中捕获用户键盘事件，比如ctrl+c退出，这样可以更好的安全退出程序
```
```python
try
```
```python
:
```
```python
```
```python
do_some_func()
```
```python
except
```
```python
KeyboardInterrupt:
```
```python
```
```python
print
```
```python
"User
 Press Ctrl+C,Exit"
```
```python
except
```
```python
EOFError:
```
```python
```
```python
print
```
```python
"User
 Press Ctrl+D,Exit"
```
```
12、Python 读写文件
```
```python
一次性读入文件到列表，速度较快，适用文件比较小的情况下
```
```python
track_file
```
```python
=
```
```python
"track_stock.conf"
```
```python
fd
```
```python
=
```
```python
open
```
```python
(track_file)
```
```python
content_list
```
```python
=
```
```python
fd.readlines()
```
```python
fd.close()
```
```python
for
```
```python
line
```
```python
in
```
```python
content_list:
```
```python
```
```python
print
```
```python
line
```
```python
逐行读入，速度较慢,适用没有足够内存读取整个文件(文件太大)
```
```python
fd
```
```python
=
```
```python
open
```
```python
(file_path)
```
```python
fd.seek(
```
```python
0
```
```python
)
```
```python
title
```
```python
=
```
```python
fd.readline()
```
```python
keyword
```
```python
=
```
```python
fd.readline()
```
```python
uuid
```
```python
=
```
```python
fd.readline()
```
```python
fd.close()
```
```python
写文件
 write 与 writelines 的区别
```
```python
Fd.write(
```
```python
str
```
```python
)
 : 把
```
```python
str
```
```python
写到文件中，write()并不会在
```
```python
str
```
```python
后加上一个换行符
```
```python
Fd.writelines(content)
 : 把content的内容全部写到文件中,原样写入，不会在每行后面加上任何东西
```
```
