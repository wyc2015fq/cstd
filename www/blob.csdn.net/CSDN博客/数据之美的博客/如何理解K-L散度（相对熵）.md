# å¦‚ä½•ç†è§£K-Læ•£åº¦ï¼ˆç›¸å¯¹ç†µï¼‰ - æ•°æ®ä¹‹ç¾çš„åšå®¢ - CSDNåšå®¢
2019å¹´03æœˆ14æ—¥ 13:50:05[çœ‹ç©¿æ•°æ®ä¹‹ç¾](https://me.csdn.net/oppo62258801)é˜…è¯»æ•°ï¼š55
è½¬è‡ªäºï¼š[https://www.jianshu.com/p/43318a3dc715?from=timeline&isappinstalled=0](https://www.jianshu.com/p/43318a3dc715?from=timeline&isappinstalled=0)ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»æˆ‘åˆ é™¤ã€‚
`Kullback-Leibler Divergence`ï¼Œå³`K-Læ•£åº¦`ï¼Œæ˜¯ä¸€ç§**é‡åŒ–ä¸¤ç§æ¦‚ç‡åˆ†å¸ƒPå’ŒQä¹‹é—´å·®å¼‚**çš„æ–¹å¼ï¼Œåˆå«`ç›¸å¯¹ç†µ`ã€‚åœ¨æ¦‚ç‡å­¦å’Œç»Ÿè®¡å­¦ä¸Šï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨ä¸€ç§`æ›´ç®€å•çš„ã€è¿‘ä¼¼çš„åˆ†å¸ƒ`æ¥æ›¿ä»£`è§‚å¯Ÿæ•°æ®`æˆ–`å¤ªå¤æ‚çš„åˆ†å¸ƒ`ã€‚K-Læ•£åº¦èƒ½å¸®åŠ©æˆ‘ä»¬åº¦é‡ä½¿ç”¨ä¸€ä¸ªåˆ†å¸ƒæ¥è¿‘ä¼¼å¦ä¸€ä¸ªåˆ†å¸ƒæ—¶æ‰€æŸå¤±çš„ä¿¡æ¯ã€‚
K-Læ•£åº¦å®šä¹‰è§æ–‡æœ«é™„å½•1ã€‚å¦å¤–åœ¨é™„å½•5ä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œè®­ç»ƒæ¨¡å‹æ—¶ä½¿ç”¨çš„æ˜¯`Cross Entropy` è€Œé`K-L Divergence`ã€‚
æˆ‘ä»¬ä»ä¸‹é¢è¿™ä¸ªé—®é¢˜å‡ºå‘æ€è€ƒK-Læ•£åº¦ã€‚
> 
å‡è®¾æˆ‘ä»¬æ˜¯ä¸€ç¾¤å¤ªç©ºç§‘å­¦å®¶ï¼Œç»è¿‡é¥è¿œçš„æ—…è¡Œï¼Œæ¥åˆ°äº†ä¸€é¢—æ–°å‘ç°çš„æ˜Ÿçƒã€‚åœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šï¼Œç”Ÿå­˜ç€ä¸€ç§é•¿æœ‰ç‰™é½¿çš„è •è™«ï¼Œå¼•èµ·äº†æˆ‘ä»¬çš„ç ”ç©¶å…´è¶£ã€‚æˆ‘ä»¬å‘ç°è¿™ç§è •è™«ç”Ÿæœ‰10é¢—ç‰™é½¿ï¼Œä½†æ˜¯å› ä¸ºä¸æ³¨æ„å£è…”å«ç”Ÿï¼Œåˆå–œæ¬¢åš¼ä¸œè¥¿ï¼Œè®¸å¤šè •è™«ä¼šæ‰ç‰™ã€‚æ”¶é›†å¤§é‡æ ·æœ¬ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°å…³äºè •è™«ç‰™é½¿æ•°é‡çš„ç»éªŒåˆ†å¸ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º
![](https://upload-images.jianshu.io/upload_images/75110-f1e63f2247d8a351.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
ç‰™é½¿æ•°é‡åˆ†å¸ƒ
![](https://upload-images.jianshu.io/upload_images/75110-a1671534d273e258.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400/format/webp)
ä¼šæ‰ç‰™çš„å¤–æ˜Ÿè •è™«
è¿™äº›æ•°æ®å¾ˆæœ‰ä»·å€¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰ç‚¹é—®é¢˜ã€‚æˆ‘ä»¬è·ç¦»åœ°çƒğŸŒå¤ªè¿œäº†ï¼ŒæŠŠè¿™äº›æ¦‚ç‡åˆ†å¸ƒæ•°æ®å‘é€å›åœ°çƒè¿‡äºæ˜‚è´µã€‚è¿˜å¥½æˆ‘ä»¬æ˜¯ä¸€ç¾¤èªæ˜çš„ç§‘å­¦å®¶ï¼Œç”¨ä¸€ä¸ªåªæœ‰ä¸€ä¸¤ä¸ªå‚æ•°çš„ç®€å•æ¨¡å‹æ¥è¿‘ä¼¼åŸå§‹æ•°æ®ä¼šå‡å°æ•°æ®ä¼ é€é‡ã€‚æœ€ç®€å•çš„è¿‘ä¼¼æ¨¡å‹æ˜¯`å‡åˆ†å¸ƒ`ï¼Œå› ä¸ºè •è™«ç‰™é½¿ä¸ä¼šè¶…è¿‡10é¢—ï¼Œæ‰€ä»¥æœ‰11ä¸ªå¯èƒ½å€¼ï¼Œé‚£è •è™«çš„ç‰™é½¿æ•°é‡æ¦‚ç‡éƒ½ä¸º `1/11`ã€‚åˆ†å¸ƒå›¾å¦‚ä¸‹ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-6f8844d5047fc1ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
uniform distribution
æ˜¾ç„¶æˆ‘ä»¬çš„åŸå§‹æ•°æ®å¹¶éå‡åˆ†å¸ƒçš„ï¼Œä½†ä¹Ÿä¸æ˜¯æˆ‘ä»¬å·²çŸ¥çš„åˆ†å¸ƒï¼Œè‡³å°‘ä¸æ˜¯å¸¸è§çš„åˆ†å¸ƒã€‚ä½œä¸ºå¤‡é€‰ï¼Œæˆ‘ä»¬æƒ³åˆ°çš„å¦ä¸€ç§ç®€å•æ¨¡å‹æ˜¯`äºŒé¡¹å¼åˆ†å¸ƒbinomial distribution`ã€‚è •è™«å˜´é‡Œé¢å…±æœ‰`n=10`ä¸ªç‰™æ§½ï¼Œæ¯ä¸ªç‰™æ§½å‡ºç°ç‰™é½¿ä¸å¦ä¸ºç‹¬ç«‹äº‹ä»¶ï¼Œä¸”æ¦‚ç‡å‡ä¸º`p`ã€‚åˆ™è •è™«ç‰™é½¿æ•°é‡å³ä¸ºæœŸæœ›å€¼`E[x]=n*p`ï¼ŒçœŸå®æœŸæœ›å€¼å³ä¸ºè§‚å¯Ÿæ•°æ®çš„å¹³å‡å€¼ï¼Œæ¯”å¦‚è¯´`5.7`ï¼Œåˆ™`p=0.57`ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„äºŒé¡¹å¼åˆ†å¸ƒï¼š
![](https://upload-images.jianshu.io/upload_images/75110-8ad3782fe0220619.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
binomial
å¯¹æ¯”ä¸€ä¸‹åŸå§‹æ•°æ®ï¼Œå¯ä»¥çœ‹å‡ºå‡åˆ†å¸ƒå’ŒäºŒé¡¹åˆ†å¸ƒéƒ½ä¸èƒ½å®Œå…¨æè¿°åŸå§‹åˆ†å¸ƒã€‚
![](https://upload-images.jianshu.io/upload_images/75110-b049f7fc560bd8d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
all distributions
å¯æ˜¯ï¼Œæˆ‘ä»¬ä¸ç¦è¦é—®ï¼Œå“ªä¸€ç§åˆ†å¸ƒæ›´åŠ æ¥è¿‘åŸå§‹åˆ†å¸ƒå‘¢ï¼Ÿ
å·²ç»æœ‰è®¸å¤šåº¦é‡è¯¯å·®çš„æ–¹å¼å­˜åœ¨ï¼Œä½†æ˜¯æˆ‘ä»¬æ‰€è¦è€ƒè™‘çš„æ˜¯å‡å°å‘é€çš„ä¿¡æ¯é‡ã€‚ä¸Šé¢è®¨è®ºçš„å‡åˆ†å¸ƒå’ŒäºŒé¡¹å¼åˆ†å¸ƒéƒ½æŠŠé—®é¢˜è§„çº¦åˆ°åªéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç‰™é½¿æ•°é‡å’Œæ¦‚ç‡å€¼ï¼ˆå‡åˆ†å¸ƒåªéœ€è¦ç‰™é½¿æ•°é‡å³å¯ï¼‰ã€‚é‚£ä¹ˆå“ªä¸ªåˆ†å¸ƒä¿ç•™äº†æ›´å¤šçš„åŸå§‹æ•°æ®åˆ†å¸ƒçš„ä¿¡æ¯å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦K-Læ•£åº¦ç™»åœºäº†ã€‚
## æ•°æ®çš„ç†µ
K-Læ•£åº¦æºäºä¿¡æ¯è®ºã€‚ä¿¡æ¯è®ºä¸»è¦ç ”ç©¶å¦‚ä½•é‡åŒ–æ•°æ®ä¸­çš„ä¿¡æ¯ã€‚æœ€é‡è¦çš„ä¿¡æ¯åº¦é‡å•ä½æ˜¯`ç†µ`Entropyï¼Œä¸€èˆ¬ç”¨`H`è¡¨ç¤ºã€‚åˆ†å¸ƒçš„ç†µçš„å…¬å¼å¦‚ä¸‹ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-7977551fba322af7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/472/format/webp)
Entropy
ä¸Šé¢å¯¹æ•°æ²¡æœ‰ç¡®å®šåº•æ•°ï¼Œå¯ä»¥æ˜¯`2`ã€`e`æˆ–`10`ï¼Œç­‰ç­‰ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä»¥`2`ä¸ºåº•çš„å¯¹æ•°è®¡ç®—Hå€¼çš„è¯ï¼Œå¯ä»¥æŠŠè¿™ä¸ªå€¼çœ‹ä½œæ˜¯ç¼–ç ä¿¡æ¯æ‰€éœ€è¦çš„æœ€å°‘äºŒè¿›åˆ¶ä½ä¸ªæ•°bitsã€‚ä¸Šé¢ç©ºé—´è •è™«çš„ä¾‹å­ä¸­ï¼Œä¿¡æ¯æŒ‡çš„æ˜¯æ ¹æ®è§‚å¯Ÿæ‰€å¾—çš„ç»éªŒåˆ†å¸ƒç»™å‡ºçš„è •è™«ç‰™é½¿æ•°é‡ã€‚è®¡ç®—å¯ä»¥å¾—åˆ°åŸå§‹æ•°æ®æ¦‚ç‡åˆ†å¸ƒçš„ç†µå€¼ä¸º`3.12 bits`ã€‚è¿™ä¸ªå€¼åªæ˜¯å‘Šè¯‰æˆ‘ä»¬ç¼–ç è •è™«ç‰™é½¿æ•°é‡æ¦‚ç‡çš„ä¿¡æ¯éœ€è¦çš„äºŒè¿›åˆ¶ä½`bit`çš„ä½æ•°ã€‚
å¯æ˜¯ç†µå€¼å¹¶æ²¡æœ‰ç»™å‡ºå‹ç¼©æ•°æ®åˆ°æœ€å°ç†µå€¼çš„æ–¹æ³•ï¼Œå³å¦‚ä½•ç¼–ç æ•°æ®æ‰èƒ½è¾¾åˆ°æœ€ä¼˜ï¼ˆå­˜å‚¨ç©ºé—´æœ€ä¼˜ï¼‰ã€‚ä¼˜åŒ–ä¿¡æ¯ç¼–ç æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ä¸»é¢˜ï¼Œä½†å¹¶ä¸æ˜¯ç†è§£K-Læ•£åº¦æ‰€å¿…é¡»çš„ã€‚ç†µçš„ä¸»è¦ä½œç”¨æ˜¯å‘Šè¯‰æˆ‘ä»¬æœ€ä¼˜ç¼–ç ä¿¡æ¯æ–¹æ¡ˆçš„ç†è®ºä¸‹ç•Œï¼ˆå­˜å‚¨ç©ºé—´ï¼‰ï¼Œä»¥åŠåº¦é‡æ•°æ®çš„ä¿¡æ¯é‡çš„ä¸€ç§æ–¹å¼ã€‚ç†è§£äº†ç†µï¼Œæˆ‘ä»¬å°±çŸ¥é“æœ‰å¤šå°‘ä¿¡æ¯è•´å«åœ¨æ•°æ®ä¹‹ä¸­ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å½“æˆ‘ä»¬ç”¨ä¸€ä¸ªå¸¦å‚æ•°çš„æ¦‚ç‡åˆ†å¸ƒæ¥è¿‘ä¼¼æ›¿ä»£åŸå§‹æ•°æ®åˆ†å¸ƒçš„æ—¶å€™ï¼Œåˆ°åº•æŸå¤±äº†å¤šå°‘ä¿¡æ¯ã€‚è¯·ç»§ç»­çœ‹ä¸‹èŠ‚å†…å®¹ã€‚â†“â†“â†“
## K-Læ•£åº¦åº¦é‡ä¿¡æ¯æŸå¤±
åªéœ€è¦ç¨åŠ ä¿®æ”¹`ç†µH`çš„è®¡ç®—å…¬å¼å°±èƒ½å¾—åˆ°`K-Læ•£åº¦`çš„è®¡ç®—å…¬å¼ã€‚è®¾`p`ä¸ºè§‚å¯Ÿå¾—åˆ°çš„æ¦‚ç‡åˆ†å¸ƒï¼Œ`q`ä¸ºå¦ä¸€åˆ†å¸ƒæ¥è¿‘ä¼¼`p`ï¼Œåˆ™`p`ã€`q`çš„`K-Læ•£åº¦`ä¸ºï¼š
![](https://upload-images.jianshu.io/upload_images/75110-e94b5412d85e5698.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/752/format/webp)
entropy-p-q
æ˜¾ç„¶ï¼Œæ ¹æ®ä¸Šé¢çš„å…¬å¼ï¼ŒK-Læ•£åº¦å…¶å®æ˜¯æ•°æ®çš„åŸå§‹åˆ†å¸ƒpå’Œè¿‘ä¼¼åˆ†å¸ƒqä¹‹é—´çš„å¯¹æ•°å·®å€¼çš„æœŸæœ›ã€‚å¦‚æœç»§ç»­ç”¨`2`ä¸ºåº•çš„å¯¹æ•°è®¡ç®—ï¼Œåˆ™**K-Læ•£åº¦å€¼è¡¨ç¤ºä¿¡æ¯æŸå¤±çš„äºŒè¿›åˆ¶ä½æ•°**ã€‚ä¸‹é¢å…¬å¼ä»¥æœŸæœ›è¡¨è¾¾K-Læ•£åº¦ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-5e6109b0e9ec780a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/576/format/webp)
DKL1
ä¸€èˆ¬ï¼ŒK-Læ•£åº¦ä»¥ä¸‹é¢çš„ä¹¦å†™æ–¹å¼æ›´å¸¸è§ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-d602c1e8d0fe3689.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/534/format/webp)
DKL2
æ³¨ï¼š`log a - log b = log (a/b)`
OKï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“å½“ç”¨ä¸€ä¸ªåˆ†å¸ƒæ¥è¿‘ä¼¼å¦ä¸€ä¸ªåˆ†å¸ƒæ—¶å¦‚ä½•è®¡ç®—ä¿¡æ¯æŸå¤±é‡äº†ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬é‡æ–°å›åˆ°æœ€å¼€å§‹çš„è •è™«ç‰™é½¿æ•°é‡æ¦‚ç‡åˆ†å¸ƒçš„é—®é¢˜ã€‚
## å¯¹æ¯”ä¸¤ç§åˆ†å¸ƒ
é¦–å…ˆæ˜¯ç”¨å‡åˆ†å¸ƒæ¥è¿‘ä¼¼åŸå§‹åˆ†å¸ƒçš„K-Læ•£åº¦ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-f682f83675fa42ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/571/format/webp)
DKL-uniform
æ¥ä¸‹æ¥è®¡ç®—ç”¨äºŒé¡¹å¼åˆ†å¸ƒè¿‘ä¼¼åŸå§‹åˆ†å¸ƒçš„K-Læ•£åº¦ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-b7a85dc7ac779750.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/581/format/webp)
DKL-binomial
é€šè¿‡ä¸Šé¢çš„è®¡ç®—å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨å‡åˆ†å¸ƒè¿‘ä¼¼åŸå§‹åˆ†å¸ƒçš„ä¿¡æ¯æŸå¤±è¦æ¯”ç”¨äºŒé¡¹å¼åˆ†å¸ƒè¿‘ä¼¼å°ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦ä»å‡åˆ†å¸ƒå’ŒäºŒé¡¹å¼åˆ†å¸ƒä¸­é€‰æ‹©ä¸€ä¸ªçš„è¯ï¼Œå‡åˆ†å¸ƒæ›´å¥½äº›ã€‚
## æ•£åº¦å¹¶éè·ç¦»
å¾ˆè‡ªç„¶åœ°ï¼Œä¸€äº›åŒå­¦æŠŠK-Læ•£åº¦çœ‹ä½œæ˜¯ä¸åŒåˆ†å¸ƒä¹‹é—´è·ç¦»çš„åº¦é‡ã€‚è¿™æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºä»K-Læ•£åº¦çš„è®¡ç®—å…¬å¼å°±å¯ä»¥çœ‹å‡ºå®ƒä¸ç¬¦åˆå¯¹ç§°æ€§ï¼ˆè·ç¦»åº¦é‡åº”è¯¥æ»¡è¶³å¯¹ç§°æ€§ï¼‰ã€‚å¦‚æœç”¨æˆ‘ä»¬ä¸Šé¢è§‚å¯Ÿçš„æ•°æ®åˆ†å¸ƒæ¥è¿‘ä¼¼äºŒé¡¹å¼åˆ†å¸ƒï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š
![](https://upload-images.jianshu.io/upload_images/75110-c72abbdf1938256e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/558/format/webp)
DKL-notdistance
æ‰€ä»¥ï¼Œ`Dkl (Observed || Binomial) != Dkl (Binomial || Observed)`ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨`p`è¿‘ä¼¼`q`å’Œç”¨`q`è¿‘ä¼¼`p`ï¼ŒäºŒè€…æ‰€æŸå¤±çš„ä¿¡æ¯å¹¶ä¸æ˜¯ä¸€æ ·çš„ã€‚
## ä½¿ç”¨K-Læ•£åº¦ä¼˜åŒ–æ¨¡å‹
å‰é¢ä½¿ç”¨çš„äºŒé¡¹å¼åˆ†å¸ƒçš„å‚æ•°æ˜¯æ¦‚ç‡ `p=0.57`ï¼Œæ˜¯åŸå§‹æ•°æ®çš„å‡å€¼ã€‚`p`çš„å€¼åŸŸåœ¨ [0, 1] ä¹‹é—´ï¼Œæˆ‘ä»¬è¦é€‰æ‹©ä¸€ä¸ª`p`å€¼ï¼Œå»ºç«‹äºŒé¡¹å¼åˆ†å¸ƒï¼Œç›®çš„æ˜¯æœ€å°åŒ–è¿‘ä¼¼è¯¯å·®ï¼Œå³K-Læ•£åº¦ã€‚é‚£ä¹ˆ`0.57`æ˜¯æœ€ä¼˜çš„å—ï¼Ÿ
ä¸‹å›¾æ˜¯åŸå§‹æ•°æ®åˆ†å¸ƒå’ŒäºŒé¡¹å¼åˆ†å¸ƒçš„K-Læ•£åº¦å˜åŒ–éšäºŒé¡¹å¼åˆ†å¸ƒå‚æ•°`p`å˜åŒ–æƒ…å†µï¼š
![](https://upload-images.jianshu.io/upload_images/75110-e6ca24b145a5ca8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
äºŒé¡¹åˆ†å¸ƒK-Lå€¼å˜åŒ–æ›²çº¿
é€šè¿‡ä¸Šé¢çš„æ›²çº¿å›¾å¯ä»¥çœ‹å‡ºï¼ŒK-Læ•£åº¦å€¼åœ¨åœ†ç‚¹å¤„æœ€å°ï¼Œå³`p=0.57`ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰çš„äºŒé¡¹å¼åˆ†å¸ƒæ¨¡å‹å·²ç»æ˜¯æœ€ä¼˜çš„äºŒé¡¹å¼æ¨¡å‹äº†ã€‚æ³¨æ„ï¼Œæˆ‘å·²ç»è¯´äº†ï¼Œæ˜¯è€Œåƒæ˜¯æ¨¡å‹ï¼Œè¿™é‡Œåªé™å®šåœ¨äºŒé¡¹å¼æ¨¡å‹èŒƒå›´å†…ã€‚
å‰é¢åªè€ƒè™‘äº†å‡åˆ†å¸ƒæ¨¡å‹å’ŒäºŒé¡¹å¼åˆ†å¸ƒæ¨¡å‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘å¦å¤–ä¸€ç§æ¨¡å‹æ¥è¿‘ä¼¼åŸå§‹æ•°æ®ã€‚é¦–å…ˆæŠŠåŸå§‹æ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œ1ï¼‰0-5é¢—ç‰™é½¿çš„æ¦‚ç‡å’Œ 2ï¼‰6-10é¢—ç‰™é½¿çš„æ¦‚ç‡ã€‚æ¦‚ç‡å€¼å¦‚ä¸‹ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-76a03ef0cd285801.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/414/format/webp)
ad hoc model
å³ï¼Œä¸€åªè •è™«çš„ç‰™é½¿æ•°é‡`x=i`çš„æ¦‚ç‡ä¸º`p/5`; `x=j`çš„æ¦‚ç‡ä¸º`(1-p) / 6`ï¼Œ`i=0,1,2,3,4,5`; `j=6,7,8,9,10`ã€‚
Ahaï¼Œæˆ‘ä»¬è‡ªå·±å»ºç«‹äº†ä¸€ä¸ªæ–°çš„ï¼ˆå¥‡æ€ªçš„ï¼‰æ¨¡å‹æ¥è¿‘ä¼¼åŸå§‹çš„åˆ†å¸ƒï¼Œæ¨¡å‹åªæœ‰ä¸€ä¸ªå‚æ•°`p`ï¼Œåƒå‰é¢é‚£æ ·ä¼˜åŒ–äºŒé¡¹å¼åˆ†å¸ƒçš„æ—¶å€™æ‰€åšçš„ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ç”»å‡ºK-Læ•£åº¦å€¼éš`p`å˜åŒ–çš„æƒ…å†µï¼š
![](https://upload-images.jianshu.io/upload_images/75110-dd374eaec9c5ad74.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
finding an optimal parameter value for our ad hoc model
å½“`p=0.47`æ—¶ï¼ŒK-Lå€¼å–æœ€å°å€¼`0.338`ã€‚ä¼¼æ›¾ç›¸è¯†å—ï¼Ÿå¯¹ï¼Œè¿™ä¸ªå€¼å’Œä½¿ç”¨å‡åˆ†å¸ƒçš„K-Læ•£åº¦å€¼æ˜¯ä¸€æ ·çš„ï¼ˆè¿™å¹¶ä¸èƒ½è¯´æ˜ä»€ä¹ˆï¼‰ï¼ä¸‹é¢æˆ‘ä»¬ç»§ç»­ç”»å‡ºè¿™ä¸ªå¥‡æ€ªæ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒå›¾ï¼Œçœ‹èµ·æ¥ç¡®å®å’Œå‡åˆ†å¸ƒçš„æ¦‚ç‡åˆ†å¸ƒå›¾ç›¸ä¼¼ï¼š
![](https://upload-images.jianshu.io/upload_images/75110-857b751b045a3aa2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
ad hoc model distribution
æˆ‘ä»¬è‡ªå·±éƒ½è¯´äº†ï¼Œè¿™æ˜¯ä¸ªå¥‡æ€ªçš„æ¨¡å‹ï¼Œåœ¨K-Lå€¼ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ›´å€¾å‘äºä½¿ç”¨æ›´å¸¸è§çš„ã€æ›´ç®€å•çš„å‡åˆ†å¸ƒæ¨¡å‹ã€‚
å›å¤´çœ‹ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€å°èŠ‚ä¸­ä½¿ç”¨K-Læ•£åº¦ä½œä¸ºç›®æ ‡æ–¹ç¨‹ï¼Œåˆ†åˆ«æ‰¾åˆ°äº†äºŒé¡¹å¼åˆ†å¸ƒæ¨¡å‹çš„å‚æ•°`p=0.57`å’Œä¸Šé¢è¿™ä¸ªéšæ‰‹å»ºç«‹çš„æ¨¡å‹çš„å‚æ•°`p=0.47`ã€‚æ˜¯çš„ï¼Œè¿™å°±æ˜¯æœ¬èŠ‚çš„é‡ç‚¹ï¼š**ä½¿ç”¨K-Læ•£åº¦ä½œä¸ºç›®æ ‡æ–¹ç¨‹æ¥ä¼˜åŒ–æ¨¡å‹**ã€‚å½“ç„¶ï¼Œæœ¬èŠ‚ä¸­çš„æ¨¡å‹éƒ½åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥æ‹“å±•åˆ°æœ‰æ›´å¤šå‚æ•°çš„é«˜ç»´æ¨¡å‹ä¸­ã€‚
## å˜åˆ†è‡ªç¼–ç å™¨VAEså’Œå˜åˆ†è´å¶æ–¯æ³•
å¦‚æœä½ ç†Ÿæ‚‰ç¥ç»ç½‘ç»œï¼Œä½ è‚¯èƒ½å·²ç»çŒœåˆ°æˆ‘ä»¬æ¥ä¸‹æ¥è¦å­¦ä¹ çš„å†…å®¹ã€‚é™¤å»ç¥ç»ç½‘ç»œç»“æ„çš„ç»†èŠ‚ä¿¡æ¯ä¸è°ˆï¼Œæ•´ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å…¶å®æ˜¯åœ¨æ„é€ ä¸€ä¸ªå‚æ•°æ•°é‡å·¨å¤§çš„å‡½æ•°ï¼ˆç™¾ä¸‡çº§ï¼Œç”šè‡³æ›´å¤šï¼‰ï¼Œä¸å¦¨è®°ä¸º`f(x)`ï¼Œé€šè¿‡è®¾å®šç›®æ ‡å‡½æ•°ï¼Œå¯ä»¥è®­ç»ƒç¥ç»ç½‘ç»œé€¼è¿‘éå¸¸å¤æ‚çš„çœŸå®å‡½æ•°`g(x)`ã€‚è®­ç»ƒçš„å…³é”®æ˜¯è¦è®¾å®šç›®æ ‡å‡½æ•°ï¼Œåé¦ˆç»™ç¥ç»ç½‘ç»œå½“å‰çš„è¡¨ç°å¦‚ä½•ã€‚è®­ç»ƒè¿‡ç¨‹å°±æ˜¯ä¸æ–­å‡å°ç›®æ ‡å‡½æ•°å€¼çš„è¿‡ç¨‹ã€‚
æˆ‘ä»¬å·²ç»çŸ¥é“K-Læ•£åº¦ç”¨æ¥åº¦é‡åœ¨é€¼è¿‘ä¸€ä¸ªåˆ†å¸ƒæ—¶çš„ä¿¡æ¯æŸå¤±é‡ã€‚K-Læ•£åº¦èƒ½å¤Ÿèµ‹äºˆç¥ç»ç½‘ç»œè¿‘ä¼¼è¡¨è¾¾éå¸¸å¤æ‚æ•°æ®åˆ†å¸ƒçš„èƒ½åŠ›ã€‚å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Autoencodersï¼ŒVAEsï¼‰æ˜¯ä¸€ç§èƒ½å¤Ÿå­¦ä¹ æœ€ä½³è¿‘ä¼¼æ•°æ®é›†ä¸­ä¿¡æ¯çš„å¸¸ç”¨æ–¹æ³•ï¼Œ[Tutorial on Variational Autoencoders 2016](https://link.jianshu.com?t=https://arxiv.org/abs/1606.05908)æ˜¯ä¸€ç¯‡å…³äºVAEsçš„éå¸¸ä¸é”™çš„æ•™ç¨‹ï¼Œé‡Œé¢è®²è¿°äº†å¦‚ä½•æ„å»ºVAEçš„ç»†èŠ‚ã€‚ [What are Variational Autoencoders? A simple explanation](https://link.jianshu.com?t=https://medium.com/@dmonn/what-are-variational-autoencoders-a-simple-explanation-ea7dccafb0e3)ç®€å•ä»‹ç»äº†VAEsï¼Œ[Building Autoencoders in Keras](https://link.jianshu.com?t=https://blog.keras.io/building-autoencoders-in-keras.html)ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨Kerasåº“å®ç°å‡ ç§è‡ªç¼–ç å™¨ã€‚
å˜åˆ†è´å¶æ–¯æ–¹æ³•ï¼ˆVariational Bayesian Methodsï¼‰æ˜¯ä¸€ç§æ›´å¸¸è§çš„æ–¹æ³•ã€‚[è¿™ç¯‡æ–‡ç« ](https://link.jianshu.com?t=https://www.countbayesie.com/blog/2015/3/3/6-amazing-trick-with-monte-carlo-simulations)ä»‹ç»äº†å¼ºå¤§çš„è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿæ–¹æ³•èƒ½å¤Ÿè§£å†³å¾ˆå¤šæ¦‚ç‡é—®é¢˜ã€‚è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿèƒ½å¤Ÿå¸®åŠ©è§£å†³è®¸å¤šè´å¶æ–¯æ¨ç†é—®é¢˜ä¸­çš„æ£˜æ‰‹ç§¯åˆ†é—®é¢˜ï¼Œå°½ç®¡è®¡ç®—å¼€é”€å¾ˆå¤§ã€‚åŒ…æ‹¬VAEåœ¨å†…çš„å˜åˆ†è´å¶æ–¯æ–¹æ³•ï¼Œéƒ½èƒ½ç”¨K-Læ•£åº¦ç”Ÿæˆä¼˜åŒ–çš„è¿‘ä¼¼åˆ†å¸ƒï¼Œè¿™ç§æ–¹æ³•å¯¹æ£˜æ‰‹ç§¯åˆ†é—®é¢˜èƒ½è¿›è¡Œæ›´é«˜æ•ˆçš„æ¨ç†ã€‚æ›´å¤šå˜åˆ†æ¨ç†ï¼ˆVariational Inferenceï¼‰çš„çŸ¥è¯†å¯ä»¥è®¿é—®[Edward library for python](https://link.jianshu.com?t=http://edwardlib.org/)ã€‚
**å› ä¸ºæœ¬äººæ²¡æœ‰å­¦ä¹ è¿‡VAEå’Œå˜åˆ†æ¨ç†ï¼Œæ‰€ä»¥æœ¬èŠ‚å†…å®¹è´¨é‡æ— æ³•å¾—åˆ°ä¿è¯ï¼Œæˆ‘ä¼šè”ç³»è¿™æ–¹é¢çš„æœ‹å‹æ¥æ”¹å–„æœ¬èŠ‚å†…å®¹ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºç»™å‡ºå»ºè®®**
è¯‘è‡ªï¼š[Kullback-Leibler Divergence Explained](https://link.jianshu.com?t=https://www.countbayesie.com/blog/2017/5/9/kullback-leibler-divergence-explained)
ä½œè€…ï¼šWill Kurt
If you enjoyed this post please [subscribe](https://link.jianshu.com?t=http://countbayesie.com/subscribe) to keep up to date and follow [@willkurt](https://link.jianshu.com?t=https://twitter.com/willkurt)!
If you enjoyed this writing and also like programming languages, you might like the [book on Haskell](https://link.jianshu.com?t=https://www.manning.com/books/learn-haskell) I just finished due in print July 2017 (though nearly all the content is available online today).
## é™„å½•
- 
K-L æ•£åº¦çš„å®šä¹‰
![](https://upload-images.jianshu.io/upload_images/75110-5d773218b2511d9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
define K-L divergence
- 
è®¡ç®—K-Lçš„æ³¨æ„äº‹é¡¹
![](https://upload-images.jianshu.io/upload_images/75110-f55d663d60503fa4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
notice
- 
é‡åˆ°`log 0`æ—¶æ€ä¹ˆåŠ
![](https://upload-images.jianshu.io/upload_images/75110-a7dc83686d7206c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp)
example for K-L smoothing
- 
ä¿¡æ¯ç†µã€äº¤å‰ç†µã€ç›¸å¯¹ç†µ
- ä¿¡æ¯ç†µï¼Œå³ç†µï¼Œé¦™æµ“ç†µã€‚ç¼–ç æ–¹æ¡ˆå®Œç¾æ—¶ï¼Œæœ€çŸ­å¹³å‡ç¼–ç é•¿åº¦ã€‚
- äº¤å‰ç†µï¼Œcross-entropyã€‚ç¼–ç æ–¹æ¡ˆä¸ä¸€å®šå®Œç¾æ—¶ï¼ˆç”±äºå¯¹æ¦‚ç‡åˆ†å¸ƒçš„ä¼°è®¡ä¸ä¸€å®šæ­£ç¡®ï¼‰ï¼Œå¹³å‡ç¼–ç é•¿åº¦ã€‚æ˜¯ç¥ç»ç½‘ç»œå¸¸ç”¨çš„æŸå¤±å‡½æ•°ã€‚
- ç›¸å¯¹ç†µï¼Œå³K-Læ•£åº¦ï¼Œrelative entropyã€‚ç¼–ç æ–¹æ¡ˆä¸ä¸€å®šå®Œç¾æ—¶ï¼Œå¹³å‡ç¼–ç é•¿åº¦ç›¸å¯¹äºæœ€å°å€¼çš„å¢åŠ å€¼ã€‚
	æ›´è¯¦ç»†å¯¹æ¯”ï¼Œè§çŸ¥ä¹[å¦‚ä½•é€šä¿—çš„è§£é‡Šäº¤å‰ç†µä¸ç›¸å¯¹ç†µ?](https://link.jianshu.com?t=https://www.zhihu.com/question/41252833)
- ä¸ºä»€ä¹ˆåœ¨ç¥ç»ç½‘ç»œä¸­ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œè€Œä¸æ˜¯K-Læ•£åº¦ï¼Ÿ
	K-Læ•£åº¦=ç†µ-äº¤å‰ç†µï¼Œå³ `DKL( p||q )=H(p)-H(p,q)`ã€‚
	åœ¨ç¥ç»ç½‘ç»œæ‰€æ¶‰åŠåˆ°çš„èŒƒå›´å†…ï¼Œ`H(p)`ä¸å˜ï¼Œåˆ™`DKL( p||q )`ç­‰ä»·`H(p,q)`ã€‚
	æ›´å¤šè®¨è®ºè§[Why do we use Kullback-Leibler divergence rather than cross entropy in the t-SNE objective function?](https://link.jianshu.com?t=https://stats.stackexchange.com/questions/265966/why-do-we-use-kullback-leibler-divergence-rather-than-cross-entropy-in-the-t-sne)å’Œ[Why train with cross-entropy instead of KL divergence in classification?](https://link.jianshu.com?t=https://www.reddit.com/r/MachineLearning/comments/4mebvf/why_train_with_crossentropy_instead_of_kl/)
ä½œè€…ï¼šAspirinrin
é“¾æ¥ï¼šhttps://www.jianshu.com/p/43318a3dc715
æ¥æºï¼šç®€ä¹¦
ç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒå¹¶æ³¨æ˜å‡ºå¤„ã€‚
