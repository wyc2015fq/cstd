# 通信算法之二十五：5G NR的Polar编码译码仿真链路 - leegang12的专栏 - CSDN博客
2019年01月20日 15:50:24[leegang12](https://me.csdn.net/leegang12)阅读数：227
Polar码（Polar Codes）
信道编码技术是无线通信物理层的最核心的基础技术之一，它的主要目的是使数字信号进行可靠的传递。信道编码技术通过在发送信息序列上增加额外的校验比特，并在接收端采用译码技术对传输过程中产生的差错进行纠正，从而实现发送信息序列的正确接收。
半个多世纪来，研究人员提出了多种纠错码技术（RS码、卷积码、Turbo码等），但这些编码方法都没有达到香农极限。
（1）什么是polar码
Polar码基于信道极化理论，是一种线性分组码，相比于LDPC码，Polar码在理论上能够达到香农极限。并且有着较低复杂度的编译码算法。
信道极化是Polar码的核心，信道极化过程包括信道组合和信道分解两个部分。
极性编码（Polar Coding）技术通过一个简单的编码器和一个简单的连续干扰抵消（SC）解码器来获得理论上的香农极限容量（当编码块的大小足够大的时候）。
大量的性能仿真实验结果表明，当编码块偏小时，在编码性能方面，极性编码与循环冗余编码，以及自适应的连续干扰抵消表（SC-list）解码器级联使用，可超越Turbo或LDPC低密度奇偶校验编码。
Polar码由于优良的编译码算法处理能力和高可靠性，已经被视为5G空口中前向纠错（FEC）的候选技术。
2016年11月14日至18日期间，3GPP RAN1 #87会议在美国Reno召开，本次会议其中一项内容是决定5G短码块的信道编码方案，其中，提出了三种短码编码方案：Turbo码、LDPC码和Polar码。
关于这三种编码方案之争，这已经是5G标准的第二次较量。在2016年10月14日葡萄牙里斯本举行的会议上，LDPC码战胜了Turbo码和Polar码，被采纳为5G eMBB场景的数据信道的长码块编码方案。
在这个背景下，这一次关于短码块编码方案的争论更为激烈。因为LDPC码已经拿下一局，出于实施复杂性考虑，整个移动通信系统采用单一的编码方案更利于5G部署，比如，3G和4G采用的是Turbo码，估计会有更多人支持LDPC码。
这样一来，主要由美国企业主导的LDPC码有可能一统5G天下，而华为等中国企业主导的Polar码将前功尽弃。
由于抛弃Turbo码的呼声较大，在上次会议失利之后，可以说Turbo码基本大势已去，本次5G编码之争最终演变为Polar码和LDPC码之间的拳击争霸赛，一场中美拳击争霸赛。
最终，经过连续熬夜的激战后，Polar码终于在5G核心标准上扳回一局，成为5G eMBB(增强移动宽带)场景的控制信道编码方案。
自此，经过两次激战，在5G eMBB场景上，Polar码和LDPC码二分天下，前者为控制信道编码方案，后者为数据信道编码方案。Polar码和LDPC码一起历史性的走进蜂窝移动通信系统，而在3G和4G时代陪伴我们多年的Turbo码再输一局，留下了落魄而孤寂的背影。
（2）Polar码和LDPC、turbo码比有什么优点？有什么区别？
对于Turbo码的研究最初集中于对于其译码算法、性能界和独特编码结构的研究上，经过十多年来的发展历程，已经取得了很大的成果，在各方面也都走向使用阶段。Turbo码由于很好地应用了香农信道编码定理中的随机性编译码条件而获得了接近香农理论极限的译码性能。它不仅在信噪比较低的高噪声环境下性能优越，而且具有很强的抗衰落、抗干扰能力。目前，Turbo码的研究主要集中在以下几个方面：
(a) 编译码技术
　　编码方面主要包括对并行级联编码与串行级联编码的分析，以及对混合级联方式的研究；译码方面主要包括迭代译码、译码算法（最大后验概率算法MAP、修正的MAP算法Max-Log-MAP、软输出Viterbi 算法SOVA等）的研究。
(b) Turbo码的设计和分析
　　主要包括交织器的设计、码的级联方式、译码算法、Turbo码的性能分析等。在性能分析中，主要对码重分布及距离谱进行分析，但由于没有相应的理论支持，这种分析只能是近似的，且仅局限于短码长、小码重的情况。
(c) Turbo 码在直扩(CDMA) 系统中的研究及应用
Turbo 码不仅在信道信噪比很低的高噪声环境下性能优越，而且还具有很强的抗衰落、抗干扰能力，因此它在信道条件差的移动通信系统中有很大的应用潜力，在第三代移动通信系统(IMT-2000)中己经将Turbo码作为其传输高速数据的信道编码标准。第三代移动通信系统(IMT-2000)的特点是多媒体和智能化，要能提供多元传输速率、高性能、高质量的服务，为支持大数据量的多媒体业务，必须在布限带宽信道上传输数据。由于无线信道传输媒质的不稳定性及噪声的不确定性，一般的纠错码很难达到较高要求的译码性能(一般要求比特误码率小于10-6e)，而Turbo码引起超乎寻常的优异译码性能，可以纠正高速率数据传输时发生的误码。另外，由于在直扩(CDMA) 系统中采用Turbo 码技术可以进一步提高系统的容量，所以有关Turbo码在直扩(CDMA) 系统中的应用，也就受到了各国学者的重视。
(d) 面向分组的Turbo 码
　　主要面向分组的Turbo 码的构造、译码及译码器的分析。
(e) Turbo 码与其它通信技术的结合
　　包括Turbo 码与调制技术(如网格编码调制TCM)的结合、Turbo码与均衡技术的结合(Turbo码均衡)、Turbo码编码与信源编码的结合、Turbo码译码与接收检测的结合等等。Turbo码与OFDM调制、差分检测技术相结合，具有较高的频率利用率，可有效地抑制短波信道中多径时延、频率选择性衰落、人为干扰与噪声带来的不利影响。国内在Turbo码的研究领域也取得了一定的成果和进展，西安电子科技大学综合业务网国家重点试验室在Turbo码的理论和应用研究方面取得了很多研究成果。此外，清华大学、北京邮电大学和上海交通大学等高校都在进行Turbo码相关的其它关键技术的研究方面取得一定的进展。深圳华为公司等在推动Turbo码在移动通信系统中的应用方面起了积极的作用。
但是选择放弃3G和4G时代使用的Turbo码的原因之一，因为4G的最大速率不过1Gbps，传统Turbo码通过迭代译码，Turbo码有一重要特点是其译码较为复杂，比常规的卷积码要复杂的多，这种复杂不仅在于其译码要采用迭代的过程，而且采用的算法本身也比较复杂。这些算法的关键是不但要能够对每比特进行译码，而且还要伴随着译码给出每比特译出的可靠性信息，有了这些信息，迭代才能进行下去。本质上源于串行的内部结构，所以，有人认为Turbo遇上更高速率的5G时就遇到了瓶颈。比如LDPC译码器是基于并行的内部结构，这意味着译码的时候可以并行同时处理，不但能处理较大的数据量，还能减少处理时延。尽管可以采用外部并行的方式，但又带来了时延问题。
LDPC码( Low-density Parity-check，低密度奇偶校验）是由 Gallager 在1963 年提出的一类具有稀疏校验矩阵的分组纠错码(linear block codes)，然而在接下来的 30 年来由于计算能力的不足，它一直被人们忽视。1993年，D MacKay、M Neal 等人对它重新进行了研究，发现 LDPC 码具有逼近香农限的优异性能。并且具有译码复杂度低、可并行译码以及译码错误的可检测性等特点，从而成为了信道编码理论新的研究热点。它的性能逼近香农限，且描述和实现简单，易于进行理论分析和研究，译码简单且可实行并行操作，适合硬件实现。
LDPC码具有巨大的应用潜力，将在深空通信、光纤通信、卫星数字视频、数字水印、磁/光/全息存储、移动和固定无线通信、电缆调制/解调器和数字用户线(DSL)中得到广泛应用。
和另一种近Shannon限的码-Turbo码相比较，LDPC码主要有以下几个优势：
a. LDPC码的译码算法，是一种基于稀疏矩阵的并行迭代译码算法，运算量要低于Turbo码译码算法，并且由于结构并行的特点，在硬件实现上比较容易。因此在大容量通信应用中，LDPC码更具有优势。
b. LDPC码的码率可以任意构造，有更大的灵活性。而Turbo码只能通过打孔来达到高码率，这样打孔图案的选择就需要十分慎重的考虑，否则会造成性能上较大的损失。
c. LDPC码具有更低的错误平层，可以应用于有线通信、深空通信以及磁盘存储工业等对误码率要求更加苛刻的场合。而Turbo码的错误平层在10-6量级上，应用于类似场合中，一般需要和外码级联才能达到要求。
d. LDPC码是上个世纪六十年代发明的，现在，在理论和概念上不再有什么秘密，因此在知识产权和专利上不再有麻烦。这一点给进入通信领域较晚的国家和公司，提供了一个很好的发展机会。
而LDPC码的劣势在于：
a. 硬件资源需求比较大。全并行的译码结构对计算单元和存储单元的需求都很大。
b. 编码比较复杂，更好的编码算法还有待研究。同时，由于需要在码长比较长的情况才能充分体现性能上的优势，所以编码时延也比较大。
c. 相对而言出现比较晚，工业界支持还不够。
5G NR（新的无线接入技术）的URLLC（超可靠的低延迟通信）应用场景要求用户面时延为0.5ms，这是4G 10ms的二十分之一。之所以要求这么高的时延，是因为我们在体验增强现实、远程控制和游戏等业务时，需要传送到云端处理，并实时传回，这一来回的过程时延一定要足够低，低到用户无法觉察到。另外，机器对时延比人类更敏感，对时延要求更高，尤其是5G的车联网、自动工厂和远程机器人等应用。
空口0.5ms时延意味着物理层的时延不能超过50 s，而物理层时延除了受译码影响，还受其它因素影响（比如同步），这就需要译码的处理时延一定要低于50 s，越低越好。
3GPP（3GPP是5G重要的标准化之一，是一个产业联盟，其目标是根据国际电信联盟组织ITU的相关需求，制定更加详细的技术规范与产业标准，规范产业的行为）定义了5G三大场景：eMBB（增强移动宽带），mMTC（大型机型通信）和URLLC（超可靠的低延迟通信），这些场景对应5G的AR、VR、车联网、大规模物联网、高清视频等等各种应用，较之3/4G只有语音和数据业务，5G可繁忙多了。
这就对5G信道编码提出了更高要求，需支持更广泛的码块长度和更多的编码率。比如，短码块应用于物联网，长码块应用于高清视频，低编码率应用于基站分布稀疏的农村站点，高编码率应用于密集城区。如果大家都用同样的编码率，这就会造成数据比特浪费，进而浪费频谱资源，这叫编码的灵活性。
另外，5G还得保障更高可靠性的通信。LTE(长期演进技术)对一般数据的空口误块率要求初始传输为10%，经过几次重传后，误块率如果低于1%即可。但是，5G要求误块率要降到十万分之一。这就意味着，10万个码块中，只允许信道译码器犯一次错，最多只能有一个码块不能纠错。
Polar码是低复杂度编解码，理论可达香农限是优势。当编码块偏小时，在编码性能方面，极性编码与循环冗余编码，以及自适应的连续干扰抵消表（SC-list）解码器级联使用，可超越Turbo或LDPC低密度奇偶校验编码。缺点是码长一般时(<2000)，最小汉明距太小(1024码长时只有16)，需要解决的问题：由于编码的特性，所有解码方法都是SC-based，也就是必须先解第一个再解第二个直到n，并行化会很困难，所以，即使“复杂度“比较低，但是VLSI实现的吞吐量(throughput)相对LDPC码非常低，这是polar codes应用上最大的问题。
综上，决定5G采用哪种编码方式的因素就是：译码吞吐量、时延、纠错能力、灵活性，还有实施复杂性、成熟度和后向兼容性等。
Turbo码被3/4G标准采用，LDPC被WiFi标准采用，LDPC码之前被广播系统、家庭有线网络、无线接入网络等通信系统所采用，此次是其第一次进入3GPP移动通信系统。而Polar码出现较晚，在5G之前还没有任何标准采用。从这方面讲，Polar码的成熟度较低。
--------------------- 
作者：司徒合羽 
来源：CSDN 
原文：https://blog.csdn.net/situheyu/article/details/79642071 
版权声明：本文为博主原创文章，转载请附上博文链接！
[ 5G通信系统，及相应MATLAB仿真代码，C语言代码。咨询qq：1279682290 ]
