# 通信算法之二十二：5G NR的调制方式与解调算法 - leegang12的专栏 - CSDN博客
2019年01月12日 15:50:34[leegang12](https://me.csdn.net/leegang12)阅读数：254
# 5G NR的调制方式与解调算法
【转载】：本文原始地址：[http://blog.csdn.net/wingsofsilence/article/details/78954315](http://blog.csdn.net/wingsofsilence/article/details/78954315)
# 前言
从物理层接收机来看，整个链路大致可以分为5部分：
![](https://img-blog.csdn.net/20180102183406681)
每个部分内容各有奥妙。
先从较为容易入手的解调开始。
# 调制
## 第一部分： 调制方式的演进
从3G到5G，数据信道的调制方式演进如下表：
![](https://blog.csdn.net/wingsofsilence/article/details/78954315)![](https://img-blog.csdn.net/20180102183607297)
备注：
1、此表中的调制方式针对的是数据信道（PUSCH/PDSCH）, 对于控制信道、广播信道等会略有差别。
2、对于5G NR， 设定256QAM是为了提高系统容量，设定π/2-BPSK是为了提高小区边缘的覆盖（仅在transforming precoding 启用时可以采用 ）。
## 第二部分： 调制映射的公式
最新版5G协议中已经将公式给出。（Ref：38.211 Chapter 5.1）
![](https://img-blog.csdn.net/20180102183851843)
## 第三部分： 调制幅度归一化因子
在传输过程中，调制方式可能发生变化。为了使所有映射有一样的平均功率，需要对映射进行归一化。映射后的复数值乘上一个归一化的量，即可得到输出数据。归一化因子的值根据不同的调制模式而不同，如下表：
![](https://img-blog.csdn.net/20180102184027881)
### 归一化因子计算方法：
所有星座点能量求平均后开方得到的就是波形幅度的平均值，其倒数就是归一化因子。
拿16QAM举例：能量为2有4个星座点，为10有8个点（+/-1,+/-3i），为18有4个点，共有能量72+80+8=160，然后这16个点的等概率分布是16分之1，所以160除以16等于10，这是平均能量，其平均后的波形幅度为 sqrt(10) 。
# 解调
调制解调是对应关系：
调制简单，是直接的映射关系；解调复杂，因为有噪声的作用，所以是概率统计的过程。
解调通用的算法是利用基于最大后验概率准则的对数似然比（LLR, log likelihood ratio）来计算调制信号的软比特信息。
以16QAM为例，简要推导其计算过程。
对于16QAM, 每个星座点用4bit来表示。I轴Q轴分别对应着2bit的数值组合。其格雷码 (Gray Code) 星座映射和星座图如下：
![](https://img-blog.csdn.net/20180102184929927)
![](https://img-blog.csdn.net/20180102185010375)
解调是一个统计过程，在接收信号为 y 时，最大化发送信号 bm 的概率 P(bm|y)。 这便是最大后验概率（MAP, maximum a posteriori probability） 
注：
如果想进一步了解概率和统计的区别，贝叶斯定律以及MAP的内容，可阅读[http://blog.csdn.net/u011508640/article/details/72815981](http://blog.csdn.net/u011508640/article/details/72815981)
根据贝叶斯公式（Bays Rule）
![](https://img-blog.csdn.net/20180102185550829)
每个星座点发生的概率是相同的，所以，最大化 P(bm|y) 和 P(y|bm) 最大化是等效的。
对于比特 b0, 映射的信息如下图。当 b0 从0变为1时，只有星座点的实数部分发生变化。
![](https://img-blog.csdn.net/20180102185652508)
（因为博客上传数学公式并不方便，下面公式推导以图片形式展开）
![](https://img-blog.csdn.net/20180102185709252)
将对数似然比进行简化、等效后， 得到解调公式：
![](https://img-blog.csdn.net/20180102185723277)
注意：
1、上述解调公式中的常数同样需要借用归一化因子处理
2、在推导过程中，1/sigma^2  并不能消掉，但每个软比特值都有，可以忽略。然而，随之调制阶数的不断增加，这个因子的影响逐渐增大。 作为解决措施，基带在进行天线均衡之后，通常会估算出一个postSNR值。 这个值可以乘在上面的LLR 向量中，提升接收机的性能。这个过程可称为LLR scaling。
解调推导过程参考:
[http://www.dsplog.com/2009/07/05/softbit-16qam/](http://www.dsplog.com/2009/07/05/softbit-16qam/)
[ 5G通信系统，及相应MATLAB仿真代码，C语言代码。咨询qq：1279682290 ]
