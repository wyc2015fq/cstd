# 机房重构——常用控件的总结 - Big Smile - CSDN博客
2016年01月25日 20:56:31[王啸tr1912](https://me.csdn.net/tr1912)阅读数：823标签：[机房收费系统](https://so.csdn.net/so/search/s.do?q=机房收费系统&t=blog)
个人分类：[机房收费](https://blog.csdn.net/tr1912/article/category/5715155)
所属专栏：[机房重构系列](https://blog.csdn.net/column/details/14105.html)
在VB.NET的窗体编辑过程中碰到了很多和VB中不一样的地方，下面来举例说明：
# 一、窗体
1.首先就是窗体的Load事件，和以往一样没有什么好说的，关键在于窗体的close事件，在vb.net中，窗体的关闭不是用的unload，而用的是close()一个关闭函数，而触发的事件也由原来的unload和querity unload变为了closeing和close，具体的发生顺序是先closeing再close，closeing只得就是窗体关闭的一瞬间还没有触发关闭事件的时候，相当于VB中的安全关闭，close是窗体已经卸载的差不多了才触发的事件，多用于窗体关闭后的处理。而在closeing事件中的函数声明处有一个参数
 e As FormClosingEventArgs 这就是关闭窗体的触发对象，窗体关闭和这个变量有密切关系，和VB中的cancel差不多，当e.Cancel = True的时候就不会退出，等于False的时候就会退出的，这要注意，所以写判断是否退出的代码要这么写：
```
Private Sub frmMain_FormClosing(sender As Object, e As FormClosingEventArgs) Handles Me.FormClosing
        If (MessageBox.Show("确定要退出吗？", "提示对话框", MessageBoxButtons.YesNo, MessageBoxIcon.Information) = DialogResult.No) Then
            e.Cancel = True
        End If
End Sub
```
        2.窗体控件的属性也有变化，不知道同学们有没有发现这样的一个属性：Anchor，这个属性是绑定控件到窗体的边缘，当窗体变动时保持和窗体的距离不变，这在某些情况下解决了窗体变化而控件不动的问题。
        3.窗体在使用默认按钮的属性上也有差别，在VB6.0中是用的按钮的default和cancel属性，而现在窗体上的AcceptButtion和CancelButton代替了他们的位置，设置默认按钮要这样设置。
![](https://img-blog.csdn.net/20160125201233417?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)这样也确保了只有一个按钮是默认按钮。
# 二、零散控件
        总体上看，控件的部分有一些小变化，但是最大的改变就是取消了控件数组，还有形状控件，所有的显示文字的属性一律改为了text而不是原来的caption和text了，下面是小部分的更改
        1.Timer控件
        Timer控件在根本上是没有变化的，只是在方法上有变化，以前是Timer事件，现在是dick(拟声词)事件，然后属性上默认是enable是false，interval为100，这一点很是人性化。
        2.TextBox
        基本上没有什么变化，只是默认只能调长度，宽度是根据字体来的，要是想随意大小，需要把multiline的属性设置为true。
        3.NumericUpDown(新)
        一个可以调节数字的控件，按上下的按钮是增减，且只是增减一个数字，很是方便设置数值的时候使用，具体的值得属性就是value。：![](https://img-blog.csdn.net/20160125202524366?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
        4.ToolStrip(新)
        工具栏控件，可以再这个栏上放lable，button，textbox等部分控件，可以实现在上下左右都创建工具栏的功能，对于一些功能的设计还真的是很有用。
        5.MenuStrip(原菜单)
        这个按理来说应该不算是新的，但是他的出现方式确实是很特别，和工具栏类似，但是上边只有菜单的选项，可以随心创建菜单按钮。
        6.ContexMenuStrip(右击菜单)
        可以定义右击菜单，可以在部分控件和窗体上设置右击菜单是哪一个，然后使用，很是方便，省去了VB6.0中的鼠标事件。
        7.DataGridView
        在这里代替了原来VB6.0里面的数据表控件，功能也更加的强大了，可以直接连接数据库，还可以自定义数据表头，非常方便使用。
三、总结
        通过学习了新的窗体控件，还有在其中遇到的困难让我越来越发现真的是和VB一样的地方很多，米老师让先学习VB的理念真的是对的，所以我们不要怕学不会，真正怕的是不学。
