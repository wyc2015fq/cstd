# 机房收费——组合查询的日期和时间的选择实现 - Big Smile - CSDN博客
2015年08月06日 19:54:21[王啸tr1912](https://me.csdn.net/tr1912)阅读数：764
在组合查询的窗体李面有两个窗体的选项带时间和日期的输入，但是时间和日期的输入都需要一定的格式才能被数据库所识别，那么怎样才能让用户直接就能方便的输入数据而又不违反格式规定呢？
        在组合窗体的内容项上，我添加了DTpiker的这个控件，从而就可以实现规范输入了，但是要怎么使用呢？
首先把窗体建好后，插入日期控件
![](https://img-blog.csdn.net/20150806195928571?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
然后把大小调整的和查询框一样大覆盖
![](https://img-blog.csdn.net/20150806200026113?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
然后就是代码的工作了：
在属性里把控件的可见性设为否
然后在字段选择的combo框的click事件里写下如下代码
```
If CombField(Index).Text = "上机时间" Or CombField(Index).Text = "下机时间" Then
        DTPicker1(Index).Visible = True
        DTPicker1(Index).Format = dtpTime   <span style="color:#009900;">'时间的格式</span>
        txtInquir(Index).Text = DTPicker1(Index).Value
    End If
    
     If CombField(Index).Text = "上机日期" Or CombField(Index).Text = "下机日期" Then
        DTPicker1(Index).Visible = True
        DTPicker1(Index).Format = dtpShortDate     <span style="color:#009900;">'日期的格式</span>
        txtInquir(Index).Text = DTPicker1(Index).Value
    End If
```
实现了在输入日期的时候显示日期控件
然后是日期控件的代码
```
Private Sub DTPicker1_Change(Index As Integer)
    txtInquir(Index).Text = DTPicker1(Index).Value
End Sub
```
然后就实现可选择式输入时间了
![](https://img-blog.csdn.net/20150806202424005?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
![](https://img-blog.csdn.net/20150806202447948?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)
