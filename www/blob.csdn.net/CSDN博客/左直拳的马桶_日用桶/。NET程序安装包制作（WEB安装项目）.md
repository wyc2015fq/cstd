# 。NET程序安装包制作（WEB安装项目） - 左直拳的马桶_日用桶 - CSDN博客
2006年04月28日 14:25:00[左直拳](https://me.csdn.net/leftfist)阅读数：3895
**。****NET****程序安装包制作（****WEB****安装项目）**
左直拳
**一、新建项目—安装和部署项目—WEB安装项目**
**二、安装文件夹。**
1、进入文件系统视图。方法为选定该项目，鼠标右键，弹出快捷菜单，选视图-文件系统。也可以直接点“解决方案资源管理器”上部的快捷图标。
2、在“WEB应用程序文件夹”里添加程序需要用到的文件，例如HTM文件，ASPX文件，BIN文件夹，等等。
3、设置虚拟目录属性。右击“WEB应用程序文件夹”，选属性。一般只须修改默认文档“defaultdocument”以及虚拟目录名“VirtualDirectorly”。
#### 如果想安装多个虚拟目录
可以根据需要添加多个“WEB自定义文件夹”，方法是右击最顶端的[目标计算机上的文件系统]，在弹出的菜单中选“添加特殊文件夹”—WEB自定义文件夹。但需要指出的是，这些多出来的虚拟目录只能在设计时设置好，而在安装包过程中却无从控制。例如，在安装的时候，程序会询问安装后的虚拟目录名和端口，但这些都指的是第一个安装文件夹，后面这些添加进去的虚拟目录无一例外地装到了端口80的位置，也就是默认网站下。不过在卸载的时候，系统反而能够将它们全部卸载。
#### 如果想在程序组菜单中也创建菜单项
可以进行以下4、5、6的步骤。不过这样做好象有点问题。我曾经在[用户的“程序”菜单]中放置卸载命令unInstall，但卸载的时候，居然提示要放进安装盘！（如果是硬盘安装，则改变了安装盘的路径或安装文件重命名，都会触发此提示）
4、WEB安装项目没有默认提供[用户的“程序”菜单]，需要自己创建一个：右击最顶端的[目标计算机上的文件系统]，在弹出的菜单中选“添加特殊文件夹”—用户的“程序”菜单。
5、在[用户的“程序”菜单]，创建一文件夹，命名，这个就是将来出现在用户的程序菜单中的文件夹。注意如果该文件夹的名字若与现有的程序菜单相同，则新安装的程序菜单项会与现有的挤在一块，如果子菜单项名字也一样，则会覆盖原有。
6、创建EXE文件快捷方式，改成适当的名字，剪切粘贴到“用户的程序菜单/文件夹”和“用户桌面”。鼠标右键看属性，ICON，从“应用程序文件夹”中选好对应的图标文件。这样安装后，程序将会在程序组以及桌面显示快捷方式。
**三、用户界面**
安装过程中，每个窗口上面会显示一幅图片。如果不指定，将会用默认图片代替。通常，应该用个性化的图片代替。同样，这张图片也应预先放在“应用程序文件夹”里。
1、进入用户界面视图。方法为选定该项目，鼠标右键，弹出快捷菜单，选视图-用户界面
2、将各个窗体的bannerBitmap改为个性化的图片。
**四、项目属性**
选定该项目，然后选菜单栏“视图”—“属性窗口”，将productname及title改为软件名称，它们在安装过程中会显示。注意，要用菜单栏中的“视图”—“属性窗口”，如果直接用鼠标右键，出来的是一个似乎没用的属性窗口。
如果在[用户的程序菜单]中添加卸载命令unInstall，可以进行以下操作：
拷贝productcode；切换到文件系统视图，选“用户的程序菜单”，找到卸载文件unInstall.exe的快捷方式，鼠标右键看属性，在属性Arguments里粘贴刚才复制的productcode。
UnInstall.exe是自行编写的一个程序，它的main()函数支持参数。将安装软件的productcode传给它，以保证准确地将其卸载。
**五、启动条件**
系统会自动加上.NET FRAMEWORK和IIS的检测。（我发现，刚新建安装项目时，系统还没有在启动条件中加上.NET FRAMEWORK，但当在文件夹中加入了文件后，启动条件视图中，.NET FRAMEWORK赫然在列）
