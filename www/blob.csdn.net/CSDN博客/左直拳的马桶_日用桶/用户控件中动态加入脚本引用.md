# 用户控件中动态加入脚本引用 - 左直拳的马桶_日用桶 - CSDN博客
2012年09月07日 17:14:57[左直拳](https://me.csdn.net/leftfist)阅读数：2626
用户控件中动态加入脚本引用，添加前先判断是否已经有引用，没有才添加。
//××××.ascx
```
protected void Page_Load(object sender, EventArgs e)
    {
　　　　StringBuilder sb = new StringBuilder();
　　　　StringWriter sw = new StringWriter(sb);
　　　　HtmlTextWriter htw = new HtmlTextWriter(sw);
　　　　this.Page.Header.RenderControl(htw);
        string headhtml = sb.ToString();
        if (headhtml.IndexOf("jquery.js", StringComparison.CurrentCultureIgnoreCase) == -1)
        {
            string jquery = @"<script type=""text/javascript"" src=""/js/jquery.js""></script>";
            this.Page.Header.Controls.Add(new LiteralControl(jquery));
        }
    }
```
不能直接用 this.Page.Header.innerHtml = ""; 这种方式，否则会报错："无法获取 的内部内容，因为该内容不是文本"
