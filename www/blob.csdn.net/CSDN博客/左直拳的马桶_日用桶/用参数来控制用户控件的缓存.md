# 用参数来控制用户控件的缓存 - 左直拳的马桶_日用桶 - CSDN博客
2007年09月30日 17:43:00[左直拳](https://me.csdn.net/leftfist)阅读数：1959
用参数来控制用户控件的缓存
左直拳
用户控件有个好处就是可以利用缓存，在不实施缓存的页面中实现部分缓存。
可是有时候同一个用户控件，放在不同的页面，又需要它可以表现出不同的样式，或提供不同的功能。
这时跟缓存有冲突吗？
伟大的微软告诉我们，可以在控件缓存设置中声明VaryByControl 或VaryByParam。
VaryByParam 我还没用过，估计就是根据包含该控件的页面中指定的参数值，如?f=1&u=0之类，针对不同值，缓存不同的版本。
我用的是VaryByControl，在控件内或包含该控件的页面内放置一个其他控件，如文本框（textbox），VaryByControl=“该控件的ID”，这样这个控件的值不同，用户控件的缓存就不同。
然而直接访问用户控件内部的控件是不方便的，或者也不严谨。可以在用户控件内设置一个属性，通过该属性来间接访问和控制该控件。如：
页面：
<%@OutputCacheDuration="1800"VaryByControl="txtCssStyle"Shared="true"%>
……
<inputtype="hidden"id="txtCssStyle"runat="server"value=""/>
……
<%if (CssStyle != "2")
{ %>
你老豆
<%}else{%>
你老母
<%}%>
代码：
#region属性
publicstring CssStyle
{
get
{
return txtCssStyle.Value;
}
set
{
txtCssStyle.Value = (value == "2") ? "2" : "";
}
}
#endregion
调用页面1：
<uc2:DirectShowID="DirectShow1"runat="server"CssStyle="1"/>
调用页面2：
<uc2:DirectShowID="DirectShow1"runat="server"CssStyle="2"/>
这样在第一次打开页面1和页面2时，就各自获得一份缓存，并且按照不同的要求，表现出不同的样式和动作。
