# 大数据与数据脱敏 - Spark高级玩法 - CSDN博客
2018年09月17日 00:00:00[Spark高级玩法](https://me.csdn.net/rlnLo2pNEfx9c)阅读数：1281
大数据平台通过将所有数据整合起来，充分分析与挖掘数据的内在价值，为业务部门提供数据平台，数据产品与数据服务。大数据平台接入的数据中可能包括很多用户的隐私和敏感信息，如用户在酒店的入住纪录，用户支付信息等，这些数据存在可能泄漏的风险。
大数据平台一般通过用户认证，权限管理以及数据加密等技术保证数据的安全，但是这并不能完全从技术上保证数据的安全。严格的来说，任何有权限访问用户数据的人员，如ETL工程师或是数据分析人员等，均有可能导致数据泄漏的风险。另一方面，没有访问用户数据权限的人员，也可能有对该数据进行分析挖掘的需求，数据的访问约束大大限制的充分挖掘数据价值的范围。
数据脱敏通过对数据进行脱敏，在保证数据可用性的同时，也在一定范围内保证恶意攻击者无法将数据与具体用户关联到一起，从而保证用户数据的隐私性。数据脱敏方案作为大数据平台整体数据安全解决方案的重要组成部分，是构建安全可靠的大数据平台必不可少的功能特性。本文首先分析了数据泄露可能带来的风险，然后详细介绍了数据脱敏技术的理论基础与常用算法，最后介绍了一个基于大数据平台的数据脱敏解决方案。
**隐私数据脱敏技术**
通常在大数据平台中，数据以结构化的格式存储，每个表有诸多行组成，每行数据有诸多列组成。根据列的数据属性，数据列通常可以分为以下几种类型：
01
可确切定位某个人的列，称为可识别列
如身份证号，地址以及姓名等。
02
单列并不能定位个人，但是多列信息可用来潜在的识别某个人，这些列被称为半识别列
如邮编号，生日及性别等。美国的一份研究论文称，仅使用邮编号，生日和性别信息即可识别87%的美国人[3]。
03
包含用户敏感信息的列
04
其他不包含用户敏感信息的列。
隐私数据泄露
类型
隐私数据泄露可以分为多种类型，根据不同的类型，通常可以采用不同的隐私数据泄露风险模型来衡量防止隐私数据泄露的风险，以及对应不同的数据脱敏算法对数据进行脱敏。一般来说，隐私数据泄露类型包括：
- 
个人标识泄露。当数据使用人员通过任何方式确认数据表中某条数据属于某个人时，称为个人标识泄露。个人标识泄露最为严重，因为一旦发生个人标识泄露，数据使用人员就可以得到具体个人的敏感信息。
- 
属性泄露，当数据使用人员根据其访问的数据表了解到某个人新的属性信息时，称为属性泄露。个人标识泄露肯定会导致属性泄露，但属性泄露也有可能单独发生。
- 
成员关系泄露。当数据使用人员可以确认某个人的数据存在于数据表中时，称为成员关系泄露。成员关系泄露相对风险较小，个人标识泄露与属性泄露肯定意味着成员关系泄露，但成员关系泄露也有可能单独发生。
将数据开放给数据分析人员，同时就引入了隐私数据泄露的风险。在限制隐私数据泄露风险在一定范围内的同时，最大化数据分析挖掘的潜力，是数据脱敏技术的最终目标。目前在隐私数据脱敏领域，有几个不同的模型可以用来从不同角度衡量数据可能存在的隐私数据泄露风险。
**  K-Anonymity  **
隐私数据脱敏的第一步是对所有可标识列进行移除或是脱敏，使得攻击者无法直接标识用户。但是攻击者还是有可能通过多个半标识列的属性值识别个人。攻击者可能通过社工（知道某个人的姓名，邮编，生日，性别等）或是其他包含个人信息的以开放数据库获得特定个人的半标识列属性值，并与大数据平台数据进行匹配，从而得到特定个人的敏感信息。如表一所示，如果攻击者知道某用户的邮编和年龄，就可以得到该用户的疾病敏感信息。
为了避免这种情况的发生，通常需要对半标识列进行脱敏处理，如数据泛化等。数据泛化是将半标识列的数据替换为语义一致但更通用的数据，已上述数据为例，对邮编和年龄泛化后的数据如表二所示。
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/WNMPtyS7Wd9CtGvsSnI5XTqHjfufsBeBzjMk0wZnuybV8OlJMBdgGU0Qp5AhQWNB6LNd1A4eJt47qCERBn49Sg/640)
 表1 原始病人信息
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/WNMPtyS7Wd9CtGvsSnI5XTqHjfufsBeBkx4rP9tI3bUQFNporgBOxcjOaWZAPSNicfOCbqPOHV6lAx8Wh9HiaDXw/640)
 表2 3-Anonymity病人信息
经过泛化后，有多条纪录的半标识列属性值相同，所有半标识列属性值相同的行的集合被称为相等集。例如，表二中1，2，3行是一个相等集，4，5，6行也是一个相等集。Sama- rati and Sweeney[4]引入了K-Anonymity用于衡量个人标识泄露的风险。 K-Anonymity定义如下：
K-Anonymity要求对于任意一行纪录，其所属的相等集内纪录数量不小于k，即至少有k-1条纪录半标识列属性值与该条纪录相同。
图二中的数据是一个3-Anonymity的数据集。作为一个衡量隐私数据泄露风险的指标，K-Anonymity可用于衡量个人标识泄露的风险，理论上来说，对于K-Anonymity数据集，对于任意纪录，攻击者只有1/k的概率将该纪录与具体用户关联。
**L-Diversity**
K-Anonymity可用于保护个人标识泄露的风险，但是无法保护属性泄露的风险。对于K-Anonymity的数据集，攻击者可能通过同质属性攻击与背景知识攻击两种方式攻击用户的属性信息。
- 
同质属性攻击。对于图二半标识列泛化后的数据集，假如攻击者知道Bob邮编为47677，年龄为29，则Bob一定对应于前面三条记录，从而可以确定Bob有心脏病。
- 
背景知识攻击。对于图二半标识列泛化后的数据集，假如攻击者知道Alice邮编为47673，年龄为36，则Alice一定对应于后面三条记录，如果攻击者知道Alice患有心脏病的几率很小，则能判断Alice很有可能患有癌症。
如果对于任意相等集内所有记录对应的敏感数据的集合，包含L个"合适"值，则称该相等集是满足L-Deversity。如果数据集中所有相等集都满足L-Deversity，则称该数据集满足L-Deversity。
所谓L个“合适”值，最简单的理解就是L个不同值。基于图二的数据通过插入干扰纪录，一个3-Anonymity 2-Diversity的数据集如表三所示：
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/WNMPtyS7Wd9CtGvsSnI5XTqHjfufsBeBOjoddALJewXRI4CX1PnTaoNVA4GjT0uNHb58AF6m43cHeLGJ8dsw6g/640)
 表3 3-Anonymity 2-Diversity 病人信息
相对于K-Anonymity标准，符合L-Deversity标准的数据集显著降低了属性数据泄露的风险。对于满足L-Diversity的数据集，理论上，攻击者最多只有1/L的概率能够属性泄露攻击，将特定用户与其敏感信息关联起来。一般来说是通过插入干扰数据构造符合L-Diversity标准的数据集，但是同数据泛化一样，插入干扰数据也会导致表级别的信息丢失。同时L-Diversity标准也有不足之处。
- 
L-Diversity标准有可能很难或是没有必要实现。
- 
L-Diversity标准无法防御特定类型的属性数据泄露。
- 
倾斜攻击
- 
相似性攻击
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/WNMPtyS7Wd9CtGvsSnI5XTqHjfufsBeB5CPMhokvdXoNgLbUP6ky1eV69twdicMh01cibBnehUuKAFib4tUo2VAGQ/640)
 表4 3-Diversity 病人信息
简单来说，对于L-Diversity相同的相等集，敏感属性值的分布信息对于保护属性泄露至关重要。L-Diversity只是用来衡量相等集的不同属性值数量，并没有衡量不同属性值的分布，所以其在衡量属性泄露风险上仍有不足之处。
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/GKmw8ib87Dx16USibw6bFXThhbNeURmIlsvmElmKCBMTJBXvWvUE268JlevRAFeV8Xc2BcdRphIeRL6JxDT1w8OQ/640)
**T-Closeness**
直观的来说，隐私信息泄露的程度可以根据攻击者增量获得的个人信息衡量。假设攻击者在访问数据集之前已知的个人信息为B0，然后假设攻击者访问所有半标识列都已移除的数据集，Q为数据集敏感数据的分布信息，根据Q，攻击者更新后的个人信息为B1.最后攻击者访问脱敏后的数据集，由于知道用户的半标识列的信息，攻击者可以将某用户与某相等集联系在一起，通过该相等集的敏感数据分布信息P，攻击者更新后的个人信息为B2.
L-Diversity约束是通过约束P的diverisity属性，尽量减少B0和B2之间的信息量差距，差距越小，说明隐私信息泄露越少。T-Closeness约束则期望减少B1和B2之间的信息量差距，减少攻击者从敏感数据的全局分布信息和相等集分布信息之间得到更多的个人隐私信息。T-Closeness的定义如下：
如果一个相等类的敏感数据的分布与敏感数据的全局分布之间的距离小于T，则称该相等类满足T-Closeness约束。如果数据集中的所有相等类都满足T-Closeness，则称该数据集满足T-Closeness.
T-Closeness约束限定了半标识列属性与敏感信息的全局分布之间的联系，减弱了半标识列属性与特定敏感信息的联系，减少攻击者通过敏感信息的分布信息进行属性泄露攻击的可能性。不过同时也肯定导致了一定程度的信息丢失，所以管理者通过T值的大小平衡数据可用性与用户隐私保护。
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/9icWThKFBdFyzLZeCe9gGjvbIgd1yTAKAibiaU6oIicLFM8EJCAp5r0x1rIe0pWWoJSxbQaMMDnwhdJIjn4Ma3icQRg/640)![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/9icWThKFBdFyzLZeCe9gGjvbIgd1yTAKAibiaU6oIicLFM8EJCAp5r0x1rIe0pWWoJSxbQaMMDnwhdJIjn4Ma3icQRg/640)![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/9icWThKFBdFyzLZeCe9gGjvbIgd1yTAKAibiaU6oIicLFM8EJCAp5r0x1rIe0pWWoJSxbQaMMDnwhdJIjn4Ma3icQRg/640)
**常见数据脱敏算法**
K-Anonymity, L-Diversity和T-Closeness均依赖对半标识列进行数据变形处理，使得攻击者无法直接进行属性泄露攻击，常见的数据变形处理方式如下：
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/WNMPtyS7Wd9CtGvsSnI5XTqHjfufsBeBdqTd1m2CnyjQ2kkXYlwvPkvMgA0K7fJ0D6VyBBho3uYGAjqiaGnvbYg/640)
 表5 常用数据变形操作
此外，K-Anonymity, L-Diversity和T-Closeness约束可能还需要生成干扰数据，敏感数据干扰项的生成策略与方法也是保证K-Anonymity, L-Diversity和T-Closeness的重要条件，在这里篇幅有限，就不过多介绍，请参考引用中的相关论文[4,5,6]。
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/Lf8AGoXcyew3d9picbyJAIU37hAl23VvsMBwrdhNqneO2XvDDtibQNDu1XpwZGdthvOsEEq6bnYU9X9nX1Yb2lHA/640)
**大数据脱敏平台**
用户隐私数据保护与挖掘用户数据价值是两个互相冲突的矛盾体，彻底的数据脱敏，需要抹去全部的用户标识信息，使得数据潜在的分析价值大大降低。另一方面，完全保留用户隐私数据信息，可最大化数据的分析价值，同时导致用户隐私泄露的风险无法控制。因此大数据脱敏平台的设计目标并不是实现工具算法用来完全抹去全部的用户标识信息，而是包括如下几个目标：
- 
数据泄露风险可控。首先，实现基于大数据平台的脱敏算法库，可并行，高效的按照脱敏规则对隐私数据进行脱敏。其次，基于数据脱敏的理论基础，建立用户隐私数据泄露风险的衡量模型，可定性定量的准确衡量数据可能发生泄露的风险。
- 
可管理。结合大数据平台的用户认证体系，权限管理体系，以及隐私数据不同保护级别的权限管理体系，实现对隐私数据基于审批的数据访问机制。结合公司制度，规范，法务等管理，实现在尽可能保护用户隐私数据，减少数据泄露风险的前提下，最大化保留数据分析挖掘的价值。
- 
可审计。对数据的访问要保证可回溯，可审计，当发生数据泄露时，要保证能够通过审计日志找到对应的泄露人员。
![640](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/QV7V3Vvf4gDwPrk1jU1LPAx3LgsLQoKrCRqm1H0pf5232MHhRI1q5uXr3iawpssGa8WjUH1WOyMW7XF3ggjBYEQ/640)
1
**总结**
1
针对于大数据平台对于数据脱敏的需求，本文分析了数据泄露可能带来的风险，介绍了数据脱敏技术的理论基础与实现方式，同时简单分析了大数据平台的隐私数据脱敏技术方向。本文讨论的均是基于离线数据的数据脱敏，流式数据的脱敏技术无论是理论基础与具体实践大都还处在摸索的过程中[7]，留待以后继续探索。
转载自李呈祥
**  引  用  **
- 
我国隐私保护相关法律报告
- 
索尼用户隐私数据泄露事件
- 
Uniqueness of Simple Demographics in the U.S. Population
- 
Protecting Privacy when Disclosing Information: k-Anonymity and Its Enforcement through Generalization and Suppression
- 
ℓ-Diversity: Privacy Beyond k-Anonymity
- 
Enhancing Cloud Security Using Data Anonymization
- 
CASTLE: Continuously Anonymizing Data Streams
