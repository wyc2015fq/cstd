# 获取系统可用串口列表 - ljx0305的专栏 - CSDN博客
2008年03月22日 09:56:00[ljx0305](https://me.csdn.net/ljx0305)阅读数：2774
- int CUtil::GetSystemPorts(CString *pNameList, CString *pPortList)   
- {   
-     CRegKey RegKey;   
- int nCount = 0;   
- 
- if(RegKey.Open(HKEY_LOCAL_MACHINE, "Hardware//DeviceMap//SerialComm") == ERROR_SUCCESS)   
-     {   
- while(true)   
-         {   
- char ValueName[_MAX_PATH];   
-             unsigned char ValueData[_MAX_PATH];   
- DWORD nValueSize = _MAX_PATH;   
- DWORD nDataSize = _MAX_PATH;   
- DWORD nType;   
- 
-    //RegEnumValue函数的作用是,从被指定打开的注册表项中列举所有的值
   //这函数每调用一次就会拷贝一个索引值的名称和数据块
- if(::RegEnumValue(HKEY(RegKey), nCount, ValueName, &nValueSize, NULL, &nType, ValueData, &nDataSize) == ERROR_NO_MORE_ITEMS)   
-             {   
- break;   
-             }   
- 
- if(pNameList)   
-                 pNameList[nCount] = ValueName;   
- 
- if(pPortList)   
-                 pPortList[nCount] = ValueData;   
- 
-             nCount++;   
-         }   
-     }   
- 
- return nCount;   
- }   
转自[http://vcer.net/1047279542283.html](http://vcer.net/1047279542283.html)
