# SendMessage函数完全使用手册  - ljx0305的专栏 - CSDN博客
2009年11月17日 21:37:00[ljx0305](https://me.csdn.net/ljx0305)阅读数：421标签：[windows																[command																[button																[menu																[文档																[list](https://so.csdn.net/so/search/s.do?q=list&t=blog)](https://so.csdn.net/so/search/s.do?q=文档&t=blog)](https://so.csdn.net/so/search/s.do?q=menu&t=blog)](https://so.csdn.net/so/search/s.do?q=button&t=blog)](https://so.csdn.net/so/search/s.do?q=command&t=blog)](https://so.csdn.net/so/search/s.do?q=windows&t=blog)
个人分类：[VC																[MFC](https://blog.csdn.net/ljx0305/article/category/403913)](https://blog.csdn.net/ljx0305/article/category/401790)
SendMessage函数完全使用手册
首先 我们了解一下Windows的消息机制。Windows是一个消息驱动式系统，Windows消息提供应用程序与应用程序之间，应用程序与Windows系统之间进行通信的手段。
举个例子，打开记事本程序，该程序有一个 “文件“菜单。 那么，在运行该程序的时候，如果用户单击“文件菜单“里的“新建“命令， 这个动作将被Windows所捕捉，Windows经过分析得知这个动作应该由我们打开的记事本程序所来处理，然后Windows就发送个消息 譬如我们编程的时候有时用到的 WM_COMMAND的消息给记事本，然后记事本就把这个消息处理掉。 这个过程就是消息处理。
接下来，我们把SendMessage的完整形式讲一下SendMessage
Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
别名 
SendMessageA
说明
调用一个窗口的窗口函数，将一条消息发给那个窗口。除非消息处理完毕，否则该函数不会返回
SendMessage所包含4个参数 
hwnd 32位的窗口句柄窗口可以是任何类型的屏幕对象，因为Win32能够维护大多数可视对象的句柄
wMsg 用于区别其他消息的常量值，这些常量可以是Windows单元中预定义的常量，也可以是自定义的常量wParam 通常是一个与消息有关的常量值，也可能是窗口或控件的句柄
lParam 通常是一个指向内存中数据的指针。由于WParm、lParam和Pointer都是32位的，因此，它们之间可以相互转换
wMsg函数
WM_CREATE 创建一个窗口
WM_DESTROY 当一个窗口被破坏时发送
WM_MOVE 移动一个窗口
WM_SIZE 改变一个窗口的大小
WM_ACTIVATE 一个窗口被激活或失去激活状态
WM_SETFOCUS 一个窗口获得焦点
WM_KILLFOCUS 一个窗口失去焦点
WM_ENABLE 一个窗口改变成Enable状态
WM_SETREDRAW 设置窗口是否能重画
WM_SETTEXT 应用程序发送此消息来设置一个窗口的文本
WM_GETTEXT 应用程序发送此消息来复制对应窗口的文本到缓冲区
WM_GETTEXTLENGTH 得到与一个窗口有关的文本的长度（不包含空字符）
WM_PAINT 要求一个窗口重画自己
WM_CLOSE 当一个窗口或应用程序要关闭时发送一个信号
WM_QUERYENDSESSION 当用户选择结束对话框或程序自己调用ExitWindows函数
WM_QUIT 用来结束程序运行
WM_QUERYOPEN 当用户窗口恢复以前的大小位置时，把此消息发送给某个图标
WM_ERASEBKGND 当窗口背景必须被擦除时（例在窗口改变大小时）
WM_SYSCOLORCHANGE 当系统颜色改变时，发送此消息给所有顶级窗口
WM_ENDSESSION 当系统进程发出 WM_QUERYENDSESSION消息后，此消息发送给应用程序，通知它对话是否结束
WM_SHOWWINDOW 当隐藏或显示窗口是发送此消息给这个窗口
WM_ACTIVATEAPP 发此消息给应用程序哪个窗口是激活的，哪个是非激活的
WM_FONTCHANGE 当系统的字体资源库变化时发送此消息给所有顶级窗口
WM_TIMECHANGE 当系统的时间变化时发送此消息给所有顶级窗口
WM_CANCELMODE 发送此消息来取消某种正在进行的摸态（操作）
WM_SETCURSOR 如果鼠标引起光标在某个窗口中移动且鼠标输入没有被捕获时，就发消息给某个窗口
WM_MOUSEACTIVATE 当光标在某个非激活的窗口中而用户正按着鼠标的某个键发送此消息给当前窗口
WM_CHILDACTIVATE 发送此消息给MDI子窗口当用户点击此窗口的标题栏，或当窗口被激活，移动，改变大小
WM_QUEUESYNC 此消息由基于计算机的训练程序发送，通过WH_JOURNALPALYBACK的hook程序分离出用户输入消息
WM_GETMINMAXINFO 此消息发送给窗口当它将要改变大小或位置
WM_PAINTICON 发送给最小化窗口当它图标将要被重画
WM_ICONERASEBKGND 此消息发送给某个最小化窗口，仅当它在画图标前它的背景必须被重画
WM_NEXTDLGCTL 发送此消息给一个对话框程序去更改焦点位置
WM_SPOOLERSTATUS 每当打印管理列队增加或减少一条作业时发出此消息 
WM_DRAWITEM 当button，combobox，listbox，menu的可视外观改变时发送
WM_MEASUREITEM 当button, combo box, list box, list view control, or menu item 被创建时
WM_VKEYTOITEM 此消息有一个LBS_WANTKEYBOARDINPUT风格的发出给它的所有者来响应WM_KEYDOWN消息 
WM_CHARTOITEM 此消息由一个LBS_WANTKEYBOARDINPUT风格的列表框发送给他的所有者来响应WM_CHAR消息 
WM_SETFONT 当绘制文本时程序发送此消息得到控件要用的颜色
WM_GETFONT 应用程序发送此消息得到当前控件绘制文本的字体
WM_SETHOTKEY 应用程序发送此消息让一个窗口与一个热键相关连 
WM_GETHOTKEY 应用程序发送此消息来判断热键与某个窗口是否有关联
WM_QUERYDRAGICON 此消息发送给最小化窗口，当此窗口将要被拖放而它的类中没有定义图标，应用程序能返回一个图标或光标的句柄，当
用户拖放图标时系统显示这个图标或光标
WM_COMPAREITEM 发送此消息来判
定combobox或listbox新增加的项的相对位置
WM_COMPACTING 显示内存已经很少了
WM_WINDOWPOSCHANGING 发送此消息给那个窗口的大小和位置将要被改变时，来调用setwindowpos函数或其它窗口管理函数
WM_WINDOWPOSCHANGED 发送此消息给那个窗口的大小和位置已经被改变时，来调用setwindowpos函数或其它窗口管理函数
WM_POWER 当系统将要进入暂停状态时发送此
消息
WM_COPYDATA 当一个应用程序传递数据给另一个应用程序时发送此消息
WM_CANCELJOURNA 当某个用户取消程序日志激活状态，提交此消息给程序
WM_NOTIFY 当某个控件的某个事件已经发生或
这个控件需要得到一些信息时，发送此消息给它的父窗口 
WM_INPUTLANGCHANGEREQUEST 当用户选择某种输入语言，或输入语言的热键改变
WM_INPUTLANGCHANGE 当平台现场已经被改变后发送此消息给受影响的最顶级窗口
WM_TCARD 当程序已经初始化windows帮助例
程时发送此消息给应用程序
WM_HELP 此消息显示用户按下了F1，如果某
个菜单是激活的，就发送此消息个此窗口关联的菜单，否则就发送给有焦点的窗口，如果当前都没有焦点，就把此消息发送给当前激活的窗口
WM_USERCHANGED 当用户已经登入或退出后发送此消息给所有的窗口，当用户登入或退出时系统更新用户的具体设置信息，在用户更新设置时系统马上发送此消息
WM_NOTIFYformAT 公用控件，自定义控件和他们的父窗口通过此消息来判断控件是使用ANSI还是UNICODE结构
WM_CONTEXTMENU 当用户某个窗口中点击了一下右键就发送此消息给这个窗口
WM_styleCHANGING 当调用SETWINDOWLONG函数将要改变一个或多个 窗口的风格时发送此消息给那个窗口
WM_styleCHANGED 当调用SETWINDOWLONG函数一个或多个 窗口的风格后发送此消息给那个窗口
WM_DISPLAYCHANGE 当显示器的分辨率改变后发送此消息给所有的窗口
WM_GETICON 此消息发送给某个窗口来返回与某
个窗口有关连的大图标或小图标的句柄
WM_SETICON 程序发送此消息让一个新的大图标
或小图标与某个窗口关联
WM_NCCREATE 当某个窗口第一次被创建时，此消息在WM_CREATE消息发送前发送
WM_NCDESTROY 此消息通知某个窗口，非客户区
正在销毁 
WM_NCCALCSIZE 当某个窗口的客户区域必须被核
算时发送此消息
WM_NCHITTEST 移动鼠标，按住或释放鼠标时发
生
WM_NCPAINT 程序发送此消息给某个窗口当它
（窗口）的框架必须被绘制时
WM_NCACTIVATE 此消息发送给某个窗口仅当它的
非客户区需要被改变来显示是激活还是非激活状态
WM_GETDLGCODE 发送此消息给某个与对话框程序
关联的控件，widdows控制方位键和TAB键使输入进入此控件通过应
WM_NCMOUSEMOVE 当光标在一个窗口的非客户区内移动时发送此消息给这个窗口 非客户区为：窗体的标题栏及窗 的边框体
WM_NCLBUTTONDOWN 当光标在一个窗口的非客户区同时按下鼠标左键时提交此消息
WM_NCLBUTTONUP 当用户释放鼠标左键同时光标某个窗口在非客户区十发送此消息 
WM_NCLBUTTONDBLCLK 当用户双击鼠标左键同时光标某个窗口在非客户区十发送此消息
WM_NCRBUTTONDOWN 当用户按下鼠标右键同时光标又在窗口的非客户区时发送此消息
WM_NCRBUTTONUP 当用户释放鼠标右键同时光标又在窗口的非客户区时发送此消息
WM_NCRBUTTONDBLCLK 当用户双击鼠标右键同时光标某个窗口在非客户区十发送此消息
WM_NCMBUTTONDOWN 当用户按下鼠标中键同时光标又在窗口的非客户区时发送此消息
WM_NCMBUTTONUP 当用户释放鼠标中键同时光标又在窗口的非客户区时发送此消息
WM_NCMBUTTONDBLCLK 当用户双击鼠标中键同时光标又在窗口的非客户区时发送此消息
WM_KEYFIRST WM_KEYDOWN 按下一个键
WM_KEYUP 释放一个键
WM_CHAR 按下某键，并已发出WM_KEYDOWN， WM_KEYUP消息
WM_DEADCHAR 当用translatemessage函数翻译
WM_KEYUP消息时发送此消息给拥有焦点的窗口
WM_SYSKEYDOWN 当用户按住ALT键同时按下其它
键时提交此消息给拥有焦点的窗口 
WM_SYSKEYUP 当用户释放一个键同时ALT 键
还按着时提交此消息给拥有焦点的窗口
WM_SYSCHAR 当WM_SYSKEYDOWN消息
被TRANSLATEMESSAGE函数翻译后提交此消息给拥有焦点的窗口
WM_SYSDEADCHAR 当WM_SYSKEYDOWN消息
被TRANSLATEMESSAGE函数翻译后发送此消息给拥有焦点的窗口
WM_INITDIALOG 在一个对话框程序被显示前发
送此消息给它，通常用此消息初始化控件和执行其它任务
WM_COMMAND 当用户选择一条菜单命令项或当某个控件发送一条消息给它的父窗口，一个快捷键被翻译 
WM_SYSCOMMAND 当用户选择窗口菜单的一条命
令或当用户选择最大化或最小化时那个窗口会收到此消息
WM_TIMER 发生了定时器事件
WM_HSCROLL 当一个窗口标准水平滚动条产生一个滚动事件时发送此消息给那个窗口，也发送给拥有它的控件
WM_VSCROLL 当一个窗口标准垂直滚动条产生一个滚动事件时发送此消息给那个窗口也，发送给拥有它的控件 
WM_INITMENU 当一个菜单将要被激活时发送此消息，它发生在用户菜单条中的某项或按下某个菜单键，它允许程序在显示前更改菜单
WM_INITMENUPOPUP 当一个下拉菜单或子菜单将要被激活时发送此消息，它允许程序在它显示前更改菜单，而不要改变全部 
WM_MENUSELECT 当用户选择一条菜单项时发送
此消息给菜单的所有者（一般是窗口）
WM_MENUCHAR 当菜单已被激活用户按下了某个键（不同于加速键），发送此消息给菜单的所有者 
WM_ENTERIDLE 当一个模态对话框或菜单进入空载状态时发送此消息给它的所有者，一个模态对话框或菜单进入空载状态就是在处理完一条或几条先前的消息后没有消息它的列队中等待
WM_CTLCOLORMSGBOX 在windows绘制消息框前发送此消息给消息框的所有者窗口，通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置消息框的文本和背景颜色
WM_CTLCOLOREDIT 当一个编辑型控件将要被绘制
时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置编辑框的文本和背景颜色
WM_CTLCOLORLISTBOX 当一个列表框控件将要被绘制前发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置列表框的文本和背景颜色 
WM_CTLCOLORBTN 当一个按钮控件将要被绘制时
发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置按纽的文本和背景颜色
WM_CTLCOLORDLG 当一个对话框控件将要被绘制
前发送此消息给它的父窗口,通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置对话框的文本背景颜色
WM_CTLCOLORSCROLLBAR 当一个滚动条控件将要被绘制时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置滚动条的背景颜色
WM_CTLCOLORSTATIC 当一个静态控件将要被绘制时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以 通过使用给定的相关显示设备的句柄来设置静态控件的文本和背景颜色
WM_MOUSEFIRST WM_MOUSEMOVE 移动鼠标
WM_LBUTTONDOWN 按下鼠标左键
WM_LBUTTONUP 释放鼠标左键
WM_LBUTTONDBLCLK 双击鼠标左键
WM_RBUTTONDOWN 按下鼠标右键
WM_RBUTTONUP 释放鼠标右键
WM_RBUTTONDBLCLK 双击鼠标右键
WM_MBUTTONDOWN 按下鼠标中键 
WM_MBUTTONUP 释放鼠标中键
WM_MBUTTONDBLCLK 双击鼠标中键
WM_MOUSEWHEEL 当鼠标轮子转动时发送此消息个当前有焦点的控件
WM_PARENTNOTIFY 当MDI子窗口被创建或被销毁
，或用户按了一下鼠标键而光标在子窗口上时发送此消息给它的父窗口
WM_ENTERMENULOOP 发送此消息通知应用程序的
主窗口that已经进入了菜单循环模式
WM_EXITMENULOOP 发送此消息通知应用程序的
主窗口that已退出了菜单循环模式
WM_SIZING 当用户正在调整窗口大小时发送此消息给窗口 通过此消息应用程序可以监视窗口大小和位置也可以修改他们
WM_CAPTURECHANGED 发送此消息 给窗口当它失
去捕获的鼠标时 
WM_MOVING 当用户在移动窗口时发送此消息，通过此消息应用程序可以监视窗口大小和位置也可以修改他们 
WM_POWERBROADCAST 此消息发送给应用程序来通
知它有关电源管理事件 
WM_DEVICECHANGE 当设备的硬件配置改变时
发送此消息给应用程序或设备驱动程序
WM_MDIDESTROY 应用程序发送此消息给多文
档的客户窗口来关闭一个MDI 子窗口
WM_MDIACTIVATE 应用程序发送此消息给多文
档的客户窗口通知客户窗口激活另一个MDI子窗口，当客户窗口收到此消息后，它发出WM_MDIACTIVE消息给MDI子窗口（未激活）激活它 
WM_MDIRESTORE 程序 发送此消息给MDI客户
窗口让子窗口从最大最小化恢复到原来大小
WM_MDINEXT 程序 发送此消息给MDI客户
窗口激活下一个或前一个窗口
WM_MDIMAXIMIZE 程序发送此消息给MDI客户
窗口来最大化一个MDI子窗口 
WM_MDITILE 程序 发送此消息给MDI客户
窗口以平铺方式重新排列所有MDI子窗口
WM_MDICASCADE 程序 发送此消息给MDI客户
窗口以层叠方式重新排列所有MDI子窗口
WM_MDIICONARRANGE 程序 发送此消息给MDI客户窗口重新排列所有最小化的MDI子窗口
WM_MDIGETACTIVE 程序 发送此消息给MDI客户
窗口来找到激活的子窗口的句柄
WM_MDISETMENU 程序 发送此消息给MDI客户
窗口用MDI菜单代替子窗口的菜单
WM_CUT 程序发送此消息给一个编辑框或combobox来删除当前选择的文本
WM_COPY 程序发送此消息给一个编辑框或combobox来复制当前选择的文本到剪贴板
WM_PASTE 程序发送此消息
给editcontrol或combobox从剪贴板中得到数据
WM_CLEAR 程序发送此消息
给editcontrol或combobox清除当前选择的内容 
WM_UNDO 程序发送此消息给editcontrol或combobox撤消最后一次操作
WM_DESTROYCLIPBOARD 当调用ENPTYCLIPBOARD函数时 发送此消息给剪贴板的所有者
WM_DRAWCLIPBOARD 当剪贴板的内容变化时发
送此消息给剪贴板观察链的第一个窗口 它允许用剪贴板观察窗口来显示剪贴板的新内容
WM_PAINTCLIPBOARD 当剪贴板包含CF_OWNERDIPLAY格式的数据并且剪贴板观察窗口的客户区需要重画 
WM_SIZECLIPBOARD 当剪贴板包含CF_OWNERDIPLAY格式的数据并且剪贴板观察窗口的客户区域的大小已经改变是
此消息通过剪贴板观察窗口发送给剪贴板的所有者 
WM_ASKCBformATNAME 通过剪贴板观察窗口发送
此消息给剪贴板的所有者来请求一个CF_OWNERDISPLAY格式的剪贴板的名字
WM_CHANGECBCHAIN 当一个窗口从剪贴板观察
链中移去时发送此消息给剪贴板观察链的第一个窗口 
WM_HSCROLLCLIPBOARD 此消息通过一个剪贴板观察窗口发送给剪贴板的所有者 它发生在当剪贴板包含CFOWNERDISPALY格式的数据并且有个事件在剪贴板观察窗的水平滚动条上 所有者应滚动剪贴板图象并更新滚动条的值 
WM_QUERYNEWPALETTE 此消息发送给将要收到焦
点的窗口，此消息能使窗口在收到焦点时同时有机会实现他的逻辑调色板
WM_PALETTEISCHANGING 当一个应用程序正要实现它的逻辑调色板时发此消息通知所有的应用程序
WM_PALETTECHANGED 此消息在一个拥有焦点的
窗口实现它的逻辑调色板后发送此消息给所有顶级并重叠的窗口，以此来改变系统调色板 
WM_HOTKEY 当用户按下由REGISTERHOTKEY函数注册的热键时提交此消息
WM_PRINT 应用程序发送此消息仅当
WINDOWS或其它应用程序发出一个请求要求绘制一个应用程序的一部分
引用:http://youhello.itpub.net/post/4630/412209
