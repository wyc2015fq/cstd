# 解决强制电脑锁屏的问题 - zhusongziye的博客 - CSDN博客





2018年03月26日 21:31:35[zhusongziye](https://me.csdn.net/zhusongziye)阅读数：2357








今天分享一个小程序，真的很小，主要解决强制电脑锁屏的问题。很多公司出于安全考虑，对员工电脑进行了域策略控制，管理员设置策略，强制组内的PC在一定时间内（比如3分钟）自动锁屏，并且必须输入密码才能解锁。这虽然能避免在公司的安全问题（比如信息泄密），同时也带来很多麻烦，想象一下，小伙子正聚精会神地研究源代码（或其他静态活动），忽然眼前一片黑暗，不得不手动输入复杂的密码。好不容易解了锁，心里却一直担心它锁屏的事，根本没法好好做事。闲话少叙，正文如下 ：

大体的思路是通过程序控制鼠标，定时让鼠标微微动一下，浮动不要太大（移动一个像素就可以了），这样就达到持续让屏幕常亮的效果。以 Windows 系统和 C# 语言为例，C# 通过DllImport 调用 win32 关于鼠标控制的函数，DllImport 是 System.Runtime.InteropServices 命名空间下的属性类，要先引入该命名空间。

#### 1.声明引用

先引入相关类库，声明函数，如下图所示：

![](https://img-blog.csdn.net/20170209222413197?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F0ZXJfMDgxNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

鼠标处理函数在 user32.dll 类库，所以引入这个类库，在系统中的位置如下所示：

![](https://img-blog.csdn.net/20170209222456229?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F0ZXJfMDgxNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

#### 2.调用函数

现在可以使用 mouse_event 编写程序了，以下代码是让鼠标沿 x、y 坐标移动一个像素，如下所示：

![](https://img-blog.csdn.net/20170209222516125?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F0ZXJfMDgxNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

mouse_event 参数含义：

> 
dwFlags： long 常量，鼠标操作类型，可组合（取 |） 
dx： x 轴移动像素 
dy： y 轴移动像素 
cButtons： 0 
dwExtroInfo： 0


dwFlags 常用取值：

> 
MOUSEEVENTF_MOVE = 0x0001; //模拟鼠标移动 
MOUSEEVENTF_LEFTDOWN = 0x0002; //模拟鼠标左键按下 
MOUSEEVENTF_LEFTUP = 0x0004; //模拟鼠标左键抬起 
MOUSEEVENTF_ABSOLUTE = 0x8000; //鼠标绝对位置 
MOUSEEVENTF_RIGHTDOWN = 0x0008; //模拟鼠标右键按下 
MOUSEEVENTF_RIGHTUP = 0x0010; //模拟鼠标右键抬起 
MOUSEEVENTF_MIDDLEDOWN = 0x0020; //模拟鼠标中键按下 
MOUSEEVENTF_MIDDLEUP = 0x0040; //模拟鼠标中键抬起


#### 3.定义定时器

这一步很简单，直接上图：

![](https://img-blog.csdn.net/20170209222933882?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F0ZXJfMDgxNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

这就完成了，运行程序，输入定时器的时间间隔，将它拖到任务栏不碍眼的位置就可以了。



