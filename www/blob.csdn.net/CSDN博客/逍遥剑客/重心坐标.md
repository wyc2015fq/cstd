# 重心坐标 - 逍遥剑客 - CSDN博客
2010年02月05日 14:18:00[xoyojank](https://me.csdn.net/xoyojank)阅读数：5920
[数学](http://writeblog.csdn.net/zh-cn/%E6%95%B0%E5%AD%A6)中，**重心坐标**是由[单形](http://writeblog.csdn.net/zh-cn/%E5%8D%95%E7%BA%AF%E5%BD%A2)（如[三角形](http://writeblog.csdn.net/zh-cn/%E4%B8%89%E8%A7%92%E5%BD%A2)或[四面体](http://writeblog.csdn.net/zh-cn/%E5%9B%9B%E9%9D%A2%E9%AB%94)等）顶点定义的坐标。重心坐标是[齐次坐标](http://writeblog.csdn.net/zh-cn/%E9%BD%90%E6%AC%A1%E5%9D%90%E6%A0%87)的一种。
设 *v*1, ..., *v**n* 是[向量空间](http://writeblog.csdn.net/zh-cn/%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4)*V* 中一个单形的顶点，如果 *V* 中某点 *p* 满足，
![(/lambda_1 + /cdots + /lambda_n)/, p = /lambda_1 /, v_1 + /cdots +/lambda_n /, v_n ,](http://upload.wikimedia.org/math/0/b/5/0b5ae2fdaf41db9b877b5f87a933500e.png)
那么我们称系数 (*λ*1, ..., *λ**n*) 是 *p* 关于 *v*1, ..., *v**n* 的**重心坐标**。这些顶点自己的坐标分别是 (1, 0, 0, ..., 0), (0, 1, 0, ..., 0), ..., (0, 0, 0, ..., 1)。重心坐标不是惟一的：对任何不等于零的 *k*，(*k λ*1, ..., *k λ**n*) 也是 *p* 的重心坐标。但总可以取坐标满足 *λ*1 + ...+ *λ*n = 1，称为**正规化**坐标。注意到定义式在[仿射变换](http://writeblog.csdn.net/zh-cn/%E4%BB%BF%E5%B0%84%E5%8F%98%E6%8D%A2)下不变，故重心坐标具有仿射不变性。
如果坐标分量都非负，则 *p* 在 *v*1, ..., *v**n* 的[凸包](http://writeblog.csdn.net/zh-cn/%E5%87%B8%E5%8C%85)内部，即由这些顶点组成的单形包含 *p*。我们设想如果有[质量](http://writeblog.csdn.net/zh-cn/%E8%B4%A8%E9%87%8F)*λ*1, ..., *λ**n* 分别位于单形的顶点，那么[质量中心](http://writeblog.csdn.net/zh-cn/%E8%B4%A8%E5%BF%83)就是 *p*。这是术语“重心”的起源，[1827年](http://writeblog.csdn.net/zh-cn/1827%E5%B9%B4)由[奥古斯特·费迪南德·莫比乌斯](http://writeblog.csdn.net/zh-cn/%E5%A5%A5%E5%8F%A4%E6%96%AF%E7%89%B9%C2%B7%E8%B4%B9%E8%BF%AA%E5%8D%97%E5%BE%B7%C2%B7%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF)最初引入。
## 三角形的重心坐标
![Areal coordinates.png](http://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Areal_coordinates.png/450px-Areal_coordinates.png)
在[三角形](http://writeblog.csdn.net/zh-cn/%E4%B8%89%E8%A7%92%E5%BD%A2)情形，重心坐标也叫**面积坐AP:PC 标**，因为 *P* 点关于三角形 *ABC* 的重心坐标和三角形 *PBC*, *PCA* 及 *PAB* 的（有向）面积成比例，证明如下（图如右）。
我们用黑体小写字母表示对应点的向量，比如三角形 *ABC* 顶点为 ![/textbf{a}/, ,/textbf{b}/,](http://upload.wikimedia.org/math/b/a/7/ba727ac82f97b063842f87451178763e.png) 和 ![/textbf{c}/,](http://upload.wikimedia.org/math/c/a/a/caa958f2b71fcba3d7b4ee9c2982f473.png)，P 点为 ![/textbf{p}](http://upload.wikimedia.org/math/b/b/2/bb2b0d14e2b2706fe5d77da5b56037b1.png) 等。设 *PBC*, *PCA* 及 *PAB* 面积之比为 ![/lambda_1 :/lambda_2:/lambda_3/,](http://upload.wikimedia.org/math/8/a/c/8ac6167f47e3f4e1324836dce438c7c8.png) 且 λ1 + λ2 + λ3 = 1，设射线 *AP* 与 *BC* 交于 *D*，则
*B**D*:*D**C* = λ2:λ3, 从而 ![/textbf{d}= /frac{/lambda_2 /textbf{b}+/lambda_3 /textbf{c}}{/lambda_2+/lambda_3},](http://upload.wikimedia.org/math/d/f/a/dfacab4bb8fa18f771c3fd20e3cc001c.png)*A**P*:*P**D* = (λ2 + λ3):λ1，故 ![/textbf{p}=/frac{(/lambda_2+/lambda_3) /textbf{d} +/lambda_1 /textbf{a}}{/lambda_1+/lambda_2+/lambda_3}/,,](http://upload.wikimedia.org/math/1/7/5/175ff5154053bc24916289ec381524ff.png)![/textbf{p}=/lambda_1 /textbf{a}+/lambda_2 /textbf{b}+/lambda_3 /textbf{c}/, .](http://upload.wikimedia.org/math/2/f/d/2fd46129d028be6aa048738f76f61727.png)
所以，(λ1,λ2,λ3) 就是 *P* 的重心坐标。
### 坐标变换
给定三角形平面一点 *P*，我们将这一点的面积坐标 ![/lambda_{1}/,](http://upload.wikimedia.org/math/4/d/9/4d90a00dc79023bb097a76015c2df9cb.png)，![/lambda_{2}/,](http://upload.wikimedia.org/math/2/f/2/2f2bfa5c506aa078634b0a3dedd7102e.png) 和 ![/lambda_{3}/,](http://upload.wikimedia.org/math/e/8/4/e84af5786fb000cf9a64c6fb5a1945b9.png) 用[笛卡尔坐标](http://writeblog.csdn.net/zh-cn/%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87)表示出来。
利用笛卡尔坐标中的三角形面积公式：
![S(ABC)=/begin{vmatrix}1 &x_a&y_a//1 &x_b&y_b//1 &x_c&y_c///end{vmatrix}](http://upload.wikimedia.org/math/c/1/a/c1a5177189700824b790a1a144e527de.png)
我们可得：
![/lambda_1=S(PBC)/S(ABC)=/begin{vmatrix}1 &x_p&y_p//1 &x_b&y_b//1 &x_c&y_c///end{vmatrix}/ /begin{vmatrix}1 &x_a&y_a//1 &x_b&y_b//1 &x_c&y_c///end{vmatrix}](http://upload.wikimedia.org/math/d/0/7/d073611560d77ed3d28e488759ebc4a0.png)
类似地有 λ2,λ3，注意 *ABC* 构成一个三角形，上式的分母不可能为 0。
反过来则简单得多：
![/textbf{p}=/lambda_1 /textbf{a}+/lambda_2 /textbf{b}+/lambda_3 /textbf{c} ,](http://upload.wikimedia.org/math/5/7/2/5725186ed50ff20a118688e3a0d8b862.png) 故 *x**p* = λ1*x**a* + λ2*x**b* + λ3*x**c*, 和 *y**p* = λ1*y**a* + λ2*y**b* + λ3*y**c*.
### 判断一点的位置
因重心坐标是笛卡尔坐标的一个线性变换，从而它们在边和三角形区域之间的变化是线性的。如果点在三角形内部，那么所有重心坐标属于开区间 (0,1)；如果一点在三角形的边上，至少有一个面积坐标 λ1...3 为 0，其余分量位于闭区间 [0,1]。如果有某个坐标小于 0，则位于三角形外部，具体分布可参考上图。
### 应用
面积坐标在涉及到三角形子区域的工程学问题时特别有用，经常可以化简解析[积分](http://writeblog.csdn.net/zh-cn/%E7%A7%AF%E5%88%86)求值，[高斯积分法](http://writeblog.csdn.net/w/index.php?title=%E9%AB%98%E6%96%AF%E7%A7%AF%E5%88%86%E6%B3%95&action=edit&redlink=1)表也常以面积坐标的形式给出。
考虑由顶点 ![/textbf{v}_{1}/,](http://upload.wikimedia.org/math/d/4/9/d49770bca26145398fafb8a270de74f9.png), ![/textbf{v}_{2}/,](http://upload.wikimedia.org/math/3/b/0/3b0f9a92f4c667ae6b4ef4395ab64ee3.png) 和 ![/textbf{v}_{3}/,](http://upload.wikimedia.org/math/e/a/d/eadf0d69e64486ebae65c30a1fa032ea.png) 定义的三角形 **T**，任何在三角形内部的点 ![/textbf{p}](http://upload.wikimedia.org/math/b/b/2/bb2b0d14e2b2706fe5d77da5b56037b1.png) 都能写成顶点的加权和：
![/textbf{p} = /lambda_{1} /textbf{v}_{1} + /lambda_{2} /textbf{v}_{2} + /lambda_{3} /textbf{v}_{3},](http://upload.wikimedia.org/math/2/c/a/2ca60ce83591013cd93a7ddebafdfeb7.png)
这里 ![/lambda_{1}/,](http://upload.wikimedia.org/math/4/d/9/4d90a00dc79023bb097a76015c2df9cb.png)、![/lambda_{2}/,](http://upload.wikimedia.org/math/2/f/2/2f2bfa5c506aa078634b0a3dedd7102e.png) 和 ![/lambda_{3}/,](http://upload.wikimedia.org/math/e/8/4/e84af5786fb000cf9a64c6fb5a1945b9.png) 是面积坐标。注意到 ![/lambda_{3} = 1 - /lambda_{1} - /lambda_{2}/,](http://upload.wikimedia.org/math/9/8/b/98bac53d7275e231237b905adb2c76db.png)。 从而，函数 *f* 在 **T** 上的积分为：
![/int_{T} f(/textbf{p}) / ds = 2S /int_{0}^{1} /int_{0}^{1 - /lambda_{2}} f(/lambda_{1} /textbf{v}_{1} + /lambda_{2} /textbf{v}_{2} + (1 - /lambda_{1} - /lambda_{2}) /textbf{v}_{3}) / d/lambda_{1} / d/lambda_{2} /,](http://upload.wikimedia.org/math/1/a/4/1a48d6951e072b97659e5a02c207b992.png)
这里 *S* 是三角形 **T** 的面积。注意上式具有[线性插值](http://writeblog.csdn.net/zh-cn/%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC)的形式。
重心坐标提供了一种[非结构网格](http://writeblog.csdn.net/zh-cn/%E9%9D%9E%E7%BB%93%E6%9E%84%E7%BD%91%E6%A0%BC)上函数插值的方法，假设函数值在所有网格的顶点上已知。如果 ![0 /leq /lambda_i /leq 1 /;/forall/; i /in {1,2,3}](http://upload.wikimedia.org/math/2/8/9/2893d137d1062207f2c0216ab05fc631.png)，则点 ![/textbf{p}](http://upload.wikimedia.org/math/b/b/2/bb2b0d14e2b2706fe5d77da5b56037b1.png) 位于三角形内部或边界上。我们取 *f* 的插值为
![f(/textbf{p}) = /lambda_1 f(/textbf{v}_1) + /lambda_2 f(/textbf{v}_2) + /lambda_3 f(/textbf{v}_3) ,](http://upload.wikimedia.org/math/5/6/6/566065652bc82bfd148ada08e5b1cf7b.png)
这个线性插值是自动[正规](http://writeblog.csdn.net/w/index.php?title=%E6%AD%A3%E8%A7%84%E5%8C%96&action=edit&redlink=1)的因为 λ1 + λ2 + λ3 = 1。
## 四面体的重心坐标
重心坐标容易推广到[三维空间](http://writeblog.csdn.net/zh-cn/%E7%B6%AD%E5%BA%A6)。3 维单形即[四面体](http://writeblog.csdn.net/zh-cn/%E5%9B%9B%E9%9D%A2%E9%AB%94)，具有四个三角形面和四个顶点。
完全类似于三角形，四面体 ![/textbf{v}_1,/textbf{v}_2, /textbf{v}_3,/textbf{v}_4](http://upload.wikimedia.org/math/0/e/a/0ea672e8b33306f953e5ab449cfe9936.png) 的顶点 ![/textbf{v}_1](http://upload.wikimedia.org/math/6/d/d/6ddebbabbbcf6f0dcc4a1397e76a3a65.png)的重心坐标为 (1,0,0,0)，![/textbf{v}_2](http://upload.wikimedia.org/math/c/a/e/cae7d30997f16aa7c44b6b04154ac54a.png) 为 (0,1,0,0)，如是等等。
点 ![/textbf{p}](http://upload.wikimedia.org/math/b/b/2/bb2b0d14e2b2706fe5d77da5b56037b1.png) 的笛卡尔坐标和为关于四面体 ![/textbf{v}_1,/textbf{v}_2, /textbf{v}_3,/textbf{v}_4](http://upload.wikimedia.org/math/0/e/a/0ea672e8b33306f953e5ab449cfe9936.png) 的重心坐标的关系：
![/lambda_1=/text{Vol}(PV_2V_3V_4)//text{Vol}(V_1V_2V_3V_4),/;/lambda_2=/cdots.](http://upload.wikimedia.org/math/b/c/2/bc27162a1149e3ea260be85f71484113.png)
这里 Vol(*V*1*V*2*V*3*V*4) 为 ![/textbf{v}_1,/textbf{v}_2, /textbf{v}_3,/textbf{v}_4](http://upload.wikimedia.org/math/0/e/a/0ea672e8b33306f953e5ab449cfe9936.png) 组成的四面体的体积，类似于三角形也可以用笛卡尔坐标的一个行列式表示出来。
3 维重心坐标和 2 维一样，可以确定一点是否位于四面体内部，也能对四面体网格上函数插值。因为利用重心坐标可以极大地简化 3 维插值，四面体网格经常用于[有限元分析](http://writeblog.csdn.net/zh-cn/%E6%9C%89%E9%99%90%E5%85%83%E5%88%86%E6%9E%90)。
## 参考文献
- Bradley, Christopher J.（2007年）．*The Algebra of Geometry: Cartesian, Areal and Projective Co-ordinates*．Bath：Highperception．[ISBN 978-1-906338-00-8](http://writeblog.csdn.net/zh-cn/Special:%E7%BD%91%E7%BB%9C%E4%B9%A6%E6%BA%90/9781906338008)．
- [Eric W. Weisstein](http://writeblog.csdn.net/zh-cn/%E5%9F%83%E9%87%8C%E5%85%8B%C2%B7%E9%9F%A6%E6%96%AF%E5%9D%A6%E5%9B%A0), [Areal Coordinates](http://mathworld.wolfram.com/ArealCoordinates.html), [MathWorld](http://writeblog.csdn.net/zh-cn/MathWorld). 
- [Eric W. Weisstein](http://writeblog.csdn.net/zh-cn/%E5%9F%83%E9%87%8C%E5%85%8B%C2%B7%E9%9F%A6%E6%96%AF%E5%9D%A6%E5%9B%A0), [Barycentric Coordinates](http://mathworld.wolfram.com/BarycentricCoordinates.html), [MathWorld](http://writeblog.csdn.net/zh-cn/MathWorld). 
## 外部链接
- [重心坐标：一个奇怪的运用](http://www.cut-the-knot.org/triangle/glasses.shtml)（解“三杯子问题”）位于 [cut-the-knot](http://writeblog.csdn.net/zh-cn/Cut-the-knot)
- [齐次重心坐标在平面欧几里得几何中的运用](http://www.math.fau.edu/yiu/barycentricpaper.pdf)
取自“[http://zh.wikipedia.org/zh-cn/%E9%87%8D%E5%BF%83%E5%9D%90%E6%A0%87](http://zh.wikipedia.org/zh-cn/%E9%87%8D%E5%BF%83%E5%9D%90%E6%A0%87)”
