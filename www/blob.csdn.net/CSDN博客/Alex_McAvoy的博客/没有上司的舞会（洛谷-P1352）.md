# 没有上司的舞会（洛谷-P1352） - Alex_McAvoy的博客 - CSDN博客





2018年10月06日 16:35:31[Alex_McAvoy](https://me.csdn.net/u011815404)阅读数：55








## 题目描述

某大学有N个职员，编号为1~N。他们之间有从属关系，也就是说他们的关系就像一棵以校长为根的树，父结点就是子结点的直接上司。现在有个周年庆宴会，宴会每邀请来一个职员都会增加一定的快乐指数Ri，但是呢，如果某个职员的上司来参加舞会了，那么这个职员就无论如何也不肯来参加舞会了。所以，请你编程计算，邀请哪些职员可以使快乐指数最大，求最大的快乐指数。

## 输入输出格式

**输入格式：**

第一行一个整数N。(1<=N<=6000)

接下来N行，第i+1行表示i号职员的快乐指数Ri。(-128<=Ri<=127)

接下来N-1行，每行输入一对整数L,K。表示K是L的直接上司。

最后一行输入0 0

**输出格式：**

输出最大的快乐指数。

## 输入输出样例

**输入样例#1：**

```
7
1
1
1
1
1
1
1
1 3
2 3
6 4
7 4
4 5
3 5
0 0
```

**输出样例#1：**
`5`
————————————————————————————————————————————————————

思路：经典的树形dp

使用 vector<int> son[N]，用 son[i] 来保存节点 i 的所有儿子

用 f[x][0] 表示以 x 为根的子树，且 x 不参加舞会的最大快乐值；用 f[x][1] 表示以 x 为根的子树，且 x 参加了舞会的最大快乐值

则有状态转移方程：f[x][0]=∑{max(f[y][0],f[y][1])}，f[x][1]=∑{f[y][0]}+happy[x]，其中 y 是 x 的儿子

找到唯一的树根 root，则有 res=max(f[root][0],f[root][1])

## 源代码

```cpp
#include<iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#include<algorithm>
#include<string>
#include<cstdlib>
#include<queue>
#include<set>
#include<map>
#include<stack>
#include<ctime>
#include<vector>
#define INF 0x3f3f3f3f
#define PI acos(-1.0)
#define N 10001
#define MOD 10007
#define E 1e-6
#define LL long long
using namespace std;
vector<int> son[N];
int happy[N];
bool vis[N];
int f[N][2];
void treeDP(int x){
    f[x][0]=0;//如果没去，为0
    f[x][1]=happy[x];//如果去了，为相应happy值

    for(int i=0;i<son[x].size();i++){//枚举x的所有孩子
        int y=son[x][i];
        treeDP(y);//递归
        f[x][0]+=max(f[y][0],f[y][1]);//父亲没去的值为孩子去或不去的最大值
        f[x][1]+=f[y][0];//父亲去了的值为孩子不去的值
    }
}
int main()
{
    int n;
    cin>>n;
    for(int i=1;i<=n;i++)
        cin>>happy[i];
    for(int i=1;i<=n-1;i++){
        int x,y;
        cin>>x>>y;
        son[y].push_back(x);//存储职员关系
        vis[x]=true;//标记
    }

    int root;
    for(int i=1;i<=n;i++){  //寻找根节点
        if(!vis[i]){
            root=i;
            break;
        }
    }

    treeDP(root);//对根节点进行dp
    int res=max(f[root][0],f[root][1]);//比较根节点去或不去
    cout<<res<<endl;

	return 0;
}
```





