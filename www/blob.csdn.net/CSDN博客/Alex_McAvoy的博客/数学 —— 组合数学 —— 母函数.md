# 数学 —— 组合数学 —— 母函数 - Alex_McAvoy的博客 - CSDN博客





2018年08月04日 12:15:33[Alex_McAvoy](https://me.csdn.net/u011815404)阅读数：94








# 【概述】

母函数是求解组合数学中计数问题的重要方法，效率高，编程规范，容易实现。

对于序列 ![\{a_0,a_1,a_2,...\}](https://private.codecogs.com/gif.latex?%5C%7Ba_0%2Ca_1%2Ca_2%2C...%5C%7D)，定义 ![G(x)=a_0+a_1x+a_2x^2+...](https://private.codecogs.com/gif.latex?G%28x%29%3Da_0&plus;a_1x&plus;a_2x%5E2&plus;...) 为序列 ![\{a_0,a_1,a_2,...\}](https://private.codecogs.com/gif.latex?%5C%7Ba_0%2Ca_1%2Ca_2%2C...%5C%7D) 的母函数。

例如：![(1+x)^n](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En) 就是 ![C(n,0),C(n,1),C(n,2),...,C(n,n)](https://private.codecogs.com/gif.latex?C%28n%2C0%29%2CC%28n%2C1%29%2CC%28n%2C2%29%2C...%2CC%28n%2Cn%29) 的母函数

也就是说，我们可以利用 ![(1+x)^n](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En) 来讨论序列![\{C(n,k)\}](https://private.codecogs.com/gif.latex?%5C%7BC%28n%2Ck%29%5C%7D) 的性质，还可以引入适当的函数，将问题简化，把复杂的问题变成形式上的初等代数运算。

# 【普通型母函数】

## 1.杨辉三角与母函数

杨辉三角中第 n 行的数字就是 ![(1+x)^n](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En) 的展开式从低项到高项的各项系数。

而 ![(1+x)^n=C_n^01^nx^0+C_n^11^{n-1}x^1+...+C_n^r1^{n-r}x^r+...+](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En%3DC_n%5E01%5Enx%5E0&plus;C_n%5E11%5E%7Bn-1%7Dx%5E1&plus;...&plus;C_n%5Er1%5E%7Bn-r%7Dx%5Er&plus;...&plus;)![C_n^{n-1}1^{1}x^{n-1}+C_n^n1^{0}x^n](https://private.codecogs.com/gif.latex?C_n%5E%7Bn-1%7D1%5E%7B1%7Dx%5E%7Bn-1%7D&plus;C_n%5En1%5E%7B0%7Dx%5En)

![=C_n^0+C_n^1x+...+C_n^rx^r+...+C_n^{n-1}x^{n-1}+C_n^nx^n](https://private.codecogs.com/gif.latex?%3DC_n%5E0&plus;C_n%5E1x&plus;...&plus;C_n%5Erx%5Er&plus;...&plus;C_n%5E%7Bn-1%7Dx%5E%7Bn-1%7D&plus;C_n%5Enx%5En)

所以，有如下形式的杨辉三角：

![](https://img-blog.csdn.net/20180804115043302?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTE4MTU0MDQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

将 (1+x) 与选择物品联系起来，在构造和分析一个母函数时，1 一般看成 ![x^0](https://private.codecogs.com/gif.latex?x%5E0)，用于表示没有选取一个物品，![x^1](https://private.codecogs.com/gif.latex?x%5E1) 可以看成选择了一个物品。因此 ![(1+x)^n](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En) 可以对应于从 n 件物品中选取了若干件物品的情况。

在一个具体的物品选择中，如果没有选择第 i 件物品，则相当于从第 i 个括号中选取了 ![x^0](https://private.codecogs.com/gif.latex?x%5E0) ，如果选择了第 i 件物品，这相当于从第 i 个括号中选择了 ![x^1](https://private.codecogs.com/gif.latex?x%5E1)，这样，在 ![(1+x)^n](https://private.codecogs.com/gif.latex?%281&plus;x%29%5En) 的展开式中，![x^i](https://private.codecogs.com/gif.latex?x%5Ei) 前面的系数就是从 n 件物品选取了 i 件物品的所有组合情况的总数，即 ![C(n,i)](https://private.codecogs.com/gif.latex?C%28n%2Ci%29)

## 2.普通母函数

1）母函数

给定数列 ![\{a_0,a_1,a_2,...,a_n,...\}](https://private.codecogs.com/gif.latex?%5C%7Ba_0%2Ca_1%2Ca_2%2C...%2Ca_n%2C...%5C%7D)，构造一个函数 ![F(x)=a_0f_0(x)+a_1f_1(x)+...+a_nf_n(x)+...](https://private.codecogs.com/gif.latex?F%28x%29%3Da_0f_0%28x%29&plus;a_1f_1%28x%29&plus;...&plus;a_nf_n%28x%29&plus;...)，称 F(x) 为数列 ![\{a_0,a_1,a_2,...,a_n,...\}](https://private.codecogs.com/gif.latex?%5C%7Ba_0%2Ca_1%2Ca_2%2C...%2Ca_n%2C...%5C%7D) 的母函数，其中，序列 ![f_0(x),f_1(x),...,f_n(x),...](https://private.codecogs.com/gif.latex?f_0%28x%29%2Cf_1%28x%29%2C...%2Cf_n%28x%29%2C...) 只作为标志用，称为标志函数。

2）母函数的一般形式

标志函数最重要的形式是 ![x^n](https://private.codecogs.com/gif.latex?x%5En)，这种情况下的母函数一般形式为：![F(x)=a_0+a_1x+a_2x^2+...+a_nx^n+...](https://private.codecogs.com/gif.latex?F%28x%29%3Da_0&plus;a_1x&plus;a_2x%5E2&plus;...&plus;a_nx%5En&plus;...)

3）母函数定理

设从 n 元集合 ![S=\{a_1,a_2,...,a_n\}](https://private.codecogs.com/gif.latex?S%3D%5C%7Ba_1%2Ca_2%2C...%2Ca_n%5C%7D) 中取 k 个元素的组合是 ![b_k](https://private.codecogs.com/gif.latex?b_k)，若限定元素 ![a_i](https://private.codecogs.com/gif.latex?a_i) 出现次数的集合为 ![M_i(1\leqslant i\leqslant n)](https://private.codecogs.com/gif.latex?M_i%281%5Cleqslant%20i%5Cleqslant%20n%29)，则该组合数序列的母函数为：![\prod_{i=1}^{n}(\sum_{m\in M_i}x^m)](https://private.codecogs.com/gif.latex?%5Cprod_%7Bi%3D1%7D%5E%7Bn%7D%28%5Csum_%7Bm%5Cin%20M_i%7Dx%5Em%29)

4）常见母函数

![1/(1-x)=1+x+x^2+x^3+...](https://private.codecogs.com/gif.latex?1/%281-x%29%3D1&plus;x&plus;x%5E2&plus;x%5E3&plus;...)

![1/(1-x)^2=1/((1-x)*(1-x))=1+2x+3x^2+...](https://private.codecogs.com/gif.latex?1/%281-x%29%5E2%3D1/%28%281-x%29*%281-x%29%29%3D1&plus;2x&plus;3x%5E2&plus;...)

![1/(1-x)^n=1+nx+(n*(n+1)/2!)x^2+(n*(n+1)*(n+2)/3!)x^3+...](https://private.codecogs.com/gif.latex?1/%281-x%29%5En%3D1&plus;nx&plus;%28n*%28n&plus;1%29/2%21%29x%5E2&plus;%28n*%28n&plus;1%29*%28n&plus;2%29/3%21%29x%5E3&plus;...)

5）例题

有重量为 1，3，5 的砝码各两个，求：

① 可以称出多少种质量不同的物品？

② 若要称出重量为 7 的物品，所用砝码有多少种本质不同的情况？

分析：

根据母函数定理，构造母函数：![G(x)=(1+x+x^2)(1+x^3+x^6)(1+x^5+x^{10})](https://private.codecogs.com/gif.latex?G%28x%29%3D%281&plus;x&plus;x%5E2%29%281&plus;x%5E3&plus;x%5E6%29%281&plus;x%5E5&plus;x%5E%7B10%7D%29)

其中，第一个括号的 1 表示不用重量为 1 的砝码，x 表示用 1 个重量为 1 的砝码，![x^2](https://private.codecogs.com/gif.latex?x%5E2) 表示用 2 个重量为 1 的砝码，第 2、3 个括号中的含义类似。

将多项式展开后，得到诸如 ![x^2*1*x^5](https://private.codecogs.com/gif.latex?x%5E2*1*x%5E5) 之类的多项式，它表示用 2 个重量为 1 的砝码，0 个重量为 3 的砝码，1 个重量为 5 的砝码，可以称出一个重量为 7 个物品。

显然，将 G(x) 展开并合并同类项后，有多少个非 0 系数项就代表了可以称出多少种不同重量的物品，而相应的 ![x^i](https://private.codecogs.com/gif.latex?x%5Ei) 前面的系数就表明了称出重量为 i 的物品可选砝码方案数。

故：![G(x)=1+x+x^2+x^3+x^4+2x^5+2x^6+2x^7+2x^8+x^9+2x^{10}+2x^{11}](https://private.codecogs.com/gif.latex?G%28x%29%3D1&plus;x&plus;x%5E2&plus;x%5E3&plus;x%5E4&plus;2x%5E5&plus;2x%5E6&plus;2x%5E7&plus;2x%5E8&plus;x%5E9&plus;2x%5E%7B10%7D&plus;2x%5E%7B11%7D)

![+2x^{12}+2x^{13}+x^{14}+x^{15}+x^{16}+x^{17}+x^{18}](https://private.codecogs.com/gif.latex?&plus;2x%5E%7B12%7D&plus;2x%5E%7B13%7D&plus;x%5E%7B14%7D&plus;x%5E%7B15%7D&plus;x%5E%7B16%7D&plus;x%5E%7B17%7D&plus;x%5E%7B18%7D)

因此，问题 ① 的解为：19，问题 ② 的解为：2

# 【指数型母函数】

1.指数型母函数定理

从多重集合 ![M=\{\infty *a_1,\infty *a_2,\infty *a_3,...,\infty *a_n\}](https://private.codecogs.com/gif.latex?M%3D%5C%7B%5Cinfty%20*a_1%2C%5Cinfty%20*a_2%2C%5Cinfty%20*a_3%2C...%2C%5Cinfty%20*a_n%5C%7D) 中选取 k 个元素的排列中，若限定元素 ![a_i](https://private.codecogs.com/gif.latex?a_i) 出现的次数集合为 ![M_i(1\leqslant i\leqslant n)](https://private.codecogs.com/gif.latex?M_i%281%5Cleqslant%20i%5Cleqslant%20n%29)，则该组合数序列的母函数为：![\prod_{i=1}^{n}(\sum_{m\in M_i}x^m/m!)](https://private.codecogs.com/gif.latex?%5Cprod_%7Bi%3D1%7D%5E%7Bn%7D%28%5Csum_%7Bm%5Cin%20M_i%7Dx%5Em/m%21%29)

2.标志函数

普通型母函数的标志函数为：![1,x,x^2,x^3,...](https://private.codecogs.com/gif.latex?1%2Cx%2Cx%5E2%2Cx%5E3%2C...)

指数型母函数的标志函数为：![1,x/1!,x^2/2!,x^3/3!,...](https://private.codecogs.com/gif.latex?1%2Cx/1%21%2Cx%5E2/2%21%2Cx%5E3/3%21%2C...)

3.物理意义

指数型母函数的标志函数可以这样理解：对于 ![x^i/j!](https://private.codecogs.com/gif.latex?x%5Ei/j%21) 表示在一个方案中某个元素出现了 j 次，而在不同的位置中的 j 次出现是相同的，所以在排列计算总数时，只应算作一次，由排列组合的知识知道，最后的结果应该除以 ![j!](https://private.codecogs.com/gif.latex?j%21)

4.简化形式

指数型母函数在使用过程中，一般会用到高等数学中的 ![e^x](https://private.codecogs.com/gif.latex?e%5Ex) 的泰勒展开式：

![e^x=\sum_{n=0}^\infty x^n/n!=1+x+x^2/2!+x^3/3!+...+x^n/n!+...](https://private.codecogs.com/gif.latex?e%5Ex%3D%5Csum_%7Bn%3D0%7D%5E%5Cinfty%20x%5En/n%21%3D1&plus;x&plus;x%5E2/2%21&plus;x%5E3/3%21&plus;...&plus;x%5En/n%21&plus;...)

因此，指数型母函数可以简化为：

![G_e(x)=b_0+b_1*(x/1!)+b_2*(x^2/2!)+b_3*(x^3/3!)+...](https://private.codecogs.com/gif.latex?G_e%28x%29%3Db_0&plus;b_1*%28x/1%21%29&plus;b_2*%28x%5E2/2%21%29&plus;b_3*%28x%5E3/3%21%29&plus;...)，其中，只有 ![b_i](https://private.codecogs.com/gif.latex?b_i) 是所需的结果。

5.例题

设有六位数字，其中三个数字1，两个数字6，一个数字8，求能组成多少个四位数？

分析：

这个题实际上是求 ![S=\{3x_1,2x_2,1x_3\}](https://private.codecogs.com/gif.latex?S%3D%5C%7B3x_1%2C2x_2%2C1x_3%5C%7D) 中取四个多重集排列数问题，其指数型母函数为：

![G_e(x)=(1+x+x^2/2!+x^3/3!)*+(1+x+x^2/2!)*(1+x)](https://private.codecogs.com/gif.latex?G_e%28x%29%3D%281&plus;x&plus;x%5E2/2%21&plus;x%5E3/3%21%29*&plus;%281&plus;x&plus;x%5E2/2%21%29*%281&plus;x%29)

![=1+3x+8(x^2/2!)+19(x^3/3!)+38(x^4/4!)+60(x^5/5!)+60(x^6/6!)](https://private.codecogs.com/gif.latex?%3D1&plus;3x&plus;8%28x%5E2/2%21%29&plus;19%28x%5E3/3%21%29&plus;38%28x%5E4/4%21%29&plus;60%28x%5E5/5%21%29&plus;60%28x%5E6/6%21%29)

因此，可以取38个四位数



