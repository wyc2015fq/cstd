# 借教室（洛谷-P1083） - Alex_McAvoy的博客 - CSDN博客





2019年03月25日 18:42:11[Alex_McAvoy](https://me.csdn.net/u011815404)阅读数：15








> 
## 题目描述

在大学期间，经常需要租借教室。大到院系举办活动，小到学习小组自习讨论，都需要向学校申请借教室。教室的大小功能不同，借教室人的身份不同，借教室的手续也不一样。

面对海量租借教室的信息，我们自然希望编程解决这个问题。

我们需要处理接下来n天的借教室信息，其中第i天学校有ri​个教室可供租借。共有m份订单，每份订单用三个正整数描述，分别为dj​,sj​,tj​，表示某租借者需要从第sj​天到第tj​天租借教室（包括第sj​天和第tj​天），每天需要租借dj​个教室。

我们假定，租借者对教室的大小、地点没有要求。即对于每份订单，我们只需要每天提供dj​个教室，而它们具体是哪些教室，每天是否是相同的教室则不用考虑。

借教室的原则是先到先得，也就是说我们要按照订单的先后顺序依次为每份订单分配教室。如果在分配的过程中遇到一份订单无法完全满足，则需要停止教室的分配，通知当前申请人修改订单。这里的无法满足指从第sj​天到第tj​天中有至少一天剩余的教室数量不足dj​个。

现在我们需要知道，是否会有订单无法完全满足。如果有，需要通知哪一个申请人修改订单。

## 输入输出格式

**输入格式：**

第一行包含两个正整数n,m，表示天数和订单的数量。

第二行包含n个正整数，其中第i个数为ri​，表示第ii天可用于租借的教室数量。

接下来有m行，每行包含三个正整数dj​,sj​,tj​，表示租借的数量，租借开始、结束分别在第几天。

每行相邻的两个数之间均用一个空格隔开。天数与订单均用从1开始的整数编号。

**输出格式：**

如果所有订单均可满足，则输出只有一行，包含一个整数0。否则（订单无法完全满足）

输出两行，第一行输出一个负整数-1，第二行输出需要修改订单的申请人编号。

## 输入输出样例

**输入样例#1：**

**4 3 2 5 4 3 2 1 3 3 2 4 4 2 4**

**输出样例#1：**

**-1 2**


思路：

首先，判断当前状态所有任务是否能够满足每天借教室的量在允许范围内，然后用差分数组记录当前状态在每天对教室的总需求与前一天的差值，那么很容易求得每一天的实际值：n[i]=sum(f[i])

然后与当天允许的教室数量进行比较，若大于提供量，则不可借出，之后检测 m 种任务能否同时执行，若可行则直接输出0，若不可行就二分答案，直到该状态所有任务都可满足

## 源代码

```cpp
#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<string>
#include<cstring>
#include<cmath>
#include<ctime>
#include<algorithm>
#include<utility>
#include<stack>
#include<queue>
#include<vector>
#include<set>
#include<map>
#define PI acos(-1.0)
#define E 1e-9
#define INF 0x3f3f3f3f
#define LL long long
const int MOD=1000000007;
const int N=1000000+5;
const int dx[]= {-1,1,0,0};
const int dy[]= {0,0,-1,1};
using namespace std;

int n,m;
struct Node{
    int num;//要租借的数量
    int start,endd;//租借开始与结束时间
}a[N];
int f[N];
int admit[N];//每天允许借出数量
bool judge(int x){//判断m个订单能否同时执行
    memset(f,0,sizeof(f));
    for(int i=1;i<=x;i++){//差分数组
        f[a[i].start]+=a[i].num;
        f[a[i].endd+1]-=a[i].num;
    }

    int sum=0;
    for(int i=1;i<=n;i++){//查询第i天的值
        sum+=f[i];
        if(sum>admit[i])
            return false;
    }
    return true;
}
int main(){
    scanf("%d%d",&n,&m);
    for(int i=1;i<=n;i++)
        scanf("%d",&admit[i]);
    for(int i=1;i<=m;i++)
        scanf("%d%d%d",&a[i].num,&a[i].start,&a[i].endd);

    if(judge(m))
            printf("0\n");
    else{//二分答案
        int left=1,right=m;
        while(left<right){
            int mid=(left+right)/2;
            if(judge(mid)) 
                left=mid+1;
            else 
                right=mid;
        }
        printf("-1\n%d\n",left);
    }
    return 0;
}
```





