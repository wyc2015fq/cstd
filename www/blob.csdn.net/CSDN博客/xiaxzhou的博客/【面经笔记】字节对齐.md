# 【面经笔记】字节对齐 - xiaxzhou的博客 - CSDN博客





2017年08月01日 15:15:59[xiaxzhou](https://me.csdn.net/xiaxzhou)阅读数：180








字节对齐以及为什么要字节对齐？

字节对齐的相关规则，举例一个char型数据，在内存中会分配多少字节？

### 为什么要字节对齐：

需要字节对齐的根本原因在于CPU访问数据的效率问题。假设整型变量（int）的地址不是自然对齐，比如为0x00000002，则CPU如果取它的值的话需要访问两次内存，**第一次**取从0x00000002-0x00000003的一个short，**第二次**取从0x00000004-0x00000005的一个short然后组合得到所要的数据，如果变量在0x00000003地址上的话则要**访问三次内存**，第一次为char，第二次为short，第三次为char，然后组合得到整型数据。而如果变量在自然对齐位置上，则只要**一次**就可以取出数据。

### 字节对齐规则：

自然边界：一个变量的内存地址正好位于它长度的整数倍，他就被称做自然对齐
- 结构体变量的首地址能被其最宽**基本类型**成员的大小整除
- 结构体每个成员相对于结构体首地址的偏移量都是**成员大小**的整数倍
- 结构体的总字节数应当保证为内部数据最宽**基本类型**成员大小的整数倍

数组 ：按照基本数据类型对齐，第一个对齐了后面的自然也就对齐了。  

联合 ：按其包含的长度最大的数据类型对齐。 



