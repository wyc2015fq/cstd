# 页面的缓存与不缓存设置 - weixin_33985507的博客 - CSDN博客
2015年02月11日 10:37:00[weixin_33985507](https://me.csdn.net/weixin_33985507)阅读数：4
HTML的HTTP协议头信息中控制着页面在几个地方的缓存信息，包括浏览器端，中间缓存服务器端(如：squid等)，Web服务器端。本文讨论 头信息 中带缓存控制信息的HTML页面(JSP/Servlet生成好出来的也是HTML页面)在中间缓存服务器中的缓存情况。
      HTTP协议中关于缓存的信息头关键字包括Cache-Control(HTTP1.1)，Pragma(HTTP1.0)，last-Modified，Expires等。
      HTTP1.0中通过**Pragma ** 控制页面缓存，可以设置：Pragma或no-cache。网上有非常多的文章说明如何控制不让浏览器或中间缓存服务器缓存页面，通常设置的值为no- cache，不过这个值不这么保险，通常还加上Expires置为0来达到目的。但是如我们刻意需要浏览器或缓存服务器缓存住我们的页面这个值则要设置为 Pragma。
      HTTP1.1中启用**Cache-Control ** 来控制页面的缓存与否，这里介绍几个常用的参数：
- no-cache，浏览器和缓存服务器都不应该缓存页面信息；
- public，浏览器和缓存服务器都可以缓存页面信息；
- no-store，请求和响应的信息都不应该被存储在对方的磁盘系统中；
- must-revalidate，对于客户机的每次请求，代理服务器必须想服务器验证缓存是否过时；
       Last-Modified只页面的最后生成时间，GMT格式；
       Expires过时期限值，GMT格式，指浏览器或缓存服务器在该时间点后必须从真正的服务器中获取新的页面信息；
       上面两个值在JSP中设置值为字符型的GMT格式，无法生效，设置long类型才生效；
下面是一个测试例子：
```
package com.servlet;
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
public class ServletA extends HttpServlet {
    @Override
    public void service(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        //servlet页面默认是不缓存的
        //本页面允许在浏览器端或缓存服务器中缓存，时限为20秒。
        //20秒之内重新进入该页面的话不会进入该servlet的
        java.util.Date date = new java.util.Date();    
        response.setDateHeader("Last-Modified",date.getTime()); //Last-Modified:页面的最后生成时间 
        response.setDateHeader("Expires",date.getTime()+20000); //Expires:过时期限值 
        response.setHeader("Cache-Control", "public"); //Cache-Control来控制页面的缓存与否,public:浏览器和缓存服务器都可以缓存页面信息；
        response.setHeader("Pragma", "Pragma"); //Pragma:设置页面是否缓存，为Pragma则缓存，no-cache则不缓存
        //不允许浏览器端或缓存服务器缓存当前页面信息。
        /*response.setHeader( "Pragma", "no-cache" );   
        response.setDateHeader("Expires", 0);   
        response.addHeader( "Cache-Control", "no-cache" );//浏览器和缓存服务器都不应该缓存页面信息
        response.addHeader( "Cache-Control", "no-store" );//请求和响应的信息都不应该被存储在对方的磁盘系统中；    
        response.addHeader( "Cache-Control", "must-revalidate" );*///于客户机的每次请求，代理服务器必须想服务器验证缓存是否过时；
        System.out.println("进入了servlet");
        response.getWriter().write("欢迎光临我的主页");
    }
    
}
```
如果需要在html页面上设置不缓存，这在<head>标签中加入如下语句：
```
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
```
**附：html页面中meta的作用**
　　meta是用来在HTML文档中模拟HTTP协议的响应头报文。meta 标签用于网页的<head>与</head>中，meta 标签的用处很多。meta 的属性有两种：name和http-equiv。name属性主要用于描述网页，对应于content（网页内容），以便于搜索引擎机器人查找、分类（目 前几乎所有的搜索引擎都使用网上机器人自动查找meta值来给网页分类）。这其中最重要的是description（站点在搜索引擎上的描述）和 keywords（分类关键词），所以应该给每页加一个meta值。比较常用的有以下几个：
**name 属性**
　　1、<meta name="Generator" contect="">用以说明生成工具（如Microsoft FrontPage 4.0）等；
　　2、<meta name="KEYWords" contect="">向搜索引擎说明你的网页的关键词；
　　3、<meta name="DEscription" contect="">告诉搜索引擎你的站点的主要内容；
　　4、<meta name="Author" contect="你的姓名">告诉搜索引擎你的站点的制作的作者；
　　5、<meta name="Robots" contect= "all|none|index|noindex|follow|nofollow">
　　其中的属性说明如下：
　　设定为all：文件将被检索，且页面上的链接可以被查询；
　　设定为none：文件将不被检索，且页面上的链接不可以被查询；
　　设定为index：文件将被检索；
　　设定为follow：页面上的链接可以被查询；
　　设定为noindex：文件将不被检索，但页面上的链接可以被查询；
　　设定为nofollow：文件将不被检索，页面上的链接可以被查询。
**http-equiv属性**
　　1、<meta http-equiv="Content-Type" contect="text/html";charset=gb_2312-80">
和 <meta http-equiv="Content-Language" contect="zh-CN">用以说明主页制作所使用的文字以及语言；
　　又如英文是ISO-8859-1字符集，还有BIG5、utf-8、shift-Jis、Euc、Koi8-2等字符集；
　　2、<meta http-equiv="Refresh" contect="n;url=http://yourlink">定时让网页在指定的时间n内，跳转到页面http://yourlink；
　　3、<meta http-equiv="Expires" contect="Mon,12 May 2001 00:20:00 GMT">可以用于设定网页的到期时间，一旦过期则必须到服务器上重新调用。需要注意的是必须使用GMT时间格式；
　　4、<meta http-equiv="Pragma" contect="no-cache">是用于设定禁止浏览器从本地机的缓存中调阅页面内容，设定后一旦离开网页就无法从Cache中再调出；
　　5、<meta http-equiv="set-cookie" contect="Mon,12 May 2001 00:20:00 GMT">cookie设定，如果网页过期，存盘的cookie将被删除。需要注意的也是必须使用GMT时间格式；
　　6、<meta http-equiv="Pics-label" contect="">网页等级评定，在IE的internet选项中有一项内容设置，可以防止浏览一些受限制的网站，而网站的限制级别就是通过meta属性来设置的；
　　7、<meta http-equiv="windows-Target" contect="_top">强制页面在当前窗口中以独立页面显示，可以防止自己的网页被别人当作一个frame页调用；
　　8、<meta http-equiv="Page-Enter" contect="revealTrans(duration=10,transtion= 50)">和<meta http-equiv="Page-Exit" contect="revealTrans(duration=20，transtion=6)">设定进入和离开页面时的特殊效果，这个功能即 FrontPage中的“格式/网页过渡”，不过所加的页面不能够是一个frame页面。
```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<%
response.setHeader("Cache-Control","no-store"); //HTTP 1.1 
response.setHeader("Pragma","no-cache"); //HTTP 1.0
response.setDateHeader("Expires", 0);    //保证每次对页面的访问都是最新的
%> 
<%@ page contentType="text/html; charset=UTF-8" %>
<%@ page import="com.hundsun.tamcx.system.base.UserInfo" %>
<%@ page import="com.hundsun.tamcx.common.Constant" %>
<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="StyleSheet" href="../js/dtree.css" type="text/css" />
<script type="text/javascript" src="../js/dtreeMain.js"></script>
<SCRIPT type=text/javascript>
</SCRIPT>
</head>
<body leftmargin="0" topmargin="0">
</body>
</html>
```
