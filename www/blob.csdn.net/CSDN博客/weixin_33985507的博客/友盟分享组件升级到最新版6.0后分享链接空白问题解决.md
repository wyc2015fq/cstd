# 友盟分享组件升级到最新版6.0后分享链接空白问题解决 - weixin_33985507的博客 - CSDN博客
2018年09月30日 19:16:00[weixin_33985507](https://me.csdn.net/weixin_33985507)阅读数：11
最近将友盟分享组件升级到了最新的版本6.0版本，并使用了分享组件的精简版，下面是Podfile
```
pod 'UMCCommon'
pod 'UMCAnalytics'
pod 'UMCSecurityPlugins'
pod 'UMCCommonLog'
pod 'UMCShare/Social/ReducedWeChat'
pod 'UMCShare/Social/ReducedQQ'
pod 'UMCShare/Social/ReducedSina'
```
然而升级完成后，测试发现QQ分享总是异常，分享的连接总是空白连接 **http://**，而且微信好友分享也是有问题，有时虽然跳转到微信了，但是不能选择好友进行分享。
![14125002-72a8791c49799c96.png](https://upload-images.jianshu.io/upload_images/14125002-72a8791c49799c96.png)
image.png
最后发现是因为分享链接**url中含有中文符号导致的**
```
# 分享url，含有中文“黄金”    
https://xiaoqiwang01.com/share/share.html?days=1&length=OneDay&win=150&income=150.00&spend=100.00&pname=黄金1812&final=0.149&type=call&uname=199*****286&ref=100097&strikeLower=0.05&strikeUpper=
```
所以应该是旧版本的友盟分享sdk中自动进行了中文的encode编码，而新版本没有进行编码，所以导致了此问题，解决办法就是对要分享的url进行encode
```
+(NSString *)URLEncodedString:(NSString *)str  {
    NSString *encodedString = [str stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLQueryAllowedCharacterSet]];
    
    return encodedString;
    
}
```
进过encode后的url如下，中文变成了unicode编码
```
https://xiaoqiwang01.com/share/share.html?days=1&length=OneDay&win=150&income=150.00&spend=100.00&pname=\U9ec4\U91d11812&final=0.149&type=call&uname=199*****286&ref=100097&strikeLower=0.05&strikeUpper=
```
然后再测试，就没问题了
