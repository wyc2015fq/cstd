# IEEE1588精确网络时钟同步协议简介 II - weixin_33985507的博客 - CSDN博客
2012年10月14日 20:33:00[weixin_33985507](https://me.csdn.net/weixin_33985507)阅读数：24
支持1588协议的设备在规范中称为“时钟”，下文中我们同样用“时钟（clock）”来指代支持1588协议的设备。
**1588拓补结构**
当1588运行于以太网时，虽然以太网本身禁止环路，但1588为了能在非以太网环境下运行，协议本身也能够检测到环路，并在逻辑上将其断开。对于非以太网环境，我们暂时不去关注它。对使用以太网介质的1588同步系统来说，一条同步链路的两端分别是master clock和slave clock；master clock周期性发出携带自身时钟信息的同步报文，slave提取报文中的时钟信息，并利用该信息来不断修正自身的时钟。最简单的情况是，整个系统由两个网络终端构成：
|M| -------------------- |S|
Master和Slave分别是两个终端。
如果系统中存在两个以上的网络终端，那么需要一台支持1588的交换机：
|----M----M----M----M----|
     |    |    |    |
    |S|  |S|  |S|  |S|
上图是一台4端口1588交换机，每个端口上都挂一台终端。交换机的每个端口都是master，所有的终端都是slave clock。交换机的每个端口都同步到交换机内部的同一个时钟，所以4个端口之间是彼此同步的，而slave又分别和与其相连的交换机端口同步，于是最终4个slave也是同步的。
但也有可能挂在交换机上的某个终端是master：
|----S----M----M----M----|
     |    |    |    |
    |M|  |S|  |S|  |S|
此时4个网络终端中的一个是master，与之相连的交换机端口是slave。交换机将自身时钟同步到终端M，并将同步后的自身时钟信息用同步报文发送给其余三个终端。这样，交换机同步到终端M，而三个S终端又同步到交换机，于是4个终端仍然是同步的。此时，终端M是同步的源头。
当然，交换机是可以级联的，这样就形成了Tree结构。Tree的root节点我们称其为Grandmaster，所有的下层节点最终都将同步到Grandmaster。Grandmaster可以是
1）支持1588的交换机，此时交换机的每个端口都是master；
2）网络终端，该网络终端或者连接到交换机，或者连接到另一个终端
    a. 如果连接到另一个终端，那么另一个终端就是slave；
    b  如果连接到交换机，那么该交换机与之相连的端口是slave，其余端口是master。
![image](https://images.cnblogs.com/cnblogs_com/byeyear/201210/201210142032394137.png)
上图引自IEEE1588-2008。图中clock-1是grandmaster，也是Tree的root。
我们将在下面一篇文章中讲述上图中的两个名词：Ordinary clock，Boundary clock，以及没有出现在图中但与之相关的E2E Transparent clock和P2P Transparent clock。
