# 经典算法研究系列：七、深入浅出遗传算法 - 结构之法 算法之道 - CSDN博客





2011年01月12日 20:57:00[v_JULY_v](https://me.csdn.net/v_JULY_v)阅读数：97587标签：[算法																[优化																[生物																[图像处理																[数据挖掘](https://so.csdn.net/so/search/s.do?q=数据挖掘&t=blog)
个人分类：[01.Algorithms（研究）](https://blog.csdn.net/v_JULY_v/article/category/769275)

所属专栏：[经典算法研究](https://blog.csdn.net/column/details/Dijkstra.html)](https://so.csdn.net/so/search/s.do?q=图像处理&t=blog)




**经典算法研究系列：七、深入浅出****遗传算法**





作者:July    二零一一年一月十二日。

本文参考：维基百科  华南理工大学电子讲义  互联网

-------------------------------------------------------------------------------



**一、初探遗传算法**

Ok，先看维基百科对遗传算法所给的解释：

遗传算法是计算数学中用于解决最优化的搜索算法，是进化算法的一种。进化算法最初是借鉴了进化生物学中的一些现象而发展起来的，这些现象包括遗传、突变、自然选择以及杂交等。



遗传算法通常实现方式为一种计算机模拟。对于一个最优化问题，一定数量的候选解（称为个体）的抽象表示（称为染色体）的种群向更好的解进化。传统上，解用二进制表示（即0和1的串），但也可以用其他表示方法。进化从完全随机个体的种群开始，之后一代一代发生。在每一代中，整个种群的适应度被评价，从当前种群中随机地选择多个个体（基于它们的适应度），通过自然选择和突变产生新的生命种群，该种群在算法的下一次迭代中成为当前种群。



光看定义，可能思路并不清晰，咱们来几个清晰的图解、步骤、公式：

**基本遗传算法的框图：**



![](http://hi.csdn.net/attachment/201101/12/8394323_12948263386zqo.jpg)



所以，遗传算法基本步骤是：

1）  初始化   t←0进化代数计数器；T是最大进化代数；随机生成M个个体作为初始群体    P（t）；

2）  个体评价 计算P（t）中各个个体的适应度值；

3）  选择运算 将选择算子作用于群体；

4）  交叉运算 将交叉算子作用于群体；

5）  变异运算 将变异算子作用于群体，并通过以上运算得到下一代群体P（t + 1）;

6）  终止条件判断  t≦T：t← t+1 转到步骤2；

               t>T：终止 输出解。 



好的，看下遗传算法的伪代码实现：

▲Procedures  GA：   伪代码

begin

       initialize P(0);

       t = 0;             //t是进化的代数，一代、二代、三代...

       while(t <= T) do

              for i = 1 to M  do     //M是初始种群的个体数

                     Evaluate fitness of P(t);  //计算P（t）中各个个体的适应度

              end for

              for i = 1 to M  do

                     Select operation to P(t);  //将选择算子作用于群体

              end for

              for i = 1 to M/2  do

                     Crossover operation to P(t); //将交叉算子作用于群体

              end for

              for i = 1 to M  do

                     Mutation operation to P(t);  //将变异算子作用于群体

              end for

              for i = 1 to M  do

                     P(t+1) = P(t);      //得到下一代群体P（t + 1）

              end for

              t = t + 1;      //终止条件判断  t≦T：t← t+1 转到步骤2

       end while

end



**二、深入遗传算法**

**1、智能优化算法概述**

智能优化算法又称现代启发式算法，是一种具有全局优化性能、通用性强且适合于并行处理的算法。

这种算法一般具有严密的理论依据，而不是单纯凭借专家经验，理论上可以在一定的时间内找到最优解或近似最优解。 

遗传算法属于智能优化算法之一。 



常用的智能优化算法有：

遗传算法 、模拟退火算法、禁忌搜索算法、粒子群算法、蚁群算法。

（本经典算法研究系列，日后将陆续阐述模拟退火算法、粒子群算法、蚁群算法。）



**2、遗传算法概述**

遗传算法是由美国的J. Holland教授于1975年在他的专著《自然界和人工系统的适应性》中首先提出的。

借鉴生物界自然选择和自然遗传机制的随机化搜索算法。 

模拟自然选择和自然遗传过程中发生的繁殖、交叉和基因突变现象。



在每次迭代中都保留一组候选解，并按某种指标从解群中选取较优的个体，利用遗传算子(选择、交叉和变异)对这些个

体进行组合，产生新一代的候选解群，重复此过程，直到满足某种收敛指标为止。 



基本遗传算法（Simple Genetic Algorithms，GA)又称简单遗传算法或标准遗传算法），是由Goldberg总结出的一种最基本的遗传算法，其遗传进化操作过程简单，容易理解，是其它一些遗传算法的雏形和基础。



**3、基本遗传算法的组成**

（1）编码（产生初始种群）

（2）适应度函数

（3）遗传算子（选择、交叉、变异）

（4）运行参数



接下来，咱们分门别类，分别阐述着基本遗传算法的五个组成部分：

**1、编码**

遗传算法（GA）通过某种编码机制把对象抽象为由特定符号按一定顺序排成的串。

正如研究生物遗传是从染色体着手，而染色体则是由基因排成的串。

基本遗传算法（SGA）使用二进制串进行编码。 



初始种群：基本遗传算法（SGA）采用随机方法生成若干个个体的集合，该集合称为初始种群。

初始种群中个体的数量称为种群规模。



**2、适应度函数 **

遗传算法对一个个体（解）的好坏用适应度函数值来评价，适应度函数值越大，解的质量越好。

适应度函数是遗传算法进化过程的驱动力，也是进行自然选择的唯一标准，

它的设计应结合求解问题本身的要求而定。 



**3.1、选择算子**

遗传算法使用选择运算对个体进行优胜劣汰操作。

适应度高的个体被遗传到下一代群体中的概率大；适应度低的个体，被遗传到下一代群体中的概率小。

选择操作的任务就是从父代群体中选取一些个体，遗传到下一代群体。



基本遗传算法（SGA）中选择算子采用轮盘赌选择方法。



Ok，下面就来看下这个轮盘赌的例子，这个例子通俗易懂，对理解选择算子帮助很大。

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826341f6bF.jpg)

轮盘赌选择方法
轮盘赌选择又称比例选择算子，其基本思想是：
各个个体被选中的概率与其适应度函数值大小成正比。

设群体大小为N，个体xi 的适应度为 f(xi)，则个体xi的选择概率为：



![](http://hi.csdn.net/attachment/201101/12/8394323_1294826341C9PV.jpg)



轮盘赌选择法可用如下过程模拟来实现：
(1)在［0, 1］内产生一个均匀分布的随机数r。
(2)若r≤q1,则染色体x1被选中。
(3)若qk-1<r≤qk(2≤k≤N), 则染色体xk被选中。 
其中的qi称为染色体xi (i=1, 2, …, n)的积累概率, 其计算公式为：



![](http://hi.csdn.net/attachment/201101/12/8394323_1294826341Ssc2.jpg)

积累概率实例： 



![](http://hi.csdn.net/attachment/201101/12/8394323_129482634014NA.jpg)

轮盘赌选择方法的实现步骤:
（1）计算群体中所有个体的适应度值；
（2）计算每个个体的选择概率；
（3）计算积累概率；
（4）采用模拟赌盘操作（即生成0到1之间的随机数与每个个体遗传到下一代群体的概率进行匹配）
来确定各个个体是否遗传到下一代群体中。

例如，有染色体
s1= 13 (01101)
s2= 24 (11000) 
s3= 8   (01000)
s4= 19 (10011)

假定适应度为f(s)=s^2 ，则
f (s1) = f(13) = 13^2 = 169
f (s2) = f(24) = 24^2 = 576
f (s3) = f(8) = 8^2 = 64
f (s4) = f(19) = 19^2 = 361

染色体的选择概率为：



![](http://hi.csdn.net/attachment/201101/12/8394323_1294826340ExMU.jpg)

染色体的累计概率为：



![](http://hi.csdn.net/attachment/201101/12/8394323_1294826340030V.jpg)



根据上面的式子，可得到：



![](http://hi.csdn.net/attachment/201101/12/8394323_12948263393zm2.jpg)



例如设从区间［0, 1］中产生4个随机数: 



   r1 = 0.450126,    r2 = 0.110347 

   r3 = 0.572496,    r4 = 0.98503 





![](http://hi.csdn.net/attachment/201101/12/8394323_1294826339Z2Ka.jpg)



**3.2、交叉算子**

交叉运算，是指对两个相互配对的染色体依据交叉概率 Pc 按某种方式相互交换其部分基因，
从而形成两个新的个体。

交叉运算是遗传算法区别于其他进化算法的重要特征，它在遗传算法中起关键作用，
是产生新个体的主要方法。
基本遗传算法（SGA）中交叉算子采用单点交叉算子。 

单点交叉运算 

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826338NWUh.jpg)

**3.3、变异算子 **

变异运算，是指改变个体编码串中的某些基因值，从而形成新的个体。
变异运算是产生新个体的辅助方法，决定遗传算法的局部搜索能力，保持种群多样性。

交叉运算和变异运算的相互配合，共同完成对搜索空间的全局搜索和局部搜索。
基本遗传算法（SGA）中变异算子采用基本位变异算子。 

基本位变异算子是指对个体编码串随机指定的某一位或某几位基因作变异运算。
对于二进制编码符号串所表示的个体，若需要进行变异操作的某一基因座上的原有基因值为0，
则将其变为1；反之，若原有基因值为1，则将其变为0 。 

基本位变异算子的执行过程：

![](http://hi.csdn.net/attachment/201101/12/8394323_129482633872s3.jpg)

**4、运行参数**

（1）M  ：种群规模 
（2）T  ： 遗传运算的终止进化代数 
（3）Pc  ：交叉概率 
（4）Pm ：变异概率 



**三、浅出遗传算法**

**遗传算法的本质**

遗传算法本质上是对染色体模式所进行的一系列运算，即通过选择算子将当前种群中的优良模式遗传
到下一代种群中，利用交叉算子进行模式重组，利用变异算子进行模式突变。
通过这些遗传操作，模式逐步向较好的方向进化，最终得到问题的最优解。

遗传算法的主要有以下八方面的应用：
（1）组合优化      （2）函数优化 （3）自动控制      （4）生产调度 
（5）图像处理      （6）机器学习 （7）人工生命      （8）数据挖掘 



**四、遗传算法的应用**

**遗传算法的应用举例、透析本质（这个例子简明、但很重要）**

已知x为整数，利用遗传算法求解区间［0, 31］上的二次函数y=x2的最大值。

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826337LFjq.jpg)



[**分析**]

原问题可转化为在区间［0, 31］中搜索能使 y 取最大值的点 a 的问题。
个体：［0, 31］ 中的任意点x
适应度：函数值f(x)=x2 
解空间：区间［0, 31］

这样, 只要能给出个体x的适当染色体编码, 该问题就可以用遗传算法来解决。

[**解**]

(1) 设定种群规模,编码染色体，产生初始种群。
将种群规模设定为4；用5位二进制数编码染色体；取下列个体组成初始种群S1

s1= 13 (01101),  s2= 24 (11000)
s3= 8 (01000),    s4= 19 (10011） 

(2) 定义适应度函数, 取适应度函数
f (x)=x^2

(3) 计算各代种群中的各个体的适应度, 并对其染色体进行遗传操作,
直到适应度最高的个体，即31（11111）出现为止。

首先计算种群S1中各个体：
s1= 13(01101),    s2= 24(11000)
s3= 8(01000),      s4= 19(10011)
的适应度f (si), 容易求得：
f (s1) = f(13) = 13^2 = 169
f (s2) = f(24) = 24^2 = 576
f (s3) = f(8) = 8^2 = 64
f (s4) = f(19) = 19^2 = 361

再计算种群S1中各个体的选择概率：

![](http://hi.csdn.net/attachment/201101/12/8394323_1294839320p2XM.png)

由此可求得
P(s1) = P(13) = 0.14
P(s2) = P(24) = 0.49
P(s3) = P(8) = 0.06
P(s4) = P(19) = 0.31

再计算种群S1中各个体的积累概率：



![](http://hi.csdn.net/attachment/201101/12/8394323_129483939094Iy.png)



**选择-复制 **

设从区间［0, 1］中产生4个随机数如下:
r1 = 0.450126,     r2 = 0.110347 
r3 = 0.572496,     r4 = 0.98503 



![](http://hi.csdn.net/attachment/201101/12/8394323_1294826337NFBv.jpg)

于是，经复制得群体：
s1’ =11000（24）,  s2’ =01101（13） 
s3’ =11000（24）（24被选中俩次）,  s4’ =10011（19）







**交叉**

设交叉率pc=100%，即S1中的全体染色体都参加交叉运算。
设s1’与s2’配对，s3’与s4’配对。
s1’ =11000（24）,  s2’ =01101（13）
s3’ =11000（24）,  s4’ =10011（19）
分别交换后两位基因，得新染色体：
s1’’=11001（25）,  s2’’=01100（12）
s3’’=11011（27）,  s4’’=10000（16）



****变异****

设变异率pm=0.001。
这样，群体S1中共有
5×4×0.001=0.02
位基因可以变异。
0.02位显然不足1位，所以本轮遗传操作不做变异。

于是，得到第二代种群S2：
s1=11001（25）,   s2=01100（12）
s3=11011（27）,   s4=10000（16）

**第二代种群S2中各染色体的情况：**

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826335m0x2.jpg)



假设这一轮选择-复制操作中，种群S2中的4个染色体都被选中，则得到群体：
 s1’=11001（25）,  s2’= 01100（12）
 s3’=11011（27）,  s4’= 10000（16）

做交叉运算，让s1’与s2’，s3’与s4’ 分别交换后三位基因，得 
  s1’’=11100（28）,    s2’’ = 01001（9）
  s3’’ =11000（24）,   s4’’ = 10011（19）

这一轮仍然不会发生变异。
于是，得第三代种群S3：
 s1=11100（28）,  s2=01001（9）
 s3=11000（24）,  s4=10011（19） 

**第三代种群S3中各染色体的情况：**

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826335y1v2.jpg)

设这一轮的选择-复制结果为：

s1’=11100（28）,   s2’=11100（28）

s3’=11000（24）,   s4’=10011（19）



做交叉运算，让s1’与s4’，s2’与s3’ 分别交换后两位基因，得

  s1’’=11111（31）,  s2’’=11100（28）

  s3’’=11000（24）,  s4’’=10000（16）



这一轮仍然不会发生变异。





**于是，得第四代种群S4****：**

s1=11111（31）(出现最优解),  s2=11100（28）

s3=11000（24）,  s4=10000（16）



显然，在这一代种群中已经出现了适应度最高的染色体s1=11111。



于是，遗传操作终止，将染色体（11111）作为最终结果输出。

然后，将染色体“11111”解码为表现型，即得所求的最优解：31。

将31代入函数y=x2中，即得原问题的解，即函数y=x2的最大值为961。 



所以，综合以上各代群的情况，如下：

![](http://hi.csdn.net/attachment/201101/12/8394323_1294826334DOdh.jpg)

ok，完。
文章有误之处，一经发现，立马修正。同时，也望各位不吝指正。
-------------------------------------------





本人July对本博客所有文章和资料享有版权，转载或引用任何文章、资料请注明出处。
向您的厚道致敬。谢谢。 July、二零一一年一月十二日。](https://so.csdn.net/so/search/s.do?q=生物&t=blog)](https://so.csdn.net/so/search/s.do?q=优化&t=blog)](https://so.csdn.net/so/search/s.do?q=算法&t=blog)




