# 数论-欧拉函数 - 安得广厦千万间的博客 - CSDN博客





2018年06月29日 15:28:53[独-](https://me.csdn.net/qq_41713256)阅读数：88








欧拉函数 H（x）表示小于n与n互质的数的个数。

H（x）=x*（1-1/P1）*（1-1/P2）........*（1/Pn） P1,P2....Pn为x的素数因子。

那么这个如何用代码实现，其实跟分解质因数是一样的O(sqrt（n）)。

```cpp
int ans=n;
        for(int i=2;i*i<=n;i++)
        {
            if(n%i==0)
            {
                ans=ans/i*(i-1);
                while ( n%i==0 )
                    n/=i;
            }
        }
        if(n>1) ans=ans/n*(n-1);
```



你也可以打表出所有小于sqrt（n）内的素数，好像会快一些。



一个数n大于sqrt（n）的素数最多只有一个。



还有就是欧拉函数的一些性质。

H（1）=1，除了2以外，H（n）都是偶数。

小于n与n互质的所有数的和为 H（n）*n/2   例题 [点击打开链接](http://hdu.hustoj.com/showproblem.php?pid=3501)

p为素数，H（p^k）=p^k-p^(k-1).

H（p）=p-1。

 如果m和n互素，即GCD(m, n) = 1，那么H(m * n) = H(m) * H(n)。



有时候通常要做一些预处理，把所有的欧拉函数先全部求出来，

线性打表，时间复杂度n

```cpp
const int maxn;
int phi[maxn],prime[maxn];
bool vis[maxn];
void init()
{
    phi[1]=1;
    int tot=0;
    for(int i=2;i<maxn;i++)
    {
        if( !vis[i] ){ prime[tot++]=i; phi[i]=i-1; }
        for(int j=0;j<tot&&i*prime[j]<maxn;j++)
        {
            vis[i*prime[j]]=1;
            if( i%prime[j]==0 )
            {
                phi[i*prime[j]]=phi[i]*prime[j];
                break;
            }
            else phi[i*prime[j]]=phi[i]*(prime[j]-1);
        }
    }
}
```









