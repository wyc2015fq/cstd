# DSP之SD卡读写 - 工作笔记 - CSDN博客





2012年08月01日 08:36:07[Eason.wxd](https://me.csdn.net/App_12062011)阅读数：10817








SD卡

SD 卡（Secure Digital Memory Card）中文翻译为安全数码卡，是一种基于半导体快闪记忆器的新一代记忆设备，它被广泛地于便携式装置上使用.

SD 卡标准

SD(Secure Digital)卡有两个标准：
1，标准SD1.1 版,采用4bit 数据带宽，工作频率25Mhz,100Mbps 理论数据传输率，设计最大容量2GB（部分厂商用特别技术使SD1.1 版容量达到4GB）。

2，标准SD2.0 版,于2006 年7 月发布，新标准提高了传输速率和容量，并支持FAT32。采用4bit 数据带宽，工作频率50Mhz,200Mbps 理论数据传输率，设计最大容量32GB。

 采用标准 1 的卡有：

SD,miniSD,microSD

采用标准2 的卡有：

SDHC，miniSDHC，microSDHC



SD 卡，24mm x 32mm x 2.1mm

miniSD 卡，21.5mm x 20.0mm x 1.4mm

micioSD 卡(TF 卡),15mm x 11mm x 1mm

SDHC 卡，和SD 一样大

SDHC 是英文‘'High Capacity SD Memory Card”的缩写即“高容量SD 存储卡”。2006 年5 月SD 协会发布了最新版的SD2.0 的系统规范，在其中规定SDHC是符合新的规范、且容量大于2GB 小于等于32GB 的SD 卡。SDHC 主要特征在于最高支持32GB 。同时传输速度被重新定义为Class2(2MB/sec)、Class4(4MB/sec)、 Classb(bMB/sec)等级别、高速的SD 卡可以支持高分辨视频录制的实时存储。

MMC卡

MMC(MultiMediaCard，多媒体存储卡)由SanDisk 和Siemens 公司在1997 年发起，与传统的移动存储卡相比，其最明显的外在特征是尺寸更加微缩——只有普通的邮票大小(是CF 卡尺寸的1/5 左右)。这使其成为世界上最小的半导体移动存储卡，它对于越来越追求便携性的各类手持设备形成强有力的支持。MMC在设计之初是瞄准手机和寻呼机市场，之后因其小尺寸等独特优势而迅速被引进更多的应用领域，如数码相机、PDA、MP3 播放器、笔记本电脑、便携式游戏机、数码摄像机乃至手持式GPS 等。

MMC（MultiMediaCard）有两个标准：
1，标准MMC，1bit 数据带宽，工作频率0-20Mbps，7 针脚

2，标准MMC4.0 版，4bit 或8bit 数据带宽，工作频率最高52MHz



采用标准1 的卡有：

MMC,RS-MMC

采用标准2 的卡有：

MMCplus,MMCmobile,MMCmicro



MMC 卡，32mm*24mm*1.4mm

RS-MMC 卡，24mm*18mm*1.4mm



MMCplus,和MMC 一样大



MMCmobile，和RS-MMC 一样大



MMCmicro，14mm*12mm*1.1mm
最重要的是，TI 的C55X 系列的DSP 只支持SD1.1 版的SD 和标准MMC



SD 卡与MMC 卡的区别

外形尺寸: 从两种卡的正面看过去，除了SD 卡侧面的的写保护开关，两者的外观是一样的（都是24mm x 32mm）。因为这个原因，这两种闪存卡标准常常被混淆。

首先，两者的厚度是不同的，MMC 卡1.4mm 而SD 卡厚2.1mm。除了厚度，还有其他物理上的区别，包括管脚的配置（在卡的背面）以及SD 卡的写保护开关。

兼容性: 因为MMC 卡比SD 卡稍微薄一些，所以通常您可以说MMC 卡兼容于SD 卡兼容设备。而由MMC 插槽物理结构上（较薄）的原因，SD 卡常常无法适用于MMC 设备。

内容保护: SD 包含一种内容保护技术，叫做CPRM（Content Protection for Recordable Media，可记录媒体的内容保护）。大致而言，这是为了防止人们通过闪存卡把一些受到版权保护的数据散布给他人。但是，这种技术很少应用于主机设备中，因此也很少被内容提供商或用户所使用。
写保护: 正如上面提到的，SD 卡有一个写保护开关。如果您将此开关设置在锁定位置，便携式设备将不能向卡中写入或擦除数据。

速度: SD 卡运行在25MHz 的时钟频率上，数据带宽是4 位，因此最大传输速率是12.5MB/s（12.5 兆字节每秒）。

MMC 卡时钟频率是20MHz，1 位数据带宽，所以最大传输速率为2.5MB/s。在2005 年，新规范定义的下一代闪存卡将闪亮登场，提供了更高的传输速率。MMC 的继任者MMCplus 提供高达52MB/s的最大传输率， 而 SD 1.1 标准也达到了50MB/s。需要注意的是，这只是理论上的最大值，实际的传输率取决于闪存卡的元件和品质。

RS-MMC：现在新出的RS-MMC 都是双电压的，双电压指的是可以支持工作在1.8/3.3V 双电压下，数码设置内存扩展接口电压有的是3.3V 的，为了加大手机电池使用时间，现在的手机的MMC 内存扩展接口电压设计成1.8V 的低电压。支持双电压的 MMC 内存适用面较广！


RS－MMC 卡

特点：尺寸、重量仅为 MMC 卡的一半。

RS－MMC标准最初由MMCA(多媒体卡协会)于2002 年11 月正式对外发布，华腾微电子于今年3 月率先向业界展示了容量为256mb 的RS－MMC 卡。RSMMC的外形尺寸仅为普通MMC 卡的一半，重量只有1 克，然而却继承和沿袭了MMC 卡所有的优势和性能特征。作为一项存储卡的技术延伸，它将海量存储及小巧的外形尺寸融为一体，基本解决了困扰手机开发者已久的存储卡所占空间的问题。由于它的出现，未来的手机外形设计有可能趋于小巧。可以支持工作在1.8/3.3V 双电压下。



##### SD卡读写

SD 卡电气特性

SD 卡标准接口包含9 根引脚，分别是VDD,VSS0-1,DATA0-3,SDCLK 和SDCMD。对于SD 卡的其它功能，如SD卡写保护，SD 卡电源使能及SD 卡检测等，SD 卡标准并没有制定，这要求SD主控制器的设计者根据各自的需求来设计。

SD 模式下允许有一个主机, 多个从机(即多个卡), 主机可以给从机分别地址。主机发命令，有些命令是发送给指定的从机,有些命令可以以广播形式发送。

SD 模式下可以选择总线宽度, 即选用几根DAT 信号线, 可以在主机初始化后设置。

SD 卡系统包括SD 主控制器，总线和SD设备。SD 总线上有一个主设备和多个从设备，星形总线接口。SD 卡系统包括两种可选的通信协议，SD 和SPI（Serial Peripheral Interface,串行外部设备接口）。应用程序可以选择其中的一种。

SD协议通信：

![](https://img-my.csdn.net/uploads/201208/15/1344993729_7927.jpg)

SPI协议通信

![](https://img-my.csdn.net/uploads/201208/15/1344993748_8661.jpg)

MMC/SD主控制器

 另外写

SD初始化

C5509 控制器的初始化主要过程是：

1 复位MMCCTL 的CMDRST 和DATRST。通过DMAEN 来使能或禁止DMA 事件，设置SPIEN 位禁止SPI 模式，清除DATAEG 位禁止DATA3 的边缘检测。

2 设置MMCFCLK 寄存器的FDIV 分频系数，MMCCLK 寄存器的CDIV 分频系数。

3 设置MMC 控制器的使能IDLE 能力。

4 置MMCCTL 的CMDRST 和DATRST 位1，使脱离复位状态。

SD读写：

C5509 的SD 卡读写操作过程是：

1 发送命令SEND_GO_IDLE，使所有卡进入静止状态。

2 发送SD 卡的工作电压，即工作条件，获取所有SD 卡的信息，将不在工作电压范围内的卡设置为不可用状态。重复3，4，5 步骤直到识别所有的SD 卡。

3 获取SD 卡的ID 信息。

4 分配SD 卡的相对位置。

5 选择要操作的SD 卡。

6 向SD 卡发送或者读取512 字节内容。

7 关闭SD 卡控制器。



