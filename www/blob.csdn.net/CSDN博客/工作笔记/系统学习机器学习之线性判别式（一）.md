# 系统学习机器学习之线性判别式（一） - 工作笔记 - CSDN博客





2015年12月19日 11:19:18[Eason.wxd](https://me.csdn.net/App_12062011)阅读数：6032








基础的线性判别式，这里不做说明。主要是逻辑斯蒂判别式的说明和梯度下降迭代求解算法。

**1.逻辑斯蒂方程（Logistic Equation）**

逻辑斯蒂方程的推导 

　　当一种[新产品](http://wiki.mbalib.com/wiki/%E6%96%B0%E4%BA%A7%E5%93%81)刚面世时，厂家和商家总是采取各种措施[促进销售](http://wiki.mbalib.com/wiki/%E4%BF%83%E8%BF%9B%E9%94%80%E5%94%AE)。他们都希望对这种产品的推销速度做到心中有数，这样厂家便于组织生产，商家便于安排进货。怎样建立[数学模型](http://wiki.mbalib.com/wiki/%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B)描述新产品推销速度呢？

　　首先要考虑社会的[需求量](http://wiki.mbalib.com/wiki/%E9%9C%80%E6%B1%82%E9%87%8F)．社会对产品的需求状况一般依如下两个特性确定：

　　1. 对产品的[需求](http://wiki.mbalib.com/wiki/%E9%9C%80%E6%B1%82)有一个饱和水平．当产品需求量达到一定数量时，对这种产品的需求也饱和了，设饱和水平为a；

　　2. 假设在时刻t，社会对产品的需求量为x=x(t)，需求的[增长速度dx](http://wiki.mbalib.com/wiki/%E5%A2%9E%E9%95%BF%E9%80%9F%E5%BA%A6)/dt正比于需求量x(t)与需求接近饱和水平的程度a-x(t)之乘积，记比例系数为k ；

　　根据上述实际背景的两个特征，可建立如下微分方程： 

![\boldsymbol{\frac{dx}{dt}=kx(a-x)}](http://wiki.mbalib.com/w/images/math/5/d/5/5d5f2de6279cfb64217c9d73b20f5fc3.png).......................(1)

　　分离变量，得: 

![\boldsymbol{\frac{x}{x(a-x)}=kdt}](http://wiki.mbalib.com/w/images/math/b/3/4/b34599d2c05c4952c7d3a765b61dc2bf.png)

　　两边积分，得: 

![\boldsymbol{\frac{dx}{a-x}=e^{ac}e^{akt}=Ae^{bt}}](http://wiki.mbalib.com/w/images/math/2/d/7/2d74fc616c4ece1109911bee691c07fd.png)

　　其中:![\boldsymbol{A=e^{ac}}](http://wiki.mbalib.com/w/images/math/3/e/0/3e09be7b23d928012da77ee327e067d0.png)

　　从而，通解为: 

![\boldsymbol{x(t)=\frac{aAe^{bt}}{Ae^{bt}+1}=\frac{a}{1+Be^{-bt}}}](http://wiki.mbalib.com/w/images/math/b/8/2/b824a8a923159e1a1686b87225f3ac02.png)......(2)

　　其中![\boldsymbol{B=\frac{1}{A}=e^{-x}}](http://wiki.mbalib.com/w/images/math/9/2/9/92950440edca8d3837aeab76b92661d3.png)，B和b为正常数，可由初始条件确定。式(1)称为逻辑斯蒂方程(1ogistic equation)，式(2)称为逻辑斯蒂曲线。




**逻辑斯蒂方程的基本性质**

　　1.当t=O时，x(t)的值为：![X_0=\frac{a}{1+B}](http://wiki.mbalib.com/w/images/math/0/9/7/09760159f6e8595a475b9d4a63256151.png)；

　　2.x(t)的增长率![\frac{dx(t)}{dt}=\frac{abBe^{-bt}}{(1+B^{-bt})^2}>0](http://wiki.mbalib.com/w/images/math/5/5/8/5582949fb24c393c6f0c6f61d2a10e80.png),因此，x(t)是增函数；

　　3.当B值较大而t较小时，![\boldsymbol{Be^{-bt}}](http://wiki.mbalib.com/w/images/math/5/4/1/541d241edbb925fb20c6043adf4d919f.png)将很大，![1+Be^{-bt} \approx Be^{-bt}](http://wiki.mbalib.com/w/images/math/4/1/8/418e3b35c2877fb2dbecb2c7d3c0e4b3.png),于是

![x(t) \approx \frac{a}{Be^{-bt}}=\frac{a}{b}e^{bt}](http://wiki.mbalib.com/w/images/math/6/4/b/64b5f86d3bb90fe3828288c1337addde.png)

　　x(t)近似于依指数函数增大，销售速度不断增大； 

　　4.当t增大以后，![\boldsymbol{Be^{-bt}}](http://wiki.mbalib.com/w/images/math/5/4/1/541d241edbb925fb20c6043adf4d919f.png)越来越接近于零，分母越来越接近于1，销售速度开始下降，x(t)的值接近于a（饱和值）。




**逻辑斯蒂方程的应用**

**1．人口限制增长问题**

　　人口的增长不是呈指数型增长的，这是由于环境的限制、有限的资源和人为的影响，最终人口的增长将减慢下来。实际上，人口增长规律满足逻辑斯蒂方程。 

**2. 信息传播问题**

　　所谓信息传播可以是一则新闻，一条谣言或市场上某种新商品有关的知识,在初期，知道这一信息的人很少，但是随时间的推移，知道的人越来越多，到一定时间，社会上大部分人都知道了这一信息．这里的数量关系可以用逻辑斯蒂方程来描述。若以t表示从信息产生算起的时间，P表示已知信息的人口比例，则逻辑斯蒂方程变为：

![P=\frac{1}{1+Be^{-bt}}](http://wiki.mbalib.com/w/images/math/9/9/d/99d14dc6c6696178cf882dd6d1faa378.png)...................(3)

　　例如,当某种商品[调价](http://wiki.mbalib.com/wiki/%E8%B0%83%E4%BB%B7)的通知下达时，有10％的市民听到这一通知，2小时以后，25％的市民知道了这一信息，由逻辑斯蒂方程可算出有75％的市民了解这一情况所需要的时间。

　　在方程(3)中，由t=0时，P=10％可得 B＝9;再由t=2时，P=25％可得,![b=\frac{1}{2}ln3](http://wiki.mbalib.com/w/images/math/4/4/2/442fe0fdc1494bba31f2cfb4e073164a.png)。

　　当P=75％时，有: 

![75%=\frac{1}{1+9e^{-\frac{1}{2}ln3}}](http://wiki.mbalib.com/w/images/math/1/a/e/1ae32ea0100754dd48ffdeb7c5d09720.png)

　　解得t=6，即6小时后，全市有75％的人了解这一通知。 

**3.商品[销售预测](http://wiki.mbalib.com/wiki/%E9%94%80%E5%94%AE%E9%A2%84%E6%B5%8B)问题**

　　例如，某种商品的销售，开始时，知道的人很少，[销售量](http://wiki.mbalib.com/wiki/%E9%94%80%E5%94%AE%E9%87%8F)也很小。当这种商品信息传播出去后，销售量大量增加，到接近饱和时销售量增加极为缓慢。比如，这种商品饱和量估计a=500(百万件)，大约5年可达饱和，常数b经测定为b=lnl0，B=100。下面我们来[预测](http://wiki.mbalib.com/wiki/%E9%A2%84%E6%B5%8B)一下第3年末的销售量是多少。

　　由![x=\frac{a}{1+Be^{-bt}}](http://wiki.mbalib.com/w/images/math/2/c/8/2c8a254fa319b24aa591172d727e1e57.png),有:

![x=\frac{500}{1+100e^{-ln10*3}}=\frac{500}{1+100(\frac{1}{10})^3}=454.5](http://wiki.mbalib.com/w/images/math/a/7/c/a7c2327343473b518891d8b92bf4b981.png)(百万件)

　　所以第三年末的市场销售量大约为454.5百万件，这样可以做到有计划地生产。 

　　逻辑斯蒂方程的应用比较广泛。如果问题的基本数量特征是：在时间t很小时，呈指数型增长，而当t增大时，增长速度就下降，且越来越接近于一个确定的值，这类问题可以用逻辑斯蒂方程加以解决。




**逻辑斯蒂方程案例分析**

案例一：基于逻辑斯蒂方程的垃圾邮件过滤特征方法的研究[[1]](http://wiki.mbalib.com/wiki/%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E6%96%B9%E7%A8%8B#_note-0)
- 　　1.逻辑斯蒂(Logistic)方程 

![Y=\frac{K}{1+ae^{bX}}](http://wiki.mbalib.com/w/images/math/c/c/d/ccd380d9b6329a3e2355ff08a3517ebb.png)(1)

　　Logistic曲线其特点是开始增长缓慢，而在以后的某一范围内迅速增长，达到某限度后，增长又缓慢下来∞3.曲线略呈拉长的“S”型.Logistic增长的速度函数图像为单峰曲线，这表明Logistic曲线增长过程分为三个阶段：慢一快一慢。

　　在实际中，特征项也根据重要程度的不同分为三部分，并且与Logistic曲线的三个阶段相对应：第一部分是在[垃圾邮件](http://wiki.mbalib.com/wiki/%E5%9E%83%E5%9C%BE%E9%82%AE%E4%BB%B6)分类中贡献甚微的特征项，特征权值不需要明显的变化，全部是不予选择的特征项，对应Logistic曲线变化幅度较小的第一阶段；第二部分是要进行甄别的特征项，需要区别特征项重要程度强弱，特征权值变化幅度越大越有利于特征项的选择，与曲线的变化幅度最快的第二阶段对应；第三个部分是必须选取的高特征权值的特征项，对应曲线第三阶段，这部分特征项同样不需要显著的差别，全部是要选择的特征项.2.参数设定。
- 　　2.参数设定 

　　以影响特征选择方法的三个要素为因子，设逻辑斯蒂(Logistic)方程的参数X为： 

![X=\alpha+\beta+\sqrt{\gamma}](http://wiki.mbalib.com/w/images/math/4/9/a/49ae6b3571552cbfbc590075a1cec3df.png)(2)

　　根据(8)式测定垃圾邮件中特征项集的X值分布情况：P(X<100)>90％，即特征权值小于100的特征项占待选择特征项集的95％以上，可判定需要甄别的特征项集中在X值小于lOO的特征项集合内，由此设定一组[样本值](http://wiki.mbalib.com/wiki/%E6%A0%B7%E6%9C%AC%E5%80%BC)(X_1,Y_1),(X_2,Y_2),\cdots(\cdotsX_10,Y_10),，其数值如下表所示.以此分析此结果是否能以Logistic方程描述。

**表：X，Y参数值表**
|X|10|20|30|40|50|60|70|80|90|95|
|----|----|----|----|----|----|----|----|----|----|----|
|y|9|12|16|30|50|65|77|84|90|93|

　　在(1)式中，当X→∞，![\lim_{x \to \infty}=K](http://wiki.mbalib.com/w/images/math/0/2/c/02cba379af0e86ca326fce786c30e6b0.png)，所以特征项重要程度的无限延长的终极量是K.假定这组值的K值为100(％)，即特征项的最重要程度为100％.将(1)式移项得：![\frac{K-Y}{Y}=ae^{-bX}](http://wiki.mbalib.com/w/images/math/1/7/b/17bc858bff621ad936d48224223990ed.png)(3)

　　令![Y^\prime=\ln(\frac{K-Y}{Y})](http://wiki.mbalib.com/w/images/math/b/2/3/b2333faae69b145e22b85408f25a5210.png),则由[最小平方法](http://wiki.mbalib.com/wiki/%E6%9C%80%E5%B0%8F%E5%B9%B3%E6%96%B9%E6%B3%95)估计的![Y^\prime](http://wiki.mbalib.com/w/images/math/5/d/f/5df14367dc3b0479ce8daff939af484c.png)为

![Y^\prime=\ln a-bX](http://wiki.mbalib.com/w/images/math/6/d/3/6d3546215fa3b693192efb2f1d595fcd.png)(4)

　　因此，Y和X对于Logistic方程的符合度，可由![Y^\prime](http://wiki.mbalib.com/w/images/math/5/d/f/5df14367dc3b0479ce8daff939af484c.png)和X的线性相关系数![\gamma Y^\prime X](http://wiki.mbalib.com/w/images/math/b/6/8/b68b8159793cb986e3173ec00a7a86e4.png)给出：

![\gamma Y^\prime X=\frac{\sum XY^\prime-\frac{1}{n}(\sum X)(\sum Y^\prime)}{\sqrt{\left[\sum X^2-\frac{1}{n}(\sum X^2)\right]\left[\sum(Y^\prime)^2-\frac{1}{n}(\sum Y^\prime)^2\right]}}=\frac{\sum xy^\prime}{\sqrt{\sum X^2\cdot\sum(y^\prime)^2}}](http://wiki.mbalib.com/w/images/math/5/d/5/5d51e451e2cbccc27f8939b9ea92f308.png)(5)

　　(5)中， 

![y^\prime=\ln(\frac{K-Y}{Y})-\overline{y^\prime},\overline{y^\prime}=\sum\ln(\frac{K-Y}{Y})/n](http://wiki.mbalib.com/w/images/math/a/9/7/a974a86a319bd18d3df9e48c1214658d.png)(6)

![x=X-\overline{x},\overline{x}=\sum X/n](http://wiki.mbalib.com/w/images/math/b/d/7/bd75110fdf0c473547ff0e72632dfd70.png)(7)

　　以为样本容量。回归参数a和b的样本估计值为： 

![-b=\frac{\sum XY^\prime-\frac{1}{n}(\sum X)(\sum Y^\prime)}{\sum X^2-\frac{1}{n}(\sum X)^2}=\frac{\sum xy^\prime}{\sum X^2}](http://wiki.mbalib.com/w/images/math/8/f/c/8fcc6d6a75e0bd5a52b90282a134a8fe.png)(8)

![\ln a=\overline{y^\prime}+b\overline{x}](http://wiki.mbalib.com/w/images/math/8/5/9/85945ebc41a5bcbceb0c400b4a47b362.png)(9)

　　根据表2以及式(6)(7)求得： 

![\sum x^2=7822.5,\sum(y^\prime)^2=28.6894,\sum xy^\prime=-471.7887](http://wiki.mbalib.com/w/images/math/2/3/e/23eb20c0b7118517db8e952fbe97dfb5.png)

　　故根据(11)得：![\gamma Y^\prime X=-0.9958](http://wiki.mbalib.com/w/images/math/e/0/e/e0ebd59c5381903e0e1522b82e995206.png)为极显著.故知X和Y的关系以Logistic方程配合是合适的.进一步根据(6)和(7)求得b值为0.0603和a值为23.1316.那么所求Logistic方程为：

![Y=\frac{100}{1+23.1316e^{-0.0603\cdot X}}](http://wiki.mbalib.com/w/images/math/f/6/1/f61da3cfada7d3ba57daf0c619402d69.png)

　　式（10）的曲线图如图所示 

![Image:Logistic方程曲线图.jpg](http://wiki.mbalib.com/w/images/3/35/Logistic%E6%96%B9%E7%A8%8B%E6%9B%B2%E7%BA%BF%E5%9B%BE.jpg)
- 　　3.实验和结果 

　　采用的是CCERT的中文邮件样本集，该样本集由中国教育科研网收集并维护．该数据集在国内和教育网内是常用的一个衡量反中文垃圾邮件技术的数据集．采用数据集的8000封垃圾邮件以及8000封正常邮件．选择贝叶斯方法进行垃圾邮件分类，分类结果利用[查全率](http://wiki.mbalib.com/wiki/%E6%9F%A5%E5%85%A8%E7%8E%87)(Recall)、准确率(Precision)和F值评测过滤系统性能。

　　查全率(R)=正确过滤掉的邮件数／应该过滤掉的垃圾邮件数； 

　　准确率(P)=正确过滤掉的邮件数／实际过滤掉的邮件数； 

![\frac{2RP}{R+P}](http://wiki.mbalib.com/w/images/math/b/a/5/ba557ca9366011b1d5d2834145007316.png)；值实际是查全率和准确率的调和平均，综合成一个指标．实验结果如下表。

**表：统评测结果**
|[信息熵](http://wiki.mbalib.com/wiki/%E4%BF%A1%E6%81%AF%E7%86%B5)|[互信息](http://wiki.mbalib.com/wiki/%E4%BA%92%E4%BF%A1%E6%81%AF)|几率比|期望交叉熵|CHI[统计量](http://wiki.mbalib.com/wiki/%E7%BB%9F%E8%AE%A1%E9%87%8F)|Logistic方程| |
|----|----|----|----|----|----|----|
|Recall|0.8446|0.8615|0.8954|0.8702|0.8737|0.9366|
|Precision|0.9698|0.9574|0.9421|0.9363|0.9316|0.9493|
|F|0.9028|0.9037|0.9181|0.9020|0.9017|0.9429|

　　实验结果表明，利用Logistic方程进行分类时的F值有显著的提高，说明过滤系统整体性能有所提高，其中查全率有明显的提高，说明这种方法检出垃圾邮件的能力较高，使漏网的垃圾邮件减少，但是准确率没有提升，说明合法邮件误判为垃圾邮件的可能性没有明显降低。

在参数估计分类中，类密度p(x|Ci)是高斯的，并且具有共同的协方差矩阵，则判别式是线性的，gi(x) = wi^Tx + wi0,我们对p(Ci|x)做分对数变换，即logit(P(Ci|x)) =  w^Tx + w，也是线性的.则logit的逆便是P(Ci | x) = sigmoid(logit(P(Ci|x))),由此因日sigmoid函数。也就是说，在逻辑斯蒂判别式中，我们不是对类条件p(x|Ci)建模，而是对他们的比率建模，不管是否条件密度为正太分布，该判别式都有很广泛的应用。一单选定，则sigmoid
 > 0.5 表示一类。




**梯度下降法(gradient descent)**是一个[最优化](http://baike.baidu.com/view/607042.htm)算法，通常也称为**最速下降法。实际上，还有牛顿法最优化算法。**

常用于机器学习和人工智能当中用来递归性地逼近最小偏差模型。




**求解过程**

顾名思义，梯度下降法的计算过程就是沿梯度下降的方向求解极小值（也可以沿梯度上升方向求解极大值）。

其迭代公式为

![](http://h.hiphotos.baidu.com/baike/s%3D118/sign=65c70ae8778da9774a2f822a8850f872/63d0f703918fa0ec27adadd6229759ee3c6ddb87.jpg)
**,**其中

![](http://g.hiphotos.baidu.com/baike/s%3D22/sign=d2fd6faed288d43ff4a996f07f1e7b9a/63d0f703918fa0ec2604acd6229759ee3c6ddb2e.jpg)

代表梯度负方向，

![](http://g.hiphotos.baidu.com/baike/s%3D15/sign=617e99e2cd3d70cf48faae08f9dc6b5d/a8014c086e061d95143bfce37ff40ad163d9cae8.jpg)

表示梯度方向上的搜索步长。梯度方向我们可以通过对函数求导得到，步长的确定比较麻烦，太大了的话可能会发散，太小收敛速度又太慢。一般确定步长的方法是由线性搜索算法来确定，即把下一个点的坐标ak+1看做是的函数，然后求满足f(ak+1)的最小值的 即可。

因为一般情况下，梯度向量为0的话说明是到了一个极值点，此时梯度的幅值也为0.而采用梯度下降算法进行最优化求解时，算法迭代的终止条件是梯度向量的幅值接近0即可，可以设置个非常小的常数阈值。




**例子**

举一个非常简单的例子，如求函数

![](http://f.hiphotos.baidu.com/baike/s%3D64/sign=d982d3abd71b0ef468e89b5adcc476a4/f603918fa0ec08fa2c7d88225cee3d6d55fbda32.jpg)

的最小值。

利用梯度下降的方法解题步骤如下：

1、求梯度，

![](http://e.hiphotos.baidu.com/baike/s%3D47/sign=a80e2821a1c27d1ea1263ac31ad57898/f603918fa0ec08fa2d0c89225cee3d6d55fbda23.jpg)


2、向梯度相反的方向移动

![](http://f.hiphotos.baidu.com/baike/s%3D9/sign=73cdb460a86eddc422e7b8ca392a1a/908fa0ec08fa513d5baef65b386d55fbb2fbd92b.jpg)

，如下


![](http://e.hiphotos.baidu.com/baike/s%3D90/sign=ed483fe79d22720e7fceeefa7acbeb20/f11f3a292df5e0fe7d9a1384596034a85fdf72b1.jpg)

，其中，

![](http://a.hiphotos.baidu.com/baike/s%3D13/sign=ea96623dd13f8794d7ff4c2dd31b7a3a/908fa0ec08fa513d5e44ed5b386d55fbb3fbd94d.jpg)

为步长。如果步长足够小，则可以保证每一次迭代都在减小，但可能导致收敛太慢，如果步长太大，则不能保证每一次迭代都减少，也不能保证收敛。

3、循环迭代步骤2，直到

![](http://b.hiphotos.baidu.com/baike/s%3D9/sign=d8aabae0b619ebc4c4787aa882f5b9/2934349b033b5bb56871a57b33d3d539b700bc95.jpg)

的值变化到使得

![](http://g.hiphotos.baidu.com/baike/s%3D32/sign=d9105891bd99a9013f355d341c958d85/7dd98d1001e93901e71f09bb7eec54e736d19612.jpg)

在两次迭代之间的差值足够小，比如0.00000001，也就是说，直到两次迭代计算出来的

![](http://g.hiphotos.baidu.com/baike/s%3D32/sign=d9105891bd99a9013f355d341c958d85/7dd98d1001e93901e71f09bb7eec54e736d19612.jpg)

基本没有变化，则说明此时

![](http://g.hiphotos.baidu.com/baike/s%3D32/sign=d9105891bd99a9013f355d341c958d85/7dd98d1001e93901e71f09bb7eec54e736d19612.jpg)

已经达到局部最小值了。

4、此时，输出

![](http://g.hiphotos.baidu.com/baike/s%3D9/sign=72fb84642a2eb938e86d76c3d57e39/38dbb6fd5266d0162f3819ad922bd40735fa3515.jpg)

，这个

![](http://g.hiphotos.baidu.com/baike/s%3D9/sign=72fb84642a2eb938e86d76c3d57e39/38dbb6fd5266d0162f3819ad922bd40735fa3515.jpg)

就是使得函数

![](http://g.hiphotos.baidu.com/baike/s%3D32/sign=d9105891bd99a9013f355d341c958d85/7dd98d1001e93901e71f09bb7eec54e736d19612.jpg)

最小时的

![](http://g.hiphotos.baidu.com/baike/s%3D9/sign=72fb84642a2eb938e86d76c3d57e39/38dbb6fd5266d0162f3819ad922bd40735fa3515.jpg)

的取值 。

MATLAB如下。



```
```bash
syms x;
```



```bash
f=x^2;
```



```bash
step=0.1;
```



```bash
x=2;
```



```bash
loss_changed=x^2;
```



```bash
loss=x^2;
```



```bash
while
```

```bash
loss_changed>0.000000001
```



```bash

```

```bash
x=x-step*2*x;
```



```bash

```

```bash
loss_changed = loss - x^2;
```



```bash

```

```bash
loss = x^2 ;
```



```bash
end
```



```bash
x
```
```



梯度下降法处理一些复杂的非线性函数会出现问题，例如Rosenbrock函数：


![](http://e.hiphotos.baidu.com/baike/s%3D230/sign=8058583fa5cc7cd9fe2d33da09032104/d009b3de9c82d158e0481a63860a19d8bd3e421d.jpg)

![](http://g.hiphotos.baidu.com/baike/s%3D220/sign=bf5ed064cf177f3e1434fb0f40ce3bb9/43a7d933c895d143c3dda6f175f082025baf07bc.jpg)


其最小值在

![](http://a.hiphotos.baidu.com/baike/s%3D87/sign=8a25d3ed4dfbfbedd8593b7879f05722/8644ebf81a4c510f0973a0c86659252dd52aa5a9.jpg)

处，函数值为

![](http://h.hiphotos.baidu.com/baike/s%3D75/sign=d66a42c8c05c1038207eccc7b311c94c/d0c8a786c9177f3e5833bedf76cf3bc79e3d56d8.jpg)

。但是此函数具有狭窄弯曲的山谷，最小点

![](http://b.hiphotos.baidu.com/baike/s%3D87/sign=5a25c7b3fe1986184547e2834bedbe55/faf2b2119313b07e23be12da0ad7912396dd8ce5.jpg)

就在这些山谷之中，并且谷底很平。优化过程是之字形的向极小值点靠近，速度非常缓慢。






