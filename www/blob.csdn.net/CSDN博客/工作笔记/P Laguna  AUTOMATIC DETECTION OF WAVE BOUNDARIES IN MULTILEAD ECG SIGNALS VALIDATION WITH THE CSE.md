# P.Laguna / AUTOMATIC DETECTION OF WAVE BOUNDARIES IN MULTILEAD ECG SIGNALS VALIDATION WITH THE CSE - 工作笔记 - CSDN博客





2012年01月18日 14:52:02[Eason.wxd](https://me.csdn.net/App_12062011)阅读数：5568








AUTOMATIC DETECTION OF WAVE BOUNDARIES IN MULTILEAD ECG
SIGNALS:  VALIDATION WITH THE CSE DATABASE
by
 Pablo Laguna PhD
 Raimon Jane PhD

 Pere Caminal PhD

论文网址： [http://diec.unizar.es/~laguna/personal/publicaciones/puntos.pdf](http://diec.unizar.es/~laguna/personal/publicaciones/puntos.pdf)

摘要

本文介绍了一个多导联（12标准导联+正交XYZ导联）ECG信号波形边界（P,QRS,T波）自动定位算法。已知这些位置，临床上重要的特征（例如RR间期，PQ间期，QRS时限，ST段，QT间期）可以容易地测量出来。首先，多导QRS检测器定位每个心拍，使用微分和低通滤波ECG信号作为输入。接下来，每个导联上定位波形边界。检测到的电活动时限最长的导联用来最终确定波形的边界。我们算法的性能已经用CSE多导联测试数据库进行评价。与其它用CSE测试过的算法相比较，我们的算法在T波终点和间期值上与手工测量值有更好的一致性，同时它的其它波形边界测量结果在
 CSE的算法和手工测量误差要求范围内。



主要内容：

（1）多导联检测QRS波的另一个例子。利用同一个QRS检测器逐个导联检测QRS波，然后15导联综合定位QRS标记点；可对漏检拍进行补充，误检测拍进行排除；

（2）检测室颤，利用序列假设检验方法；发生室颤不定位波形及其边界点；

（3）逐个导联定位每个心拍的波形的峰值点、起终点，未检测到的心拍和排除掉的心拍除外。利用过零点，和过阈值点的检测方法；且结合波形的形态；

（4）对每个特征点进行选取，排除定位错误，同时又保证在最长投影导联确定波形综合的不依赖导联的特征点；

（5）用CSE测量数据库进行验证。

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------

摘要



这篇文章介绍了一种自动定位多导联ECG信号波形边界的算法（P，QRS和T波起止点，12个标准导联和XYZ正交导联）。给定这些位置，临床上重要的特征（例如RR间期，PQ间期，QRS时限，ST段和QT间期）可以容易的测量出来。首先，多导联QRS检测器定位每一个心拍，使用微分低通ECG信号作为输入。接下来，每个导联中的波形边界定位。电活动时限最长的导联用来最终确定波形边界。算法的性能已经用CSE多导联测量数据库测试评价过。与CSE测试过的其它算法相比，本算法在T波终点和间期值方面和手工测量的一致性更好，同时，其它波形边界的测量结果也在CSE得到的算法与手工测量结果的范围内。

1引言



心电图（ECG）用与每个心拍相关联的重复出现的波形序列（P，Q，R，S，T）来刻画。用这些波形的起点和终点定义的各种时间间期在心电图诊断中是重要的。这些间期中最重要的是RR间期，PQ间期，QRS时限，ST段和QT间期。这些间期的直接测量需要知道P，QRS和T波边界点的位置（起点和终点）。



由于逐拍手工测量标准12导联ECG中这些间期在日常临床实践中是不切实际的，于是自动测量算法被提出用来定位QRS起点和终点，QT间期，P、QRS波的起点和P、QRS、T波终点。虽然这些算法分析无干扰信号的结果可以接受，但是在噪声存在时性能下降。

欧盟赞助的定量心电图机一般标准（CSE）项目，已经研究了许多ECG波形定位算法的性能。CSE研究发现这些算法对T波终点的定位明显比人类专家定位的时间偏早。很遗憾，没有给出文献中使用的算法的技术细节，使得这个研究结果的使用受限。所有这些原因致使我们开发了新的方法用来定位波形边界，在本文进行介绍。我们利用与CSE相同的方法和测试信号评价我们的算法，结果表明与手工测量的波形边界的一致性极好，特别是对T波终点的测量。



我们的方法基于对先前描述的单导联QT间期测量程序进行多导联的推广，随后使用单导联和多导联波形边界确定。这个方法已经应用到MIT-BIH数据库的ECG记录，并且用CSE多导联测量数据库进行验证，其他程序已经用CSE数据库验证过。



2方法

首先，多导联QRS检测器（设计为15导联）应用到ECG记录。接下来，对每个导联独立地进行波形边界估计（----应该是对每个导联中的每个波形确定边界！）。这个过程使用了微分信号和波形形状信息。算法在每个导联根据不同波形微分信号的相对幅度实现准则用来确定波形存在或是不存在。给定波形存在性信息和微分信号，算法刻画出P波的模式（直立的或是倒置的），QRS复合波（用各种Q，R，S，R'序列表示），以及T波（直立的，倒置的，或双向的），与CSE工作组使用的分类相一致。利用在每个导联上获得的波形边界，最终的波形边界从电活动最长的那些导联中选择出来，减少干扰对测量的影响。

图1显示了波形边界检测程序的主要步骤。多导联QRS检测器包含15个单导联QRS检测器并生成第j个导联ECGj(k)中第i个QRS波的位置QRSj(i)。接下来，多导联QRS决策规则给出每个导联第i个心拍最终位置QRSj(i)。我们分析各个导联ECGj(k)，使用下面的单导联步骤：心室颤动过程抑制，波形定位（Wj(i)），波形边界确定，产生第j导联第i个心拍的单导联波形边界估计WBj(i)。利用WBj(i)估计，一个多导联波形边界定位规则给出每个心拍最终的不依赖于导联的波形边界WB(i)。最后，已知这些WB（i）位置，我们计算有临床意义的间期（PR，QT，…）。下面，我们更加详细的描述这些步骤。

2.1    预处理

第一步包含单导联滤波处理用来降噪以及非线性变换利于QRS检测。线性滤波使用二阶带通Lynn滤波（0.8—18Hz，-3dB）用来减弱基线漂移和高频干扰。带通滤波获得ECGPB后，应用低通差分（微分）器获得信号斜率变化信息。微分后信号称为ECGDER。我们使用的非线性变换是对平方信号的移动窗口积分，积分宽度为95ms。



 2.2  QRS检测



2.2.1．单导联QRS检测



本文使用的单导联QRS检测器是在Pan和Tompkins方法基础上做的修改，在检测时使用信号斜率规则：当前波形的最大斜率应在前一个已经检出的QRS波最大斜率的正负百分之三十以内，当前波形才可能是QRS波。



2.2.2多导联QRS检测



利用单导联检测器获得的第j导联第i个心拍的位置估计结果QRSj(i)，见图1，我们应用一个多导联QRS检测规则：在每个导联仅将与其他导联同序数QRS波位置差别不超过90ms的位置作为该导联的一个QRS波。决策规则包含如下步骤：



a)这个处理步骤的输入值是单导联QRS检测器已检到的第i个心拍的位置QRSj(i)
 (j = 1,…,15)。图2a给出一个例子。

b)从QRSj(i) (j = 1,…,15)中搜索第一个（min）和最后一个（max）时间位置（图2b）。从这些时间位置我们定义两个QRSj(i)的（子）序列：序列1，QRSj(i)中与min距离不超过90ms的那些位置；序列2，QRSj(i)中与max距离不超过90ms的那些位置。在图2b中，序列1包含11个位置，序列2包含8个位置。

c)比较两个序列。如果两个序列都包含全部15个QRSj(i)
 (j = 1,…,15)位置，则认为在所有导联第i个心拍的位置都正确检出。如果两个序列包含位置数量不同，包含位置数量较少的序列的极值（min或max）被去除。



如果去掉的位置是max，可能是由漏检导致，max可能属于下一拍。因此，如果max属于第k导联，第k导联QRS波检出位置从第i拍开始右移一位。在图2b,c中，max位置属于II导联，作为错误检测被去除，算法假定II导联真实的QRS波被单导联QRS检测器漏检。



如果去掉的位置是min，可能由该导联假阳性检测（误检）导致。这种情况下，如果min属于第k导联，QRSk(i+1)可能是我们正在找的正确检测位置。因此，我们可以从第i+1个心拍开始左移一拍。图2d,e中min位置输入V3导联，由于可能是错误检测被去掉，算法将QRSv3（i+1）赋值给V3导联第i个心拍作为它的位置。



d)这个过程重复进行直到两个序列相同。剩余位置认为是每个导联第i个心拍的正确位置。第i个心拍没有检出或是在前面步骤中被去除的导联，不做第i拍的波形边界定位。



图3是CSE数据库中MO1_109记录的7导联的单导联检测标记。多导联决策规则抑制了II导联中第12个检测拍（P波而不是QRS位置）因为它和其他导联不一致；并且识别到V3导联中两个漏检拍（第7个和第11个）。表1总结了这个记录的检测结果。



2.3 心室颤动抑制



室颤发生时，测量P，QRS，T边界没有意义。在波形定位前使用文献（13）中提出的单导联室颤检测方法。

2.4 波形定位

检测器给出的QRS位置QRSj(i)可能是Q,R 或S 波峰. 算法在ECGDER中QRSj（i）位置之前和之后搜索最近的波峰位置Pb和Pa（信号中过零点）。根据这些波峰的极性和相对值，确定QRSj(i)属于Q，R，或S波。在ECGDER中，相邻波形位置被当成QRSj（i）最临近的过零点被检出。要承认这些相邻的检出点是波形位置（W(i)),波形之间的时间距离必须在生理上可能的间期范围内，并且这些波形相应的最大斜率 必须大于有关QRS波最大斜率（maxder）
 的阈值。阈值是由经验调整的并且对Q，R，S或R'波是不同的，范围从是QRS最大斜率（maxder）的3%—10%。这个过程试图定位存在的Q，R，S和R'波峰。

  接下来，搜索P，T波波峰。这些波形含有比QRS波低频低的成分。 再次应用低通滤波（-3db 截止频率12Hz)到ECGDER来减少剩余的噪声。在滤波后所得信号（DERFI）中 从R波位置之前255 ms 开始定义一个155 ms 宽窗口。当前一个T波或是下一个Q波在这个窗口中时缩短窗口的宽度。在窗口中搜索最大最小值。如果这些值大于QRS最大斜率的2%， 算法假定已经定位一个P波； 否则，算法假定在该导联P伯波不能定位。P波峰点假定发生在窗口中最大值和最小值之间的过零点。

     为检测T 波，在DERFI中定义搜索窗口，且是心率的函数。根据搜索窗口中最大最小值相对位置和数值， 利用CSE工作组分类方法，算法确定T 波类型（直立，倒置，双向+- 或双向-+）。T波峰假定出现在最大或最小值相邻的过零点。

2.5   波形边界定位

 2.5.1   单导联波形边界定位

一旦有了波形位置（微分信号ECGDER或RERFI中过零点），接下来定位每个波形的起点和终点。本文使用的微分阈值法 是 文献（2）中用来确定QT间期的方法，这里 将其推广用来确定多导联ECG记录任何波形的界限。图4 演示了QRS终点确定过程。

从零点（S波位置）向右或向左搜索相邻的波峰pk（向右找终点，向左找起点），波形斜率最大点。用pk时刻的值ECGDER（pk）定义阈值TH=ECGDER(pk)/k。从而，在ECGDER中从零点开始向前（或向后）的过阈值点看成波形终点（或起点）。（图4是S波终点）。k是常值，通过实验进行调整，用表2中给出的k值可以达到最好的性能。



当两个波形重叠时，阈值准则会失效并且可能给出与生理上预期的点相距很远的边界位置。于是，算法使用图5中所描述的最小微分准则：从pk位置开始在同一个方向上找绝对值最小的波峰pk'作为波形边界，这个波峰位置与ECG形状变化有关。（图5）。图6显示出本程序应用到MIT-BIH数据库中单导联ECG记录的结果。每个QRS波上短的水平线代表在给定心拍处计算出的等电位水平，用来测量波形幅度。等电位水平用P波终点（pe）和QRS起点（QRSb）之间的ECG信号均值来估计，不包含这个区间的开始和最后15
 ms。



存在振幅很高的基线漂移时，已经知道这种干扰能重叠P波和T波得谱，ECG记录去除基线漂移后再利用本方法分析效果更好。如果没有做预先的去基漂处理，在微分信号中存在低频伪迹时，利用阈值准则可能导致错误的估计结果。



2.5.2多导联波形起终点确定



用前述方法可以获得每个波形的边界WB，（Pb,Pe,QRSb,…）,波形边界位置WBj(i)属于第j导联第i拍（j取值从1到15，除了没有检到心拍的导联或是被多导联QRS检测规则排除的导联）。下一步是从WBj(i)中选择出第i拍波形真实起终点WB(i)。根据电生理学知识，假如所有WBj(i)都正确检出，应该选择WBj(i)(j=1,…,15)中最早的位置作为起点，最晚位置作为终点，目的是从心脏电活动时间投影最长的导联回复出边界。然而，由于噪声或是误差存在，在确定某些WBj(i)时可能发生错误的估计，就可能导致最终位置WB(i)错误。为减少这种风险，对第i个心拍应用下面多导联波形边界检测规则（图1）：

搜索WBj(i)(j=1,…,15)中最小时间位置（min，针对起点）或最大时间位置（max，针对终点）。如果没有两个以上其他导联WBj(i)标记位于区间（min,min+delta）或（max-delta,max）内，WBj(i)中min或max点会因为可能受噪声影响而被排除。delta值的选择是基于通常手工测量的变异性和实践经验。对Pb,Pe,QRSb,QRSe和Te，delta值分别是6,6,6,10,12
 ms。这样处理后，WBj(i)中剩余位置的最小值（最大值）作为波形起点（终点）。







----------------字数限制，下面内容翻译放到别处



