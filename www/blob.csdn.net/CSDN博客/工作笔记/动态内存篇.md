# 动态内存篇 - 工作笔记 - CSDN博客





2011年12月14日 17:17:20[Eason.wxd](https://me.csdn.net/App_12062011)阅读数：5413标签：[delete																[struct																[语言																[存储																[float](https://so.csdn.net/so/search/s.do?q=float&t=blog)
个人分类：[基础编程](https://blog.csdn.net/App_12062011/article/category/952065)





从大学毕业，到现在，工作了四个月了。遇到最纠结的问题就是动态分配内存时，产生的数组越界问题。


一、C语言动态内存分配

    要实现动态内存的分配，除了利用含指针成员的结构体之外，还需利用C语言提供的几个标准库函数。（使用时应包含头文件“alloc.h”或“malloc.h”或“stdlib.h”）

    1.malloc函数

　　函数原型为void *malloc(unsigned int size)；在内存的动态存储区中分配一块长度为"size" 字节的连续区域。函数的返回值为该区域的首地址。 “类型说明符”表示把该区域用于何种数据类型。(类型说明符*)表示把返回值强制转换为该类型指针。“size”是一个无符号数。例如： pc=(char *) malloc (100); 表示分配100个字节的内存空间，并强制转换为字符数组类型，函数的返回值为指向该字符数组的指针， 把该指针赋予指针变量pc。若size超出可用空间，则返回空指针值NULL。

      注意 这里是100个字节，而不是100个字符。

    2.calloc 函数

    函数原型为void *calloc(unsigned int num, unsigned int size)

　　按所给数据个数和每个数据所占字节数开辟存储空间。其中num为数据个数，size为每个数据所占字节数，故开辟的总字节数为num*size。函数返回该存储区的起始地址。calloc函数与malloc 函数的区别仅在于一次可以分配n块区域。例如： ps=(struct stu*) calloc(2,sizeof (struct stu)); 其中的sizeof(struct stu)是求stu的结构长度。因此该语句的意思是：按stu的长度分配2块连续区域，强制转换为stu类型，并把其首地址赋予指针变量ps。

    3． realloc函数：

　 函数原型为void *realloc(void *ptr, unsigned int size)

      重新定义所开辟内存空间的大小。其中ptr所指的内存空间是用前述函数已开辟的，size为新的空间大小，其值可比原来大或小。函数返回新存储区的起始地址（该地址可能与以前的地址不同）。例如p1=(float *)realloc(p1,16);将原先开辟的8个字节调整为16个字节。

 **动态申请的内存空间要进行手动用free（）函数释放

    4． free函数：

　 函数原型为void free(void *ptr)

　　将以前开辟的某内存空间释放。函数原型为 void free(void *ptr)其中ptr为存放待释放空间起始地址的指针变量，函数无返回值。应注意：ptr所指向的空间必须是前述函数所开辟的。例如free((void *)p1);将上例开辟的16个字节释放。可简写为free(p1);由系统自动进行类型转换。

二、C++语言动态内存分配

　　C++语言中用new和delete来动态申请和释放内存。

    1. 申请单个对象

　　int *p;

　　p=new int;或者 p=new int(value);

　 2. 动态申请数组

　　int *p;

　　p=new int [100];

　　这样可以申请长度为100的数组，但是不能进行初始化。注意，这里100是长度，就是数组元素个数

　3. delete

　　int *p, *q;

　　p=new int;

　　q=new int[10];

　　delete p;

　　delete [ ]q;](https://so.csdn.net/so/search/s.do?q=存储&t=blog)](https://so.csdn.net/so/search/s.do?q=语言&t=blog)](https://so.csdn.net/so/search/s.do?q=struct&t=blog)](https://so.csdn.net/so/search/s.do?q=delete&t=blog)




