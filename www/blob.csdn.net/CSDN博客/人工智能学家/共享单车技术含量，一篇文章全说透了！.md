# 共享单车技术含量，一篇文章全说透了！ - 人工智能学家 - CSDN博客
2017年12月07日 00:00:00[人工智能学家](https://me.csdn.net/cf2SudS8x8F0v)阅读数：302
*![640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1](https://ss.csdn.net/p?http://mmbiz.qpic.cn/mmbiz_jpg/zJgiblIeQ3ujADtNqE7ke2IpeOEJlbkAPlxLyeIEZvzsg5PNz2EK62m3Lgbv6iaqojP9CL6pFgLpel89UFm7Yucg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1)*
*来源：**物联网智库*
*概要：共享单车已经成为了中国新四大发明之一，被输往了世界上很多城市。*
共享单车已经成为了中国新四大发明之一，被输往了世界上很多城市。在我看来，虽然共享单车的实现并不复杂，其实质是一个典型的“物联网+互联网”应用。应用的一边是车（物）、另一边是用户（人），通过云端的控制来向用户提供单车租赁服务。
**一.共享单车的“云端应用”**
**1.云计算基础平台**
共享单车的云端应用，是一个建立在云计算之上的大规模双向实时应用。云计算一方面能够保证共享单车应用的快速部署和高扩展性，另一方面能够应付大规模高并发场景，满足百万级数量的连接需要。（例如摩拜的云服务是建立在微软的Azure公有云服务平台之上）
**2.数据资产**
云端应用需要采集、存储并管理两类关键数据：
**a.单车数据**（物联网特性的资产数据：包括单车的通信连接状态、车锁状态、使用记录等），单车数据由智能锁通过通信模块和SIM卡，经过电信运营商的网络以及运营商的物联网平台，上传到共享单车的服务平台；
**b.用户数据**（互联网特性的用户数据：除了用户基本信息、消费记录、用户账户和征信信息等，还包括用户的行为数据：骑行的路径和位置信息）。正如此文开头所述，共享单车是“物联网+互联网”应用，所以企业资产（单车）和用户数据是共享单车企业的核心资产。
**3.平台服务**
由于共享单车一方面涉及海量的物联网数据、用户数据的管理，另一方面又要随时跟进用户需求而做功能开发和优化，所以应用之下会先构建平台服务（PaaS）。配备平台服务层，一方面能够使得应用承载百万量级的高并发数据流，另一方面又能做到资源和能力的动态调配、功能的灵活开发。
所以，摩拜不仅使用了微软的基础云服务（Azure），还使用了微软的平台服务（PaaS），包括物“Azure-Iot”平台服务、Dynamics 、CRM、客户关系管理服务、以及基于机器学习的预测分析功能等。
**二.共享单车的“智能锁”**
从摩拜1代的短信解锁和OFO 1代的手动机械解锁，到如今的蓝牙解锁、电子围栏、预约等新增的功能应用，智能锁关键、基础的功能已经逐渐确定下来，各家智能锁的差异已经不大了。目前，智能锁基本都是由控制、通信、感知、执行、供电等几大类模块组成。
主要的模块功能如下：
**控制芯片(单片机)**：智能锁系统的控制中枢，整体负责通信、车锁控制和状态信息收集。
**移动通信芯片(Modem)**：内置电信运营商的Sim卡，负责与云端应用后台进行通信。
**蓝牙通信模块**：主要是用于连接用户手机并实现解锁、也与电子围栏的应用实现有关。
**GPS通信模块**：物理定位功能
**车锁的传感器：**感知车锁的开、关状态，并将车锁状态信息向控制芯片上报。
**车锁的执行器**：控制芯片通过执行器对车锁进行开、关操作。
**蜂鸣器**：用于异常状态的发声告警
**电源模块**：电池、充电模块（芯片）、充电装置（太阳能电池板；电机和测速传感器等）
共享单车应用，其实就是通过“单车-云端-用户手机”之间的信息传递来完成的，其中最关键的是解闭智能锁的过程。目前，最新的“GPS定位+蓝牙”解锁和还车模式已经比较普遍。
**蓝牙模式解锁流程：**
1. 手机先扫单车上二维码，而后向云端发起解锁请求（请求中会携带扫码单车的ID信息及用户个人账号信息）。云端对用户信息、单车信息进行核查，而后将授权信息发送给手机。（步骤1、2）
2. 用户通过手机蓝牙接口将解锁指令和授权信息传递给单车的智能锁，智能锁核验授权信息后解锁，并将解锁成功的信息通知手机。（步骤3、4）
3. 手机将解锁成功的信息回复给云端，云端开始给用户计费。（步骤5、6）
4. 在用户骑行过程中，单车和手机APP会将各自的GPS定位信息上报云端应用。（步骤7）
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/0LtvMYEcicGQKr8hrZYGNkD88jIy8GicZg6HNMWGJYGgIdwtc75bs6DeBj6Hn7fMLRfoWb77GOVXjicLrJxhnQExQ/640?wx_fmt=jpeg)
**蓝牙模式锁车、还车流程：**
1. 用户锁车后，由智能锁通过蓝牙通知手机：“还车成功”。（步骤1）
2. 手机随即通知云端“还车成功”，云端将费用结算信息会送给手机和用户。（步骤2、3）
3. 智能锁在用户还车后将位置信息的上报。（步骤4）
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/0LtvMYEcicGQKr8hrZYGNkD88jIy8GicZglI467xcLfZmpSRyZMZlr4MZkaRUrWzhBzu8Z6gAdhPTZxRWMShatyA/640?wx_fmt=jpeg)
采用蓝牙的方式，实现手机对智能锁的解闭，能够减少智能锁的通信量（通信资费）和耗电量。不过采用蓝牙方式，稳定性和兼容性不能够完全保证。所以传统的、比较耗电的解锁方式（手动密码解锁、GSM短信或GPRS流量解锁）往往还是会被保留，作为备选。
**短信或流量方式的解锁流程（具备GPS功能）：**
1. 手机先扫单车上二维码，而后向云端发起解锁请求。（步骤1）
2. 云端完成对用户和单车的信息核查，并将解锁指令发送给单车智能锁，智能锁开启后向云端回复“解锁成功”。（备注：部分共享单车在解锁信息上报过程中，智能锁会把下一次解锁的密码或秘钥也一并上报给云端）（步骤2、3）
3. 云端通知用户手机，并开始计费。（步骤4）
4. 在用户骑行过程中，单车和手机APP会将各自的GPS定位信息上报云端应用。（步骤5）
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/0LtvMYEcicGQKr8hrZYGNkD88jIy8GicZgFd8ZLaNq2Moy1OF4Ep1y0TLcjJExU9W7fRibtRY2leYCC6o71y52sGg/640?wx_fmt=jpeg)
**短信或流量方式的锁车、还车流程：**
1. 用户锁车后，由智能锁通知云端：“还车成功”。（步骤1）
2. 云端随即通知用户手机并进行费用结算。（步骤2）
3. 智能锁在用户还车后将位置信息的上报。（步骤3）
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/0LtvMYEcicGQKr8hrZYGNkD88jIy8GicZg6ytXwiadCria2u2dySmXO8iaGucqUXwZiaS2Ql69UMO7R9eRYgOIudfN1Q/640?wx_fmt=jpeg)
**三.共享单车迭代的步伐不止**
从整体来看，共享单车“端-云-用户”三位一体的应用架构并不复杂，但从行业舆论对共享单车各方面的争论和点评来看，似乎共享单车的应用又要比纯正的互联网应用更复杂一些。其实，复杂就复杂在了对车的管理上。因为单车不再是属于用户的终端设备（例如手机、平板电脑）了，而是摩拜、OFO们的企业资产。
既然单车是最重要资产，就需要花心思去管理（在单车管理上，目前主要是关注：耗电、连接、零件故障、位置、使用频率）。对单车的有效管理和用户体验有极大的正相关关系，单车企业对其资产（车）管理的手段和技术必然会不断迭代和进步。
所以，如今的智能锁都会配备GPS定位的功能，以方便企业获取单车位置和移动路径；智能锁再带上蓝牙解锁的功能，减少运营商网络的通信流量和连接的不确定性，同时还能更省电；
单车企业跟进电信运营商推销的NB-Iot网络接入方案，一方面降低智能锁通信的耗电量，另一方面增加连接可靠性，更利于资产的状态跟踪；研发、测试、试运行各种电子围栏的解决方案，配合市政要求解决单车在公共场所乱停放的问题；此外，还有研发更高效稳定的供电方式、向用户提供故障反馈页面等等。
除了“玩车”外，单车企业还需要结合用户行为的大数据分析，来提升单车的使用频率。例如，工作日早晚发生的用户潮汐效应，即大量用户早上“涌灌”到工业园区，晚上下班“回流”到居民区所形成一种规律的“人口迁移”现象。
单车企业就需要考虑如何调度单车，以迎合用户集中的出行需求，以提高资产（单车）使用率。
未来智能实验室致力于研究互联网与人工智能未来发展趋势，观察评估人工智能发展水平，由互联网进化论作者，计算机博士刘锋与中国科学院虚拟经济与数据科学研究中心石勇、刘颖教授创建。
未来智能实验室的主要工作包括：建立AI智能系统智商评测体系，开展世界人工智能智商评测；开展互联网（城市）云脑研究计划，构建互联网（城市）云脑技术和企业图谱，为提升企业，行业与城市的智能水平服务。
*如果您对实验室的研究感兴趣，欢迎支持和加入我们。扫描以下二维码或点击本文左下角“阅读原文”*
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/f84kJBXzrBXoz49H9w8lfGXmBjcGga9W15bmYAvZDqbbI8p0liaLcxEh1iao7YXIgJvp6MLHpskd7jHq8ibX0QzDQ/640?wx_fmt=png)
