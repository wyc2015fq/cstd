# 对象浅复制和深复制的几个问题 - littlely_ll的博客 - CSDN博客





2017年08月20日 18:47:10[littlely_ll](https://me.csdn.net/littlely_ll)阅读数：146标签：[copy																[deepcopy																[python](https://so.csdn.net/so/search/s.do?q=python&t=blog)
个人分类：[python](https://blog.csdn.net/littlely_ll/article/category/6664856)





## 一、“==”与“is”

==运算符是比较的两个对象的值，而is比较的是对象的标识。例如：

```
a = [1,2,3]
b = a
c=list(a) 
a == b == c ##返回True
id(a) == id(b) ##返回True
id(a) == id(c) ##返回False
```

这里a指向对象[1,2,3]，而b是对象[1,2,3]的别名，也就是说，a和b都指向[1,2,3]这个对象，所以他们的值相同，id也相同。而c是a创建的副本，a和c的值相同，但是id标识不同。

## 二、浅复制问题

```php
l1 = [3, [66, 55, 44],(7, 8, 9)]
l2 = list(l1)
l1.append(100)
l1[1].remove(55)
print("l1:", l1) ##l1: [3, [66, 44], (7, 8, 9), 100]
print("l2:", l2) ##l2: [3, [66, 44], (7, 8, 9)]

l2[1] += [33,22] ##l1: [3, [66, 44, 33, 22], (7, 8, 9), 100]
l2[2] += (10,11) ##l2: [3, [66, 44, 33, 22], (7, 8, 9, 18, 11)]
```

首先l1创建了一个副本l2，然后对l1追加100，又删除了l1列表元素55，从结果中看到，l1追加的元素对l2没有影响，但是l1删除的元素对l2有影响了，为什么呢，从查看他们的id标识可以看出来：

```
id(l1) == id(l2) ##返回False
id(l1[1]) == id(l2[1]) ##返回True
```

这是l1和l2绑定了同一个列表。由下面的交互动画可以看到： 
![这里写图片描述](https://img-blog.csdn.net/20170820182436635?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

这是l1列表 
![这里写图片描述](https://img-blog.csdn.net/20170820182459372?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

这是l2列表，可以看出，他们指向同一个对象。 
![这里写图片描述](https://img-blog.csdn.net/20170820182537525?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

在增加100时，只有l1增加了。 
![这里写图片描述](https://img-blog.csdn.net/20170820182614823?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

而删除55时，这是他们公共的。 
![这里写图片描述](https://img-blog.csdn.net/20170820182654621?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

当列表增加元素时，这是就地修改，即两个都改变了。 
![这里写图片描述](https://img-blog.csdn.net/20170820182741838?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

而当对l2修改元组时，它没有就地修改，而是新创建了一个对象，因为元组是不可变的。 

因此，在使用可变的对象时，要改变其内容应格外注意。
## 再看copy模块

copy模块中有两个函数，分别是浅复制copy和深复制deepcopy。

```
import copy
s1 = [3,[12,23],(1,2,5)]
s2 = copy.copy(s1)
s3 = copy.deepcopy(s1)
s1[1].append(200)
s2[2] += (0,0)
print(s1)
print(s2)
print(s3)

[3, [12, 23, 200], (1, 2, 5)]
[3, [12, 23, 200], (1, 2, 5, 0, 0)]
[3, [12, 23], (1, 2, 5)]
```

s1, s2, s3它们的id都不相同，s1和s2如上述所讲，但s3是一个新对象，看一看以下交互图： 
![这里写图片描述](https://img-blog.csdn.net/20170820184250910?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170820184259538?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170820184308336?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170820184316576?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170820184325244?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![这里写图片描述](https://img-blog.csdn.net/20170820184334074?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl0dGxlbHlfbGw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

虽然deepcopy复制的时候，s1,s2,s3最后一个元组的id虽然相同，但是s2改变的是元组，它若一经修改就变为另一个对象了，所以对深复制没有影响。](https://so.csdn.net/so/search/s.do?q=deepcopy&t=blog)](https://so.csdn.net/so/search/s.do?q=copy&t=blog)




