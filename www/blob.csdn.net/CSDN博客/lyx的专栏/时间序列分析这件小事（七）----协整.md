# 时间序列分析这件小事（七）----协整 - lyx的专栏 - CSDN博客





2016年12月05日 16:15:09[钱塘小甲子](https://me.csdn.net/qtlyx)阅读数：10531标签：[R																[时间序列分析](https://so.csdn.net/so/search/s.do?q=时间序列分析&t=blog)](https://so.csdn.net/so/search/s.do?q=R&t=blog)
个人分类：[R语言与时间序列分析](https://blog.csdn.net/qtlyx/article/category/6551781)

所属专栏：[R语言的时间序列分析](https://blog.csdn.net/column/details/15558.html)








        真实世界中，其实有很少是平稳时间序列，通常都是含有一定趋势的时间序列，譬如GDP值等等。之前我们说了可以用差分的方法获取平稳序列，但是，一旦差分其实我们丢失了原始序列的一些信息，而且往往很难从实际的意义上去解释差分后拟合的结果，所以今天我们讨论一下“协整”

## 1.单整

        在说协整之前，我们先讨论一下单整。如果一个序列经过一次差分之后就变成了平稳序列，那么我们就称之为一阶单整序列；如果d次差分之后才变成平稳序列，则称之为d阶单整。

        我们可以知道，平稳序列的线性组合还是平稳序列；平稳序列和一阶单整序列的线性组合是一阶单整，也就是说，一阶单整序列具有占优性质。

        但是，重点来了，两个一阶单整序列的线性组合一定是一阶单整吗？答案是不一定。于是我们得到了另外一种获得平稳序列的方法，就是两个一阶单整的序列的线性组合。

## 2.协整

ut=m+a*xt+b*yt

> 
如果ut是平稳序列，xt与yt都是一阶单整序列，那么我们就称xt与yt是协整的，（a，b）称为协整向量。


我们先构造两个非平稳序列：



```
#example 14
set.seed(123)
n=100
u1 = rnorm(n)
xt = cumsum(u1)
u2 = rnorm(n)
yt = 0.6*xt + u2
plot(xt,type = 'l',ylab = '')
lines(yt,lty = 2)
legend('topleft',c('xt','yt'),lty = 1:2,bty = 'n')
```
![](https://img-blog.csdn.net/20161205113353993?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

> 很显然，xt与yt都不是序列平稳的。



> 
我们对xt于yt做一个回归，然后残差作为一个时间序列来分析：




```
#example 15
fm = lm(yt~xt)
et = resid(fm)
plot(et,type = 'o');abline(h=0)
adf.test(et)
```
![](https://img-blog.csdn.net/20161205113729313?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)




![](https://img-blog.csdn.net/20161205113735657?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)


















