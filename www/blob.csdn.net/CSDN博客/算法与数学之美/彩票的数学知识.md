# 彩票的数学知识 - 算法与数学之美 - CSDN博客
2018年09月18日 22:06:37[算法与数学之美](https://me.csdn.net/FnqTyr45)阅读数：803
彩票怎样才能中奖？
理论上，只能靠运气。但是，如果规则设计得不好，就可以钻漏洞。
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/951TjTgiabkxkrW97ylibE3fUibHp4SthcPtYq8ZSMFauSXUDhB7g3eMMB2sHJbxUWIan05VKXI11GUJDyCmiaztFw/640?wx_fmt=jpeg)
2005年2月，美国的一个彩票品种，就出现了漏洞，被麻省理工学院的学生发现了。随后的七年，这个学生反复购买这个品种，一共赚到了300万美元。
本文介绍他怎么做的，以及其中的数学原理。我依据的材料，主要来自数学教授 Jordan Ellenberg 在斯坦福大学的一次演讲（Youtube）。
一、期望值
彩票最重要的数学概念，叫做"期望值"（expected value），即同一种行为多次重复以后，所能得到的平均收益。
举例来说，如果每次抽奖需要2元，假设200次抽奖可以中奖一次，奖金为300元。那么，你花了2000元，一共抽奖1000次，中奖了5次，奖金为1500元。
也就是说，1000次抽奖的总收益是1500元，每次的平均收益是1.5元，这就是期望值。它的计算公式如下。
期望值 = 300 * (1 / 200) + 0 * (199 / 200) = 1.5
期望值是1.5元，但是每次抽奖成本2元，于是净亏损0.5元。
一看就知道，这个事情是不划算的，做得越多，越不划算。偶尔买一次彩票，倒也算了；如果你一天到晚不断买彩票，就肯定会亏很多钱（上例是每200次亏100元）。
总之，期望值是衡量彩票收益的一个关键指标。
二、马萨诸塞州的 WinFall 彩票
美国马萨诸塞州有一个彩票品种，叫做 WinFall。它的规则很简单：1到48里面，你猜6个数字，猜中就有奖。
> 
**四等奖（6个猜中2个）：奖金2元**
**三等奖（6个猜中3个）：奖金5元**
**二等奖（6个猜中4个）：奖金150元**
**一等奖（6个猜中5个）：奖金4000元**
**特等奖（6个猜中6个）：奖金池剩余的全部奖金**
有一期，一共卖出了930万张彩票，其中特等奖一个，奖金100万美元，一等奖238个，二等奖11625个，三等奖19.8万个，四等奖136.8万个。
计算可知，这种彩票的期望值是0.798元。
期望值 =
100万 * ( 1 / 930万) +
4000 * ( 238 / 930万) +
150 * (11625 / 930万) +
5 * (19.8万 / 930万) +
2 * (136.8万 / 930万 )
= 0.798
每张彩票的价格是2元，可是平均收益只有0.798元，连一半都不到，可见这种彩票是非常不划算的。因此没有吸引力，购买这种彩票的民众不断减少。
州政府很着急，因为政府从彩票抽成20%（每张0.4元）。如果销售量减少，政府的收益也会减少。于是，政府为了增加这种彩票的吸引力，决定修改彩票规则。
三、新规则
新的规则是，如果当期没有特等奖（没人猜中６个数字），那么奖金会分配给一等奖、二等奖、三等奖的得主，各奖项新的中奖金额如下。
> 
**一等奖（6中5）：50000元**
**二等奖（6中4）：2385元**
**三等奖（6中3）：60元**
还是使用前面的中奖率，计算期望值。
期望值 =
50000 * ( 238 / 930万) +
2385 * (11625 / 930万) +
60 * (19.8万 / 930万) +
= 5.53
每张彩票的价格还是2元，但是期望值变成了5.53元。购买这种彩票就变得非常划算，大量购买的话， 可以得到2.5倍的收益。之所以期望值大于彩票的成本，是因为奖金池还包含前期剩余的奖金。
麻省理工学院的一个学生，发现了这一点。他凑了5000元购买彩票，结果中了将近15000元！
四、如何选择号码？
现在我们知道，新规则的彩票是有利可图的，可以大量购买。但是，还有一个问题，应该怎么选择号码，才能保证收益？也就是说，48个号码里面，你应该选择哪6个号码，才能收益最大化？
毕竟你不能购买所有彩票，因为彩票的收益来自没中奖的那些人。你只能购买一部分彩票，设法使得自己购买的号码有最大的中奖可能。
为了简化思考，让我们考虑一种简单的情况。1到7里面猜三个数字，奖金如下。
> 
**猜中3个：奖金6元**
**猜中2个：奖金2元**
**猜中1个：无奖金**
你可以同时选择七种组合（即购买七张彩票），请问应该如何选择号码？
五、组合数公式
首先，让我们考虑一下，1到7这七个数字里面，三个数字的组合一共有多少种？这在数学里面，叫做组合数公式。
组合数公式是指从 m 个不同元素中，取出 n（n ≤ m）个元素的所有组合的个数，用符号 c(m, n) 表示。
它的计算公式如下。
c(m, n) = m! / n! * (m - n)!
上面公式中，感叹号表示阶乘，比如4!等于4 * 3 * 2 * 1。
按照上面的定义，七个数字里面的三个号码的组合，共有c(7, 3)个。
c(7, 3) = 7! / 3! * (7 - 3)! = 35
这就是说，三个数字的组合共有 35 种。我们可以把它们全部列出来。
> 
**123 124 125 126 127**
**134 135 136 137**
**145 146 147**
**156 157**
**167**
**234 235 236 237**
**245 246 247**
**256 257**
**267**
**345 346 347**
**356 357**
**367**
**456 457**
**467**
**567**
上面是所有35种可能的组合，你必须从中选出7种。请问应该选择哪七种？
六、最佳组合
答案是下面这七种组合。
123 145 167 247 256 346 357
这七张彩票能让你的收益最大化。因为，不管最后的中奖号码是什么，它们可以保证你总是获得6元奖金。如果中奖号码是123，那么你拿到头奖6元；如果中奖号码是367，那么167、346、357这三张彩票各自猜中两个号码，你中了三个小奖，奖金总额也是6元。
仔细观察这七张彩票，你会发现它们是精心选择的：每个数字都正好出现三次。这导致你要么中一个大奖，要么中三个小奖。
七、几何选择法
这七张彩票是怎么选出的呢？
![640?wx_fmt=gif](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/951TjTgiabkxkrW97ylibE3fUibHp4SthcPyqwSbn4R4lP4frdUdIow3xtrEgJ34zpStxLAsOKgxWtwo1iayuNV18Q/640?wx_fmt=gif)
有一种几何方法，可以非常简单地做到这一点。七个号码就是七个点，把它们用直线连起来，每根线上只能有三个点，而每个点出现在三根线上。画成上面的形状，就得到了七根线（内部的圆也算一根线）。然后，记录一下每根线上的号码，很简单就选出了七张彩票。
更严谨的证明是这样的：1到7这七个数字，共有21种两个数字的组合（C(7, 2)），这意味着只要把这21种组合都买全了，就可以保证中三个小奖。因为三个中奖号码里面，共有三种两个数字的组合（比如中奖号码是367，那么36、37、67都可以中小奖）。另一方面，由于每张彩票包含三个号码，即包含三种两个数字的组合，那么最少只要买7张彩票就能覆盖全部21种组合。
八、实际的策略
回到前面的问题，马萨诸塞州的彩票应该怎么买？
6个号码只要猜中4个，就可以中二等奖，只要把所有四个号码的组合都买了，就可以确保中15个二等奖（6个中奖号码共有15个四个号码的组合C(6, 4)）。
48个号码里面共有194580种四个号码的组合（C(48, 4)），既然一张彩票包含15种组合，那么最少购买12972张彩票就够了（194580 / 15 = 12972），就可以包含所有四个号码的组合。如果有兴趣的话，你可以写一个程序，算出包含这194580种组合的所有彩票。
购买12972张彩票，需要25944元（12972 * 2）。根据前面的奖金额，二等奖的奖金是2385元，那么15个二等奖就是35775元（2385 * 15）。因此，投入25944元，可以无风险地获得35775元。当然，这样做的前提是，当期没人猜中特等奖，否则奖金就会被大大稀释。
∑编辑 | Gemini
来源 | 阮一峰的网络日志
更多精彩：
☞  [哈尔莫斯：怎样做数学研究](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554187&idx=1&sn=35143b89b06fe4f5273f210b2d6a7c91&chksm=8b7e3290bc09bb86f7bb3f158d993df3f019a7e9ce3bc8897e164e35a2ebe5a4e0bdcc111089&scene=21#wechat_redirect)
☞  [扎克伯格2017年哈佛大学毕业演讲](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554187&idx=2&sn=c75293463823e4d6769638e54b64f3ec&chksm=8b7e3290bc09bb86dc1e3f8e78d0b6de8811d75f3dcb092766fcb8ba0bab1cd9ba1ddfcef3b9&scene=21#wechat_redirect)
☞  [线性代数在组合数学中的应用](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554141&idx=1&sn=74a74c4e4d08eba0dd734528aa0b08e7&chksm=8b7e32c6bc09bbd073b34c22004ac6e4d99c8a0caa64c7d3dbaa8fd55e6ef1fc87ed545b8b7e&scene=21#wechat_redirect)
☞  [你见过真的菲利普曲线吗？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554105&idx=1&sn=224ab0d38fb57facea70081385360d58&chksm=8b7e3222bc09bb34d3b6df665087e64b233778ed427598d08e809f96261e898c1c0de6188bbc&scene=21#wechat_redirect)
☞  [支持向量机(SVM)的故事是这样子的](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554096&idx=1&sn=46783e6ace661a3ccbd8a6e00fb17bf9&chksm=8b7e322bbc09bb3d73dc240f2280bddf2ef8b7824a459a24bd7f6eeadd60edb96e690d467f6e&scene=21#wechat_redirect)
☞  [深度神经网络中的数学，对你来说会不会太难？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554077&idx=2&sn=3ecd63f2205fd59df8c360c97c943ef6&chksm=8b7e3206bc09bb10a36b09547efe0c54f41423b180622c1fdc7f14747ccc8f8fecee3a12e2cd&scene=21#wechat_redirect)
☞  [编程需要知道多少数学知识？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554062&idx=1&sn=17f0a88d5e15d1adfc29c690a0b1b89b&chksm=8b7e3215bc09bb038c6caa59d0f49cedd929f9be1104beea3411186cf4c81de69efc71a17883&scene=21#wechat_redirect)
☞  [陈省身——什么是几何学](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553994&idx=2&sn=74f67a1a3ac5c705f51f2ba619b717f6&chksm=8b7e3251bc09bb47dce73319948780081efe0333ffae99ea04a9eeabbcfcb38a29b4b73fb7c1&scene=21#wechat_redirect)
☞  [模式识别研究的回顾与展望](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553949&idx=2&sn=d171680964df774397efd9db81c00347&chksm=8b7e3386bc09ba90bf0f6e1cabf82ba86ff94630cb5ee2e0f14ff9455db52be32ddbc289d237&scene=21#wechat_redirect)
☞  [曲面论](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553747&idx=1&sn=e25f866d510cf2338b6d9e1b32bafb62&chksm=8b7e3348bc09ba5ea1caaf2a7bfcd80a7e7559b1983e473eda2206e56df7f38ef3cecf2f77c7&scene=21#wechat_redirect)
☞  [自然底数e的意义是什么？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553811&idx=1&sn=000305074471c3d4c681c9cfd4e4bc93&chksm=8b7e3308bc09ba1e3043f5568a3a75a045285a1de97e4da36918bac68e7c6d579ad5d8cc25ab&scene=21#wechat_redirect)
☞  [如何向5岁小孩解释什么是支持向量机（SVM）？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553670&idx=1&sn=ea75a448c016f7229e4cb298f6017614&chksm=8b7e309dbc09b98bc622acdf1223c7c2f743609d0a577dd43c9e9d98ab4da4314be7c1002bd5&scene=21#wechat_redirect)
☞  [华裔天才数学家陶哲轩自述](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553646&idx=2&sn=bbf8f1be1ca1c66ad3f3270babea6885&chksm=8b7e30f5bc09b9e3e1a4fa735412e2fcb20df9e78f2f346bf578018ceab77de6326095d1bf71&scene=21#wechat_redirect)
☞  [代数，分析，几何与拓扑，现代数学的三大方法论](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553596&idx=1&sn=bc5064e871831f862db6d19c3de6327e&chksm=8b7e3027bc09b93194fa09b25e2df400421c062927bb9120912875f8aaf0bb25553fc8f51e3b&scene=21#wechat_redirect)
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/951TjTgiabky7x6u1VxMVMia4MLibNzC2nrumY3zDflTsCeoM04M1BrkvPny8tsw6hYkIicUr42iarLmadL2x6JwV6A/640?wx_fmt=png)
算法数学之美微信公众号欢迎赐稿
稿件涉及数学、物理、算法、计算机、编程等相关领域，经采用我们将奉上稿酬。
投稿邮箱：math_alg@163.com
