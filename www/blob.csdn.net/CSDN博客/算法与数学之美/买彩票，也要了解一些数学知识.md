# 买彩票，也要了解一些数学知识 - 算法与数学之美 - CSDN博客
2018年05月08日 11:23:00[算法与数学之美](https://me.csdn.net/FnqTyr45)阅读数：4375
彩票怎样才能中奖？ 理论上，只能靠运气。但是，如果规则设计得不好，就可以钻漏洞。
>>>> 
![640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/XjGG4txZI4E8O8DPD23rGia6oZ4jBMfgyeAiasmIIyiajicE98aw0qMy9L4vN9WqUAGJcCxnOKDL4K8Pf0dYiaia9cow/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1)
2005 年 2 月，美国的一个彩票品种，就出现了漏洞，被麻省理工学院的学生发现了。随后的七年，这个学生反复购买这个品种，一共赚到了 300 万美元。
本文介绍他怎么做的，以及其中的数学原理。我依据的材料，主要来自数学教授 Jordan Ellenberg 在斯坦福大学的一次演讲。
一、期望值
彩票最重要的数学概念，叫做 "期望值"（expected value），即同一种行为多次重复以后，所能得到的平均收益。
举例来说，如果每次抽奖需要 2 元，假设 200 次抽奖可以中奖一次，奖金为 300 元。那么，你花了 2000 元，一共抽奖 1000 次，中奖了 5 次，奖金为 1500 元。
也就是说，1000 次抽奖的总收益是 1500 元，每次的平均收益是 1.5 元，这就是期望值。它的计算公式如下。
> 
期望值 = 300 * (1 / 200) + 0 * (199 / 200) = 1.5
期望值是 1.5 元，但是每次抽奖成本 2 元，于是净亏损 0.5 元。
一看就知道，这个事情是不划算的，做得越多，越不划算。偶尔买一次彩票，倒也算了；如果你一天到晚不断买彩票，就肯定会亏很多钱（上例是每 200 次亏 100 元）。
总之，期望值是衡量彩票收益的一个关键指标。
二、马萨诸塞州的 WinFall 彩票
美国马萨诸塞州有一个彩票品种，叫做 WinFall。它的规则很简单：1 到 48 里面，你猜 6 个数字，猜中就有奖。
> - 
四等奖（6 个猜中 2 个）：奖金 2 元
- 
三等奖（6 个猜中 3 个）：奖金 5 元
- 
二等奖（6 个猜中 4 个）：奖金 150 元
- 
一等奖（6 个猜中 5 个）：奖金 4000 元
- 
特等奖（6 个猜中 6 个）：奖金池剩余的全部奖金
有一期，一共卖出了 930 万张彩票，其中特等奖一个，奖金 100 万美元，一等奖 238 个，二等奖 11625 个，三等奖 19.8 万个，四等奖 136.8 万个。
计算可知，这种彩票的期望值是 0.798 元。
> 
期望值 = 
　　100 万 * (1 / 930 万) + 
　　4000 * (238 / 930 万) + 
　　150 * (11625 / 930 万) + 
　　5 * (19.8 万 / 930 万) + 
　　2 * (136.8 万 / 930 万) 
　　= 0.798
每张彩票的价格是 2 元，可是平均收益只有 0.798 元，连一半都不到，可见这种彩票是非常不划算的。因此没有吸引力，购买这种彩票的民众不断减少。
州政府很着急，因为政府从彩票抽成 20%（每张 0.4 元）。如果销售量减少，政府的收益也会减少。于是，政府为了增加这种彩票的吸引力，决定修改彩票规则。
三、新规则
新的规则是，如果当期没有特等奖（没人猜中６个数字），那么奖金会分配给一等奖、二等奖、三等奖的得主，各奖项新的中奖金额如下。
> - 
一等奖（6 中 5）：50000 元
- 
二等奖（6 中 4）：2385 元
- 
三等奖（6 中 3）：60 元
还是使用前面的中奖率，计算期望值。
> 
期望值 = 
　　50000 * (238 / 930 万) + 
　　2385 * (11625 / 930 万) + 
　　60 * (19.8 万 / 930 万) + 
　　= 5.53
每张彩票的价格还是 2 元，但是期望值变成了 5.53 元。购买这种彩票就变得非常划算，大量购买的话， 可以得到 2.5 倍的收益。之所以期望值大于彩票的成本，是因为奖金池还包含前期剩余的奖金。
麻省理工学院的一个学生，发现了这一点。他凑了 5000 元购买彩票，结果中了将近 15000 元！
四、如何选择号码？
现在我们知道，新规则的彩票是有利可图的，可以大量购买。但是，还有一个问题，应该怎么选择号码，才能保证收益？也就是说，48 个号码里面，你应该选择哪 6 个号码，才能收益最大化？
毕竟你不能购买所有彩票，因为彩票的收益来自没中奖的那些人。你只能购买一部分彩票，设法使得自己购买的号码有最大的中奖可能。
为了简化思考，让我们考虑一种简单的情况。1 到 7 里面猜三个数字，奖金如下。
> - 
猜中 3 个：奖金 6 元
- 
猜中 2 个：奖金 2 元
- 
猜中 1 个：无奖金
你可以同时选择七种组合（即购买七张彩票），请问应该如何选择号码？
五、组合数公式
首先，让我们考虑一下，1 到 7 这七个数字里面，三个数字的组合一共有多少种？这在数学里面，叫做组合数公式。
> 
组合数公式是指从 m 个不同元素中，取出 n（n ≤ m）个元素的所有组合的个数，用符号 c(m, n) 表示。
它的计算公式如下。
> 
c(m, n) = m! / n! * (m - n)!
上面公式中，感叹号表示阶乘，比如 `4!` 等于 `4 * 3 * 2 * 1` 。
按照上面的定义，七个数字里面的三个号码的组合，共有 `c(7, 3)`个。
> 
c(7, 3) = 7! / 3! * (7 - 3)! = 35
这就是说，三个数字的组合共有 35 种。我们可以把它们全部列出来。
> 
123 124 125 126 127 
134 135 136 137 
145 146 147 
156 157 
167 
234 235 236 237 
245 246 247 
256 257 
267 
345 346 347 
356 357 
367 
456 457 
467 
567
上面是所有 35 种可能的组合，你必须从中选出 7 种。请问应该选择哪七种？
六、最佳组合
答案是下面这七种组合。
> 
123 145 167 247 256 346 357
这七张彩票能让你的收益最大化。因为，不管最后的中奖号码是什么，它们可以保证你总是获得 6 元奖金。如果中奖号码是 123，那么你拿到头奖 6 元；如果中奖号码是 367，那么 167、346、357 这三张彩票各自猜中两个号码，你中了三个小奖，奖金总额也是 6 元。
仔细观察这七张彩票，你会发现它们是精心选择的：每个数字都正好出现三次。这导致你要么中一个大奖，要么中三个小奖。
七、几何选择法
这七张彩票是怎么选出的呢？
![640?wx_fmt=gif](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/XjGG4txZI4E8O8DPD23rGia6oZ4jBMfgy8YlqBCbwj264WkXjeW3X5ichiamllN6kmS6JeLgdsdvUgzopV9HHOv3Q/640?wx_fmt=gif)
有一种几何方法，可以非常简单地做到这一点。七个号码就是七个点，把它们用直线连起来，每根线上只能有三个点，而每个点出现在三根线上。画成上面的形状，就得到了七根线（内部的圆也算一根线）。然后，记录一下每根线上的号码，很简单就选出了七张彩票。
更严谨的证明是这样的：1 到 7 这七个数字，共有 21 种两个数字的组合（ `C(7, 2)`），这意味着只要把这 21 种组合都买全了，就可以保证中三个小奖。因为三个中奖号码里面，共有三种两个数字的组合（比如中奖号码是 367，那么 36、37、67 都可以中小奖）。另一方面，由于每张彩票包含三个号码，即包含三种两个数字的组合，那么最少只要买 7 张彩票就能覆盖全部 21 种组合。
八、实际的策略
回到前面的问题，马萨诸塞州的彩票应该怎么买？
6 个号码只要猜中 4 个，就可以中二等奖，只要把所有四个号码的组合都买了，就可以确保中 15 个二等奖（6 个中奖号码共有 15 个四个号码的组合 `C(6, 4)`）。
48 个号码里面共有 194580 种四个号码的组合（ `C(48, 4)`），既然一张彩票包含 15 种组合，那么最少购买 12972 张彩票就够了（ `194580 / 15 = 12972`），就可以包含所有四个号码的组合。如果有兴趣的话，你可以写一个程序，算出包含这 194580 种组合的所有彩票。
购买 12972 张彩票，需要 25944 元（ `12972 * 2`）。根据前面的奖金额，二等奖的奖金是 2385 元，那么 15 个二等奖就是 35775 元（ `2385 * 15`）。因此，投入 25944 元，可以无风险地获得 35775 元。当然，这种回报率的前提是，当期没人猜中特等奖，否则奖金就会被大大稀释。
∑编辑 | Gemini
来源 | 阮一峰的网络日志
![640?wx_fmt=jpeg](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/951TjTgiabkz1SRWmm2kJgtV2NTQtdSgtyl7nJbJm8xS78Td2LBbJQKKqyE54oaOO9upMribZagMKYJVBaEDyKtA/640?wx_fmt=jpeg)
算法数学之美微信公众号欢迎赐稿
稿件涉及数学、物理、算法、计算机、编程等相关领域
经采用我们将奉上稿酬。
投稿邮箱：math_alg@163.com
