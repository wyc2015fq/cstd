# 一个42KB的文件，解压完其实是个4.5PB的“炸弹” - 算法与数学之美 - CSDN博客
2018年09月19日 22:41:58[算法与数学之美](https://me.csdn.net/FnqTyr45)阅读数：182
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bw4ab46ehjjFcV7M6NDdIUyeQIBibHan6JjL2rSext6BNibpAfcjsm1Lkg/640?wx_fmt=png)你听说过 ZIP 炸弹吗?
一个很小很小的，几十 KB 的压缩过后的文件，解压以后有几百万 GB ，好像炸弹一样。
在继续介绍它之前，差评君想先问问各位都用过哪些压缩软件。。。
WinRAR ？
或者 2345 好压？
还是开源的 7 - Zip ？
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZM9MEOOkQI4CTL4GQP4iaIgLfR1xibDwtAZcPbNrgWicvonb5b4VzTJOriaw/640?wx_fmt=png)
其实压缩软件虽然五花八门，但目的都很单纯：
**把文件占用空间缩小。**
不过差评君上面提到的压缩软件，又不单纯是缩小空间。
JPG 图片 ， MP3 音乐格式也起到了压缩作用。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bw7A5QXcuCMd6hpEbo5lFicuMHicSCPiberT1LDttgV4oqazQcsnp908BiaQ/640?wx_fmt=png)但是 JPG， MP3 们执行的是**有损压缩**。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMrR6ibMLZvFDQQ6RLfuibcTuxPkO4TlVvmCFHYHBibialRnL7Zyib2Vu8LpQ/640?wx_fmt=png)
一旦个文件被有损压缩的时候，会损失一部分数据。
损失的代价就是，你**无法从被压缩的文件还原出压缩前的文件。**
图片，音乐等多媒体在有的时候考虑可用性和传播性，对这样的结果是可以接受的。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwEDMVca9OoeoQ0ax5dqib44PkcERL0KIncEzP5jbCMibOsBAyvIjQ2dyg/640?wx_fmt=png)但对许多通用数据来说，往往需要的是**无损压缩**，比如 .zip 。
对于无损压缩来说，算法非常重要，不同的算法能实现的压缩率和速度有很大差别。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMXgdicQEI4ibZR26ic28YsqIFxRGE37yEoAE6UYfibQ6iac8ENZ0QyPt33Yg/640?wx_fmt=png)
如上图所示，主流的算法一般在 30% - 40% 。
而文章一开始介绍的 ZIP 炸弹，是一个名为 42.zip 的文件。
它的初始大小是 42KB ， 解压密码是 42 。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMLOk8VKLaWvoBoXcl3zu1fibaHUtEmlzibia9HR0BSiaQmBvqUJBYiayyzNw/640?wx_fmt=png)
解压之后的大小，足足有** 4.5 PB 。**
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwuH6FklibNjvYLadMm5YGNFuy7xTVObm8HJZmfIyhAYASL8QtYvwApow/640?wx_fmt=png)嗯。。。就是这么嚣张。
解压这个 42.zip 以后会出现 16 个压缩包，每个压缩包又包含 16 个，如此循环 5 次，最后得到 16 的 5 次方个文件，也就是 1048576 个。
![640?wx_fmt=gif](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMrDwBN4Hqj4cNpDgQDZBNphRZgUmEGq6jmWZhr54H2icXgUqgYgS1vow/640?wx_fmt=gif)
**这一百多万个最终文件，每个大小为 4.3 GB 。**
因此整个解压过程结束以后，会得到 1048576 * 4.6 GB = 4508876.8 GB
也就是 4508876.8 ÷ 1024 ÷ 1024 = **4.5 PB**
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwhMCCSHh5icKVdWNUdy3bxxKvFMbzVic0Z2h0dic1UnHrf0F3Ur77a3pQQ/640?wx_fmt=png)还有比它更嚣张的。
一个叫做 droste.zip 的大小为 28 KB 的文件，一旦被打开了以后，就会无限解压缩生成一份同样的文件，**直到永远。**
这个文件名灵感应该取自德罗斯特效应 （ Droste Effect ），是指一张图片的部分与整张图片相同，无限循环。。。如下图↓
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMmIKtXb0T5l8rNhS0S9DeXvpkRajcGsldvrRZzEQMt71UMNlsP80Quw/640?wx_fmt=png)
这个名字源自一家叫德罗斯特的可可粉厂商做的商品包装。。。
注意女仆手上拿着的产品图
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMOH6R169cRexzXZ1BefBQxLhY3YOibjgD3yiah88t6N6xhI1ZH7Iib9h9w/640?wx_fmt=png)
咳咳。。。扯远了。
总而言之，这个 droste.zip 的核心原理就是输出结果为自身。
举个例子，制作者大概做了这么一件事：
在引号里重复这句话 “ 在引号里重复这句话 ” 
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bw4ab46ehjjFcV7M6NDdIUyeQIBibHan6JjL2rSext6BNibpAfcjsm1Lkg/640?wx_fmt=png)然后解压缩之后，硬盘就。。。 BOOM ！
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZM7iakwXG5zdZFTJXx8dYG8XIcC4WZ9tSxuK0hGmf8WA7Ak1RmvicMRmGg/640?wx_fmt=png)
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwSXtxu938cDdHtKdQRGKNYeIHeaZsibe2qdT0CLwiaKTOWKr5ZtSjbXRQ/640?wx_fmt=png)当然。。。也有剑走偏锋思路不同的。
有一段名为 《 彗星撞地球 》 的影片，也展现了神奇的压缩比率。
这段 3D 影片如果直接放出来要 15 G 左右，效果。。。放在它出生的年代 2000 年还真不差。
![640?wx_fmt=gif](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMaATEW0cE9o1qibLibFaUYSbn9SicibMgdPnianKMyfuEgeMooa9Bu4ub4Cw/640?wx_fmt=gif)
这个压缩过的大小**只有 64 KB， 压缩了 25 万倍 ！**
实现的原理其实不算通常意义上的压缩。
而是制作组 Warez 做了一个 64KB 的可执行 EXE 文件，运行的时候会调用显卡，CPU 及内存等等及时渲染动画。
打个比方，动画就好比连环画，传统影片是画好的一册，而这个 《 彗星撞地球 》 则是看的时候现场一幅幅画。
录屏软件录了 7 分钟都要 2.27 G 。（ 当然，这和现代显示屏分辨率比较高有关系 ）
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZM3uI9R1FbbLaXNsBhgmyLK8AIWJKfCU56PyX06Kl7udfCRplu3dJQhA/640?wx_fmt=png)
那么问题来了。。。
一个文件的压缩率有极限吗？
有，可以由信息学之父克劳德·香农提出的信息熵函数算出来。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZMcpst4LDgWep3n4tNZIMjMZib2I6Q4Q2UD267ictqibqMd1S68zm9uUsVw/640?wx_fmt=png)
不过 42.zip 也好，droste.zip 也好，不适合套用香农提出的极限。
因为这两个文件为了达到惊人的压缩比，有大量刻意重复的数据，这种重复数据在压缩的时候是可以被丢弃的，没啥实质性内容的信息。
那么。。。
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwSUKjbicib84GnkUIgZqjibDmdwZzoSUPxicKqJIObvqnibPbNLJbceNCPOg/640?wx_fmt=png)如果动画还有点传播意义， 42.zip 和 droste. zip 还有啥意义呢？
这儿就要提就是 ZIP 炸弹之所以被称作 “ 炸弹 ” 的真正原因了。。。
除了会 “ 爆炸 ” ，** 这玩意儿其实是拿来攻击别人的。**
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/yZPTcMGWibvtiaH6WBgAJ0ENFW4pMLZhZM5iccIKY7JgaXDIicKsqAnlSjDydficl359W2gbZ5ibe1LW4Lg7hQVZ13Jw/640?wx_fmt=png)
某些病毒制作者利用杀毒软件会扫描压缩文件内部的特性，会把 ZIP 炸弹连带病毒一起发到目标电脑上。
而 ZIP 炸弹表面上看起来很小，易于传输，但实际上扫描起来非常花时间。
趁着杀毒软件忙着扫描 4.5 PB 的数据，被占用时，病毒软件就可以趁虚而入了 ~
**干黑产的，角度刁钻得让人折腰。**
不过现在很多杀毒软件已经有办法避开这种 zip 炸弹的佯攻了，这个话题渐渐地抛开了黑产。
一直以来压缩算法是算法研究里津津乐道的话题， Huffman 树， LZW 字典等等。。。
用程序解决信息问题的姿势，仔细一琢磨也挺有意思的不是？
∑编辑 | Gemini
来源 | 差评
更多精彩：
☞  [哈尔莫斯：怎样做数学研究](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554187&idx=1&sn=35143b89b06fe4f5273f210b2d6a7c91&chksm=8b7e3290bc09bb86f7bb3f158d993df3f019a7e9ce3bc8897e164e35a2ebe5a4e0bdcc111089&scene=21#wechat_redirect)
☞  [扎克伯格2017年哈佛大学毕业演讲](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554187&idx=2&sn=c75293463823e4d6769638e54b64f3ec&chksm=8b7e3290bc09bb86dc1e3f8e78d0b6de8811d75f3dcb092766fcb8ba0bab1cd9ba1ddfcef3b9&scene=21#wechat_redirect)
☞  [线性代数在组合数学中的应用](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554141&idx=1&sn=74a74c4e4d08eba0dd734528aa0b08e7&chksm=8b7e32c6bc09bbd073b34c22004ac6e4d99c8a0caa64c7d3dbaa8fd55e6ef1fc87ed545b8b7e&scene=21#wechat_redirect)
☞  [你见过真的菲利普曲线吗？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554105&idx=1&sn=224ab0d38fb57facea70081385360d58&chksm=8b7e3222bc09bb34d3b6df665087e64b233778ed427598d08e809f96261e898c1c0de6188bbc&scene=21#wechat_redirect)
☞  [支持向量机(SVM)的故事是这样子的](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554096&idx=1&sn=46783e6ace661a3ccbd8a6e00fb17bf9&chksm=8b7e322bbc09bb3d73dc240f2280bddf2ef8b7824a459a24bd7f6eeadd60edb96e690d467f6e&scene=21#wechat_redirect)
☞  [深度神经网络中的数学，对你来说会不会太难？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554077&idx=2&sn=3ecd63f2205fd59df8c360c97c943ef6&chksm=8b7e3206bc09bb10a36b09547efe0c54f41423b180622c1fdc7f14747ccc8f8fecee3a12e2cd&scene=21#wechat_redirect)
☞  [编程需要知道多少数学知识？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652554062&idx=1&sn=17f0a88d5e15d1adfc29c690a0b1b89b&chksm=8b7e3215bc09bb038c6caa59d0f49cedd929f9be1104beea3411186cf4c81de69efc71a17883&scene=21#wechat_redirect)
☞  [陈省身——什么是几何学](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553994&idx=2&sn=74f67a1a3ac5c705f51f2ba619b717f6&chksm=8b7e3251bc09bb47dce73319948780081efe0333ffae99ea04a9eeabbcfcb38a29b4b73fb7c1&scene=21#wechat_redirect)
☞  [模式识别研究的回顾与展望](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553949&idx=2&sn=d171680964df774397efd9db81c00347&chksm=8b7e3386bc09ba90bf0f6e1cabf82ba86ff94630cb5ee2e0f14ff9455db52be32ddbc289d237&scene=21#wechat_redirect)
☞  [曲面论](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553747&idx=1&sn=e25f866d510cf2338b6d9e1b32bafb62&chksm=8b7e3348bc09ba5ea1caaf2a7bfcd80a7e7559b1983e473eda2206e56df7f38ef3cecf2f77c7&scene=21#wechat_redirect)
☞  [自然底数e的意义是什么？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553811&idx=1&sn=000305074471c3d4c681c9cfd4e4bc93&chksm=8b7e3308bc09ba1e3043f5568a3a75a045285a1de97e4da36918bac68e7c6d579ad5d8cc25ab&scene=21#wechat_redirect)
☞  [如何向5岁小孩解释什么是支持向量机（SVM）？](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553670&idx=1&sn=ea75a448c016f7229e4cb298f6017614&chksm=8b7e309dbc09b98bc622acdf1223c7c2f743609d0a577dd43c9e9d98ab4da4314be7c1002bd5&scene=21#wechat_redirect)
☞  [华裔天才数学家陶哲轩自述](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553646&idx=2&sn=bbf8f1be1ca1c66ad3f3270babea6885&chksm=8b7e30f5bc09b9e3e1a4fa735412e2fcb20df9e78f2f346bf578018ceab77de6326095d1bf71&scene=21#wechat_redirect)
☞  [代数，分析，几何与拓扑，现代数学的三大方法论](http://mp.weixin.qq.com/s?__biz=MzA5ODUxOTA5Mg==&mid=2652553596&idx=1&sn=bc5064e871831f862db6d19c3de6327e&chksm=8b7e3027bc09b93194fa09b25e2df400421c062927bb9120912875f8aaf0bb25553fc8f51e3b&scene=21#wechat_redirect)
![640?wx_fmt=png](https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/951TjTgiabky7x6u1VxMVMia4MLibNzC2nrumY3zDflTsCeoM04M1BrkvPny8tsw6hYkIicUr42iarLmadL2x6JwV6A/640?wx_fmt=png)
算法数学之美微信公众号欢迎赐稿
稿件涉及数学、物理、算法、计算机、编程等相关领域，经采用我们将奉上稿酬。
投稿邮箱：math_alg@163.com
