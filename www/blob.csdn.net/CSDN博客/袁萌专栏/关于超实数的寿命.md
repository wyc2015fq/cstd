# 关于超实数的寿命 - 袁萌专栏 - CSDN博客
2018年09月15日 14:23:37[yuanmeng001](https://me.csdn.net/yuanmeng001)阅读数：187
        今年9月12日,袁萌一行三人在向国家教育部高教司汇报工作时,袁萌指出：超实数有条件诞生在19世纪20年代柯西定义实数为柯西序列等价类的同一时代。然而,历史对人类开了一个大玩笑。直到20世纪60年代,在法国布尔巴基学派关于集合滤器、超幂“引产婆”助力之下,美国数学家鲁宾逊在1960年接生了“超实数”这个晚生儿。
        进入本世纪,世界范围内,超实数研究“方兴未艾”,来日方长。
        近年来,ISAAC  GOLDBRING教授撰写了简明易懂的超实数科普文章,内容丰富,值得一读。
        当前,无穷小微积分手机版投放全国高校行动已经进行三轮,少数师生对超实数也许有所耳闻,但是,对于什么滤器,什么是超幂却不甚明了。
        阅读本文附件,共计16章,110页,篇幅不大,即可释疑解惑。超实数的寿命究竟有多长？伴随00后宝贝一块儿成长。学无止境也。
        袁萌  陈启清   9月15日
附：**LECTURE NOTES ON NONSTANDARD ANALYSIS UCLA SUMMER SCHOOL IN LOGIC**
ISAAC GOLDBRING（2014年11月10日发表）
Contents
1. The hyperreals 3
1.1. Basic facts about the ordered real ?eld 3
1.2. The nonstandard extension 4
1.3. Arithmetic in the hyperreals 5
1.4. The structure of N? 7 1.5. More practice with transfer 8
1.6. Problems 9
2. Logical formalisms for nonstandard extensions 10 2.1. Approach 1: The compactness theorem 11 2.2. Approach 2: The ultrapower construction 12 2.3. Problems 16
3. Sequences and series 17 3.1. First results about sequences 17
3.2. Cluster points 19
3.3. Series 21
3.4. Problems 22
4. Continuity 23
4.1. First results about continuity 23
4.2. Uniform continuity 25 4.3. Sequences of functions 27
4.4. Problems 30
5. Di?erentiation 33
5.1. The derivative 33
5.2. Continuous di?erentiability 35
5.3. Problems 36
6. Riemann Integration 38 6.1. Hyper?nite Riemann sums and integrability 38 6.2. The Peano Existence Theorem 41
6.3. Problems 43
7. Weekend Problem Set #1 44
8. Many-sorted and Higher-Type Structures 47 8.1. Many-sorted structures 47
Date: November 10, 2014.
1
2 ISAAC GOLDBRING
8.2. Higher-type sorts 48
8.3. Saturation 51
8.4. Useful nonstandard principles 53
8.5. Recap: the nonstandard setting 54
8.6. Problems 54
9. Metric Space Topology 55 9.1. Open and closed sets, compactness, completeness 55
9.2. More about continuity 63
9.3. Compact maps 64
9.4. Problems 65
10. Banach Spaces 67
10.1. Normed spaces 67 10.2. Bounded linear maps 68
10.3. Finite-dimensional spaces and compact linear maps 69
10.4. Problems 71
11. Hilbert Spaces 73
11.1. Inner product spaces 73
11.2. Orthonormal bases and `2 75
11.3. Orthogonal projections 79
11.4. Hyper?nite-dimensional subspaces 82
11.5. Problems 83
12. Weekend Problem Set #2 85
13. The Spectral Theorem for compact hermitian operators 88
13.1. Problems 93
14. The Bernstein-Robinson Theorem 94
15. Measure Theory 101 15.1. General measure theory 101
15.2. Loeb measure 102 15.3. Product measure 103 15.4. Integration 104
15.5. Conditional expectation 104
15.6. Problems 105
16. Szemer′edi Regularity Lemma 106
16.1. Problems 108 References 110
Nonstandard analysis was invented by Abraham Robinson in the 1960s as a way to rescue the na¨?ve use of in?nitesimal and in?nite elements favored by mathematicians such as Leibniz and Euler before the advent of the rigorous methods introduced by Cauchy and Weierstrauss. Indeed, Robinson realized that the compactness theorem of ?rst-order logic could be used to provide ?elds that “logically behaved” like the ordered real ?eld while containing “ideal” elements such as in?nitesimal and in?nite elements.
LECTURE NOTES ON NONSTANDARD ANALYSIS 3
Since its origins, nonstandard analysis has become a powerful mathematical tool, not only for yielding easier de?nitions for standard concepts and providing slick proofs of well-known mathematical theorems, but for also providing mathematicians with amazing new tools to prove theorems, e.g. hyper?nite approximation. In addition, by providing useful mathematical heuristics a precise language to be discussed, many mathematical ideas have been elucidated greatly. In these notes, we try and cover a wide spectrum of applications of nonstandard methods. In the ?rst part of these notes, we explain what a nonstandard extension is and we use it to reprove some basic facts from calculus. We then broaden our nonstandard framework to handle more sophisticated mathematical situations and begin studying metric space topology. We then enter functional analysis by discussing Banach and Hilbert spaces. Here we prove our ?rst serious theorems: the Spectral Theorem for compact hermitian operators and the Bernstein-Robinson Theorem on invariant subspaces; this latter theorem was the ?rst major theorem whose ?rst proof was nonstandard. We then end by brie?y discussing Loeb measure and using it to give a slick proof of an important combinatorial result, the Szemer′edi Regularity Lemma. Due to time limitations, there are many beautiful subjects I had to skip. In particular, I had to omit the nonstandard hull construction (although this is brie?y introduced in the second weekend problem set) as well as applications of nonstandard analysis to Lie theory (e.g. Hilbert’s ?fth problem), geometric group theory (e.g. asymptotic cones), and commutative algebra (e.g. bounds in the theory of polynomial rings). Wehaveborrowedmuchofourpresentationfromtwomainsources: Goldblatt’s fantastic book [2] and Davis’ concise [1]. Occasionally, I have borrowed some ideas from Henson’s [3]. The material on Szemer′edi’s Regularity Lemma and the Furstenberg Correspondence come from Terence Tao’s blog. I would like to thank Bruno De Mendonca Braga and Jonathan Wolf for pointing out errors in an earlier version of these notes. 1. The hyperreals 1.1. Basic facts about the ordered real ?eld. The ordered ?eld of real numbers is the structure (R;+,·,0,1,<). We recall some basic properties: ? (Q is dense in R) for every r ∈R and every  ∈R>0, there is q ∈Q such that |r?q| < ; ? (Triangle Inequality) for every x,y ∈R, we have |x + y|≤|x|+|y|; ? (Archimedean Property) for every x,y ∈ R>0, there is n ∈ N such that nx > y. Perhaps the most important property of the ordered real ?eld is De?nition 1.1 (CompletenessProperty). If A ?Risnonemptyandbounded above, then there is a b ∈R such that: ? for all a ∈ A, we have a ≤ b (b is an upper bound for A);
4 ISAAC GOLDBRING ? if a ≤ c for all a ∈ A, then b ≤ c (b is the least upper bound for A). Such b is easily seen to be unique and is called the least upper bound of A, or the supremum of A, and is denote sup(A). Exercise 1.2. Show that if A is nonempty and bounded below, then A has a greatest lower bound. The greatest lower bound is also called the in?mum of A and is denoted inf(A). 1.2. The nonstandard extension. In order to start “doing” nonstandard analysis as quickly as possible, we will postpone a formal construction of the nonstandard universe. Instead, we will pose some postulates that a nonstandard universe should possess, assume the existence of such a nonstandard universe, and then begin reasoning in this nonstandard universe. Of course, after we have seen the merits of some nonstandard reasoning, we will return and give a couple of rigorous constructions of nonstandard universes. We will work in a nonstandard universe R? that has the following properties: (NS1) (R;+,·,0,1,<) is an ordered sub?eld of (R?;+,·,0,1,<). (NS2) R? has a positive in?nitesimal element, that is, there is  ∈R? such that  > 0 but  < r for every r ∈R>0. (NS3) For every n ∈N and every function f : Rn →R, there is a “natural extension” f : (R?)n → R?. The natural extensions of the ?eld operations +,· : R2 → R coincide with the ?eld operations in R?. Similarly, for every A ?Rn, there is a subset A? ?(R?)n such that A?∩Rn = A.(NS4) R?, equipped with the above assignment of extensions of functions and subsets, “behaves logically” like R. Thelastitemintheabovelistis,of course,extremelyvagueandimprecise. Wewillneedtodiscusssomelogicinordertocarefullyexplainwhatwemean by this. Roughly speaking, any statement that is expressible in ?rst-order logic and mentioning only standard numbers is true in R if and only if it is true in R?. This is often referred to as the Transfer Principle, although, logically speaking, we are just requiring that R?, in a suitable ?rst-order language, be an elementary extension of R. We will explain this in more detail later in these notes. That being said, until we rigorously explain the logical formalism of nonstandard analysis, we should caution the reader that typical transferrable statements involve quanti?ers over numbers and not sets of numbers. For example, the completeness property for R says that “for all sets of numbers A that are nonempty and bounded above, sup(A) exists.” This is an example of a statement that is not transferrable; see Exercise 1.8 below. De?nition 1.3. R? is called the ordered ?eld of hyperreals. Remark. If f : A → R is a function, where A ? Rn, we would like to also consider its nonstandard extension f : A? → R?. We will take care of this matter shortly.
LECTURE NOTES ON NONSTANDARD ANALYSIS 5
1.3. Arithmetic in the hyperreals. First, let’s discuss some immediate consequences of the above postulates. Since R? is an ordered ?eld, we can start performing the ?eld operations to our positive in?nitesimal . For example, has an additive inverse?, which is then a negative in?nitesimal. Also, we can consider π ·; it is reasonably easy to see that π · is also a positive in?nitesimal. (This will also follow from a more general principle that we will shortly see.) Since  6= 0, it has a multiplicative inverse ?1. For a given r ∈ R>0,since  < 1 r, we see that ?1 > r. Since r was an arbitrary positive real number, we see that ?1 is a positive in?nite element. And of course, ??1 is a negative in?nite element. But now we can continue playing, considering numbers like √2·?3 and so on... And besides algebraic manipulations, we also have transcendental matters to consider. Indeed, we have the nonstandard extension of the function sin : R? → R?; what is sin()? All in due time... First, let’s make precise some of the words we have been thus far freely tossing around. De?nition 1.4. (1) The set of ?nite hyperreals is R?n :={x ∈R? ||x|≤ n for some n ∈N}. (2) The set of in?nite hyperreals is Rinf := R?\R?n. (3) The set of in?nitesimal hyperreals is μ :={x ∈R? ||x|≤ 1 n for all n ∈N>0}. The notation μ comes from the more general notion of monad, which we will encounter later in the notes. Observe that μ ? R?n, R ? R?n, and μ ∩R = {0}. Also note that ifδ ∈ μ\{0}, then δ?1 / ∈R?n. Lemma 1.5. (1) R?n is a subring of R?: for all x,y ∈R?n, x±y, x·y ∈R?n. (2) μ is an ideal of R?n: μ is a subring of R? and for all x ∈ R?n and y ∈ μ, we have xy ∈ μ. Proof. (1) Fix x,y ∈R?n. Choose r,s ∈R>0 such that |x|≤ r and |y|≤ s. Then |x±y|≤ r + s and |xy|≤ rs, whence x±y, xy ∈R?n. (2) Suppose x,y ∈ μ. We need to show that x±y ∈ μ. Fix r ∈ R>0; we need |x±y|≤ r. Well, since x,y ∈ μ, we have that |x|,|y|≤ r 2. Then, |x±y|≤|x|+|y|≤ r 2 + r 2 = r. Now suppose x ∈R?n and y ∈ μ. We need xy ∈ μ. Fix r ∈R>0; we need |xy|≤ r. Choose s ∈ R>0 such that |x|≤ s. Since y ∈ μ, we have |y|≤ r s. Thus, |xy|=|x||y|≤ s· r s = r.
 A natural question now arises: What is the quotient ring R?n/μ? The answer will arrive shortly.
6 ISAAC GOLDBRING De?nition 1.6. For x,y ∈R?, we say x and y are in?nitely close, written, x ≈ y, if x?y ∈ μ. Exercise 1.7. (1) ≈ is an equivalence relation on R?, namely, for all x,y,z ∈R?: ? x ≈ x; ? x ≈ y implies y ≈ x; ? x ≈ y and y ≈ z implies x ≈ z.(2) ≈ is a congruence relation on R?n, namely, ≈ is an equivalence relation on R?n and, for all x,y,u,v ∈ R?n, if x ≈ u and y ≈ v, then x±y ≈ u±v and xy ≈ uv. Exercise 1.8. Show that R is a nonempty set that is bounded above in R? but that sup(R) does not exist in R?. Thus, the completeness property is not true for R?. The next theorem is of extreme importance. Theorem 1.9 (Existence of Standard Parts). If r ∈ R?n, then there is a unique s ∈ R such that r ≈ s. We call s the standard part of r and write st(r) = s. Proof. Uniqueness is immediate: if r ≈ s1 and r ≈ s2, with s1,s2 ∈R, then s1 ≈ s2, so s1 ? s2 ∈ μ ∩R = {0}, so s1 = s2. We now show existence. Without loss of generality, we can assume r > 0. (Why?) We then set A = {x ∈ R | x < r}. Since r ∈ R?n, A is bounded above. Also, 0 ∈ A, so A is nonempty. Thus, by the Completeness Property, sup(A) exists. Set s := sup(A). We claim that this is the desired s. Fix δ ∈R>0. Since s is an upper bound for A, s + δ / ∈ A, so r ≤ s + δ. If r ≤ s?δ, then s?δ wouldbe an upper bound for A, contradicting the fact that s was the least upper bound for A. Consequently, r ≥ s?δ. It follows that |r ?s| ≤ δ. Since δ ∈R>0 is arbitrary, it follows that r?s ∈ μ.
 Remark. In proving that standard parts exist, we used the Completeness Property for R. Later, we will show that the Completeness Property is a consequence of the existence of standard parts. Thus, an equivalent way to state the completeness property for R is that standard parts exist. Remark. Later, when we start studying metric space topology from the nonstandard perspective, we will call an element nearstandard if it is within an in?nitesimal distance from a standard element. Some metric spaces also have a natural notion of ?nite, e.g. R, and, more generally, normed vector spaces. The equivalence between ?nite and nearstandard asserted in the previous theorem will also hold for ?nite-dimensional normed spaces. In general, nearstandard points are always ?nite, but in in?nite-dimensional settings, this inclusion is often strict. This topic will be discussed later in these notes. Exercise 1.10. Let x,y ∈R?n.
LECTURE NOTES ON NONSTANDARD ANALYSIS 7 (1) x ≈ y if and only if st(x) = st(y). (2) If x ≤ y, then st(x)≤st(y). The converse of this statement is false; give an example. (3) If x ∈R, then st(x) = x. Theorem 1.11. st : R?n → R is a surjective ring homomorphism: for all x,y ∈R?n, st(x + y) = st(x)+st(y) and st(xy) = st(x)st(y). Proof. This follows immediately from Exercises 1.7(2) and 1.10(3).
 Corollary 1.12. R?n/μ ～ = R. Proof. The kernel of st is precisely μ; now use the First Isomorphism Theorem for rings.
 Corollary 1.13. μ is a maximal ideal of R?n. Proof. This follows from the fact that R?n/μ is a ?eld.
 Exercise 1.14. Give a direct proof of the last corollary, that is, show directly that μ is a maximal ideal of R?n. 1.4. The structure of N?. In this subsection, let’s take a brief look at the picture of N?. First, let’s establish that N?\N6= ?. To see this, let y ∈R? be positive in?nite. Since the statement “for all x ∈R, if x > 0, then there is n ∈ N such that x ≤ n” is true in R, the statement “for all x ∈ R?, if x > 0, then there is n ∈ N? such that x ≤ n” is true in R? by the transfer principle. Thus, there is N ∈ N? such that y ≤ N. However, if N ∈ N, then y is ?nite, a contradiction. Thus, N ∈N?\N. Also note that the same argument implies that N is positive in?nite. The last sentence of the previous paragraph holds for all N ∈ N? \N:if N ∈ N? \N, then N is positive in?nite. Indeed, the statement “for alln ∈ N, n ≥ 0” is true in R, so the statement “for all n ∈ N?, n ≥ 0” is true in R?, whence N ≥0. Also, if N ∈R?n, then there is n ∈N such that n ≤ N ≤ n +1. However, the statement “for all m ∈N, if n ≤ m ≤ n +1, then m = n or m = n+1” is true in R; applying the transfer principle to this statement, we have N = n or N = n + 1, whence N ∈ N, a contradiction. Thus, N ∈Rinf. Now that we know that all nonstandard natural numbers are positive in?nite, let’s ask the question: “How many nonstandard natural numbers are there?” To examine this question, let’s ?rst establish some notation and terminology. For N ∈ N?, set γ(N) := {N ± m | m ∈ N}, the galaxy or archimedean class of N. Clearly, N ∈ N if and only if γ(N) = Z; we call this the ?nite galaxy, while all other galaxies will be referred to as in?nite galaxies. Lemma 1.15. If N ∈N?\N, then γ(N)?N?. Proof. By transfer, N+1∈N?; by induction, this shows that N+m ∈N? for all m ∈N. We now show, also inductively, that N ?m ∈N? for all m ∈N.
8 ISAAC GOLDBRING Suppose that the result is true for a given m. Notice that N ?m 6= 0, else N = m ∈ N. Applying transfer to the statement “for all n ∈ N, if n 6= 0, then n?1∈N,” we see that (N ?m)?1 = N ?(m +1)∈N?.
 Since we know we have at least one nonstandard natural number, we now know that we have an entire galaxy of them. Notice that a galaxy looks just like a copy of Z and that γ(M) = γ(N) if and only if |M ?N|∈N. Observe that if γ(M) = γ(M0) and γ(N) = γ(N0) and γ(M) 6= γ(N),then M < N if and only if M0 < N0. Consequently, we can de?ne an ordering on galaxies: if γ(M) 6= γ(N), then we say γ(M) < γ(N) if and only if M < N. When γ(M) < γ(N), we think of M as being in?nitely less than N. What can be said about the ordering of the set of galaxies? In particular, are there more than just two galaxies? Lemma 1.16. The set of in?nite galaxies is densely ordered without endpoints, meaning: (1) there is no largest in?nite galaxy, that is, for every M ∈ N? \N, there is N ∈N?\N such that γ(M) < γ(N);(2) there is no smallest in?nite galaxy, that is, for every M ∈ N? \N, there is N ∈N?\N such that γ(N) < γ(M);(3) between any two in?nite galaxies, there is a third (in?nite) galaxy, that is, for every M1,M2 ∈N?\N such that γ(M1) < γ(M2), there is N ∈N?\N such that γ(M1) < γ(N) < γ(M2). Proof. (1) Given M ∈ N? \N, we claim that γ(M) < γ(2M). Otherwise, 2M = M + m for some m ∈N, whence M = m, a contradiction. (2) Since γ(M) = γ(M?1), we may as well suppose that M is even. Then γ(M 2 ) < γ(M) from the proof of (1); it remains to note that M 2 ∈N?\N.(3) Again, we may as well assume that M1 and M2 are both even. In this case, arguing as before, one can see that γ(M1) < γ(M1+M2 2 ) < γ(M2).
 Under suitable richness assumptions on the nonstandard extension (to be discussed later), one can go even further: if (Nα)α<κ is a descending sequence of nonstandard natural numbers, then there is N ∈ N? \N such that N < Nα for all α < κ. 1.5. More practice with transfer. In order to get some practice with the Transfer Principle, we will prove the assertion made in Remark 1.3. More precisely: Theorem 1.17. The statement “every ?nite element of R? has a standard part” implies the Completeness Property of the ordered real ?eld. Proof. Suppose that A ? R is nonempty and bounded above. We must show that sup(A) exists. Let b ∈ R be an upper bound for A. Let’s de?ne a function f : R → R as follows: If r ∈ R\N, set f(r) = 0. Otherwise, set f(n) = the least k ∈Z such that k n is an upper bound for A; such a k exists
LECTURE NOTES ON NONSTANDARD ANALYSIS 9 by the Archimedean property. Observe that, if m,n ∈ N and n ≤ m, then f(n)≤ f(m). We now consider the nonstandard extension of the function f : R? →R?.Fix N ∈ N? \N. The key idea is to understand f(N). By the transfer principle, we know that f(N) is the least element of Z? such that f(N) N is an upper bound for A?. Also, by the transfer principle applied to the last observation of the previous paragraph, if m ∈N, then f(m)≤ f(N). Claim 1: f(N) N ∈ R?n: Suppose this is not the case, so, f(N) N ∈ Rinf. Sincef (1) ≤ f(N), we must have that f(N) is a positive in?nite element. Since the statement “for all n ∈N, there is a ∈ A such that f(n)?1 n < a” is true in R, by the Transfer Principle, the statement for all n ∈ N?, there is a ∈ A? such that f(n)?1 n < a” is true in R?. Thus, we may ?x a0 ∈ A? such thatf (N)?1 N < a0. Since f(N)?1 N is a positive in?nite element (as it di?ers from the positive in?nite element f(N) N by the in?nitesimal amount 1 N), we have that a0 is also a positive in?nite element of R?. However, the statement “for all a ∈ A, we have a ≤ b” is true in R, whence the statement “for all a ∈ A?, we have a ≤ b” is true in R?. Consequently, a0 ≤ b, contradicting the fact that a is a positive in?nite element of R?.
By Claim 1 and the assumption of the theorem, st(f(N) N ) exists. Set r := st(f(N) N ). Claim 2: r is an upper bound for A: To see this, ?x a ∈ A. Then, by the transfer principle, r ≤ f(N) N , whence a = st(a)≤st(f(N) N ) = r. Claim 3: r = sup(A): To see this, ?x δ ∈ R>0. We must ?nd a ∈ A such that r?δ < a. As we showed in the proof of Claim 1, there is a ∈ A? such that f(N)?1 N < a. Since 1 N < δ, we have r?δ < f(N)?1 N , whence r?δ < a.In other words, the statement “there is a ∈ A? such that r?δ < a” is truein R?. By the transfer principle, the statement “there is a ∈ A such thatr ?δ < a” is true in R, which is precisely what we needed.
 1.6. Problems. Problem 1.1. Let x,x0,y,y0 ∈R?n. (1) Show that x ≈ y if and only if st(x) = st(y). (2) Show that if x ∈R, then x = st(x). (3) Show that x ≤ y implies st(x) ≤ st(y). Show that the converse is false. (4) Show that if st(x) < st(y), then x < y. In fact, show that if st(x) < st(y), then there is r ∈R such that x < r < y. (5) Suppose that x ≈ x0 and y ≈ y0. Show that: (a) x±y ≈ x0±y0;
10 ISAAC GOLDBRING (b) x·y ≈ x0·y0; (c) x y ≈ x0 y0 if y 6≈0. Show that (c) can fail if y,y0 ∈ μ\{0}. Problem 1.2. Suppose x,y ∈ R? and x ≈ y. Show that if b ∈ R?n, then bx ≈ by. Show that this can fail if b / ∈R?n. Problem 1.3. (1) Show that R? is not complete by ?nding a nonempty subset of R? which is bounded above that does not have a supremum. (2) Show that if A ?R is unbounded, then A has no least upper bound when considered as a subset of R?. (This may even be how you solved part (a).) Problem 1.4. Let F be an ordered ?eld. F is said to be archimedean if for any x,y ∈ F with x,y > 0, there is n ∈N such that y < nx. Show that R? is not archimedean. (It is a fact that archimedean ordered ?elds are complete, so this problem strengthens the result of the previous problem.) Problem 1.5. Construct a sequence of subsets (An) of R such that
(
∞ [ n=1
An)? 6=
∞ [ n=1
A? n.
Problem 1.6. If F is a ?eld and V is an F-vector space, let dimF(V ) denote the dimension of V as an F-vector space. (1) Observe that R? is an R?-vector space. (More generally, any ?eld F is naturally an F-vector space.) What is dimR?(R?)? (2) ObservethatR? isalsoavectorspaceoverR. ShowthatdimR(R?) = ∞. (Hint: Let x ∈R?\R. Show that {1,x,x2,...,xn,...} is an Rlinearly independent set.) (3) Show that R?n is an R-subspace of R?. What is dimR(R?n)? (4) Show that μ is an R-subspace of R?. What is dimR(μ)? (5) What is dimR(R?/R?n)? (6) What is dimR(R?n/μ)? Problem 1.7. Show that card(N?) ≥ 2?0; here card(A) denotes the cardinality of the set A. (Hint: First show that card(Q?)≥2?0). Problem 1.8. Give a direct proof that μ is a maximal ideal of R?n, that is, show that if I is an ideal of R?n such that μ ? I, then I = μ or I = R?n. 2. Logical formalisms for nonstandard extensions At this point, you might be wondering one of two things: (1) What else can I do with these wonderful postulates for nonstandard extensions? or (2) Does such a nonstandard extension exist or was everything done in Section 1 all magical nonsense?
LECTURE NOTES ON NONSTANDARD ANALYSIS 11
If you asked the former question, you can safely skip this section and discover the wonders of the nonstandard calculus to come in the following sections. (But please, at some point, return and read this section!) If you asked the latter question, we will ease your trepidations by o?ering not one, but two, di?erent logical formalisms for nonstandard extensions. The ?rst formalism will rely heavily on the Compactness Theorem from ?rst-order logic, but, modulo that prerequisite, this route is the quickest way to obtain nonstandard extensions. The second formalism is the Ultraproduct Approach, which is the most algebraic and “mainstream” way to explain nonstandard methods to “ordinary” mathematicians. Of course, at some point, some logic must be introduced in the form of L os’ (pronounced “Wash’s”) theorem, which will be discussed as well.
2.1. Approach 1: The compactness theorem. In this section, some familiarity with ?rst-order logic is assumed. We let L denote the ?rst-order language consisting of the following symbols: ? for every r ∈R, we have a constant symbol cr; ? for every n > 0 and every f : Rn → R, we have a n-ary function symbol Ff; ? for every n > 0 and every A ?Rn, we have a n-ary relation symbol PA. We let R be the L-structure whose universe is R and whose symbols are interpreted in the natural way, namely (cr)R = r, (Ff)R = f, and (PA)R = A. Let Γ = Th(R)∪{c0 < v < cr | r ∈ R>0}, a set of L-formulae. Then Γ is ?nitely satis?able: for any r1,...,rn ∈ R>0, choose r ∈ R>0 such that r < ri for i = 1,...,n. Then R |= Th(R)∪{c0 < v < cri | i = 1,...,n}JrK. By the Compactness Theorem, Γ is satis?able, say by some L-structure A and a ∈ A. Intuitively, a will be our desired positive in?nitesimal. But ?rst, we need R to be a substructure of A; some “abstract nonsense” can help take care of this.
Exercise 2.1. (1) The function h : R → A given by h(r) = (cr)A is an injective homomorphism of L-structures. (2) Use (1) to ?nd some L-structure A0 isomorphic to A such that R is a substructure of A0. By the result of the previous exercise, we may suppose that R is a substructure of A. In this case, we denote A by R? and denote the universe of R? by R?. For f : Rn → R, we let f : (R?)n → R? denote (Ff)R?. For A ? Rn, we set A? := (PA)R?. These are the extensions that axiom (NS3) postulates. Since being an ordered ?eld is part of Th(R), we have that R? is an ordered ?eld and, since R is a substructure of R?, we have that R is an ordered sub?eld of R?, verifying postulate (NS1). Let  ∈ R? be such
12 ISAAC GOLDBRING that, for every r ∈R>0, R? |= c0 < v < crJK. Then is a positive in?nitesimal, verifying postulate (NS2). Finally, the fact that R? |= Th(R) is the rigorous, precise meaning of postulate (NS4). We have thus proven: Theorem 2.2. There is a nonstandard universe, namely R?. Exercise 2.3. Suppose that A ?Rn and f : A →R is a function. (1) Let f1 : Rn →R be an arbitrary extension of f to all of Rn. De?ne f? := f? 1|A?. Show that f? is independent of the choice of extensionf 1. (This provides a way to de?ne the nonstandard extensions of partial functions.) (2) Set Γf :={(x,y)∈Rn+1 | f(x) = y}. Show that Γ? f is the graph of a function g : A? →R?. Show also that g = f?. The following observation is very useful. Proposition 2.4. Suppose that ?(x1,...,xm) is an L-formula. Set S := {~r ∈Rm | R |= ?J~rK}. Then S? ={~r ∈(R?)m | R? |= ?J~rK}. Proof. Just observe that ?~v(PS~v ? ?(~v)) belongs to Th(R).
 Corollary 2.5. N is not a de?nable set (even with parameters) in R?. Proof. Suppose, towards a contradiction, that there is an L-formula ?(x,~y) and ~r ∈ R? such that N = {a ∈ R? | R? |= ?Ja,~rK}. Write down an L-sentence σ which says that for all ~y, if ?(x,~y) de?nes a nonempty set of natural numbers that is bounded above, then ?(x,~y) has a maximum. (Remember you have a symbol PN for the set of natural numbers.) Since R |= σ, we have R? |= σ. Now N is bounded above in R? (by an in?nite element). Thus, Nshould have a maximum inR?, which is clearly ridiculous.
 Since N? is a de?nable set in R? (de?ned by PN), we obtain the following Corollary 2.6. N?\N is not de?nable in R?. In modern nonstandard analysis parlance, the previous two results would be phrased as “N and N?\N” are not internal sets. We will discuss internal sets later in these notes. 2.2. Approach 2: The ultrapower construction. In this approach to nonstandard analysis, one gives an “explicit” construction of the nonstandard universe in a manner very similar to the explicit construction of the real numbers from the rational numbers. Recall that a real number can be viewed as a sequence of rational numbers which we view as better and better approximations to the real number. Similarly, an element of R? should be viewed as a sequence of real numbers. For example, the sequence (1,2,3,...) should represent some in?nite element of R?. However, manydi?erentsequencesofrationalnumbersrepresentthesame real number. Thus, a real number is an equivalence class of sequences of
LECTURE NOTES ON NONSTANDARD ANALYSIS 13
rational numbers (qn), where (qn) and (q0 n) are equivalent if they “represent the same real number,” or, more formally, if limn→∞(qn ?q0 n) = 0. We run into the same issue here: many sequences of real numbers should represent the same hyperreal number. For instance, it should hopefully be clear that the sequence (1,2,3,...,n,n+1,...) and (π,e,?72,4,5,6,...,n,n+1,...) should represent the same (in?nite) hyperreal number as they only di?er in a ?nite number of coordinates. More generally, we would like to say that two sequences of real numbers represent the same hyperreal number if they agree on “most” coordinates. But what is a good notion of “most” coordinates? A ?rst guess might be that “most” means all but ?nitely many; it turns out that this guess is insu?cient for our purposes. Instead, we will need a slightly more general notion of when two sequences agree on a large number of coordinates; this brings in the notion of a ?lter. De?nition 2.7. A (proper) ?lter on N is a set F of subsets of N (that is, F ?P(N)) such that: ? ? /∈F, N∈F; ? if A,B ∈F, then A∩B ∈ F; ? if A ∈F and A ? B, then B ∈F. We think of elements of F as “big” sets (because that’s what ?lters do, they catch the big objects). The ?rst and third axioms are (hopefully) intuitive properties of big sets. Perhaps the second axiom is not as intuitive, but if one thinks of the complement of a big set as a “small” set, then the second axiom asserts that the union of two small sets is small (which is hopefully more intuitive). Exercise 2.8. Set F := {A ? N | N\A is ?nite}. Prove that F is a ?lter on N, called the Frechet or co?nite ?lter on N. Exercise 2.9. SupposethatDisasetofsubsetsofNwiththe?nite intersection property, namely, whenever D1,...,Dn ∈D, we have D1∩···∩Dn 6=?. Set hDi:={E ?N | D1 ∩···Dn ? E for some D1,...,Dn ∈D}. Show that hDi is the smallest ?lter on N containing D, called the ?lter generated by D. If F is a ?lter on N, then a subset of N cannot be simultaneously big and small (that is, both it and it’s complement belong to F), but there is no requirement that it be one of the two. It will be desirable (for reasons that will become clear in a second) to add this as an additional property: De?nition 2.10. If F is a ?lter on N, then F is an ultra?lter if, for any A ?N, either A ∈F or N\A ∈F (but not both!). Ultra?lters are usually denoted by U. Observe that the Frechet ?lter onN is not an ultra?lter since there are sets A ? N such that A and N\ A
14 ISAAC GOLDBRING
are both in?nite (e.g. the even numbers). So what is an example of an ultra?lter on N? De?nition 2.11. Given m ∈N, set Fm :={A ?N | m ∈ A}. Exercise 2.12. For m ∈N, prove that Fm is an ultra?lter on N, called the principal ultra?lter generated by m. We say that an ultra?lter U on N is principal if U = Fm for some m ∈N . Although principal ultra?lters settle the question of the existence of ultra?lters, they will turn out to be useless for our purposes, as we will see in a few moments. Exercise 2.13. Prove that an ultra?lter U on N is principal if and only if there is a ?nite set A ?N such that A ∈U. Exercise 2.14. Suppose that U is an ultra?lter on N and A1,...,An are pairwise disjoint subsets of N such that A1∪···∪An ∈U. Prove that there is a unique i ∈{1,...,n} such that Ai ∈U. We are now ready to explain the ultrapower construction. Fix an ultra?lter U on N. If (an) and (bn) are in?nite sequences of real numbers, we say that (an) and (bn) are equal modulo U, written (an) ～U (bn), if {n ∈N|| an = bn}∈U. (This is the precise meaning of when two sequences agree on “most” coordinates.) Exercise 2.15. Showthat～U isanequivalencerelationonthesetofin?nite sequences of real numbers. (The “ultra” assumption is not used in this exercsie.) For an in?nite sequence (an), we write [(an)]U, or simply [(an)], for the equivalence class of (an) with respect to ～U. We let RU denote the set of ～U-equivalence classes. We want to turn RU into an ordered ?eld. The natural guess for the ?eld operations are: ? [(an)]+[(bn)] := [(an + bn)] ? [(an)]·[(bn)] := [(anbn)]. Of course, since we are working with equivalence classes, we need to make surethattheaboveoperationsarewell-de?ned. Forexample, if(an)～U (a0n) and (bn) ～U (b0n), we need to know that (an + bn) ～U (a0n + b0n) (and similarly for multiplication). However, if we set A := {n ∈ N | an = a0n} and B := {n ∈ N | bn = b0n}, then for n ∈ A∩B, an + bn = a0n + b0n; since A ∩ B ∈ U and A ∩ B ? {n ∈ N | an + bn = a0n + b0n}, this shows that (an + bn)～U (a0n + b0n). Next we de?ne an order on RU by declaring [(an)] < [(bn)] if and only if {n ∈ N | an < bn} ∈ U. One needs to verify that this is in fact a linear order. For example, to check the “linearity” axioms, ?x [(an)],[(bn)] ∈ RU. Set A := {n ∈ N | an < bn}, B := {n ∈ N | an = bn}, and C = {n ∈ N| an > bn}. Then N = A ∪ B ∪ C and A,B,C are pairwise disjoint.
LECTURE NOTES ON NONSTANDARD ANALYSIS 15 Thus, by Exercise 2.14, exactly one of A, B, C is in U, corresponding to the situations [(an)] < [(bn)], [(an)] = [(bn)], and [(an)] > [(bn)]. (This is the ?rst time that we have used the ultra- assumption.) Set 0 := [(0,0,0,...)] and 1 := [(1,1,1,...)]. Theorem 2.16. (RU,+,·,0,1,<) is an ordered ?eld. Proof. Checking the ordered ?eld axioms is mainly routine. Let us only verify the existence of multiplicative inverses. Suppose that [(an)]6= 0, that is, that {n ∈ N | an 6= 0} ∈ U. De?ne a new sequence (bn) by bn = an if an 6= 0 and bn = 1 if an = 0. (The choice of 1 is irrelevant here; all that matters is we de?ned bn 6= 0.) Observe that [(an)] = [(bn)] and bn 6= 0 for all n. Now [(an)]·[(b?1 n )] = [(bn)]·[(b?1 n )] = 1, whence [(an)] has a multiplicative inverse.
 We claim that RU (for suitable U) will serve as a nonstandard extension. First, in order to verify postulate (NS1), we need R to be an ordered sub?eld of RU. This can’t literally be true as R is not a subset of RU. Instead, we are going to de?ne an ordered ?eld embedding d : R→RU (and then, following ordinary mathematical practice, we pretend that R “is” d(R)?RU, that is, we identify R with its image d(R)). The embedding d is given by d(r) = [(r,r,r,...)]. For example, d(0) = 0 and d(1) = 1. It is straightforward to verify that d is an ordered ?eld embedding, called the diagonal embedding. In this sense, (NS1) is satis?ed. What about (NS2)? Here, we need to specify an extra condition on our ultra?lter U. To see this, we ?rst explain why principal ultra?lters are boring: Exercise 2.17. Prove that the diagonal embedding d : R→RU is surjective (that is, an isomorphism) if and only if U is principal. The whole point of nonstandard extensions is to get new elements, so principal ultrapowers (that is RU forU principal) do not help us achieve the goals of nonstandard analysis. So, we should use nonprincipal ultra?lters. But do they exist? Theorem 2.18. There exists a nonprincipal ultra?lter on N. Proof. Let F be the Frechet ?lter on N. By Zorn’s Lemma, there is a maximal ?lterU on N containingF. We leave it as an exercise to the reader to show thatU is a nonprincipal ultra?lter. (Hint: Use Exercise 2.9 to show that U is an ultra?lter.)
 For the rest of this subsection, ?x a nonprincipal ultra?lter U on N. We can now verify (NS2). For notational reasons, it will be simpler to construct a positive in?nite element α ∈ RU; then  := 1 α will be the desired positive in?nitesimal. We claim that α := [(1,2,3,...)] is a positive in?nite element. To see this, ?x r ∈ R>0; we need to verify that d(r) < α, that is, we need to verify X := {n ∈ N | r < n}∈U. Well, if X /∈U, then N\X ∈U; but
16 ISAAC GOLDBRING N\X is ?nite, whence U is principal by Exercise 2.13. Consequently X ∈U and α is in?nite. For axiom (NS3), we de?ne nonstandard extensions of sets and functions as follows: ? For f : Rn →R, we de?ne f : (RU)n →RU by f([(a1 m)],...,[(an m)]) := [(f(a1 m,...,an m))]. ? For A ?Rn, we de?ne A? ?(RU)n by ([(a1 m)],...,[(an m)])∈ A? if and only if {m ∈N | (a1 m,...,an m)∈ A}∈U. As before, one must check that these operations are well-de?ned (we leave this to the reader) and, after identifying R with d(R), these functions and relations really do “extend” the original functions and relations (again relegated to the lucky reader to verify). Finally, what about (NS4)? It is here that logic must reenter the picture in some shape or form. (Up until this point, the nonlogician aiming to use nonstandard methods via the ultrapower approach has been content.) LetL be the ?rst-order language described in the previous subsection. We make RU into an L-structure RU by interpreting Ff and PA as the extensions de?ned above. Then the precise formulation of (NS4) is the following: Theorem 2.19 (L os’). Suppose that ?(v1,...,vn) is an L-formula and [(a1 m)],...,[(an m)]∈RU. Then RU |= ?J[(a1 m)],...,[(an m)]Kif and only if {m ∈N|R |= ?Ja1 m,...,an mK}∈U.Proof. A useful exercise in logic; proceed by induction on the complexity of ?.
 Observe that, as a corollary of L os’ theorem, that RU is an ordered ?eld (as these axioms are ?rst-order). The analyst trying to refrain from logic surely avoids L os’ theorem, but in practice, ends up repeatedly verifying its conclusion on a case-by-case basis. In summary, we obtain: Theorem 2.20. RU is a nonstandard universe. 2.3. Problems. Problem 2.1. Discuss how to make de?ne the nonstandard extension of functions f : A → B with A ?Rm and B ?Rn. Problem 2.2. Let A ?Rm and B ?Rn. (1) Suppose f : A → B is 1-1. Show that if a ∈ A? \A, then f(a) ∈ B?\B. (2) Show that A is ?nite if and only if A? = A.
LECTURE NOTES ON NONSTANDARD ANALYSIS 17
3. Sequences and series 3.1. First results about sequences. OK, so let’s start doing some calculus nonstandardly. We start by studying sequences and series. A sequence is a function s : N → R. We often write (sn | n ∈ N) or just (sn) to denote a sequence, where sn := s(n). By Exercise 2.3, we have a nonstandard extension s : N? →R?, which we also often denote by (sn | n ∈N?). Notation: We write N > N to indicate N ∈N?\N. De?nition 3.1. (sn) converges to L, written (sn) → L or limn→∞sn = L, if: for all  ∈ R>0, there is m ∈ N such that, for all n ∈ N, if n ≥ m, then |sn ?L| < . We now give our ?rst nonstandard characterization of a standard concept. Theorem 3.2. sn → L if and only if sN ≈ L for all N > N. This theorem lends solid ground to the heuristic expression: sn → L if and only if, for really large N, sN is really close to L. Proof. (?) Suppose sn → L. Fix N > N. We want sN ≈ L. Fix  ∈ R>0. We want |sN ?L| < . By assumption, there is m ∈N such that R |=?n ∈N(n ≥ m →|sn ?L| < ). (Here, we are mixing formal logic with informal notation. If we were being polite, we would write R |=?n((PNn∧P≥nm)→ P<F|???|FsncLc). After seeing the formal version, hopefully you will forgive our rudeness and allow us to write in hybrid statements as above!) Thus, by the Transfer Principle, R? |=?n ∈N?(n ≥ m →|sn ?L| < ). Since m ∈N and N > N, we have N ≥ m. Thus, |sN ?L| < , as desired. (?) We now suppose sN ≈ L for N > N. Fix  ∈ R>0. We needm ∈ N such that, n ∈ N and n ≥ m implies |sn ? L| < . But how are we to ?nd such m? Well, R? knows of such an m (satisfying the ?version of the desired condition). Indeed, if m > N, then n ∈ N? and n ≥ m implies n > N, whence sn ≈ L and, in particular, |sn ?L| < . So, R? |= ?m ∈ N??n ∈ N?(n ≥ m → |sn ? L| < ). Thus, by the Transfer Principle, R |=?m ∈N?n ∈N(n ≥ m →|sn ?L| < ), as desired.
 We used transfer in each direction of the previous proof. The ?rst application is often called “Upward Transfer” as a fact from below (in the “real world”) was transferred up to the nonstandard world. Similarly, the second application is often called “Downward Transfer” for a similar reason. Theorem 3.3 (Monotone Convergence). Let (sn) be a sequence. (1) Suppose (sn) is bounded above and nondecreasing. Then (sn) converges to sup{sn | n ∈N}.
18 ISAAC GOLDBRING
(2) Suppose (sn) is bounded below and nonincreasing. Then (sn) converges to inf{sn | n ∈N}.. Proof. We only prove (1); the proof of (2) is similar. By the previous theorem, it su?ces to prove the following Claim: For any N > N, sN ∈R?n and st(sN) = sup{sn | n ∈N}. Proof of Claim: Let b be an upper bound for (sn), so R |=?n ∈N(s1 ≤ sn ≤ b). Thus, by transfer, R? |= ?n ∈ N?(s1 ≤ sn ≤ b). Thus, sN ∈ R?n for all N ∈ N?. Fix N > N and let L := st(sN). We need to show L = sup{sn | n ∈ N}. By the transfer principle applied to the nondecreasing assumption, sn ≤ sN for all n ∈ N, whence sn ≤ st(sN) = L for all n ∈ N. Why is L the least upper bound of {sn | n ∈N}? Let r be an upper bound for {sn | n ∈ N}. Then R |= ?n ∈ N(sn ≤ r). By the transfer principle, R? |=?n ∈N?(sn ≤ r); in particular, sN ≤ r, whence L = st(sN)≤ r.
 Corollary 3.4. Suppose c ∈(0,1). Then cn →0. Proof. (cn | n ∈ N) is bounded below (by 0) and nonincreasing since c ∈ (0,1). Thus, cn → L for some L. Fix N > N; by Theorem 3.2, cN ≈ L and cN+1 ≈ L. So L ≈ cN+1 = c·cn ≈ c·L. Since L,cL are both standard numbers, we have cL = L. Since c 6= 1, we have L = 0.
 De?nition 3.5. (sn) is bounded if there is b ∈ R such that |sn| < b for all n ∈N. Proposition 3.6. (sn) is bounded if and only if sN ∈R?n for all N ∈N?. Proof. The (?) direction follows immediately from transfer. For the converse, suppose that sN ∈R?n for all N ∈N?. Fix M > N. Then |sN|≤ M for all N ∈ N?, so R? |= (?M ∈ N?)(?n ∈ N?)(|sN| ≤ M). Applying the transfer principle to this statement yields a standard bound for (sn).
 De?nition 3.7. (sn) is a Cauchy sequence if for all  ∈R>0, there is k ∈N such that, for all m,n ∈N, if m,n ≥ k, then |sm ?sn| < . Lemma 3.8. If (sn) is Cauchy, then (sn) is bounded. Proof. We use the nonstandard criteria for boundedness. Fix N > N; we must show sN ∈R?n. Set A :={n ∈N? ||sn?sN| < 1}, so A is a de?nable set in R?. Since (sn) is Cauchy, there is k ∈ N such that, for m,p ∈ N, if m,p ≥ k, then |sm ?sp| < 1. Applying the transfer principle to this last statement, if n > N, then |sn ?sN| < 1. Thus, N?\N ? A. Since N?\N is not de?nable, we have N?\N ( A. In other words, there is n ∈ A∩N. Since sn ∈R for n ∈N, we see that sN ∈R?n.
LECTURE NOTES ON NONSTANDARD ANALYSIS 19 Exercise 3.9. (sn) is Cauchy if and only if, for all M,N > N, sM ≈ sN. Proposition 3.10. (sn) converges if and only if (sn) is Cauchy. Proof. The (?) direction is an easy exercise, so we only prove the (?) direction. Suppose (sn) is Cauchy; then (sn) is bounded. Fix M > N; then sM ∈ R?n. Set L := st(sM). If N > N is another in?nite natural number, then by the previous exercise, sN ≈ sM, so sN ≈ L. Thus, (sn) converges to L.
 3.2. Cluster points. If (sn) is a sequence and L ∈ R, then we say that L is a cluster point of (sn) if, for each  ∈ R>0, the interval (L?,L + ) contains in?nitely many sn’s. It will be useful for us to write this in another way: L is a cluster point of (sn) if and only if, for every  ∈R>0, for every m ∈N, there is n ∈N such that n ≥ m and |sn ?L| < . We can also recast this notion in terms of subsequences. A subsequence of (sn) is a sequence (tk) such that there is an increasing function α : N→N satisfying tk = sα(k). We often write (snk) for a subsequence of (sn), where nk := α(k). Exercise 3.11. L is a cluster point of (sn) if and only if there is a subsequence (snk) of (sn) that converges to L. Recall that (sn) converges to L if sN ≈ L for all N > N. Changing the quanti?er “for all” to “there exists” gives us the notion of cluster point: Proposition 3.12. L is a cluster point of (sn) if and only if there is N > N such that sN ≈ L. Proof. (?): Apply the transfer principle to the de?nition of cluster point. Fix  ∈ μ>0 and M > N. Then there is N ∈ N?, N ≥ M, such that |sN ?L| < . This is the desired N since N > N and is in?nitesimal. (?): Fix N > N such that sN ≈ L. Fix  ∈R>0, m ∈N. Then R? |= (?n ∈N?)(n ≥ m∧|sn ?L| < ); indeed, N witnesses the truth of this quanti?er. It remains to apply transfer to this statement.
 We immediately get the famous: Corollary 3.13 (Bolzano-Weierstra?). Suppose that (sn) is bounded. Then (sn) has a cluster point. Proof. Fix N > N. Then since (sn) is bounded, sN ∈R?n. Let L = st(sN); then L is a cluster point of (sn) by the last proposition.
 Suppose s = (sn) is a bounded sequence. Let C(s) denote the set of cluster points of s. Then, by the previous proposition, we have C(s) ={L ∈R | sN ≈ L for some N > N}. Exercise 3.14. C(s) is a bounded set.
20 ISAAC GOLDBRING
We may thus make the following de?nitions: De?nition 3.15. (1) limsupsn := supC(s); (2) liminf sn := inf C(s). It turns out that limsupsn and liminf sn are themselves cluster points of s, that is, these suprema and in?ma are actually max and min: Proposition 3.16. limsupsn,liminf sn ∈ C(s). Proof. We only prove this for limsupsn; the proof for liminf sn is similar. For simplicity, set r := limsupsn. Fix  > 0 and m ∈ N. We need to ?nd n ∈Nsuch that|r?sn| < . Since r := supC(s), there is L ∈ C(s) such that r? < L ≤ r. Take N > N such that L = st(sN). Then r? < sN < r+. Now apply transfer.
 Theorem 3.17. (sn)→ L if and only if limsupsn = liminf sn = L. Proof. (sn) → L if and only if st(sN) = L for all N > N if and only if C(s) ={L} if and only if limsupsn = liminf sn = L.
 There is an alternate description of limsupsn and liminf sn in terms of tail sets which we now explain. For n ∈ N, set Tn := {sn,sn+1,sn+2,...}, the nth tailset of s. Set Sn := supTn. Since Tn+1 ? Tn, we have Sn+1 ≤ Sn, whence (Sn) is a nonincreasing sequence. Since (sn) is bounded, so is (Sn). Thus, by the Monotone Convergence Theorem, (Sn) converges to inf Sn. Theorem 3.18. limsupsn = limSn = inf Sn. Before we can prove this result, we need a preliminary result: Lemma 3.19. Let  ∈R>0. Then there is m ∈N such that, for all n ∈N, if n ≥ m, then sn < limsupsn + . Proof. Fix N > N. Then st(sN)≤limsupsn, so sN < limsupsn +. Thus, any M > N witness that R? |= (?M ∈N?)(?N ∈N?)(N ≥ M ? sN < limsupsn + ). Now apply the transfer principle.
 Proof. (of Theorem 3.18) Fix m ∈ N. Then by de?nition, if n ∈ N and n ≥ m, then sn ≤ Sm. By transfer, this holds for all n ∈ N? with n ≥ m. Take N > N such that limsupsn = st(sN). Then sN ≤ Sm, so limsupsn = st(sN)≤ Sm. Since m ∈N is arbitrary, we see that limsupsn ≤inf Sn. Now suppose, towards a contradiction, that limsupsn < inf Sn. Choose  ∈R>0 suchthatlimsupsn+ < inf Sn. Bythepreviouslemma, thereis m ∈Nsuch that, for all n ≥ m, sn < limsupsn +. Thus, Sm ≤limsupsn + < inf Sn, a contradiction.
 Exercise 3.20. State and prove an analog of Theorem 3.18 for liminf sn.
LECTURE NOTES ON NONSTANDARD ANALYSIS 21 3.3. Series. Recall that an in?nite seriesP∞ k=0 ak is convergent if the sequence of partial sums (sn) converges, where sn :=Pn k=0 ak. In this case, we writeP∞ k=0 ak = L if (sn) converges to L. It is useful to observe thatP n k=m ak = sn ?sm?1. Some notation: If N > N, then we have an element sN of the extended sequence. We use this to de?nePN k=0 ak, that is, we setPN k=0 ak := sN. Similarly, if M > N is also in?nite and M ≤ N, we setPN k=M ak := sN ?s M?1. Proposition 3.21. (1)P∞ k=0 ak = L if and only ifPN k=0 ak ≈ L for all N > N. (2) (Cauchy Criteria)P∞ k=0 ak converges if and only ifPN k=M ak ≈ 0for all M,N > N with M ≤ N. Proof. (1) follows immediately from the nonstandard characterization of convergent sequences, while (2) follows immediately from the fact that a sequence converges if and only if it is Cauchy together with the nonstandard characterization of Cauchy sequence given in Exercise 3.9.
 Corollary 3.22. IfPak converges, then ak →0 as k →∞. Proof. Let N > N. Then aN = sN ?sN?1 ≈ 0 by part (2) of the previous proposition.
 The usual warning is relevant here: the converse of the above corollary is not true. Indeed,P1/k diverges even though 1/k →0 as k →∞. De?nition 3.23.Pak converges absolutely ifP|ak| converges. Exercise 3.24. IfPak converges absolutely, then it converges. Theorem 3.25 (Ratio Test). Suppose ak 6= 0 for all k. (1) If limsup |ak+1| |ak| < 1, thenPak converges absolutely.(2) If liminf |ak+1| |ak| > 1, thenPak diverges.Proof. (1) Choose N > N such that limsup |ak+1| |ak| = st(|aN+1| |aN| ). Fix c ∈ R satisfyinglimsup |ak+1| |ak| < c < 1. If M > N, thenst(|aM+1| |aM| )≤limsup |ak+1| |ak| < c, whence|aM+1 aM | < c and hence|aM+1| < c|aM|. By transfer, there is m ∈N such that, for all k ≥ m, |ak+1| < c|ak|. By induction, |ak+m| < ck|am| for all k ∈ N, whencePk+n k+m|aj| ≤ (Pn m ci)|am| for all m,n ∈ N with m ≤ n. Fix M,N > N with M ≤ N. We will show thatPN M |aj| ≈ 0. Indeed,P N M |aj| ≤ (PN?m M?m cj)|am|. Use the fact that the geometric seriesPciconverges and M ?m,N ?m > N to conclude thatPN?m M?m cj ≈0. (2) Choose N > N such that liminf |ak+1| |ak| = st(|aN+1| |aN| ). For any M > N, we have st(|aM+1| |aM| ) ≥ st(|aN+1| |aN| ) > 1, whence |aM+1| > |aM|. Thus, R? |=
22 ISAAC GOLDBRING (?N ∈ N?)(?M ∈ N?)(M ≥ N → |aM+1| ≥ |aM|). Apply transfer to this statement, yielding n ∈ N such that |am+1| ≥ |am| for all m ≥ n. By induction, this yields |ak| > |an| for all k > n. Thus, by transfer again, if K > N, then |aK| > |an| > 0, so aK 6≈ 0, whence ak 6→ 0 and thusPak diverges.
 3.4. Problems. Problem 3.1. Suppose that sn → L and tn → M. Show that: (1) (sn ±tn)→ L±M; (2) (csn)→ cL for any c ∈R; (3) (sntn)→ LM; (4) (sn tn )→ L M if M 6= 0;(5) If sn ≤ tn for all n ∈N, then L ≤ M. Problem 3.2. (1) Let (sn) be a sequence. Show that (sn) is bounded above if and only if sN is not positive in?nite for all N > N. Likewise, show that (sn) is bounded below if and only if sN is not negative in?nite for all N > N. (2) Say that (sn) converges to positive in?nity if for every r ∈R, there is n ∈N such that, for all m ∈N, if m ≥ n, then sm > r. Show that (sn) converges to positive in?nity if and only if for every N > N, sN is positive in?nite. De?ne what it means for (sn) to converge to negative in?nity and give an analogous nonstandard description. Problem 3.3. Suppose thatP∞ 0 ai = L andP∞ 1 bi = M. Show that: (1)P∞ 0 (ai ±bi) = L±M;(2) P∞ 0 (cai) = cL for any c ∈R. Problem 3.4. Let c ∈R. Recall the identity 1+ c + c2 +···+ cn = 1?cn+1 1?c . Use this identity to show thatP∞ 0 ci converges if |c| < 1. Conclude thatP n m ci is in?nitesimal if |c| < 1 and m,n > N are such that m ≤ n. Problem 3.5. Suppose that (rn),(sn),(tn) are three sequences such that rn ≤ sn ≤ tn for all n ∈N. Further suppose that L ∈R is such that rn → L and tn → L. Show that sn → L. (This is often referred to as the Squeeze Theorem.) Problem 3.6. Suppose that s,t are bounded sequences. Show that limsup(s + t)≤limsups +limsupt. Problem 3.7. Suppose that ai ≥ 0 for all i ∈N. Prove that the following are equivalent: (1)P∞ 0 ai converges;
LECTURE NOTES ON NONSTANDARD ANALYSIS 23
(2)PN 0 ai ∈R?n for all N > N; (3)PN 0 ai ∈R?n for some N > N. (Hint: Use the Monotone Convergence Theorem.) Problem 3.8. Let (sn) be a sequence. Show that (sn) is Cauchy if and only if for every M,N > N, we have sM ≈ sN. Problem 3.9 (Advanced). (1) LetP∞ 0 ai andP∞ 0 bi be two series, where an,bn ≥ 0 for all i ∈N.Suppose that an ≤ bn for all n > N. Further suppose thatP∞ 0 bi converges. Show thatP∞ 0 ai converges. (2) Show that the condition “an ≤ bn for all n > N” is equivalent to the condition “there exists k ∈ N such that an ≤ bn for all n ∈ N with n ≥ k,” i.e. (bn) eventually dominates (an). The result established in this problem is usually called the Comparison Test.
4. Continuity 4.1. First results about continuity. Let A ? R, f : A → R a function, and c ∈ A. We say that f is continuous at c if: for all  ∈R>0, there is δ ∈ R>0 such that, for all x ∈R, if x ∈ A and|x?c| < δ, then|f(x)?f(x)| < . We say that f is continuous if f is continuous at c for all c ∈ A. Here is the nonstandard characterization of continuity: Theorem 4.1. Suppose f : A →R and c ∈ A. The following are equivalent: (1) f is continuous at c; (2) if x ∈ A? and x ≈ c, then f(x)≈ f(c); (3) there is δ ∈ μ>0 such that, for all x ∈ A?, if |x ? c| < δ, then f(x)≈ f(c). The equivalence between (1) and (2) backs up our usual heuristic that f is continuous at c if, for all x ∈ A really close to c, we have f(x) is really close to f(c). Proof. (1) ? (2): Suppose that x ≈ c; we want f(x) ≈ f(c). Fix  ∈ R>0; we want |f(x)?f(c)| < . By (1), there is δ ∈R>0 such that R |=?x((x ∈ A∧|x?c| < δ)→|f(x)?f(c)| < ). Applying transfer to this statement and realizing that x ≈ c implies|x?c| < δ yields that |f(x)?f(c)| < . (2)?(3) follows by taking δ ∈ μ>0 arbitrary. (3) ? (1): Fix δ as in (3). Fix  ∈ R>0. Since x ∈ A? and |x?c| < δ implies f(x)≈ f(c), and, in particular, |f(x)?f(c)| < , we have R? |= (?δ ∈R>0)(?x ∈ A)(|x?c| < δ →|f(x)?f(c)| < ). Apply transfer.
24 ISAAC GOLDBRING Example 4.2. Since |sinx| ≤ |x| for x small, we see that, by transfer, sin ∈ μ for  ∈ μ. (In other words, sin is continuous at 0.) A similar argument, shows that cos is continuous at 0, that is, cos ≈ 1 for  ∈ μ. Using this and the transfer of the usual trigonometric identities, we can prove that sin is continuous: if c ∈ R and x ≈ c, write x = c +  for  ∈ μ. Then sinx = sin(c + ) = sinccos+coscsin ≈sinc·1+cosc·0 = sinc. Example 4.3. Let f(x) =(sin(1 x) if x 6= 0 0 if x = 0. Then f is not continuous at 0. Indeeed, let N > N be odd and set x := 2 Nπ ≈0. Then f(x) = sin Nπ 2 = 16≈ f(0).However, the function g de?ned by g(x) =(xsin(1/x) if x 6= 0 0 if x = 0 is continuous at 0. Indeed, suppose x ≈0, x 6= 0. Then since|sin(1/x)|≤1, |g(x)|=|x||sin(1/x)|≈0. How about the usual connection between continuity and limits? We say that limx→c f(x) = L if: for all  ∈R>0, there is δ ∈R>0 such that, for all x ∈ A, if 0 < |x?c| < δ, then |f(x)?L| < . Exercise 4.4. Prove that limx→c f(x) = L if and only if, for all x ∈ A?, if x ≈ c but x 6= c, then f(x)≈ L. Corollary 4.5. f is continuous at c if and only if limx→c f(x) = f(c). Proposition 4.6. Suppose that f is continuous at c and g is continuous at f(c). Then g?f is continuous at c. Proof. If x ≈ c, then f(x)≈ f(c), whence g(f(x))≈ g(f(c)).
 The following result is fundamental: Theorem 4.7 (Intermediate Value Theorem). Suppose that f : [a,b] → R is continuous. Let d be a value strictly in between f(a) and f(b). Then there is c ∈(a,b) such that f(c) = d. The nonstandard proof of the Intermediate Value Theorem will be our ?rst example of using so-called “hyper?nite methods;” in this case, we will be using hyper?nite partitions. The idea is to partition the interval [a,b] into subintervals of width 1 N for N > N. Then, logically, this partition will behave as if it were ?nite; in particular, we will be able to detect “the last time” some particular phenomenon happens. However, since we are taking in?nitesimal steps, the change in function value at this turning point will be in?nitesimal. Here are the precise details:
LECTURE NOTES ON NONSTANDARD ANALYSIS 25
Proof. Without loss of generality, f(a) < f(b), so f(a) < d < f(b). De?ne a sequence (sn) as follows: for n > 0, let {p0,...,pn} denote the partition of [a,b] into n equal pieces of width b?a n , so p0 = a and pn = b. Since f(p0) < d, we are entitled to de?ne the number sn := max{pk | f(pk) < d}, so pk is the “last time” that f(pk) < d. Observe that sn < b. We now ?x N > N and claim that c := st(sN) ∈ [a,b] is as desired, namely, that f(c) = d. (Note that sN ∈ [a,b], whence st(sN) is de?ned.) Indeed, by transfer, sN < b, whence sN + b?a N ≤ b. Again, by transfer, f(sN) < d ≤ f(sN + b?a N ). However, sN + b?a N ≈ sN ≈ c. Since f iscontinuous at c, we have f(c)≈ f(sN) < d ≤ f(sN + b?a N )≈ f(c), whence f(c)≈ d. Since f(c),d ∈R, we get that f(c) = d.
 The next fundamental result is also proven using hyper?nite partitions. Theorem 4.8 (Extreme Value Theorem). Suppose that f : [a,b] → R is continuous. Then there are c,d ∈[a,b] such that f(c)≤ f(x)≤ f(d) for all x ∈[a,b]. (In other words, f achieves it maximum and minimum.) Proof. Wewillonlyprovetheexistenceofthemaximumof f. Onceagain, let {p0,p1,...,pn} denote the partition of [a,b] into n equal pieces. This time, we de?ne sn to be some pk such that f(pj)≤ f(pk) for all j = 0,...,n. Fix N > N and set d := st(sN)∈[a,b]. We claim that f achieves its maximum at d. (Please appreciate the beauty of this claim: We are partitioning [a,b] into hyper?nitely many pieces, looking for where the function achieves its maximum on this hyper?nite set, and claiming that this element is in?nitely close to where the function achieves its maximum on [a,b]. Magic!) Fix x ∈ [a,b]. We need f(x) ≤ f(d). First, we need to “locate” x in our hyper?nite partition. Since R |= (?n ∈N)(?k ∈N)(0≤ k < n∧a+ k(b?a) n ≤ x ≤ a+ (k +1)(b?a) n ), by transfer, we can ?nd k ∈ N?, 0 ≤ k < N, such that a + k(b?a) N ≤ x ≤ a+ (k+1)(b?a) N . Since the interval [a+ k(b?a) N ,a+ (k+1)(b?a) N ] has in?nitesimal width b?a N and f is continuous at x, we see that f(a + k(b?a) N ) ≈ f(x) ≈ f(a + (k+1)(b?a) N ). However, by transfer, f(a + k(b?a) N ) ≤ f(sN). Sincef (sN)≈ f(d) (since f is continuous at d), it follows that f(x)≤ f(d).
 4.2. Uniform continuity. Recall that f : A →R is continuous if: (?x ∈ A)(? ∈R>0)(?δ ∈R>0)(?y ∈ A)(|x?y| < δ →|f(x)?f(y)| < ). The crucial point here is that a particular δ (a priori) depends both on the given  and the location x. Uniform continuity is what one gets when one demands that the δ depend only on the given and not on the location
26 ISAAC GOLDBRING
x. In other words, it is what one gets when one slides the ?rst universal quanti?er in the above display over to the spot after the ?δ. More formally: De?nition 4.9. f : A →R is uniformly continuous if, for all  ∈R>0, there exists δ ∈R>0 such that, forall x,y ∈ A, if|x?y| < δ, then|f(x)?f(y)| < . Using purely symbolic language as above, we see that f : A → R is uniformly continuous if and only if: (? ∈R>0)(?δ ∈R>0)(?x,y ∈ A)(|x?y| < δ →|f(x)?f(y)| < ). While uniform continuity is no more di?cult to state than ordinary continuity (as it results from a simple permutation of quanti?ers), it is often di?cult for students to ?rst digest. For this reason, uniform continuity is perhaps one of the best examples of elucidating a standard concept by nonstandard means. Here is the nonstandard equivalence: Proposition 4.10. f : A → R is uniformly continuous if and only if, whenever x,y ∈ A? are such that x ≈ y, then f(x)≈ f(y). Please make sure that you see how this is di?erent from ordinary continuity. Indeed, f : A → R is continuous if and only if, whenever x,y ∈ A? are such that x ≈ y, and at least one of x and y are standard, then f(x)≈ f(y). Thus, uniform continuity demands continuity for the extended part of A as well. Exercise 4.11. Prove Proposition 4.10. Example 4.12. It is now easy to see why f : (0,1]→R given by f(x) = 1 x is not uniformly continuous. Indeed, ?x N > N. Then 1 N , 1 N+1 ∈ (0,1]?,1 N ≈ 1 N+1, but N = f( 1 N) 6≈ f( 1 N+1) = N + 1. Note that this calculation does not contradict the fact that f is continuous. Indeed, since 0 is not in the domain of f, we would never be calculating f(x) for in?nitesimal x when verifying continuity. Recallouraboveheuristic, namelythat f : A →Risuniformlycontinuous when f is continuous on the “extended part” of A. But sometimes A doesn’t have an extended part. For example, if A = [a,b], then A? is such that every element is in?nitely close to an element of A. It is for this reason that continuous functions whose domains are closed, bounded intervals are automatically uniformly continuous: Theorem 4.13. Suppose f : [a,b]→R is continuous. Then f is uniformly continuous. Proof. Suppose x,y ∈ [a,b]?, x ≈ y. Then c := st(x) = st(y) ∈ [a,b]. Since f is continuous at c, we have that f(x)≈ f(c)≈ f(y).
 Please compare the proof of the previous theorem with the usual standard proof. In particular, compare the lengths of these proofs!
LECTURE NOTES ON NONSTANDARD ANALYSIS 27
4.3. Sequences of functions. We now would like to consider sequences of functions and di?erent types of convergence of such sequences. For each n ∈ N, let fn : A → R be a function. Also, let f : A → R be another function. De?nition 4.14. Wesaythat fn converges to f pointwise if: foreach x ∈ A, the sequence of numbers (fn(x)) converges to the number f(x). In other words: fn converges to f pointwise if and only if: (?x ∈ A)(? ∈R>0)(?m ∈N)(?n ∈N)(n ≥ m →|fn(x)?f(x)| < ). Wewouldliketogetanonstandardcharacterizationofthisconcept. First, how should we de?ne the extended sequence (fn)? Clearly, for each n ∈N, we get an extended function fn : A? → R?. But what about in?nite N? Here’s, the trick: de?ne a function F : N×R→R by F(n,x) = fn(x). We thus have a nonstandard extension F : N?×R? → R?. We now de?ne, for n ∈ N?, fn : A? → R? by fn(x) = F(n,x). We should be a bit worried at this point as, for standard n ∈ N, we have used fn : A? → R? to denote two, possibly di?erent functions. Thankfully, by transfer, there is no issue here: we leave it to the reader to check that, for standard n ∈N, both uses of fn : A? → R? agree. And now we have extended the sequence (fn) by de?ning fn : A? →R? for n ∈N?\N. Exercise 4.15. Prove that fn converges to f pointwise on A if and only if, for all x ∈ A, for all N > N, fN(x)≈ f(x). Once again, we will de?ne the uniform concept by moving the quanti?ers and asking the m in the above de?nition of pointwise convergence to depend only on the  and not on the location x. De?nition 4.16. Wesaythat fn converges uniformly to f if, forall  ∈R>0, there exists m ∈ N, such that, for all n ∈ N, if n ≥ m, then, for all x ∈ A, |fn(x)?f(x)| < . In symbols: fn converges uniformly to f if and only if: (? ∈R>0)(?m ∈N)(?n ∈N)(n ≥ m →(?x ∈ A)(|fn(x)?f(x)| < )). The way to visualize uniform convergence is the following: for a given , draw the strip around f of radius ; then fn converges uniformly to f if and only if, eventually, all of the functions fn live in the strip of radius  around f. Here’s the nonstandard equivalence; notice the similarity in the nonstandard comparison between continuity and uniform continuity. Proposition 4.17. fn converges uniformly to f if and only if, for all x ∈ A?, for all N > N, fN(x)≈ f(x). Exercise 4.18. Prove Proposition 4.17.
28 ISAAC GOLDBRING Example 4.19. Consider fn : [0,1] → R given by fn(x) = xn. Let f : [0,1]→R be de?ned by f(x) =(0 if x 6= 1 1 if x = 1. Then fn converges pointwise to f. However, fn does not converge uniformly to f. Indeed, ?x x ∈[0,1]? such that x < 1 but x ≈1. We will ?nd N > N such that fN(x) = xN 6≈0 = f(x). To do this, set X ={n ∈N? ||xn ?1| < 1 2}. Note that X is de?nable and, by continuity of fn for n ∈N, we have N? X. SinceNisnotde?nable, thereis N ∈ X\N. Forthis N, wehave|xN?1| < 1 2, whence xN 6≈0. Notice that, in the above example, each fn was continuous but f was not continuous. This cannot happen if the convergence is uniform: Theorem 4.20. Suppose that fn : A →R is continuous for each n and that fn converges to f uniformly. Then f is continuous. Proof. Fix c ∈ A; we want to show that f is continuous at c. Fix x ∈ A?. By the triangle inequality, we have, for any n ∈N?, that |f(x)?f(c)|≤|f(x)?fn(x)|+|fn(x)?fn(c)|+|fn(c)?f(c)|. We would like to make all three of the quantities in the right hand side of the aboveinequalityin?nitesimal. Well, if n > N, thenbyuniformcontinuity, we have f(x) ≈ fn(x) and f(c) ≈ fn(c). But we only know that fn(x) ≈ fn(c) for n ∈N. Can we arrange for the middle term to be in?nitesimal for in?nite n as well? Yes, but we need to be a bit more careful. Since each fn is continuous at c, we have that the following is true in R: (?n ∈N)(? ∈R>0)(?δ ∈R>0)(?y ∈ A)(|y?c| < δ →|fn(y)?fn(c)| < ). Apply the transfer principle to this result with N > N and  ∈ μ>0. We then get a δ ∈(R?)>0 such that, whenever x ∈ A? satis?es |x?c| < δ, then fN(x) ≈ fN(c). Without loss of generality, we may assume that δ ∈ μ>0. Thus, for all x ∈ A?, whenever |x?c| < δ, we have f(x) ≈ f(c). By the direction (3)?(1) of Theorem 4.1, we see that f is continuous at c.
 In the above proof, we actually stumbled upon some important concepts. De?nition 4.21. Suppose that f : A? → R? is a function (not necessarily the nonstandard extension of a standard function). Then f is internally continuous or ?continuous if: for all x ∈ A?, for all  ∈ (R?)>0, there is δ ∈(R?)>0 such that, for all y ∈ A?, if |x?y| < δ, then |f(x)?f(y)| < .
LECTURE NOTES ON NONSTANDARD ANALYSIS 29
The terminology internally continuous will make more sense later in these notes when we de?ne internal sets and functions. Notice that being internally continuous is just like ordinary continuity, but with everything decorated by stars. By the transfer principle, if f : A → R is continuous, then its nonstandard extension f : A? → R? is internally continuous. Another example is provided by the above proof: if each element of the sequence fn is continuous, then fn : A? →R? is internally continuous for all n ∈N?. While we are on the topic, let’s de?ne another notion of continuity for nonstandard functions. De?nition 4.22. f : A? →R? is S-continuous if, for all x,y ∈ A?, if x ≈ y, then f(x)≈ f(y). So, for example, if f : A →R is a standard function, then f is uniformly continuous if and only if f : A? →R? is S-continuous. Here is another nice convergence theorem: Theorem 4.23 (Dini). Suppose that fn : [a,b] → R is continuous, f : [a,b] → R is continuous and fn converges pointwise to f. Further suppose that fn(x) is nonincreasing for each x ∈[a,b]. Then fn converges uniformly to f. Proof. By subtracting f from all of the functions involved, we may as well assume that f is the zero function. Fix N > N and c ∈ [a,b]?. We need to show that fN(c) ≈ 0. Fix n ∈ N. By transfer, 0 ≤ fN(c) ≤ fn(c). Set d := st(c) ∈ [a,b]. Since fn is continuous, we see that fn(c) ≈ fn(d). Consequently, fN(c)∈R?n. Taking standard parts, we see that 0≤st(fN(c))≤st(fn(c)) = fn(d). Since fn(d)→0 as n →∞, we see that st(fN(c)) = 0.
 In Theorem 4.20, if we assumed that each fn was uniformly continuous, could we conclude that f was uniformly continuous? Unfortunately, this is not true in general. To explain when this is true, we need to introduce a further notion. First, suppose that each fn : A →R is uniformly continuous. Then, in symbols, this means: (?n ∈N)(? ∈R>0)(?δ ∈R>0)(?x,y ∈ A)(|x?y| < δ →|fn(x)?fn(y)| < ). Thus, δ can depend on both the  and the particular function fn. Here’s what happens when we only require the δ to depend on the : De?nition 4.24. The sequence (fn) is equicontinuous if: for all  ∈ R>0, there is δ ∈R>0 such that, for all x,y ∈ A, for all n ∈N, if |x?y| < δ, then |fn(x)?fn(y)| < . In other words, (fn) is equicontinuous if it is uniformly uniformly continuous in the sense that each fn is uniformly continuous and, for a given , there is a single δ that witnesses the uniform continuity for each fn.
30 ISAAC GOLDBRING Exercise 4.25. Provethat(fn)isequicontinuousifandonlyif fn : A? →R? is S-continuous for each n ∈N?. Equicontinuity guarantees that the limit function is uniformly continuous: Theorem 4.26. Suppose fn : A →R and f : A →R are functions such that fn converges pointwise to f. If (fn) is equicontinuous, then f is uniformly continuous. Proof. Fix x,y ∈ A? with x ≈ y. We need to prove that f(x) ≈ f(y). Fix  ∈ μ>0. Choose n1,n2 ∈N? such that, for all n ∈N?: ? if n ≥ n1, then |fn(x)?f(x)| < ; ? if n ≥ n2, then |fn(y)?f(y)| < . Such n1,n2 exist by the transfer of the pointwise converge assumption. Without loss of generality, we may assume that n1,n2 > N. Now ?x N ∈N? with N > max(n1,n2). Then fN(x) ≈ f(x) and fN(y) ≈ f(y). But, by Exercise 4.25, fN(x)≈ fN(y). Thus, f(x)≈ f(y), as desired.
 Here’s one last equivalence to round out the discussion: Theorem 4.27. Suppose each fn : [a,b]→R is continuous and fn converges pointwise to f. Then fn converges uniformly to f if and only if (fn) is equicontinuous. Proof. Firstsupposethat fn convergesuniformlyto f. Then f iscontinuous. Since the domain of each fn and f is a closed, bounded interval, we know that, by Theorem 4.13, that each fn and f are uniformly continuous. Thus, for n ∈N, we have that fn : [a,b]? →R? is S-continuous. Now suppose that N > N and x,y ∈[a,b]? are such that x ≈ y. By Exercise 4.25, it su?ces to prove that fN(x)≈ fN(y). However, fN(x)≈ f(x)≈ f(y)≈ fN(y), where the ?rst and last≈are true by uniform convergence, while the middle ≈ holds by uniform continuity of f. Conversely, suppose that (fn) is equicontinuous; we want to show that fn converges to f uniformly. To do this, we need to show that, if N > N and x ∈[a,b]?, that fN(x)≈ f(x). Let y := st(x). Since fN is S-continuous (by Exercise 4.25), we know that fN(x) ≈ fN(y). By Theorem 4.26, we know that f is (uniformly) continuous, whence f(x) ≈ f(y). Since y is standard and fn converges pointwise to f, we know that fN(y)≈ f(y). Thus, fN(x)≈ fN(y)≈ f(y)≈ f(x), as desired.
 4.4. Problems. Problem 4.1. Suppose f : A →R and c,L ∈R. (1) Show that limx→c+ f(x) = L i? f(x) ≈ L for all x ∈ A? with x ≈ c and x > c.
LECTURE NOTES ON NONSTANDARD ANALYSIS 31 (2) Show that limx→c? f(x) = L i? f(x) ≈ L for all x ∈ A? with x ≈ c and x < c. (3) Show that limx→c f(x) = L i? f(x) ≈ L for all x ∈ A? with x ≈ c and x 6= c. (4) Show that limx→c+ f(x) = L i? f(x) ≈ L for all x ∈ A? with x ≈ c and x > c. (5) Show that limx→c f(x) = +∞ i? f(x) > N for all x ∈ A? with x ≈ c and x 6= c. (6) Show that limx→c f(x) = ?∞ i? ?f(x) > N for all x ∈ A? with x ≈ c and x 6= c. (7) Show that limx→+∞f(x) = L i? there is x ∈ A? such that x > N and f(x)≈ L for all x ∈ A? with x > N. (8) Show that limx→?∞f(x) = L i? there is x ∈ A? such that ?x > N and f(x)≈ L for all x ∈ A? with ?x > N. Problem 4.2. Suppose f,g : A →R and c,L,M ∈R. Show that: (1) limx→c f(x) = L i? limx→c+ f(x) = L and limx→c? f(x) = L. (2) If limx→c f(x) = L and limx→c g(x) = M, then: (a) limx→c[(f + g)(x)] = L + M; (b) limx→c[(fg)(x)] = LM; (c) limx→c[f g(x)] = L M if M 6= 0. Problem 4.3. Suppose that  ∈ μ. Show that: (1) sin()≈0; (2) cos()≈1; (3) tan()≈0. Problem 4.4. Determine the points of continuity for each of the functions below. (1) g(x) =(1 if x ∈Q 0 if x / ∈Q. (2) h(x) =(x if x ∈Q ?x if x / ∈Q. (3) j(x) =(0 if x / ∈Q1 n if x = m n ∈Q in simplest form with n ≥1. Problem 4.5. Suppose f : R → R is uniformly continuous and (sn) is a Cauchy sequence. Show that (f(sn)) is also a Cauchy sequence. Problem 4.6. Suppose f : [a,b] → R is monotonic on [a,b]. Further suppose that f satis?es the Intermediate Value Property, i.e. for any d in
32 ISAAC GOLDBRING between f(a) and f(b), there is c ∈[a,b] such that f(c) = d. Show that f is continuous. For c ∈R, de?ne the monad of c to be μ(c) :={x ∈R? | x ≈ c}. Problem 4.7. There is a meta-principle, called Cauchy’s principle, which states that if c ∈R and a property holds for all x within some in?nitesimal distance of c, then the property holds for all x within some real distance of c. Once we have the logical framework described precisely, we can give this a more de?nite meaning. This problem investigates some concrete instances of this principle. (1) Suppose c ∈R and A ?R. Show that μ(c)? A? if and only if there is  ∈R>0 such that (c?,c+ )? A. (2) Suppose f : A → R and μ(c) ? A?. Show that if f is constant on μ(c), then there is  ∈ R>0 such that (c ? ,c + ) ? A and f is constant on (c?,c+ ). (3) Suppose f : A → R is continuous and f(x) ∈ R for all x ∈ A? (i.e. the extension of f to A? only takes standard values). Show that f is locally constant. (Hint: Use part (2).) Problem 4.8. A function f : R → R is said to be Lipshitz with constant c if c ∈ R>0 and for any x,y ∈ R, |f(x)? f(y)| ≤ c|x ? y|. f is said to be a contraction mapping if f is Lipshitz with constant c for some c < 1. The Contraction Mapping Theorem says that a contraction mapping has a unique ?xed point, that is, there is a unique y ∈R such that f(y) = y. This theorem has many applications, for example in the proof of the existence and uniqueness of solutions of di?erential equations. In this exercise, we will prove the Contraction Mapping Theorem. (1) Use nonstandard reasoning to show that a Lipshitz function is uniformly continuous. (2) Show that a contraction mapping cannot have two distinct ?xed points (this proves the uniqueness part of the Contraction Mapping Theorem). Let f be a contraction mapping with Lipshitz constant c ∈(0,1). Fix x ∈R. Recursively de?ne a sequence (sn) by s0 = x and sn+1 = f(sn). The goal is to show that (sn) converges to a ?xed point of f. (3) Use induction to show that |sn ?sn+1|≤ cn|s0 ?s1| for all n ∈N. (4) Use the formula for the partial sums of a geometric series to show that |s0 ?sn|≤ 1?cn 1?c |s0 ?s1|≤ 1 1?c|s0 ?s1| for all n ∈N. (5) Use transfer of the result in (4) to show that sn ∈ R?n for n > N. Fix n > N and set y := st(sn). Show that sn ≈ sn+1. Conclude that f(y) = y. It is interesting to remark that one can start with any x ∈R and iterate f to approach the ?xed point. The standard proof of the contraction mapping
LECTURE NOTES ON NONSTANDARD ANALYSIS 33
theorem involves proving the more careful estimate that |sm ?sn|≤ cm 1?c|s0 ?s1| to show that (sn) is Cauchy and hence converges.
5. Differentiation 5.1. The derivative. We suppose that f : A →R is a function and c ∈ A is an interior point, that is, there is an interval around c contained in A. De?nition 5.1. f is di?erentiable at c if limh→0 f(c+h)?f(c) h exists; in this case, the limit is denoted by f0(c) and is called the derivative of f at c. The nonstandard characterization of limits (Exercise 4.4) immediately gives the following nonstandard characterization of di?erentiability: Proposition 5.2. f is di?erentiable at c with derivative D if and only if for every  ∈ μ\{0}, we have f(c+)?f(c)  ≈ D. Suppose f is di?erentiable at c. Fix dx ∈ μ\{0}. (Here we are calling our in?nitesimal dx to match with the usual verbiage of calculus.) Set df := df(c,dx) = f(c + dx)?f(c). Then f0(x) = st(df dx). In this way, the derivative is, in some sense, an actual fraction. (Recall in calculus we are warned not to take the notation df dx to seriously and not to treat this as an actual fraction.) If the domain of f is an open (possibly in?nite) interval, we say that f is di?erentiable if it is di?erentiable at all points of its domain. Example 5.3. If f(x) = x2, then df = f(x + dx)?f(x) = (x + dx)2 ?x2 = x2 +2xdx +(dx)2 ?x2. Thus, df dx = 2x + dx ≈2x, whence f0(x) exists and f0(x) = st(df dx) = 2x. Proposition 5.4. If f is di?erentiable at x, then f is continuous at x. Proof. Suppose y ≈ x; we need f(y)≈ f(x). Write y = x+dx with dx ∈ μ. Without loss of generality, dx 6= 0. Then f(y)?f(x) = df ≈ f0(x)dx ≈0.
 Here are some fundamental properties of derivatives: Theorem 5.5. Suppose that f,g are di?erentiable at x and c ∈ R. Then f + g, cf, and fg are also di?erentiable at x. If g(x) 6= 0, then f g is also di?erentiable at x. Moreover, the derivatives are given by: (1) (f + g)0(x) = f0(x)+ g0(x); (2) (cf)0(x) = cf0(x); (3) (Product Rule) (fg)0(x) = f0(x)g(x)+ f(x)g0(x);
34 ISAAC GOLDBRING
(4) (Quotient Rule) (f g)0(x) = f0(x)g(x)?f(x)g0(x) [g(x)]2 . Proof. We’ll only prove the Product Rule, leaving the others as exercises. Fix dx ∈ μ\{0}. Then d(fg) = f(x+dx)g(x+dx)?f(x)g(x) = (f(x)+df)(g(x)+dg)?f(x)g(x), so d(fg) dx = f(x)dg dx + g(x)df dx +(df)dg dx . Since f is continuous at x, df ≈0. Thus, taking standard parts of the above display yields (fg)0(x) = f(x)g0(x)+ g(x)f0(x).
Now, the Chain Rule is notorious for having many incorrect proofs in textbooks. Hopefully our nonstandard proof is correct: Theorem 5.6 (Chain Rule). Suppose that f is di?erentiable at x and g is di?erentiable at f(x). Then g ? f is di?erentiable at x and (g ? f)0(x) = g0(f(x))·f0(x). Proof. Fix dx ∈ μ\{0}. Then df = f(x + dx)?f(x). Set h := g ?f, so dh = h(x + dx)?h(x). Then dh = g(f(x + dx))?g(f(x)) = g(f(x)+ df)?g(f(x)). Since f is continuous at x (by Proposition 5.4), df ≈ 0. First suppose that df 6= 0. Then dh dx = dh df · df dx = g(f(x)+ df)?g(f(x)) df · df dx ≈ g0(f(x))·f0(x). Now suppose that df = 0. Then f0(x) = 0 and dh = 0, so dh dx = g0(f(x))· f0(x). Either way, dh dx ≈ g0(f(x))·f0(x). Since dx was arbitrary, this showsthat h is di?erentiable at x and h0(x) = g0(f(x))·f0(x).
 The following theorem is the reason we use derivatives in connection with extrema of functions: Theorem 5.7. Suppose that f : (a,b)→R is di?erentiable and f achieves a local max at c ∈(a,b), that is, there is  ∈R>0 such that f(x)≤ f(c) for all x ∈(c?,c+ ). Then f0(c) = 0. Proof. Suppose, towards a contradiction, that f0(c) > 0. (The case that f0(c) < 0 is similar.) Fix  as in the statement of the theorem and ?x dx ∈ μ>0. Then c + dx ∈ (c ? ,c + )?, so f(c + dx) ≤ f(c). However, f0(c) ≈ f(c+dx)?f(c) dx , whence f(c+dx)?f(c) dx > 0. Since dx > 0, this forces f(c + dx)?f(c) > 0, a contradiction.
LECTURE NOTES ON NONSTANDARD ANALYSIS 35 5.2. Continuous di?erentiability. In this subsection, f : (a,b) →R is a function and c ∈(a,b). We aim to give a nonstandard characterization of f being continuously di?erentiable, that is f0 exists and is continuous. First, let’s give an alternate nonstandard characterization of di?erentiability. Proposition 5.8. f is di?erentiable at c if and only if, for all u,u0 ∈(a,b)? with u ≈ u0 ≈ c and u 6= c and u0 6= c, we have f(u)?f(c) u?c ≈ f(u0)?f(c) u0?c . Observe that this proposition has the desirable feature that it does not need to know the actual value of f0(c) in order to verify di?erentiability; compare this with Proposition 5.2. Proof. The (?) direction is immediate as both fractions are ≈ f0(c). We now prove the (?) direction. First, we show that f is continuous at c. Fix u0 ≈ c, u0 6= c. Set L :=|f(u0)?f(c) u0?c |∈R?. Suppose L ∈R?n. Then wheneveru ≈ c, u 6= c, since we have, f(u)?f(c) u?c ? f(u0)?f(c) u0?c ≈0, it follows that f(u)?f(c)?(f(u0)?f(c) u0?c )(u?c)≈0, and hence f(u)≈ f(c).Now suppose that L / ∈R?n. Fix  ∈ μ, so  L ∈ μ. Suppose|u?c| < L. Then |f(u)?f(c)|≤|f(u)?f(c)?(f(u0)?f(c) u0?c )(u?c)|+|(f(u0)?f(c) u0?c )(u?c)| The ?rst term on the right hand side is in?ntiesimal and the second term is ≤ . Thus, if |u?c| < L, it follows that f(u)≈ f(c). By the equivalence of(1) an (3) in Theorem 4.1, we see that f is continuous at c in this case too. Now, ?x δ ∈ R>0 such that, whenever u ∈ (a,b) and |u?c| < δ, then |f(u)? f(c)| < 1. Suppose u ∈ (a,b)? and |u ? c| < δ. If u 6≈ c, then f(u)?f(c) u?c ∈ R?n. If u ≈ c, then f(u)?f(c) u?c might be in?nite, but all such quotients (for di?erent u’s in?nite close to c) are all in?nitely close to one another. Thus: R? |= (?M ∈R?)(?u ∈(a,b)?)(|u?c| < δ →|f(u)?f(c) u?c |≤ M). Applying transfer to this statement, we get a real bound M ∈R>0 such that R |= (?u ∈(a,b))(|u?c| < δ →|f(u)?f(c) u?c |≤ M). But now, transfer this statement back to R?: for all u ∈(a,b)?, if|u?c| < δ, then |f(u)?f(c) u?c | ≤ M. In particular, for all u ∈ (a,b)?, if u ≈ c, thenf (u)?f(c) u?c ∈ R?n. The common standard part of all these fractions is thenf 0(c).
 We can now give a similar nonstandard criteria for continuous di?erentiability:
36 ISAAC GOLDBRING Theorem 5.9. f : (a,b)→R is continuous di?erentiable if and only if, for all u,u0,v,v0 ∈ (a,b)? with u ≈ u0 ≈ v ≈ v0 and u 6= v and u0 6= v0 and st(u)∈(a,b), we have f(u)?f(v) u?v ≈ f(u0)?f(v0) u0?v0 . Proof. (?) Take c ∈ (a,b) and ?x u,u0,v,v0 ≈ c with u 6= v and u0 6= v0. Then by the transfer of the Mean Value Theorem, there are w (resp. w0) between u and v (resp. between u0 and v0) such that f0(w) = f(u)?f(v) u?v and f0(w0) = f(u0)?f(v0) u0?v0 . Since w,w0 ≈ c and f0 is continuous at c, we have that f0(w) ≈ f0(w0), yielding the desired result. (?) Fix c ∈(a,b). By considering u,u0 ≈ c, u 6= c, u0 6= c and v = v0 = c, the assumption and the previous proposition imply that f0(c) exists. We now must show that f0 is continuous at c. Fix u ∈ (a,b)?, u ≈ c; we need f0(u) ≈ f0(c). Fix  ∈ μ>0. By the transfer of the de?nition of f0, there is δ ∈ (R?)>0 such that, for all v ∈ (a,b)?, if 0 < |u ? v| < δ, then |f(u)?f(v) u?v ? f0(u)| < . Without loss of generality, we may assumethat δ ∈ μ. Likewise, by the transfer of the fact that f0(c) exists, we may further assume that δ is chosen small enough so that, for all u0 ∈ (a,b)?, if 0 < |u0?c| < δ, then|f(u0)?f(c) u0?c ?f0(c)| < . Choose v,u0 ∈(a,b)? such that0 < |u?v|,|u0?c| < δ. Then: |f0(u)?f0(c)|≤  +|f(u)?f(v) u?v ? f(u0)?f(c) u0?c |+ . By assumption, the middle term is in?nitesimal, whence f0(u)≈ f0(c).
 5.3. Problems. Problem 5.1. Suppose f : (a,b) → R and c ∈ (a,b). Show that f is di?erentiable at c with derivative D if and only if for every  ∈ μ\{0}, we have f(c + )?f(c)  ≈ D. Problem 5.2. Suppose that  ∈ μ\{0}. Show that: (1) sin()  ≈1. (2) cos()?1  ≈0. (3) d dx(cosx) =?sinx. Problem 5.3. Suppose that f and g are di?erentiable at x and c ∈ R. Show that: (1) cf is di?erentiable at x and (cf)0(x) = cf0(x). (2) Ifg(x)6= 0, then f g isdi?erentiableatx and(f g)0(x) = g(x)f0(x)?f(x)g0(x) [g(x)]2 .
LECTURE NOTES ON NONSTANDARD ANALYSIS 37 Problem 5.4. Suppose f : R→R. We say that f has a local maximum at c if there is  ∈ R>0 such that f(c) ≥ f(x) for all x ∈ (c?,c + ). Show that f has a local maximum at c if and only if f(c) ≥ f(x) for all x ≈ c. De?ne what it means for f to have a local minimum at c and give a similar nonstandard description. Problem 5.5. Suppose f : R→R and c ∈R. Suppose that f0(c) = 0 and f00(c) < 0. Prove that f has a local maximum at c. Hint: Use transfer and the Mean Value Theorem to conclude that, for any x ≈ c, x 6= c, there is t in between x and c such that f0(t) = f(c)?f(x) c?x . (This result is often called the Second Derivative Test.) The next few problems deal with the Taylor Series of a function. Suppose f : R → R and a ∈ R. Further suppose that the nth derivative of f at a exists for all n. Then the Taylor series for f centered at a is the power series ∞ X i=0 f(i)(x) i! (x?a)i = f(a)+ f0(a)(x?a)+ f00(a) 2 (x?a)2 +··· . The Taylor series for f need not converge at some (or even any) x. Even if the Taylor series for f does converge at some x, it need not converge to f(x). For example, suppose f(x) =(e?1 x2 if x 6= 0 0 if x = 0. Then f(n)(x) = 0 for all n ∈N and x ∈R, whence the Taylor series for f is identically 0. Fix n ≥ 0. The nth degree Taylor polynomial for f centered at a is the polynomial
pn(x) =
n X i=0
f(i)(x) i!
(x?a)i = f(a)+ f0(a)(x?a)+···+ f(n)(x) n!
(x?a)n.
Problem 5.6. Foragiven x, showthattheTaylorseriesfor f at x converges to f if and only if pn(x)≈ f(x) for all n > N. Set Rn(x) := f(x)? pn(x). It follows from the previous problem that the Taylor series for f at x converges to f(x) if and only if Rn(x) ≈ 0 for all n > N. There is a theorem due to Lagrange that says that if f is (n + 1)-times di?erentiable on some open interval I containing a, then for each x ∈ I, there is a c between a and x such that Rn(x) = f(n+1)(c) (n +1)! (x?a)n+1.
38 ISAAC GOLDBRING Problem 5.7. Suppose that f(n)(x) exists for all n ∈N and x ∈ I (we say f is in?nitely di?erentiable on I in this situation). Discuss how to make sense of f(n)(x) for n ∈N? and x ∈ I?. Show that for all x ∈ I? and n ∈N? with n ≥1, we have pn(x)?pn?1(x) = f(n)(a) n! (x?a)n. Problem 5.8. Suppose that f is in?nitely di?erentiable on I and x ∈ I. (1) Suppose that f(n+1)(c) (n +1)! (x?a)n+1 is in?nitesimal for every n > N and every c ∈ R? such that c is between a and x. Show that the Taylor series for f at x converges to f(x). (2) Use part (1) to show that the Taylor series for cosx centered at a = 0 (otherwise known as the Maclaurin series for cosx) converges to cosx for all x ∈R. (3) Use part (1) to show that the Maclaurin series for ex converges to ex for all x ∈R. Problem 5.9. Suppose that f(n) exists for all real numbers in some open interval I. Further suppose that f(n) is continuous at x ∈ I. Show that for any in?nitesimal ?x, there is an in?nitesimal such that f(x +?x) = f(x)+ f0(x)?x + f00(x) 2 +···+ f(n)(x) n! (?x)n + (?x)n. (Hint: Consider the Lagrange form of the remainder Rn.) Problem 5.10. There is another form of the remainder Rn, which states that Rn(x) = f(n)(c)?f(n)(a) (c?a)(n +1)! (x?a)n+1 for some c in between a and x. Apply this form of the remainder to Rn?1 to prove the result from Problem 5.9 without using the assumption that f(n) is continuous. 6. Riemann Integration 6.1. Hyper?nite Riemann sums and integrability. The Riemann integral has a particularly slick description in terms of hyper?nite partitions. Indeed, one takes a Riemann sum with respect to rectangles of in?nitesimal width; this Riemann sum will then be in?nitely close to the Riemann integral. First, let’s recall some standard notions. Throughout, we assume that f : [a,b] →R is a bounded function. A partition of [a,b] is a ?nite ordered set P ={x0,...,xn} such that a = x0 < x1 < ... < xn = b. A partition P2 is a re?nement of a partition P1 if P1 ? P2. (So P2 is obtained from P1 by
LECTURE NOTES ON NONSTANDARD ANALYSIS 39 further subdivision.) For a partition P = {x0,...,xn} of [a,b], we de?ne, for i = 1,...,n: ? Mi := Mi(P) := sup{f(x) | x ∈[xi?1,xi]} ? mi := mi(P) := inf{f(x) | x ∈[xi?1,xi]} ? ?xi := xi ?xi?1. De?nition 6.1. (1) The upper Riemann sum of f with respect to P is
U(f,P) :=
n X i=1
Mi?xi.
(2) The lower Riemann sum of f with respect to P is
L(f,P) :=
n X i=1
mi?xi.
(3) The left-hand Riemann sum of f with respect to P is
S(f,P) :=
n X i=1
f(xi?1)?xi. Set M := sup{f(x) | x ∈[a,b]} and m := inf{f(x) | x ∈[a,b]}. Exercise 6.2. (1) For any partition P, we have m(b?a)≤ L(f,P)≤ S(f,P)≤ U(f,P)≤ M(b?a). (2) If P2 is a re?nement of P1, then L(f,P1)≤ L(f,P2)≤ U(f,P2)≤ U(f,P1). (3) For any two partitions P1 and P2, L(f,P1)≤ U(f,P2). Part (2) of the previous exercise motivates the following De?nition 6.3. (1) The lower Riemann integral of f is L(f) := sup{L(f,P) | P a partition of [a,b]}. (2) The upper Riemann integral of f is U(f) := inf{L(f,P) | P a partition of [a,b]}. By Exercise 6.2(1) and (3), we see that m(b?a)≤ L(f)≤ U(f)≤ M(b?a). We say that f is Riemann integrable if U(f) = L(f). In this case, we set Rb a fdx := U(f) = L(f). The following Cauchy-type criterion for integrability is quite useful:
40 ISAAC GOLDBRING
Exercise 6.4 (Riemann Lemma). f is Riemann integrable if and only if, for every  ∈R>0, there is a partition P of [a,b] such that U(f,P)?L(f,P) < . Fix?x ∈R>0. Set P?x ={x0,...,xn}, where[a,x1],[x1,x2],...,[xn?2,xn?1] allhaveequallength?x and[xn?1,xn]isthe“leftover”piece. (If?x ≥ b?a, then P?x = {a,b}.) We thus get a function U(f,·) : R>0 → R by setting U(f,?x) := U(f,P?x). In a similar manner, we get functions L(f,·) and S(f,·). Here is another Cauchy-type criterion for integrability: Exercise 6.5. f is Riemann integrable if and only if, for every  ∈ R>0, there is δ ∈ R>0 such that, for all ?x ∈ R>0, if ?x < δ, then U(f,?x)? L(f,?x)) < . Thefunctions U(f,·), L(f,·), S(f,·)havenonstandardextensions U(f,·) :( R?)>0 →R?, etc... So, for example, if ?x ∈ μ>0, then U(f,?x) equals the upper Riemann sum of f with respect to a hyper?nite partition, where each interval in the partition has in?nitesimal length. Theorem 6.6. f is Riemann integrable if and only if U(f,?x)≈ L(f,?x) for any ?x ∈ μ>0. In this case, for any ?x ∈ μ>0, we have Zb a fdx = st(U(f,?x)) = st(L(f,?x)) = st(S(f,?x)). Proof. First suppose that f is Riemann integrable. Fix  ∈ R>0. Take δ ∈ R>0 satisfying the conclusion of Exercise 6.5. By transfer, if ?x ∈ μ>0, then U(f,?x)?L(f,?x) < . Since was arbitrary, this shows that L(f,?x)≈ U(f,?x). For the converse, we verify the criterion given by the Riemann Lemma. Let > 0. By the assumption of the theorem, R? |= (??x ∈(R?)>0)(U(f,?x)?L(f,?x) < ). Now apply transfer. It remains to verify the statement about the value of the integral. Fix ?x ∈ μ>0. Then L(f,?x)≤ S(f,?x)≤ U(f,?x)and L(f,?x)≈ U(f,?x). Thus, st(U(f,?x)) = st(L(f,?x)) = st(S(f,?x)). Fix an ordinary partition P of [a,b]. Then, by the transfer of Exercise 6.2(3), we have L(f,P)≤ U(f,?x)≈ L(f,?x)≤ U(f,P). Thus, L(f)≤st(U(f,?x))≤ U(f). Since f is Riemann integrable, we have Zb a fdx = U(f) = L(f) = st(U(f,?x)).
 We now verify that certain classes of functions are integrable.
LECTURE NOTES ON NONSTANDARD ANALYSIS 41 Theorem 6.7. If f is continuous on [a,b], then for any ?x ∈ μ>0, L(f,?x)≈ U(f,?x). Consequently, by the previous theorem, continuous functions are Riemann integrable. Proof. Let’s give the idea of the proof ?rst. Note that U(f,?x)?L(f,?x) = Pn i=1(Mi ?mi)?xi. We will ?nd an upper bound for this sum of the form[ f(c) ? f(d)](b ? a), where |c ? d| < ?x. If ?x ∈ μ>0, then c ≈ d, sof (c)≈ f(d) by the uniform continuity of f. Since b?a ∈R, this will show that U(f,?x)?L(f,?x)≈0. Now for the details: for ?x ∈ R>0, de?ne Mi(?x) := Mi(P?x) andm i(?x) := mi(P?x). We then de?ne the oscillation of f with respect to ?x to be the quantity ω(?x) := max{Mi(?x)?mi(?x) | i = 1,...,n}. Suppose that j ∈{1,...,n} is such that ω(?x) = Mj(?x)?mj(?x). Fix c?x,d?x ∈ [xj?1,xj] such that f(c?x) = Mj(?x) and f(d?x) = mj(?x); thisispossiblesincecontinuousfunctionsachievetheirmaxandmin. Clearly, |c?x ?d?x|≤?x. Also, U(f,?x)?L(f,?x) = n X i=1 (Mi(?x)?mi(?x))(?xi)≤ ω(?x)(b?a). Fix ?x ∈ μ>0. By transfer, there are c,d ∈[a,b]? such that|c?d|≤?x and U(f,?x)?L(f,?x)≤(f(c)?f(d))(b?a), whence U(f,?x)≈ L(f,?x).
 Exercise 6.8. Prove Theorem 6.7 with the assumption of “continuity” replaced by “monotonicity.” Now that integrals are in?nitely close to hyper?nite sums, properties of integrals follow almost immediately from properties of sums. For example: Proposition 6.9. Suppose that f is integrable and c ∈ R. Then cf is integrable andRb a(cf)dx = cRb a fdx. Proof. Fix ?x ∈ μ>0. First suppose that c ≥ 0. Then U(cf,?x) = cU(f,?x) and L(cf,?x) = cL(f,?x). Since U(f,?x) ≈ L(f,?x), we have that U(cf,?x)≈ L(cf,?x), whence cf is integrable. Moreover, Zb a (cf)dx = st(U(cf,?x)) = cst(U(f,?x) = cZb a fdx. If c < 0, then U(cf,?x) = cL(f,?x) and L(cf,?x) = cU(f,?x). The proof then proceeds as in the previous paragraph.
 6.2. The Peano Existence Theorem. Here is an application of the nonstandard approach to integration to di?erential equations: Theorem 6.10 (Peano Existence Theorem). Suppose that g : [0,1]×R→R is a bounded, continuous function. Then for any a ∈R, there is a di?erentiable function f : [0,1] → R satisfying f(0) = a and f0(t) = g(t,f(t)) for all t ∈[0,1].
42 ISAAC GOLDBRING
Proof. The idea is quite simple: we ?nd a “polygonal” solution by starting at (0,a) and taking in?nitesimal steps with slope according to g; we then take the standard part of the polygonal solution to obtain a curve solving the di?erential equation. Now for the gory details: Let Y : R×N→R be such that, for all 0 ≤ k < n, we have Y (0,n) = aand Y (k+1 n ,n) = Y (k n,n) + g(k n,Y(k n,n))· 1 n. Let Z : R → R be such that Z(k n) = Y (k n,n). Fix N > N. We will show that Z( l N) ∈ R?n for all 0≤ l ≤ N and that f : [0,1]→R de?ned by f(t) = st(Z( l N)), where t ≈ l N, is the desired solution to the di?erential equation. Fix a bound M ∈R>0 for g. Fix 0≤ k ≤ l ≤ N. Then: |Z( l N )?Z( k N )|=| l?1 X n=k (g( n N ,Z( n N ))· 1 N )| ≤ l?1 X n=k (|g( n N ,Z( n N ))|· 1 N ) ≤ M · l?1 X n=k 1 N = M · l?k N . This shows two things: ?rst, by setting k = 0, we see that |Z( l N)|≤|a|+ M · l N for all 0 ≤ l ≤ N, whence Z( l N) ∈ R?n. Secondly, if l?k N ≈ 0, then Z( l N) ≈ Z( k N). These observations allow us to de?ne f : [0,1] → R by setting f(t) = st(Z( l N)) for any l ∈{0,...,N} with t ≈ l N. Exercise 6.11. Use the above calculation to verify that f is continuous. It remains to verify that f is a solution of the di?erential equation f0(t) = g(t,f(t)). By the fundamental theorem of calculus, it is enough to show that f(x) = a +Rx 0 g(t,f(t))dt for all x ∈[0,1]. Let W : R → R be such that W(k n) = g(k n,Z(k n)). De?ne h : [0,1] → Rby h(r) = g(r,f(r)), a continuous function. Then, for 0≤ k ≤ N, we have W( k N )≈ g(st( k N ),f(st( k N )) = h(st( k N ))≈ h( k N ). For n ∈ N, de?ne sn := max{|W(k n)?h(k n)| | 0 ≤ k ≤ n}. Thus, by theabove observation, sN ∈ μ. Consequently, for 0≤ k ≤ N, we have | k X n=0 (W( n N )· 1 N )? k X n=0 (h( n N ) 1 N )|≤ k X n=0 |W( n N )?h( n N )|· 1 N ≤ k X n=0 sN · 1 N
LECTURE NOTES ON NONSTANDARD ANALYSIS 43 = sN · k +1 N ∈ μ. Therefore, for any x ∈[0,1], writing x = st( k N) with k N < x, we have f(x)≈ Z( k N )
= a +
k?1 X n=0
(g( n N
),Z( n N
))·
1 N
)
= a +
k?1 X n=0
(W( n N
)·
1 N
)
≈ a +
k?1 X n=0
(h( n N
)·
1 N
)
≈ a +Zx 0
h(t)dt.
The last step follows from Theorem 6.6. Since the beginning and end are standard numbers, we have f(x) = a +Rx 0 h(t)dt.
 6.3. Problems. Problem 6.1. Let f : [a,b] → R be continuous. For n ∈ N>0 and i = 0,...,n?1, de?ne xi := a + i(b?a) n . De?ne Av(n) := f(x0)+ f(x1)+···+ f(xn?1) n , which is often referred to as a sample average for f. Prove that if n > N, we have Av(n)≈ 1 b?aRb a f(x)dx. Remark. 1 b?aRb a f(x)dx is often referred to as the average of f on [a,b]. This exercises illustrates a common phenomenon in nonstandard analysis, namely approximating continuous things by hyper?nite discrete things. Problem 6.2 (Both). Supposethat f,g : [a,b]→RareRiemannintegrable. Show that: (1) f +g is integrable andRb a(f(x)+g(x))dx =Rb a f(x)d(x)+Rb a g(x)dx. (2) f is Riemann integrable on both [a,c] and [c,b] for any c ∈[a,b] and Rb a f(x)dx =Rc a f(x)dx +Rc b f(x)dx. (3)Rb a f(x)dx ≤Rb a g(x)dx if f(x)≤ g(x) for all x ∈[a,b]. (4) m(b?a)≤Rb a f(x)dx ≤ M(b?a) if m ≤ f(x)≤ M for all x ∈[a,b]. Problem 6.3. Suppose that f : [a,b] → R is Riemann integrable. De?ne F : [a,b] → R by F(x) :=Rx a f(t)dt. Prove that F is continuous (even though f may not be). Problem 6.4.
44 ISAAC GOLDBRING (1) Suppose f : [a,∞)→R is continuous. De?ne Z∞ a f(x)dx := lim b→∞Zb a f(x)dx if this limit exists; in this case the improper integral R∞ a f(x)dx is said to converge. Otherwise, the improper integral diverges. Show thatR∞ a f(x)dx = L if and only if for every b ∈R? such that b > N, we haveRb a f(x)dx ≈ L. (But ?rst: what doesRb a f(x)dx for b > N even mean?) (2) There are three other kinds of improper integrals, namely when f is continuous on intervals (?∞,a] as well as [a,b) and (a,b]. Discuss how to de?ne these improper integrals and give nonstandard characterizations of them as in (1). Problem 6.5. Suppose f : [a,∞) → R is continuous and f(x) ≥ 0 for all x ∈ [a,∞). Show that eitherR∞ a f(x)dx converges or diverges to +∞.(Hint: De?ne F : [a,∞) → R by F(x) :=Rx a f(t)dt. Consider the cases when F is bounded and unbounded respectively.) Problem 6.6. Suppose that (an : n ≥ 1) is a sequence from R. Suppose that f : [1,∞) → R is a continuous, nonnegative, nonincreasing function such that f(n) = an for all n ≥ 1. Show thatP∞ 1 an converges if and only ifR∞ 1 f(x)dx converges. (This result is often called the Integral Test.) 7. Weekend Problem Set #1 Problem 7.1. (Sierpinski) Suppose r,a1,a2,...,an ∈ R>0. Show that the equation a1 x1 + a2 x2 +···+ an xn = r has only ?nitely many solutions (x1,...,xn) in N>0. Problem 7.2. (1) Show there is N ∈N? such that N is divisible by k for every k ∈N. (2) Let P ? N denote the set of primes. Show that for every n ∈ N?, there is p ∈ P? such that p divides n. (3) Use parts (1) and (2) to show that P is in?nite (Euclid). (4) Show that Z? is a subring of R?. (5) Let p ∈ P? \P. Let (p) be the ideal of Z? generated by p. Show that the quotient ring Z?/(p) is a ?eld. What is the characteristic of Z?/(p)? Problem 7.3. (Limit Comparison Test) LetP∞ 0 ai andP∞ 0 bi be two series, where ai,bi > 0 for all i ∈N. Suppose that (ai bi ) converges. Show that for m,n > N with m ≤ n, we havePn m ai ∈ μ if and only ifPn m bi ∈ μ.Conclude that P∞ 0 ai converges if and only ifP∞ 0 bi converges.
LECTURE NOTES ON NONSTANDARD ANALYSIS 45 Problem 7.4. Let (sn) denote a sequence in R. For each n ∈N, de?ne σn := s0 +···sn n +1 . Show that if sn → L, then σn → L. (Hint: If N > N, there exists M > N such that M N is in?nitesimal.) We should say the sequence (σn) is called the sequence of Ces′aro means of the sequence (sn). It is possible that (σn) converges when (sn) diverges. When (sn) is the sequence of partial sums of an in?nite series, this leads to the notion of Ces′aro summability, which is useful in the theory of Fourier series. Problem 7.5. Suppose f : R→R is a function and f(x+y) = f(x)+f(y) for all x,y ∈R (i.e. f is an additive group homomorphism). (1) Show that f(0) = 0. (2) Show that f(nx) = nf(x) for all x ∈R and n ∈N. (3) Show that f(?x) =?f(x) for all x ∈R. (4) Show that f(kx) = kf(x) for all k ∈Z. (5) Show that f(qx) = qf(x) for all q ∈Q. (6) (Cauchy) Suppose f is continuous. Show that f(x) = f(1)·x for all x ∈R. Problem 7.6. In this problem, we prove a strengthening of Cauchy’s result from Problem 6 by showing that if f : R → R is an additive group homomorphism and there is an inteveral I ?R such that f is bounded on I, then f(x) = f(1)·x for all x ∈ R. (This result is due to Darboux.) Fix x0 ∈ I and M ∈R>0 such that |f(x)|≤ M for all x ∈ I. (1) Show that if x ≈0, then |f(x)|≤ M +|f(x0)|. (2) Show that if x ≈0, then f(x)≈0. (Hint: If x ≈0, then nx ≈0 for all n ∈N. (3) Show that f(x) = f(1)·x for all x ∈ R. (Hint: Use the fact that any x ∈R is in?nitely close to an element of Q?.) Problem 7.7. (1) Suppose f : (a,b) → R is C1. Suppose x ∈ (a,b)? is such that st(x) ∈ (a,b). Suppose ?x ≈ 0. Prove that there exists  ∈ μ such that f(x +?x) = f(x)+ f0(x)+ ?x. (2) De?ne f : R→R by f(x) =(x2 sin(1 x) if x 6= 0 0 if x = 0. (a) Show that f0(x) exists for all x but that f0 is not continuous at 0.
46 ISAAC GOLDBRING
(b) Let N > N and x = 1 2πN. Show that there is an in?nitesimal ?x such that there is no  ∈ μ making the conclusion of (a) true. (c) Discuss why parts (1) and (2)(b) don’t contradict the fact that f0 is continuous on (0,1). Problem 7.8. A Dirac delta function is a de?nable function D : R? →R? such that: ? D(x)≥0 for all x ∈R?; ?R+∞ ?∞ D(x)dx = 1; ? there is a positive in?nitesimal δ > 0 such thatRδ ?δ D(x)dx ≈1. (1) Make sense of the above properties, i.e. explain how to precisely state the above properties of a Dirac delta function. (2) Let D be a Dirac delta function and f : R→R a standard function. Show that st(R+∞ ?∞ f(x)D(x)dx) = f(0). (3) Suppose f : R→R is standard andR∞ ?∞ f(x)dx = 1. Fix n ∈N?\Nand de?ne D : R? →R? by D(x) := nf(nx). Show that D is a Dirac delta function. In particular, the following functions are Dirac delta functions: ? D(x) =(n if |x|≤ 1 2n 0 otherwise. ? D(x) = n π(1+n2x2). ? D(x) = ne?πn2x2. (4) Suppose that f : R → R is a standard function such that f(x) ≥ 0 for all x ∈RandR+∞ ?∞ f(x) = 1. For n ∈N>0, de?ne an :=R1 n ?1 n f(x). Showthat an ≈0forall n > N. ConcludethataDiracdeltafunction can never be the nonstandard extension of a standard nonnegative, integrable function. Problem 7.9. For a,b ∈N with a ≤ b, we set [a,b] :={a,a+1,...,b?1,b}?N. Suppose that A ?N. We say that: ? A isthick ifforall k ∈N>0, thereis x ∈Nsuchthat[x+1,x+k]? A. ? A is syndetic if N\A is not thick, that is, there is k ∈N>0 such that, for all x ∈N, [x +1,x+ k]∩A 6=?. ? A is piecewise syndetic if A = B ∩ C, where B is thick and C is syndetic. (1) Prove that A is thick if and only if A? contains an in?nite interval, that is, there are M,N ∈ N? with N ? M ∈ N? \ N such that [M,N]? A?.
LECTURE NOTES ON NONSTANDARD ANALYSIS 47
(2) Prove that A is syndetic if and only if A? has ?nite gaps, that is, for all intervals [M,N]?N?, if [M,N]∩A? =?, then N ?M ∈N. (3) (Standard) Prove that A is piecewise syndetic if and only if there is a ?nite set F ?N such that A + F is thick, where A + F :={a + f : a ∈ A,f ∈ F}. (4) Prove that A is piecewise syndetic if and only if there is an in?nite interval on which A? has only ?nite gaps. (5) Use the nonstandard characterization of piecewise syndeticity to prove that piecewise syndeticity is a partition regular notion, that is, if A = A1 ∪···∪An is piecewise syndetic, then Ai is piecewise syndetic for some i ∈{1,...,n}. The notions appearing in the previous problem are present in additive combinatorics and combinatorial number theory.
8. Many-sorted and Higher-Type Structures We would now like to start applying nonstandard methods to areas of mathematics more complex than calculus. To do this, we will need a slightly more elaborate nonstandard framework. 8.1. Many-sorted structures. In many areas of mathematics, we study many di?erent sets at a time as well as functions between these various sets. Example 8.1 (Linear Algebra). A vector space is a set V together with two functions: vector addition, which is a function + : V ×V → V , and scalar multiplication, which is a function · : F×V → V , where F is some ?eld. Example 8.2 (Topology). A metric space is a set X together with a metric, which is a function d : X ×X →R satisfying certain axioms (to be de?ned in the next section). Example 8.3 (Measure Theory). A measure space is a triple (X,B,μ), where X is a set, B is a σ-algebra of subsets of X (so B ? P(X)), and μ :B→R is a measure. We now develop a nonstandard framework suitable for studying such situations. Before, we were working with a structure consisting of just a single “sort,” namely a sort for R. Now, we will work in a structure M with a (nonempty) collection of sorts S. For each s ∈ S, we have a set Ms, the universe of the sort s in M. So, for example, in the linear algebra situation, we might have S = {s,t}, with Ms = V and Mt = F. Often we will write a many-sorted structure as M = (Ms | s ∈ S). Thus, we might write the linear algebra example as (V,F), suppressing mention of the names of the sorts. For any ?nite sequence ~s = (s1,...,sn) of sorts, we have the product set M~s := Ms1 ×···×Msn.
48 ISAAC GOLDBRING
We now consider a language which was just as expressive as before. Namely, we have: ? For every ?nite sequence ~s of sorts and every A ? M~s, we have a predicate symbol PA. ? For every sort s and every a ∈ Ms, we have a constant symbol ca. ? For every ?nite sequence ~s of sorts, every sort t, and every function f : M~s → Mt, we have a function symbol Ff. One now builds terms and formulae just as in ordinary logic, with the understanding that each sort comes equipped with its own collection of variables. If we need to be clear, we might decorate a variable with the name of the sort it is intended to range over, e.g. xs. Example 8.4. Returning to the vector space example, let’s see how we might write the distributive law c · (x + y) = c · x + c · y. Recall that S = {s,t}, with Ms = V and Mt = F. Let f : Ms × Ms → Ms denote vector addition and g : Mt ×Ms → Ms denote scalar multiplication. Then the axiom for the distributive law would be written as: ?xs?ys?zt(g(z,f(x,y)) = f(g(z,x),g(z,y))). Of course, for the purpose of sanity, in practice we will continue to write things as they might naturally be written in ordinary mathematics; however, one must be aware of the formal way that such sentences would be written. As in the earlier part of these notes, we obtain a “nonstandard extension” by considering an embedding M → M?, where the universe of M? corresponding to the sort s is M? s and the map is given by a 7→ a?. We will demand more from this embedding later, but for now we do not even assume that the embedding is an inclusion, that is, we do not assume that Ms ? M? s. As before, we write A? for the interpretation of the predicate symbol PA in M?. To be of any use, we assume that the nonstandard extension is proper, meaning that, for every s ∈ S and every in?nite A ? Ms, we assume that there is b ∈ A? such that b 6= a? for any a ∈ A. (In other words, we are postulating the existence of many nonstandard elements.) Of course, such nonstandard extensions exist by the Compactness Theorem (Exercise!). Exercise 8.5. Suppose the nonstandard extension is proper. Then for any ?nitesequence~s ofsortsandanyin?nite A ? M~s, A? containsanonstandard element. 8.2. Higher-type sorts. As we saw with the measure theory example in the previous subsection, it will often be convenient to have a sort for P(X) whenever X is itself a sort. For simplicity of discussion, let us consider the many-sorted structure (X,P(X)); what we say now is easily adapted to the more general situation that X and P(X) are sorts in a many-sorted structure containing other sorts.
LECTURE NOTES ON NONSTANDARD ANALYSIS 49 We have the nonstandard extension (X,P(X))→(X?,P(X)?). We must be careful not to confuse P(X)? with P(X?), the latter retaining its usual meaning as the set of subsets of X?. At the moment,P(X)? is some abstract set, perhaps having no a?liation with an actual powerset. We now discuss how to relate P(X)? and P(X?). Set E = {(x,A) ∈ X ×P(X) | x ∈ A}, the symbol for the membership relation. Lemma 8.6 (Normalization). We may assume that our nonstandard extension satis?es the additional two conditions: (N1) X ? X? and x = x? for all x ∈ X; (N2) P(X)? ? P(X?) and E? is the membership relation restricted to X?×P(X)?. Proof. Webeginwithsomeabstractnonsense: let Y beasetand h : X? → Y a bijection such that X ? Y and h(x?) = x for all x ∈ X. For A ∈ P(X)?, set Φ(A) = {h(x) | x ∈ X? and (x,A) ∈ E?} ? Y . We claim that Φ is injective. Indeed, suppose that A1,A2 ∈ P(X)? and A1 6= A2. By the transfer principle, there is x ∈ X? such that either (x,A1) ∈ E? and (x,A2) / ∈ E?; or (x,A2) ∈ E? and (x,A1) / ∈ E?. Theneither h(x)∈Φ(A1)\Φ(A2) or h(x)∈Φ(A2)\Φ(A1); either way, Φ(A1)6=Φ( A2). Now make (Y,Φ(P(X)?)) into a structure in the unique way so that the map (h,Φ) : (X?,P(X)?) → (Y,Φ(P(X)?)) is an isomorphism. (Exercise!) Note that (Y,Φ(P(X)?)) has the desired properties (N1) and (N2).
 Recap: We have the many-sorted structure (X,P(X)) and its nonstandard extension (X?,P(X)?). Furthermore, we assume that X ? X? and for all Y ∈P(X)?, we view Y ? X? by declaring, for x ∈ X?: x ∈ Y ?(x,Y)∈ E?. There is some potential confusion that we should clear up now. Suppose that A ? X. Then we have A? ? X? from the interpretation of the symbol PA. However, A ∈P(X), so it is mapped by the embedding to an element of P(X)?, which we temporarily denote by (A)?. Fortunately, all is well: Lemma 8.7. A? = (A)?. Proof. By the transfer principle, we have that, for x ∈ X?, x ∈ A? if and only if (X?,P(X)?) |= PA(x). By the normalization assumption, we have that, for x ∈ X?, x ∈ (A)? if and only if (x,(A)?) ∈ E?. Fortunately, (X,P(X))|=?x ∈ X(PA(x)? PE(x,A)), so the desired result follows from transfer.
 De?nition 8.8. Asubset A of X? iscalledinternal if A ∈P(X)?; otherwise, A is called external. Thus, the transfer principle applies to the internal subsets of X?.
50 ISAAC GOLDBRING Example 8.9. Let us consider (N,P(N)) and its nonstandard extension (N?,P(N)?). We claim that N is an external subset of N?. To see this, note that the following sentence is true in (N,P(N)): ?A ∈P(N)((?x ∈N(PE(x,A))∧?y ∈N?z ∈N(PE(z,A)→ z ≤ y)) →?y ∈N(PE(y,A)∧?z ∈N(PE(z,A)→ z ≤ y). This sentence says that if A ?N is bounded above, then A has a maximum element. By transfer, the same holds true for any A ∈ P(N)?, that is, for any internal subset of N?. If N were internal, then since it is bounded above (by an in?nite element), it would have a maximum, which is clearly not true. Example 8.10. We continue to work with the set-up of the previous example. Since (N,P(N))|=?n ∈N?A ∈P(N)?m ∈N(PE(m,A)? m ≤ n), by transfer we have (N?,P(N)?)|=?n ∈N??A ∈P(N)??m ∈N?(PE(m,A)? m ≤ n). Fixing N ∈ N, we suggestively let {0,1,...,N} denote the internal subset of N? consisting of all the elements of N? that are no greater than N. This is a prototypical example of a hyper?nite set. The following principle is useful in practice; it says that sets de?ned (in the ?rst-order logic sense) from internal parameters are internal. Theorem 8.11 (InternalDe?nitionPrinciple). Let ?(x,x1,...,xm,y1,...,yn) be a formula, where x,x1,...,xm range over the sort for X and y1,...,ym range over the sort forP(X). Suppose that a1,...,am ∈ X? and A1,...,An ∈ P(X)?. Set B :={b ∈ X? | (X?,P(X)?)|= ?(b,a1,...,am,A1,...,An)}. Then B is internal. Proof. The following sentence is true in (X,P(X)): ?x1,...,xm?y1,...,yn?z?x(PE(x,z)? ?(x,x1,...,xm,y1,...,yn)). By transfer, this remains true in (X?,P(X)?). Plugging in ai for xi and Aj for yj, we see that (X?,P(X)?)|=?z?x(PE(x,z)? ?(x,a1,...,am,A1,...,An)). The set asserted to exist is B, which then belongs to P(X)?, that is, B is internal.
 Example 8.12. Forany?nitecollection a1,...,am ∈ X?, theset{a1,...,am} is internal. Indeed, let ?(x,x1,...,xm) be the formula x = x1∨···∨x = xm. Then {a1,...,am}={b ∈ X? | (X?,P(X)?)|= ?(b,a1,...,am)}.
LECTURE NOTES ON NONSTANDARD ANALYSIS 51
It will also prove useful to have a notion of internal function. To do this, we need to expand our set-up a bit. We now consider the many-sorted structure (X,P(X),P(X×X)) with an embedding into a nonstandard extension (X?,P(X)?,P(X ×X)?). We set: ? E1 :={(x,A)∈ X ×P(X) | x ∈ A}, and ? E2 :={(x,y,A)∈ X ×X ×P(X ×X) | (x,y)∈ A}. The proof of the following lemma is exactly like the proof of Lemma 8.6. Lemma 8.13. We may assume that our nonstandard extension satis?es the additional three conditions: (N1) X ? X? and x = x? for all x ∈ X; (N2) P(X)? ? P(X?) and E? 1 is the membership relation restricted to X?×P(X)?;(N3) P(X ×X)? ? P(X? ×X?) and E? 2 is the membership relation restricted to X?×X?×P(X ×X)?. De?nition 8.14. B ? X?×X? is internal if B ∈P(X×X)?. If A,B ? X? and f : A → B is a function, then we say that f is internal if the graph of f, Γ(f) :={(x,y)∈ X?×X? | x ∈ A and f(x) = y}? X?×X?, is internal. At this point, the reader should verify that they would know how to escape the friendly con?nes of considering many-sorted structures of the form (X,P(X)) or (X,P(X),P(X ×X)) and instead be able to consider much wildermany-sortedstructuresthatmightcontainmanysetsandtheirpowersets. Forexample, instudyingvectorspaces, itwillbeconvenienttoconsider a many-sorted structure of the form (V,P(V ),P(V ×V ),F,P(F),P(F×V )). As an exercise, make sure you understand how to speak of an internal linear transformation T : V? → V? or an internal norm k·k: V? →R?. In a similar vein, if s : N? → X? is an internal function, then we refer to the “sequence” (sn | n ∈N?) as an internal sequence. De?nition 8.15. Set P?n(X) := {A ∈ P(X) | A is ?nite } ? P(X). We then say that B ? X? is hyper?nite if B ∈P?n(X)?. Exercise 8.16. Assume that (N,P(N),P(N×N)) is part of the structure. (1) Prove that hyper?nite sets are internal. (2) Prove that an internal subset of a hyper?nite set is hyper?nite. (3) Prove that B ? X? is hyper?nite if and only if there is an internal function f : B → N? such that f is a bijection between B and {0,1,...,N}for some N ∈N?; we then refer to N+1 as the internal cardinality of B. (4) Prove that ?nite subsets of X? are hyper?nite. 8.3. Saturation. For various nonstandard arguments, it will not su?ce to merely assume that the extension is proper; we will need to assume a further richness condition on our nonstandard extensions.
52 ISAAC GOLDBRING
De?nition 8.17. Suppose that κ is an uncountable cardinal. We say that the nonstandard extension is κ-saturated if whenever (Ai | i ∈ I) is a family ofinternalsetswith|I| < κ satisfyingthe?nite intersection property, thatis, the intersection of any ?nite number of Ai’s is nonempty, thenTi∈I Ai 6=?. Example 8.18. Suppose that the nonstandard extension is ?1-saturated and that R is a basic sort. For each q ∈Q>0, set Aq :={r ∈R? |0 < r < q}. By the internal de?nition principle, Aq is an internal set. Moreover, it is easy to verify that the family (Aq | q ∈ Q>0) has the ?nite intersection property. By ?1-saturation, there is r ∈Tq∈Q>0 Aq; this r is then a positive in?nitesimal. Although this example is modest (as we already have ways of constructing in?nitesimals), saturation will prove crucial in the analysis to come; see also the problems below. Exercise 8.19. Assume that the nonstandard extension is?1-saturated and that (Nm | m ∈N) is a sequence of elements of N?\N. Prove that there is N > N such that N < Nm for each m ∈N. In any research article, one always assumes at least ?1-saturation of the nonstandard extension. For other applications, κ-saturation for larger κ is oftenneeded. However, howcanwebeassuredthat κ-saturatednonstandard extensions exist? Theorem 8.20. For any uncountable cardinal κ, there is a κ-saturated nonstandard extension. Proof. See any textbook on model theory.
 Saturation is closely related to another richness concept, namely comprehension. Theorem 8.21 (Saturated extensions are comprehensive). Suppose that the nonstandard extension is κ-saturated. Suppose A and B are internal sets and suppose that A0 ? A is a (possibly external) set with |A0| < κ. Suppose f0 : A0 → B is a function. Then there is an internal function f : A → B extending f0. Proof. For x ∈ A0, de?ne Dx :={f | f : A → B is internal and f(x) = f0(x)}. By the internal de?nition principle, each Dx is internal. By κ-saturation, it remains to verify that (Dx | x ∈ A0) has the ?nite intersection property. Fix x1,...,xn ∈ A0. De?ne f : A → B by f(y) =(f0(xi) if y = xi for some i ∈{1,...,n}; f0(x1) otherwise. Then f is internal by the internal de?nition principle.
LECTURE NOTES ON NONSTANDARD ANALYSIS 53
De?nition 8.22. The nonstandard extension is said to be countably comprehensive if whenever B is internal and (bn |n ∈N) is a countable sequence from B, then there is an internal f : N? → B such that f(n) = bn for all n ∈N. In other words, countable comprehension says that sequences indexed by N can be internally extended to sequences indexed by N?. Corollary 8.23. If the nonstandard extension is ?1-saturated, then it is also countably comprehensive. The converse to the previous corollary is also true; see Problem 8.8 below. 8.4. Useful nonstandard principles. In this subsection, we collect some useful principles that are often used in nonstandard proofs. Theorem 8.24 (Over?ow). Suppose that A ? R? is internal and suppose that, for every n ∈N, there is a ∈ A such that a > n. Then there is a ∈ A such that a > N. Proof. Set B := {n ∈ N? | there is a ∈ A such that a > n}. B is internal by the internal de?nition principle. By assumption, N ? B. Since N is external, we have N ( B, whence there is n ∈ B with n > N. Take a ∈ A such that a > n; it follows that a > N.
 Theorem 8.25 (Under?ow). Let A ?(R?)>0 be internal and suppose that, for every n ∈N?\N, there is a ∈ A such that a < n. Then A∩R?n 6=?. Proof. Set B := {n ∈ N? | there is a ∈ A such that a < n}. Then B is internal and contains N?\N. Note that N?\N is external, else, since N? is internal, we would see that N is internal. Thus, we have B ∩N 6= ?, which yields the desired result.
 Theorem 8.26 (Internal Induction). Let A ? N? be internal and suppose that: ? 0∈ A; ? for all n ∈N?, if n ∈ A, then n +1∈ A. Then A = N?. Proof. Suppose A 6= N?. Since N?\A is internal, it has a minimum element (by transfer). Let n = min(N?\A). By assumption, n > 0. Then n?1∈ A, whence, by assumption, n ∈ A, a contradiction.
 As a warning, we really must assume that A is internal in the previous theorem. Indeed, N satis?es the two assumptions of the previous theorem, but N6= N?. Theorem 8.27 (In?nitesimal Prolongation). Suppose that (sn | n ∈N?) is an internal sequence from R?. Suppose that sn ≈ 0 for each n ∈ N. Then there is N > N such that sn ≈0 for each n ≤ N.
54 ISAAC GOLDBRING Incorrect First Attempt. Let A ={n ∈N? | sn 6≈0}. If A =?, we are done. Otherwise, let N = minA. By assumption, N > N, whence we are done. This proof is incorrect since A is external, whence we cannot conclude that it has a minimum!
 Proof. For n ∈ N?, de?ne tn := n·sn; then the sequence (tn | n ∈ N?) is internal by assumption. By assumption, tn ≈ 0 for n ∈ N; again, this is an external statement. However, it is enough to replace that statement by the weaker, internal statement |tn| < 1 for all n ∈ N. More precisely, let A = {n ∈ N? | |tm| < 1 for all m ≤ n}. By over?ow, there is N ∈ N? \N such that N ∈ A. This N is as desired.
 The In?nitesimal Prolongation Theorem is often used in conjunction with countable comprehension as follows. Suppose that (xn | n ∈ N?) is an internal sequence from R? such that xn ∈R?n for n ∈N. For n ∈N, de?ne yn := st(xn). By countable comprehension, we can internally extend the sequence (yn | n ∈ N) to an internal sequence (yn | n ∈ N?) from R?. For n ∈ N, we know that xn ≈ yn. By in?nitesimal prolongation, we can ?nd N > N such that xn ≈ yn for all n ≤ N. The last principle is perhaps the most important of all in applications, as we will see later in these notes. Theorem 8.28 (Hyper?niteApproximation). Suppose that the nonstandard extension is κ-saturated. Let A ? X? be internal and let B ? A be a (possibly external) set with |B| < κ. Then there is a hyper?nite set C ? A such that B ? C. Proof. For x ∈ B, set Dx :={C ∈P?n(X)? | C ? A and x ∈ C}. Note that each Dx is internal by the internal de?nition principle. Moreover, (Dx | x ∈ B) has the ?nite intersection property. Indeed, given x1,...,xn ∈ B, we have that {x1,...,xn} ∈ Dx1 ∩···∩ Dxn. Thus, by κ-saturation, there is C ∈Tx∈B Dx; such C is as desired.
 8.5. Recap: the nonstandard setting. From now on, we will proceed under the following assumptions: we assume that our nonstandard extension contains as sorts all sets relevant to the mathematics we are about to study. Moreover, we assume that enough cartesian products and powersets are also sorts. We assume that the nonstandard extension satis?es the normalization assumptions from Lemma 8.6. Finally, we assume that the nonstandard extension is κ-saturated for κ large enough for our purposes. 8.6. Problems. Problem 8.1. Suppose that A and B are internal subsets of X?. (1) Show that X?\A, A∪B and A∩B are internal. (2) Suppose that f : X? → X? is an internal function. Show that f(A) and f?1(A) are internal sets and f  A is an internal function.
LECTURE NOTES ON NONSTANDARD ANALYSIS 55
Problem 8.2. (1) Suppose r,s ∈R? and r < s. Set [r,s] :={t ∈R? | r ≤ t ≤ s}. Show that [r,s] is internal. (2) Show that μ is external. (3) Show that R?n is external. Problem 8.3. Discuss what it should mean for a function f : A → B to be internal, where A ? M~s and B ? M~ t. Problem 8.4. Suppose that f : N?×X? → X? is an internal function. Fix x ∈ X?. Show that there exists a unique internal function F : N? → X? such that F(0) = x and F(n+1) = f(n+1,F(n)). (This is the principle of Internal Recursion.) Problem 8.5. Supposethatthenonstandardextensionis κ-saturated. Show that every in?nite internal set has cardinality at least κ. Problem 8.6. (1) Suppose that N ∈ N? \N. Fix r ∈ (0,1) (so r is standard). Show there is a smallest k ∈N? such that Nr ≤ k. (2) Show that any in?nite hyper?nite set has cardinality at least 2?0. (3) Show that any in?nite internal set has cardinality at least 2?0. (This improves the result from the previous exercise.) Problem 8.7. Suppose the nonstandard extension satis?es the Countable Comprehension Principle. Further suppose that (Kn | n ∈N) is a sequence of elements of N? such that Kn > N for all n ∈ N. Show that there is K ∈N?\N such that K < Kn for all n ∈N. Problem 8.8. Show that a nonstandard extension satisfying the Countable Comprehension Principle must be ?1-saturated. (Hint: you might ?nd the previous problem useful.) Problem 8.9. Fix k ∈ N. Suppose that G = (V,E) is a (combinatorial) graph such that every ?nite subgraph of G is k-colorable. Prove that G is k-colorable. (Hint: hyper?nite approximation!) 9. Metric Space Topology In this section, we will start using the new nonstandard framework developed in the previous section to develop metric space topology from a nonstandard point of view. Although general topological spaces can be treated in the nonstandard framework, we have made a conscience decision to discuss the (important) special case of metric spaces. 9.1. Open and closed sets, compactness, completeness. De?nition 9.1. A metric space is a pair (X,d) such that X is a nonempty set and d : X × X → R is a function (the metric or distance function) satisfying, for all x,y,z ∈ X:
56 ISAAC GOLDBRING (1) d(x,y)≥0; (2) d(x,y) = 0 if and only if x = y; (3) d(x,y) = d(y,x); (4) (Triangle Inequality) d(x,z)≤ d(x,y)+ d(y,z). If (2) in the above list is replaced by the weaker condition (2’) x = y implies d(x,y) = 0, then d is called a pseudometric and (X,d) is called a pseudometric space. As usual, we often speak of “the metric space X,” suppressing mention of the metric. Keep in mind: the same set X can be equipped with many di?erent metrics, yielding many di?erent metric spaces. (See the examples below.) Example 9.2. (1) For ~x,~y ∈ Rn, de?ne d(~x,~y) :=pPn i=1(xi ?yi)2. Then (Rn,d) is a metric space. This metric is usually referred to as the euclidean metric on Rn. (2) For ~x,~y ∈Rn, de?ne d∞(~x,~y) := maxi=1,...,n|xi?yi|. Then (Rn,d∞) is a metric space. (3) Set C([0,1]),R) to be the set of continuous functions f : [0,1]→R. De?ne a metric d on C([0,1],R) by setting d(f,g) := max x∈[0,1]|f(x)?g(x)|. Note that this maximum exists by continuity. Untilotherwisespeci?ed, we?xametricspace X. For a ∈ X and r ∈R>0, we set B(a;r) := {x ∈ X | d(a,x) < r}, the open ball in X centered at a with radius r. We can also consider the closed ball in X centered at a with radius r: ˉ B(a;r) :={x ∈ X | d(a,x)≤ r}. We will work in a nonstandard extension containing N, R, X, and whatever else we might need to refer to. We also assume that the extension is κ-saturated for κ > max(2?0,|X|) (although we can get away with an often smaller level of saturation; we will discuss this later). Observe that the metric extends to a function d : X? × X? → R? satisfying the axioms in De?nition 9.1 above. Thus, (X?,d) is almost a metric space; it’s only defect is that the metric takes values in R? rather than R. We begin by giving a nonstandard characterization of the topological notion of a set being open. First, the standard de?nition: De?nition 9.3. O? X is open if for any a ∈O, there is r ∈R>0 such that B(a;r)?O. To give the nonstandard equivalent of open, we ?rst make a very important nonstandard de?nition: De?nition 9.4. For a ∈ X, the monad of a is the set μ(a) :={x ∈ X? | d(a,x)≈0}.
LECTURE NOTES ON NONSTANDARD ANALYSIS 57
Notice that if X = R is given the euclidean metric, then μ(0) = μ is the set of in?nitesimals. Proposition 9.5. O? X is open if and only if, for all a ∈O, μ(a)?O?. Proof. First assume that O is open. Fix a ∈ O. By assumption, there is r ∈ R>0 such that, for all x ∈ X, if d(a,x) < r, then x ∈ O. Thus, by transfer, if x ∈ X? and d(a,x) < r, then x ∈O?. In particular, if x ∈ μ(a), then d(a,x)≈0, so d(a,x) < r and hence x ∈O?. Thus, μ(a)?O?. For the converse, ?x a ∈ X. By assumption, μ(a) ? O?. Fix δ ∈ μ>0. Then if x ∈ X? is such that d(a,x) < δ, then x ∈ μ(a), whence x ∈ O?. Thus, (?δ ∈ (R>0)?)(?x ∈ X?)(d(a,x) < δ → x ∈ O?). Now apply the transfer principle to obtain δ ∈R>0 such that, for all x ∈ X, if d(a,x) < δ, then x ∈ O, whence B(a;δ) ? O. Since a ∈ O was arbitrary, this shows that O is open.
 Before we state the next corollary, we ?rst note that, by the transfer principle, B(a;r)? :={x ∈ X? | d(a,x) < r}. Corollary 9.6. For any a ∈ X and r ∈ R>0, B(a;r) is open. (So the terminology open ball is appropriate.) Proof. Fix b ∈ B(a;r); we need μ(b) ? B(a;r)?. Suppose c ∈ μ(b), so d(b,c) ≈ 0. Then, by the (transfer of the) triangle inequality, d(a,c) ≤ d(a,b)+ d(b,c) < r, whence c ∈ B(a;r)?.
 Exercise 9.7. Prove that μ(a) is internal if and only if a is an isolated point of X, that is, {a} is an open set. Some notation: for x,y ∈ X?, we write x ≈ y to indicate d(x,y)≈0. So,for a ∈ X, μ(a) = {b ∈ X? | a ≈ b}. Also, if x,y ∈ X, then x ≈ y if andonly if x = y. Exercise 9.8. The relation ≈ is an equivalence relation on X?. De?nition 9.9. C ? X is closed if X \C is open. Corollary 9.10. C is closed if and only if, whenever p ∈ X and q ∈ C? are such that p ≈ q, then p ∈ C. Proof. X \C is open if and only if for all p ∈ X \C, for all q ∈ X? with p ≈ q, we have q ∈(X \C)? = X?\C?.
 Digression: Before we continue studying metric space topology, let us just mention brie?y how the above set-up generalizes to an arbitrary topological space. First, what is a topological space? A topological space is a nonempty set X, together with a collection τ of subsets of X, called the open subsets of X, satisfying the following criteria: ? ?,X ∈ τ; ? If (Ui | i ∈ I) is a family of subsets of X, each of which is in τ, then Si∈I Ui ∈ τ;
58 ISAAC GOLDBRING ? If U,V ∈ τ, then U ∩V ∈ τ. So, for example, a metric space, equipped with its collection of open sets (as de?ned above), is a topological space. There are a plethora of topological spaces not arising from metric spaces and the notion of topological space is central to most areas of mathematics (even logic!). Given a topological space X and a ∈ X, we de?ne the monad of a to be μ(a) =T{U? | U ∈ τ, a ∈ U}. (Double-check that this agrees with the de?nition in the metric space context.) With a little more e?ort, the results we have established in this section (that do not refer to metric notions) hold in the more general context of topological spaces. In fact, this is true of the majority of the results to come (at least the ones that do not mention metric notions).
We return to metric space topology. The following de?nition, while awkward at ?rst site, is fundamental in topology: De?nition 9.11. K ? X is compact if and only if: whenever (Oi | i ∈ I) is a family of open subsets of X such that K ?Si∈I Oi, then there are i1,...,in ∈ I such that K ?Oi1 ∪···∪Oin. In English: every open covering of K has a ?nite subcover. Observe that, in the above de?nition of compactness, we can restrict attention to open coverings of K whose index set I has cardinality at most |K|. (Why?) Consider the following elegantnonstandard characterizationof compactness: Proposition 9.12 (Robinson’scharacterizationofcompactness). K is compact if and only if, for every p ∈ K?, there is q ∈ K with p ≈ q. Proof. First assume that K is compact and yet, towards a contradiction, that there is p ∈ K? such that p 6≈ q for every q ∈ K. For each q ∈ K, there is then rq ∈R>0 such that d(p,q)≥ rq. Notice that {B(q;rq) | q ∈ K} is an open cover of K. Thus, since K is compact, there are q1,...,qn ∈ K such that K ?Sn i=1 B(qi;rqi). In logical terms, the following is true: (?x ∈ K)(d(x,q1) < rq1 ∨d(x,q2) < rq2 ∨···∨d(x,qn) < rqn). Applying the transfer principle to the displayed statement, we see that d(p,qi) < rqi for some i ∈{1,...,n}, which is a contradiction. For the converse, assume that K is not compact. Thus, there is an open cover (Oi | i ∈ I) of K with no ?nite subcover. For i ∈ I, consider the internal set Ai := K? \O? i . By assumption, each Ai is nonempty and the family (Ai | i ∈ I) has the ?nite intersection property: indeed, if Ai1 ∩···∩ Ain = ?, then for all x ∈ K?, there is i ∈{1,...,n} such that x ∈O? i . By transfer, this would imply that K ?Sn j=1Oij, contradicting the choice ofthe open cover ( Oi). Thus, by saturation, there is p ∈Ti∈I Ai. (Our ?rstserious use of saturation!) Then p ∈ K? and p 6≈ q for any q ∈ K: indeed,if p ≈ q with q ∈ K, then taking i ∈ I such that q ∈ Oi, we would havep ∈ μ(q)?O? i , contradicting p ∈ Ai.
LECTURE NOTES ON NONSTANDARD ANALYSIS 59
Example 9.13. It is easy to see, using the nonstandard characterization of compactness, that [a,b] is compact. However, if  ∈ μ>0, then a+ ∈(a,b]?, but not in the monad of any element of (a,b], whence (a,b] is not compact. Similarly, if N > N, then N ∈[0,∞)? butnotinthemonadofanyelementof [0,∞), whence [0,∞) is not compact. Compactness is meant to generalize the notion of closed, bounded intervals [a,b], but we’ll soon see that this analogy breaks down in “in?nite-dimensional” examples. Corollary 9.14. (1) If C ? K, where C is closed and K is compact, then C is compact. (2) If K is compact, then K is closed. Proof. For (1), suppose p ∈ C?; we need to ?nd q ∈ C such that p ≈ q. Since p ∈ K? as well, by compactness of K, p ≈ q for some q ∈ K. By the nonstandard characterization of closed, we have q ∈ C. For (2), suppose that p ∈ K?, q ∈ X are such that p ≈ q; we need q ∈ K. Since K is compact, there is q0 ∈ K such that p ≈ q0. By Exercise 9.8, q ≈ q0; since q,q0 ∈ X, we have that q = q0, whence q ∈ K.
 Here’saquestion: WhatistheanalogofR?n forourmetricspace X? Ifwe use just the de?nition of R?n, then we should make the following de?nition: De?nition 9.15. The set of ?nite points of X? is X?n ={a ∈ X? | d(a,b)∈R?n for some b ∈ X}. However, by Theorem 1.9, every element of R?n is in?nitely close to a (standard) real number. This motivates: De?nition 9.16. The set of nearstandard elements of X? is Xns :={a ∈ X? | a ≈ b for some b ∈ X}. In other words, Xns =Sb∈X μ(b). Some remarks are in order: Remarks 9.17. (1) The “for some” in De?nition 9.15 can be replaced with “for all,” that is, X?n :={a ∈ X? | d(a,b)∈R?n for all b ∈ X}. Indeed, suppose that a ∈ X? and b ∈ X are such that d(a,b)∈R?n. For any other c ∈ X, we have d(a,c)≤ d(a,b)+ d(b,c)∈R?n +R?R?n. (2) It is immediate to see that Xns ? X?n. Sometimes we have equality; for example, Theorem 1.9 says that Rns = R?n. However, we often have a strict inclusion Xns ( X?n. For example, let X = C([0,1],R) from Example 9.2. By transfer, an element of X? is a function
60 ISAAC GOLDBRING f : [0,1]? → R? that satis?es the -δ de?nition of continuity for ,δ ∈R?. So consider f : [0,1]? →R? given by f(x) =? ? ? ? ? 0 if x ≤ 1 2 1 (x? 1 2) if 1 2 ≤ x ≤ 1 2 +  1 otherwise, where  ∈ μ>0. Then f ∈ X?, but since f makes an “appreciable” jump in an in?nitesimal time period, f cannot be in?nitely close to a standard, continuous function g : [0,1] → R. We will later clarify exactly when Xns = X?n. (3) Suppose p ∈ Xns. Then there is a unique q ∈ X such that p ≈ q: indeed, if p ≈ q and p ≈ q0, where q,q0 ∈ X, then q ≈ q0, so q = q0. In analogy with earlier in these notes, we call this unique q the standard part of p, denoted st(p). Robinson’s characterization of compactness can now be phrased as: Corollary 9.18. X is compact if and only if X? = Xns. De?nition 9.19. B ? X is bounded if there is a ∈ X and r ∈ R>0 such that B ? B(a;r). Proposition 9.20. B ? X is bounded if and only if B? ? X?n. Proof. Suppose that B is bounded, say B ? B(a;r). Then B? ? B(a;r)?; clearly B(a;r)? is contained in X?n. Conversely, suppose that B? ? X?n. Fix a ∈ X and N > N. Then the following is true in the nonstandard universe: (?N ∈N?)(?x ∈ B?)(d(a,x) < N). Now apply transfer.
 In particular, X is bounded if and only if X? = X?n. Corollary 9.21. If K ? X is compact, then K is bounded. Proof. This follows from the inclusions K? ? Xns ? X?n.
 De?nition 9.22. X is a Heine-Borel (or proper) metric space if, for all K ? X, we have K is compact if and only if K is closed and bounded. The name Heine-Borel metric space comes from the Heine-Borel Theorem (to be proven below), which states that a subset of Rn is compact if and only if it is closed and bounded. We have already seen that compact sets are always closed and bounded, so the meat of the de?nition is the other implication. Proposition 9.23. X is a Heine-Borel metric space if and only if Xns = X?n.
LECTURE NOTES ON NONSTANDARD ANALYSIS 61
Proof. First suppose that X is a Heine-Borel metric space and suppose that a ∈ X?n; we need a ∈ Xns. Fix b ∈ X; then d(a,b) ∈ R?n, say d(a,b) < r with r ∈ R>0. Then a ∈ ˉ B(b;r)?. Since X is Heine-Borel, we have ˉ B(b;r) is compact, whence a ≈ c for some c ∈ ˉ B(b;r). In particular, a ∈ Xns.Conversely, suppose that Xns = X?n. Suppose that K ? X is closed andbounded; we need K to be compact. Fix a ∈ K?; we need a ≈ b for someb ∈ K. Since K is bounded, we have K? ? X?n, whence a ∈ X?n = Xns. Thus, there is (unique) b ∈ X such that a ≈ b. It remains to verify that b ∈ K; but this follows immediately from the fact that K is closed (and the nonstandard characterization of closed).
 Corollary 9.24. Rn is a Heine-Borel metric space. C([0,1],R) is not a Heine-Borel metric space. We can de?ne continuity between metric spaces. Suppose that Y is also a metric space and f : X → Y is a function. For p ∈ X, we say that f is continuous at p if whenever O? Y is open and f(p) ∈O, then there is an open O0 ? X such that f(O0) ? f(O). We say that f is continuous if f is continuous at p for all p ∈ X. The astute observer will notice that this is not the direct translation of continuity for functions on R. However, the following exercise will make them feel better: Exercise 9.25. The following are equivalent: (1) f is continuous at p; (2) For all  ∈ R>0, there is δ ∈ R>0 such that, for all q ∈ X, if d(p,q) < δ, then d(f(p),f(q)) < ; (3) f(μ(p))? μ(f(p)), that is, if q ≈ p, then f(q)≈ f(p). Weusetheabovede?nitionforcontinuityasitmakessenseinanarbitrary topological space and not just for metric spaces. The equivalence of (1) and (3) in the previous exercise will still hold in this more general context. Proposition 9.26. Suppose that f : X → Y is continuous and K ? X is compact. Then f(K)? Y is compact. Proof. Suppose y ∈ f(K)?; we need y ∈ f(K)ns. By transfer, we have y = f(x) for some x ∈ K?. Since K is compact, st(x) exists and belongs to K. Since f is continuous at st(x), y = f(x)∈ μ(f(st(x)), so y ∈ f(K)ns.
 Exercise 9.27. Suppose that f : X → Y is a function. (1) De?ne what it means for f to be uniformly continuous. Then state and prove a nonstandard characterization of uniform continuity. (2) Suppose that f is continuous and X is compact. Prove that f is uniformly continuous. For the purpose of the next exercise, de?ne Xinf := X? \ X?n. A (not necessarily continuous) function f : X → Y is said to be proper if f?1(K)? X is compact for every compact K ? Y .
62 ISAAC GOLDBRING
Exercise 9.28. Suppose that X and Y are Heine Borel metric spaces and f : X → Y iscontinuous. Provethat f isproperif andonlyif f(Xinf)? Yinf. We can also bring the notions of sequences and convergence of sequences intothemetricspacesetting. Forexample, asequence(an)from X converges to a ∈ X if and only if, for every  ∈R>0, there is m ∈N such that, for all n ∈N, if n ≥ m, then d(an,a) < . Here is the metric space version of Bolzano-Weierstrauss: Theorem 9.29. If X is a compact metric space and (an) is a sequence in X, then an has a convergent subsequence. Proof. Fix N > N. Then aN ∈ X? = Xns. Then st(aN) is a limit point of (an).
 De?nition 9.30. X is a complete metric space if every Cauchy sequence in X converges. Corollary 9.31. Compact metric spaces are complete. Proof. Suppose that (an) is a Cauchy sequence in X, so aM ≈ aN for all M,N > N. Since X is compact, aN ∈ Xns for all N > N. Thus, if L = st(aN) for N > N, then aM ≈ L for all M > N, whence (an) converges to L.
 Exercise 9.32. Suppose that X is complete and C ? X is closed. Prove that C is also complete. In order to explain the nonstandard characterization of completeness, it is convenient at this point to introduce another important set of points in X?: De?nition 9.33. The set of pre-nearstandard points of X? is Xpns :={a ∈ X? | for each  ∈R>0, there is b ∈ X such that d(a,b) < }. Immediately, we see that Xns ? Xpns ? X?n. Theorem 9.34. X is complete if and only if Xns = Xpns. Proof. First suppose that X is complete and p ∈ Xpns. Then, for every n ≥1, there is qn ∈ X such that d(p,qn) < 1 n. It follows that (qn) is Cauchy, whence converges to q ∈ X. It follows that p ≈ q, whence p ∈ Xns. Towards the converse, suppose that Xns = Xpns and suppose that (xn) is Cauchy. Fix N > N; it su?ces to show that xN ∈ Xns. If not, then xN / ∈ Xpns, whence there is  ∈ R>0 such that d(xN,q) ≥  for all q ∈ X. In particular, d(xN,xn) ≥  for all n ∈ N. But (xn) is Cauchy, so for some n ∈N big enough, d(xN,xn) < , a contradiction.
 Corollary 9.35. If X is Heine-Borel, then X is complete. The following theorem on “remoteness” will prove useful later in these notes:
LECTURE NOTES ON NONSTANDARD ANALYSIS 63 Theorem 9.36. Suppose that (pn |n ∈N?) is an internal sequence from X?. Suppose that r ∈ R>0 is such that d(pm,pn) ≥ r for all distinct m,n ∈ N. Then pn / ∈ Xns for some n ∈N?. Proof. Suppose, towards a contradiction, that pn ∈ Xns for all n ∈N?. For n ∈ N set qn := st(pn). We then get the nonstandard extension of (qn), namely (qn | n ∈ N?). We must be careful here: just because pn ≈ qn for all n ∈ N does not imply that pn ≈ qn for all n ∈ N? (as the relation ≈ is external). Nevertheless, the sequence (d(pn,qn) | n ∈N?) is internal and in?nitesimal for n ∈ N. Thus, by the In?nitesimal Prolongation Theorem, there is N > N such that d(pn,qn) ≈ 0 for all n ≤ N. Fix M > N with M < N and set q := st(pM) = st(qM) (which is possible by our standing assumption). Thus, there is a subsequence (qnk) converging to q. Choose n0 ∈N such that, for j,k ≥ n0: d(qnj,qnk) < r 2. It follows that d(pnj,pnk) < r, a contradiction.
 9.2. More about continuity. De?nition 9.37. Suppose that f : X? → Y? is a function. (1) f is S-continuous if, for all x,x0 ∈ X?, if x ≈ x0, then f(x)≈ f(x0). (2) f is δ-continuous if, for all p ∈ X? and  ∈ R>0, there is δ ∈ R>0 such that, for all q ∈ X?, if d(p,q) < δ, then d(f(p),f(q)) < . The important point in (2) is that both and δ are standard. It is easy to see that δ-continuity implies S-continuity. The converse need not hold: Exercise 9.38. Consider f : R? → R? de?ned by f(x) = 0 if x ≈ 0 while f(x) = 1 otherwise. Show that f is S-continuous but not δ-continuous. Observe that the function f in the previous exercise is external. For internal functions, the above notions coincide: Proposition 9.39. Suppose that f : X? → Y? is internal and S-continuous. Then f is δ-continuous. Proof. Suppose, towards a contradiction, that there is  ∈R>0 and p ∈ X? such that, for every δ ∈ R>0, there is q ∈ X? such that d(p,q) < δ while d(f(p),f(q))≥ . By saturation (how?), there is q ∈ X? such that d(p,q)≈ 0 while d(f(p),f(q))≥ , contradicting S-continuity.
 The following construction is crucial in de?ning standard continuous functions from internal functions. Theorem 9.40. Suppose X and Y are metric spaces with X compact. Suppose that f : X? → Y? is an internal, S-continuous function. Suppose further that f(p)∈ Yns for each p ∈ X. De?ne F : X → Y by F(p) = st(f(p)). Then F is continuous and F(p)≈ f(p) for all p ∈ X?. Proof. Fix p ∈ X; we show that F is continuous at p. Fix  ∈ R>0. By Proposition 9.39, there is δ ∈ R>0 witnessing that f is δ-continuous for
64 ISAAC GOLDBRING
 2. Suppose q ∈ X is such that d(p,q) < δ. Then d(f(p),f(q)) < 2. Since f(p)≈ F(p) and f(q)≈ F(q), this shows that d(F(p),F(q)) < . Now suppose that p ∈ X?; we need F(p) ≈ f(p). Let p0 := st(p); this is possible since X is compact. Then f(p) ≈ f(p0) by S-continuity of f. Meanwhile, F(p0)≈ f(p0) by de?nition of F and F(p0)≈ F(p) by continuity of F.
 We recall the de?nition of equicontuity, this time in the metric space setting: a sequence of functions (fn) from X to Y is equicontinuous if, for all  ∈ R>0, there is δ ∈ R>0 such that, for all p,q ∈ X and n ∈ N: if d(p,q) < δ, then d(fn(p),fn(q)) < . Exercise 9.41. Suppose that X and Y are metric spaces and X is compact. Set Z := C(X,Y) to be the space of continuous functions from X to Y . De?ne a function d on Z by setting d(f,g) := supx∈X d(f(x),g(x)). (1) Show that d is a metric on Z. (In particular, this means showing that the supremum is never in?nite.) (2) Show that (fn) converges to f (in the sense of the metric space Z) if and only if (fn) converges to f uniformly. If X is a compact metric space and fn : X →R is a continuous function for each n ∈N, we say that the sequence (fn) is uniformly bounded if there is M ∈R such that |fn(x)|≤ M for all x ∈ X and all n ∈N. Corollary 9.42 (Arzela-Ascoli). If X is a compact metric space and (fn) is a uniformly bounded, equicontinuous sequence of functions from X to R, then (fn) has a uniformly convergent subsequence. Proof. Fix N > N. As in an earlier part of the notes, fN : X? → R? is S-continuous (and internal). Since (fn) is uniformly bounded, it follows that fN(X) ? Rns.De?ne F : X → R (as in the last theorem) by setting F(p) := st(fN(p)). By the last exercise, it su?ces to show that F is a limit point of (fn); to do this, we will show that F ≈ fN as elements of C(X,R)?. Well, by transfer, d(F,fN) <  if and only if d(F(p),fN(p)) <  for all p ∈ X?; this follows immediately from the conclusion of the previous theorem.
9.3. Compact maps. We now discuss an important class of functions that will appear later in the functional analysis section. Once again, X and Y are metric spaces. De?nition 9.43. f : X → Y is compact if, for every bounded B ? X, we have a compact K ? Y such that f(B)? K. In other words, f is compact if and only if f(B) is compact. Theorem 9.44. f : X → Y is compact if and only if f(X?n)? Yns.
LECTURE NOTES ON NONSTANDARD ANALYSIS 65 Proof. First suppose that f is compact. Fix p ∈ X?n; we need f(p) ∈ Yns. Well, p ∈ B := B(a;r) for some a ∈ X and r ∈R>0, whence f(p)∈ f(B)? ? Yns since f(B) is compact. Conversely, suppose that f(X?n) ? Yns. Fix B ? X bounded; we must show that f(B) is compact. Take q ∈ f(B)?; we must ?nd q0 ∈ f(B) such that q ≈ q0. Fix  ∈ μ>0; by transfer, there is y ∈ f(B)? such that d(q,y) < . Write y = f(x) for x ∈ B?. By assumption, f(x) ∈ Yns, so f(x)≈ q0 for some q0 ∈ Y . It remains to show that q0 ∈ f(B). Fix δ ∈R>0. By assumption, there is z ∈ f(B)? such that d(q,z) < δ, whence it follows that d(q0,z) < δ. Applying transfer to this last fact, we see that there is z ∈ f(B) such that d(q0,z) < δ.
 Corollary 9.45. Suppose that f : X → Y is a function. If Y is compact, then f is compact. Corollary 9.46. Suppose that (fn) is a sequence of compact functions from X to Y . Further assume that Y is complete and that (fn) converges uniformly to f. Then f is compact. Proof. Suppose x ∈ X?n; we need f(x) ∈ Yns. Since Y is complete, it su?ces to prove that f(x) ∈ Ypns. Fix  ∈ R>0. Fix m ∈ N such that d(fm(p),f(p)) <  2 for all p ∈ X. By transfer, d(fm(x),f(x)) < 2. Since fm is compact, we have fm(x)∈ Yns, say fm(x)≈ y with y ∈ Y . It follows that d(f(x),y) < . Since was arbitrary, this shows that f(x)∈ Ypns.
 9.4. Problems. You may assume any level of saturation that you need in any given problem. Problem 9.1. Suppose that X is a metric space and A is a subset of X. The interior of A, denoted A?, is de?ned by A? :={x ∈ A | there exists r ∈R>0 such that B(x,r)? A}. (1) Show that A is open i? A = A?. (Standard reasoning) (2) Show that A? =S{O | O is open and O ? A}. (Standard reasoning) (3) Show that, for any x ∈ X, we have x ∈ A? i? y ∈ A? for any y ∈ X? with y ≈ x. Problem 9.2. Suppose that X is a metric space and A is a subset of X. The closure of A, denoted A. is de?ned by A :={x ∈ X | for any r ∈R>0, there is a ∈ A such that d(x,a) < r}. (1) Show that A = {x ∈ X | there is (an) from A such that an → x}. (Standard reasoning) (2) Showthat A =T{F |F is closed and A ? F}. (Standardreasoning) (3) Show that A is closed i? A = A. (Standard reasoning) (4) Show that, for any x ∈ X, we have x ∈ A i? there is y ∈ A? such that x ≈ y.
66 ISAAC GOLDBRING Problem 9.3. Let C ?R?n be internal. De?ne st(C) :={st(c) | c ∈ C}? R. Prove that st(C) is closed. Problem 9.4. (1) Suppose f : X → Y is continuous. Show that f : X? → Y? is ?-continuous. (2) Suppose that f : X? → Y? is δ-continuous. Show that f is Scontinuous. (3) Consider the function f : R? →R? de?ned by f(x) =(0 if x ≈0 1 otherwise. Show that f is S-continuous, but not δ-continuous. (4) Let f : R → R be de?ned by f(x) = x2. Show that f : R? → R? is ?-continuous, but not S-continuous.(5) Fix α ∈ μ>0. Consider the function f : R? →R? de?ned by f(x) =(αsin(1 x) if x 6= 0 0 if x = 0. Show that f is S-continuous at 0 but not ?-continuous at 0. Problem 9.5. Suppose that A ? X? is internal. Let st(A) ={x ∈ X | x ≈ y for some y ∈ A}. (1) Show that st(A) is closed. (2) Suppose that A ? Xns is internal. Show that st(A) is compact. (3) Suppose that A ? X. Show that A = st(A?). (4) We say that A ? X is relatively compact if A is compact. Show that A ? X is relatively compact i? A? ? Xns. Problem 9.6. . Let C([0,1],R) denote the set of all continuous functions from [0,1] to R. For f,g ∈ C([0,1],R), set d(f,g) := sup{|f(x)?g(x)|| x ∈[0,1]}. (1) Show that C([0,1],R)? is the set of ?-continuous functions from [0,1]? to R?. (2) Suppose f ∈ C([0,1],R)?. Show that f ∈ C([0,1],R)ns i? f is Scontinuous and f(x)∈R?n for all x ∈[0,1]. (3) Show that C([0,1],R)ns ( C([0,1],R)?n. (4) Convince yourself that the results of this problem remains true when [0,1] is replaced by any compact metric space X. Problem 9.7. (Arzela-Ascoli Theorem-reformulated) Suppose that F ? C([0,1],R). Show that the following are equivalent: (1) F is relatively compact; (2) F? ? C([0,1],R)ns;
LECTURE NOTES ON NONSTANDARD ANALYSIS 67 (3) F is equicontinuous and, for all x ∈[0,1], the set Fx :={f(x) | f ∈F} is relatively compact. (ThenotionofequicontinuityisexactlyasinSection3, namely,F isequicontinuous i? for every  ∈ R>0, there is δ ∈ R>0 such that for all x,y ∈ [0,1] and all f ∈F, if |x?y| < δ, then |f(x)?f(y)| < . You will need to show again that F is equicontinuous i? each f ∈F? is S-continuous.) By (4) of Problem 9.6, the equivalence in the previous problem remains true when [0,1] is replaced by any compact metric space.
10. Banach Spaces In this section, F denotes one of the two ?elds R or C. Let’s say a word about C?. By transfer, the elements of C? are of the form z = x + iy for x,y ∈R? and then |z|=px2 + y2. It is then straightforward to verify that C?n = {z ∈C? | |z|∈R?n} = {x + iy | x,y ∈R?n} = Cns since R?n = Rns. If z = x + iy ∈Cns, then st(z) = st(x)+ ist(y). 10.1. Normed spaces. De?nition 10.1. If V is a vector space over F, then a norm on V is a function k·k: V →R satisfying, for all x,y ∈ V and α ∈F: (1) kxk≥0; (2) kxk= 0 if and only if x = 0; (3) kαxk=|α|·kxk; (4) (Triangle Inequality) kx + yk≤kxk+kyk. A normed space is a vector space equipped with a norm. Example 10.2. (1) For any p ≥1, the p-norm on Fn is given by kxkp := p pPn i=1|xi|p.(2) There is an in?nitary analog of the previous example. Fix p ≥1 andset `p to be the set of all in?nite sequences (αn) from F such thatP ∞ n=1|αn|p < ∞. Then `p is a vector space over F and we de?ne the p-norm on `p in the exact same way: k(αn)kp := p pP∞ n=1|αn|p.(3) Fix a compact metric space X and set C(X,F) := {f : X →F |f is continuous}. Then C(X,F)isa(usuallyin?nite-dimensional) vector space over F and kfk := supx∈X |f(x)| de?nes a norm on C(X,F). Exercise 10.3. Supposethat(V,k·k)isanormedspace. De?ne d : V×V → R by d(x,y) := kx?yk. Then d is a metric on V and d(x,y) = d(x?y,0) for any x,y ∈ V . We will always treat a normed space as a metric space as in the previous exercise. A normed space is called a Banach space if the associated metric is complete.
68 ISAAC GOLDBRING
Exercise 10.4. Verify that all of the normed spaces from Example 10.2 are Banach spaces. (Hints: Don’t forget our nonstandard characterization of completeness. Also, for showing that C(X,F) is a Banach space, don’t forget about our nonstandard characterization of C(X,F)ns from Problem 9.6.) Until otherwise stated, we ?x normed spaces V and W; we write d for both of the associated metrics on V and W. For x ∈ V?, we say that x is in?nitesimal if x ≈0, that is, d(x,0)∈ μ (equivalently, kxk∈ μ). It follows immediately that x ≈ y if and only if x?y is in?nitesimal. Lemma 10.5. If x,y ∈ V? and x ≈ y, then kxk≈kyk. (The converse fails miserably!) Proof. We may suppose that kxk ≤ kyk Write y = x + (y ? x). Then kyk≤kxk+ky?xk≈kxksince y?x is in?nitesimal. Thus, kxk≈kyk.
 Exercise 10.6. (1) If α ∈F?n and x,y ∈ V? are such that x ≈ y, show that αx ≈ αy. (2) Prove that the addition and scalar multiplication maps + : V ×V → V and ·: F×V → V are continuous (with respect to the metric d). Please use the nonstandard characterization of continuity. 10.2. Bounded linear maps. Proposition 10.7. Suppose that T : V → W is a linear transformation and T is continuous at some x0 ∈ V . Then T is uniformly continuous. Proof. We use the nonstandard characterization of uniform continuity: suppose x,y ∈ V? and x ≈ y. We show that Tx ≈ Ty. Well, x0 +(x?y)≈ x0, so by the continuity of T at x0, we have T(x0 + x ? y) ≈ T(x0). Thus, T(x0) + T(x)? T(y) ≈ T(x0), whence T(x) ≈ T(y). (We have used the transfer principle to infer that the nonstandard extension of T is also linear.)
 Exercise 10.8. Suppose that T : V → W is a linear transformation that is continuous. Prove that ker(T) := {x ∈ V | T(x) = 0} is a closed subspace of V . De?nition 10.9. We say that a linear transformation T : V → W is bounded if there is M ∈R>0 such that kTxk≤ Mkxk for all x ∈ V . The terminology in the above de?nition corresponds to the next fact: Proposition 10.10. T : V → W is bounded if and only if {T(x) |kxk= 1} is a bounded subset of W. Proof. Let A :={T(x) |kxk= 1}. For the (?) direction, if kTxk≤ Mkxk for all x ∈ V , then A is contained in the closed ball around 0 (in W) of radius M. Conversely, suppose A is contained in the closed ball around 0 of radius M. We claim that kTxk ≤ Mkxk for all x ∈ V . Indeed, for x ∈ V \{0}, k 1 kxk xk= 1, so kT( 1 kxk x)k≤ M, whence kTxk≤ Mkxk.
LECTURE NOTES ON NONSTANDARD ANALYSIS 69 If T : V → W is bounded, set kTk := sup{kT(x)k|kxk = 1}, which is a real number by the previous proposition. Taking M = kTk in the proof of the (?) direction of the previous proposition, we obtain the following: Corollary 10.11. kTxk≤kTkkxk for all x ∈ V . De?nition 10.12. We set B(V,W) to be the set of all bounded linear transformations from V to W. Exercise 10.13. Show that B(V,W) is a vector subspace of the set of all linear transformations from V to W. Further show thatB(V,W) is a normed space (with the above de?nition of kTk). If V = W, prove that whenever T,U ∈B(V,V ), then T?U ∈B(V,V ) andkT?Uk≤kTk·kUk. (This shows that B(V,V ) is a normed algebra.) Theorem 10.14. Suppose that T : V → W is linear. The following are equivalent: (1) T is continuous at x0 for some x0 ∈ V ; (2) T is uniformly continuous; (3) T is bounded; (4) T(V?n)? W?n; (5) T(Vns)? Wns. Proof. The equivalence of (1) and (2) follows from Proposition 10.7 and (2)?(5) is clear. Suppose that T is not bounded. Let X ={n ∈N? |kT(x)k > n for some x ∈ V? with kxk= 1}, an internal subset of N? that contains N by assumption. Thus, by over?ow, there is N ∈ X \N. Choose x ∈ V? with kTxk > N and kxk = 1. At this point we have established the implication (4) ? (3). Set y := 1 kT(x)k x, so kyk < 1 N, whence y ≈ 0. But kT(y)k = 1, so T(y) 6≈ y, that is, T is not continuous. This proves the direction (2) ? (3). Set z := 1 √kTxkx; since kzk ∈ μ, we have z ∈ Vns. But kTzk = 1 √kTxkkTxk ∈ Rinf, so Tz / ∈ Wns; this shows (5)?(3). For (3)?(1), if x ≈0, thenkTxk≤kTk·kxk≈0, so Tx ≈0 and T is continuous at 0. For (3)?(4), assume that T is bounded and ?x x ∈ V?n. Then kT(x)k≤kTk·kxk∈R?n, whence T(x)∈ W?n.
 10.3. Finite-dimensional spaces and compact linear maps. We now aimtounderstandwhathappensfor?nite-dimensionalnormedspaces. First, some lemmas. Lemma 10.15. Suppose that x1,...,xn ∈ V?n, α1,...,αn ∈ F? are such that α1,...,αn ≈0. Then α1x1 +···+ αnxn ≈0. Proof. Immediate from the triangle inequality.
 Lemma 10.16. Suppose that x1,...,xn ∈ V are linearly independent and α1,...,αn ∈ F? are such that α1x1 +···+ αnxn ∈ V?n. Then αi ∈ F?n for all i = 1,...,n.
70 ISAAC GOLDBRING
Proof. Without loss of generality (by renumbering if necessary), we may assume that max{|α1|,...,|αn|} = |α1|. Suppose, towards a contradiction, that α1 / ∈F?n. Thenkx1+ α2 α1 x2+···+ αn α1 xnk= 1 |α1|kα1x1+···+αnxnk≈0 since | 1 α1| ≈ 0 and kα1x1 +···+ αnxnk ∈ R?n. Since |αi| ≤ |α1| for each i = 1,...,n, st(|αi α1|) exists. By the previous lemma, we have 0≈ x1 + α2 α1 x2 +···+ αn α1 xn ≈ x1 +st(α2 α1 )x2 +···+st(αn α1 )xn. Since the term on the right of the above display is standard, it equals 0. This contradicts the fact that x1,...,xn are linearly independent.
 Corollary 10.17. If V is ?nite-dimensional, then V?n = Vns Proof. Let{x1,...,xn}be a basis for V . By transfer, every element of V? is a F?-linear combination of x1,...,xn. If x = α1x1 +...+αnxn ∈ V?n, then each αi ∈ F?n = Fns by the previous lemma, whence x is in?nitely close to st(α1)x1 +···+st(αn)xn ∈ V .
 Corollary 10.18. If V is ?nite-dimensional, then V is a Banach space. Corollary 10.19. If T : V → W is a linear transformation and V is ?nitedimensional, then T is bounded. Proof. By Theorem 10.14, it su?ces to prove that T(V?n) ? W?n. Fix x = α1x1 +···+ αnxn ∈ V?n, so each αi ∈F?n. Thus, T(x) = α1T(x1)+···+ αnT(xn)≈st(α1)T(x1)+···+st(αn)T(xn)∈ W, so T(x)∈ Wns ? W?n.
 We now introduce a very important class of linear transformations that will play a prominent role in the rest of these notes. In some sense, they are the transformations on in?nite-dimensional spaces that behave most like transformations between ?nite-dimensional spaces. De?nition 10.20. If T : V → W is a linear transformation, we say that T is a compact transformation if T is a compact map of the associated metric spaces, that is, for every bounded B ? V , there is a compact K ? W such that T(B)? K. (Or in nonstandard terms, T(V?n)? Wns.) By Theorem 10.14, a compact linear transformation is automatically bounded. Exercise 10.21. Let B0(V,W) denote the set of compact linear transformations from V to W. Show that B0(V,W) is a subspace of B(V,W). Observe that the proof of Corollary 10.19 actually shows Corollary 10.22. If T : V → W is a linear transformation and V is ?nitedimensional, then T is compact. In fact, we can generalize the previous corollary, but ?rst we need a de?nition.
LECTURE NOTES ON NONSTANDARD ANALYSIS 71 De?nition 10.23. If T : V → W is a linear transformation, we say that T is ?nite-rank if T(V ) is a ?nite-dimensional subspace of W. Certainly, if V is ?nite-dimensional, then T : V → W is of ?nite-rank. Lemma 10.24. If T : V → W is of ?nite rank and bounded, then T is compact. Proof. We know that T(V?n) ? W?n. Set W0 := T(V ). Then W0?n = W0ns by Corollary 10.17. Thus T(V?n) ? W0?n = W0ns ? Wns, whence T is compact.
 Exercise 10.25. LetB00(V,W) denote the set of ?nite-rank bounded transformations from V to W. Show that B00(V,W) is a subspace of B0(V,W). We now consider convergence of transformation. Lemma 10.26. Suppose that B ? V is a bounded set and Tn,T : V → W are all bounded linear transformations. Further assume that kTn ?Tk→ 0 as n →∞. Then Tn → T uniformly on B. Proof. Choose M ∈ R>0 such that kxk ≤ M for all x ∈ B. We need to show that TN(x) ≈ T(x) for all x ∈ B? and all N ∈ N? \ N. Well, kTN(x)?T(x)k≤kTN?Tkkxk≤ M·kTN?Tk≈0 sincekTN?Tk≈0.
 Exercise 10.27. Supposethat W isaBanachspace. Provethatthenormed space B(V,W) is also a Banach space. Proposition 10.28. Suppose that W is a Banach space, Tn,T : V → W are bounded linear operators and each Tn is compact. Further suppose that kTn ?Tk→0 as n →∞. Then T is compact. Proof. Let x ∈ V?n; we need T(x) ∈ Wns. Let B ? V be a ball around 0 such that x ∈ B?. Since Tn converges uniformly to T on B, we know that T|B : B → W is compact. Thus, T(B) is contained in a compact subset of W, whence T(B)? ? Wns. In particular, T(x)∈ Wns.
 The previous proposition can be rephased as saying that, when W is a Banachspace, thatB0(V,W)isaclosed subspaceofB(V,W), whencealsoaBanach space. By Exercise 10.25, the closure ofB00(V,W) is a closed subspace ofB0(V,W), in symbols: B00(V,W)?B0(V,W). In the next section, we will encounter a certain class of Banach spaces where B00(V,W) =B0(V,W). 10.4. Problems. Throughout, V denotes a normed space. F denotes either R or C. Problem 10.1. Suppose that x ∈ V? is such that x ≈ 0. Show that there is N ∈N?\N such that Nx ≈0. Problem 10.2. Suppose that V is a Banach space and (xn | n ∈ N) is a sequence from V such thatP∞ n=1kxnk < ∞. Show thatP∞ n=1 xn converges in V .
72 ISAAC GOLDBRING
For the next problem, you will need to use the following: Fact 10.29. If V is a normed space, then {x ∈ V | kxk≤1} is compact if and only if V is ?nite-dimensional. Problem 10.3. Suppose that V is a Banach space and T : V → V is a compact linear operator. (1) Show that the identity operator I : V → V is compact if and only if V is ?nite-dimensional. (2) Suppose that U : V → V is any bounded linear operator. Show that T ?U and U ?T are also compact. (3) Suppose that T is invertible. Show that T?1 is compact if and only if V is ?nite-dimensional. Problem 10.4. Suppose K : [0,1]×[0,1] → R is a continuous function. Suppose that T : C([0,1],R)→ C([0,1],R) is de?ned by T(f)(s) :=Z1 0 f(t)K(s,t)dt. Show that T is a compact linear operator. (Hint: Use our earlier characterization of C([0,1],R)ns.) Such an operator is called a Fredholm Integral Operator. Problem 10.5. Suppose that k·k1 and k·k2 are both norms on a vector space W. We say that k·k1 and k·k2 are equivalent if there exist constants c,d ∈R>0 such that, for all x ∈ W, we have ckxk1 ≤kxk2 ≤ dkxk1. For x,y ∈ W? and i = 1,2, let us write x ≈i y to mean kx?yki ≈0. (1) Suppose that, for all x ∈ W?, if x ≈1 0, then x ≈2 0. Show that {kxk2 | x ∈ W,kxk1 ≤1} is bounded. (2) Suppose that {kxk2 | x ∈ W,kxk1 ≤1} is bounded. Let d := sup{kxk2 | x ∈ W,kxk1 ≤1}. Show that kxk2 ≤ dkxk1 for all x ∈ W. (3) Show that k·k1 and k·k2 are equivalent i? for all x ∈ W?, we have x ≈1 0 i? x ≈2 0. (4) Show that (W,k·k1) is a Banach space i? (W,k·k2) is a Banach space. (5) Suppose A ? W. For i = 1,2, say that A is openi if A is open with respect to the metric associated to k·ki. Show that k·k1 and k·k2 are equivalent i? for all A ? W, we have A is open1 i? A is open2. (In fancy language, this exercise says that two norms are equivalent if and only if they induce the same topology on W.) Problem 10.6. (1) Let k·k be any norm on Rn (not necessarily the usual norm on Rn). Suppose x ∈(R?)n. Show that kxk≈0 i? |xi|≈0 for i = 1,...,n.
LECTURE NOTES ON NONSTANDARD ANALYSIS 73
(2) Conclude that any two norms on a ?nite-dimensional vector space are equivalent. (3) For f ∈ C([0,1],R), de?ne kfk1 :=R1 0 |f(x)|dx. Show that k·k1 isa norm on C([0,1],R). (4) Show that (C([0,1],R),k·k1) is not a Banach space. Thusk·k1 is not equivalenttothenormk·k∞ on C([0,1],R)consideredearlier. Hence, for in?nite-dimensional vector spaces, there can exist inequivalent norms. (5) Give a direct proof that the identity function I : (C([0,1],R),k·k1)→(C([0,1],R),k·k∞) isanunboundedlinearoperator. (Thisfollowsfromearlierproblems, but it would be nice to ?nd f ∈ C([0,1],R)? such that kfk1 ∈ R?n but kfk∞ / ∈R?n.) 11. Hilbert Spaces Once again, F denotes either R or C. 11.1. Inner product spaces. De?nition 11.1. An inner product space (i.p.s.) is a vector space V over F equipped with an inner product, which is a function h·,·i : V ×V → F satisfying, for all x,y,z ∈ V and α ∈F: ? hx,xi∈R and hx,xi≥0; ? hx,xi= 0? x = 0; ? hx,yi=hy,xi (complex conjugate); ? hαx + y,zi= αhx,zi+hy,zi. Throughout, (V,h·,·i) denotes an inner product space over F. Exercise 11.2. Show that, for all x,y,z ∈ V and α ∈F: (1) hx,αy + zi= αhx,yi+hx,zi. (2) hx,0i= 0. Exercise 11.3. De?ne k·k: V →R by kxk:=phx,xi. Show that k·k is a norm on V . By the previous exercise, we can consider an i.p.s. over F as a normed space over F, and hence as a metric space as well. We will often consider V as an i.p.s., normed space, and metric space all at the same time. (In fact, it is the interplay between these three structures on V that is what is most interesting.) The following is encountered in a ?rst course in linear algebra: Theorem 11.4 (Cauchy-Schwarz Inequality). For all x,y ∈ V , we have |hx,yi|≤kxk·kyk.
74 ISAAC GOLDBRING Corollary 11.5. Equip V ×V with the metric d given by d((x1,x2),(y1,y2)) := max{kx1 ?y1k,kx2 ?y2k}. Then the inner product h·,·i: V ×V →F is continuous. Proof. Fix x,y,u,v ∈ V . Then khx,yi?hu,vik=khx,yi?hx,vi+hx,vi?hu,vik ≤khx,y?vik+khx?u,vik ≤kxk·ky?vk+kx?uk·kvk. Now suppose that (x,y) ∈ V ×V and (u,v) ∈ μ((x,y)). Then x ≈ u and y ≈ v. Since kxk,kvk ∈ R?n, it follows from the transfer of the above inequality that hx,yi≈hu,vi.
 Example 11.6. The main example of an i.p.s. encountered in a ?rst course on linear algebra is Fn, equipped with the standard inner product h~x,~yi := Pn i=1 xiyi. Observe that this induces the norm on Fn introduced in the previous section. Example 11.7. The in?nite-dimensional analogue of the previous example is `2 as de?ned in the previous section. The inner product on `2 is given by h(xn),(yn)i:=P∞ n=1 xnyn. To see that this sum converges, use CauchySchwarz for Fm (applied to (|x1|,...,|xm|) and (|y1|,...,|ym|)) to see that m X n=1 |xnyn|≤v u u t m X n=1 |xn|2 · m X n=1 |yn|2 ≤v u u t ∞ X n=1 |xn|2 · ∞ X n=1 |yn|2. Now let m →∞. It is now easy to verify that the axioms for an i.p.s. hold. We should remark that of all the `p spaces, `2 is the only one that carries the structure of an i.p.s. and the above inner product on `2 induces the norm on `2 introduced in the previous section. Example 11.8. Let V = C([0,1],F). Then V becomes an i.p.s. when equipped with the inner product given by hf,gi :=R1 0 f(x)g(x)dx. How does the norm on V induced by the inner product compare with the norm placed on V in the previous section? De?nition 11.9. V is called a Hilbert space if the metric associated to V is complete. In other words, an i.p.s. is a Hilbert space if the associated normed space is a Banach space. Exercise 11.10. (1) Prove that the inner product spaces in Exercises 11.6 and 11.7 are Hilbert spaces. (Your proof for `2 should probably be standard as we have yet to characterize `2 ns.) (2) Prove that the inner product space in Exercise 11.8 is not a Hilbert space.
LECTURE NOTES ON NONSTANDARD ANALYSIS 75
11.2. Orthonormal bases and `2. De?nition 11.11. (1) If x,y ∈ V , we say that x and y are perpendicular or orthogonal if hx,yi = 0. We sometimes write x ⊥ y to indicate that x and y are orthogonal. (2) A set {ei | i ∈ I} from V is called orthonormal if ? keik= 1 for each i ∈ I, and ? ei,ej are orthogonal for all i 6= j. Lemma 11.12. If {ei | i ∈ I} is orthonormal, then it is also linearly independent. Proof. SupposePm n=1 cnein = 0. Then ck = m X n=1 cnhein,eiki=h m X n=1 cnein,eiki=h0,eiki= 0.
 De?nition 11.13. An orthonormal basis for V is a maximal orthonormal sequence of vectors for V . By Zorn’s lemma, every inner product space has an orthonormal basis. One must be careful with the word basis here: while in ?nite-dimensional inner product spaces, an orthonormal basis is a basis (in the usual linear algebrasense), forin?nite-dimensionalinnerproductspaces, anorthonormal basis is never a basis. (In this setting, the usual notion of “basis” is called “Hamel basis” to help make the distinction.) Fact 11.14. Let (en | n ∈N) be an orthonormal set of vectors for the Hilbert space H. Then the following are equivalent: (1) (en) is an orthonormal basis for V ; (2) If v ∈ V is such that v ⊥ en for each n, then v = 0; (3) For all v ∈ V , there is a sequence (αn) from F such thatPm n=0 αnen converges to v as m →∞. You will prove the previous fact in the exercises. In (3) of the previous fact, we write v =P∞ n=0 αnen. Example 11.15. For n ∈N, let bn ∈ `2 be de?ned by bn := (0,0,...,0,1,0,...,0), where the 1 is in the nth spot. Then certainly (bn) is an orthonormal sequence. Fix a = (a1,a2,...)∈ `2. Then ka? m X n=1 anbnk2 = ∞ Xn =m+1 kank2 →0
76 ISAAC GOLDBRING as m → ∞ since a ∈ `2. It follows that (bn) is an orthonormal basis for `2, often referred to as the standard orthonormal basis for `2. Observe that (bn) is not a Hamel basis as the vector ( 1 n2) is not in the span of (bn). Fact 11.16. Every orthonormal basis for `2 is countable. More generally, for any inner product space V , every two orthonormal bases for V have the same cardinality. We will often refer to an inner product space as being separable when its orthonormal bases are countable. (It is a fact that all separable Hilbert spaces are isomorphic to `2, but we will not need this fact.) Until further notice, let us ?x a separable Hilbert space H (which you may think of as `2). We also ?x an orthonormal basis (en | n ∈N) for H. Lemma 11.17. For a =P∞ n=0 αnen and b =P∞ n=0 βnen, we have ha,bi =P ∞ n=0 αnβn. Proof. Fix m ∈N. Then it is straightforward to verify that h m X n=0 αnen, m X n=0 βneni= m X n=0 αnβn. It remains to let m →∞ and use the fact that the inner product is continuous.
 Corollary 11.18. For a =P∞ n=0 αnen, we have kak2 =P∞ n=0|αn|2. Corollary 11.19. For a ∈ H, there is a unique sequence (αn) from F such that a =P∞ n=0 αnen. Proof. Suppose that P∞ n=0 αnen = a = P∞ n=0 α0nen. Then P∞ n=0(αn ? α0n)en = 0, whenceP∞ n=0|αn ?α0n|2 =k0k2 = 0.
 Let’s bring the nonstandard description into the picture: We get a nonstandard extension of the orthonormal basis (en | n ∈ N?); this set is still orthonormal by transfer. Also, for every a ∈ H?, there is a unique sequence (αn | n ∈ N?) from F? such that a =Pn∈N? αnen in the sense that, for every  ∈(R>0)?, there is m0 ∈N? such that, for all m ∈N? with m ≥ m0, we have ka ?Pm n=0 αnenk < . But what do we mean byPm n=1 αnen if m > N? Well, we have the set FinSeq(V ) of ?nite sequences from V , which is a subset ofP(N×V ), and the corresponding function Σ : FinSeq(V )→ V given by adding the elements of the ?nite sequence. Consequently, we get a function Σ : FinSeq(V )? → V?, given by “adding” the elements of the hyper?nite sequence. In a similar vein, we have kak2 =Pn∈N?|αn|2, with the interpretation of the sum as in the previous paragraph. We have thus proven: Proposition 11.20. For a =Pn∈N? αnen ∈ H?, we have a ∈ H?n if and only ifPn∈N?|αn|2 ∈R?n. Characterizing the nearstandard points is a bit more subtle:
LECTURE NOTES ON NONSTANDARD ANALYSIS 77 Theorem 11.21. Suppose that a =Pn∈N? αnen is in H?n. Then a ∈ Hns if and only if, for every k > N, we havePn>k|αn|2 ≈ 0. In this case, st(a) =Pn∈Nst(αn)en. Proof. First suppose that a ∈ H, so a = Pn∈N αnen. For k ∈ N, set rk =P∞ n=k+1|αn|2. Thus, rk → 0 as k → ∞ and hence rk ≈ 0 if k > N; this proves the result for a ∈ H. Now suppose that a ∈ Hns, say a ≈ b ∈ H. Write b =P∞ n=1 βnen. Fix k > N. Then, by the transfer of the triangle inequality for `2, we have sX n>k |αn|2 ≤sX n>k |αn ?βn|2 +sX n>k |βn|2 = (?)+(??). Since a ≈ b, we have that ka?bk2 =Pn∈N?|αn?βn|2 ≈0, whence (?)≈0. It remains to prove that (??)≈0. However, since b ∈ H, by the ?rst part of the proof, we know that (??)≈0. NowsupposethatPn>k|αn|2 ≈0forevery k > N; we mustshowthat a ∈H ns. Since a ∈ H?n, we know thatPn∈N?|αn|2 ∈ R?n; sayPn∈N?|αn|2 ≤M ∈ R>0. In particular, αn ∈ F?n for each n ∈ N?. For n ∈ N, setβ n := st(αn). We claim that b :=Pn∈N βnen de?nes an element of H. Form ∈ N, de?ne sm :=Pm n=0|βn|2. Then sm ≈Pm n=0|αn|2 ≤ M. Hence,( sm) is a bounded, nondecreasing sequence in R, whence convergent. For m,k ∈N with m ≤ k, we have k m X n=0 βnen ? k X n=0 βnenk2 ≤ k Xn =m+1 |βn|2. Since (sm) is Cauchy, it follows that the partial sums ofP∞ n=0 βnen are Cauchy, whence, by completeness,P∞ n=0 βnen de?nes an element of H. It remains to verify that a ≈ b. To see this, observe that, for any k ∈N?, we have ka?bk2 = X n∈N? |αn ?βn|2 =X n≤k |αn ?βn|2 +X n>k |αn ?βn|2. If k ∈N, thenPn≤k|αn?βn|2 ≈0; thus, by the In?nitesimal Prolongation Theorem, there is k > N such thatPn≤k|αn?βn|2 ≈0. On the other hand, X n>k |αn ?βn|2 ≤X n>k |αn|2 +X n>k |βn|2. By assumption, Pn>k|αn|2 ≈ 0, whilstPn>k|βn|2 ≈ 0 by the forward direction of the theorem and the fact that b is standard. Consequently, ka?bk2 ≈0.
 Fora =P∞ n=0 αnen ∈ H and m ∈N, setP(m,a) := Pm(a) =Pm n=0 αnen ∈H . We thus have maps P : N×H → H and, for n ∈N, Pn : H → H. Exercise 11.22. For n ∈ N, Pn is a bounded linear transformation with kPnk= 1.
78 ISAAC GOLDBRING Extending to the nonstandard universe, we get a map P : N?×H? → H?.For N ∈ N?, we de?ne PN : H? → H? by PN(a) = P(N,a). For a =P n∈N? αnen ∈ H?, we may view PN(a) as the hyper?nite sumPN n=0 αnen ∈H ?. Theorem 11.23. Suppose N > N and a ∈ Hns. Then PN(a)≈ a. Proof. Write a =Pn∈N? αnen. Then, by Theorem 11.21, we have ka? N X n=0 αnenk2 =kX n>N αnenk2 =X n>N |αn|2 ≈0.
 Recall that we have a norm k·k on B(H). Going to the nonstandard universe, we get an internal norm k·k : B(H)? → R?. By transfer, for T ∈B(H)?, wehavekTkistheinternalsuprememumoftheset{kT(x)k|x ∈ H?, kxk = 1}. By the transfer of Exercise 11.22, for N > N, we have PN ∈B(H)? and kPNk= 1. Corollary 11.24. Suppose that T : H → H is a compact operator and N > N. Then kT ?PNTk≈0. Proof. Suppose a ∈ H? and kak = 1. Then a ∈ H?n, whence T(a) ∈ Hns by the compactness of T. Thus, by Theorem 11.23, T(a) ≈ PNT(a). Since the internal supremum of an internal set of in?nitesimals is once again in?nitesimal, this shows that kT ?PNTk≈0.
 ThefollowinglemmawillbecrucialintheproofoftheBernstein-Robinson Theorem in Section 14. Lemma 11.25. Suppose that T ∈ B(H) is compact, {e1,e2,...} is an orthonormal basis for H, and [ajk] is the “matrix” for T with respect to this basis, that is, for all k ≥1, we have T(ek) =Pj∈N ajkej. Then ajk ≈0 for all j ∈ N?\N and k ∈ (N?)>0. (So the “in?nite” rows of the matrix for T consist entirely of in?nitesimals.) Proof. Fix k ∈ (N?)>0. Since T is compact and ek is ?nite, T(ek) ∈ Hns, say T(ek)≈ y. Write y =Pi∈N? yiei. Set η :=kT(ek)?yk2 =kX i∈N? (aik ?yi)eik2 =X i∈N? |aik ?yi|2. Since T(ek)≈ y, we have η ≈0. Now suppose j ∈N?\N. Then|ajk?yj|2 ≤ η, whence |ajk?yj|≈0. Since y ∈ H, yj ≈0. Since |ajk|≤|ajk?yj|+|yj|, we get that ajk ≈0.
LECTURE NOTES ON NONSTANDARD ANALYSIS 79
11.3. Orthogonal projections. Inthissubsection, weassumethat H isan arbitrary Hilbert space. For u,v ∈ H, we have the Parallelogram Identity: ku + vk2 +ku?vk2 = 2(kuk2 +kvk2). If, in addition, u and v are orthogonal, we have the Pythagorean Theorem: ku+vk2 =kuk2 +kvk2. By induction, we see that whenever u1,...,un are mutually orthogonal, then ku1 +···+ unk2 =ku1k2 +···+kunk2. Lemma 11.26. If{t1,...,tk}is an orthonormal set in H, then sp(t1,...,tk) is a closed subspace of H. Later we will be able to remove the “orthonormal” assumption. Proof. Set E := sp(t1,...,tk). Suppose x ∈ E? and y ∈ H are such that x ≈ y; we need y ∈ E. By transfer, there are α1,...,αk ∈ F? such that x = α1t1+···+αktk. By the (transfer of the) Pythagorean theorem, we see thatkxk2 =kα1t1k2+···+kαktkk2 =|α1|2+···+|αk|2. Since x ∈ Hns, wesee thatkxk∈R?n, whence each αi ∈F?n. Set z := st(α1)t1+···+st(αk)tk ∈ E. By the Pythagorean theorem again, we see that kx?zk2 =|α1 ?st(α1)|2 +···+|αk ?st(αk)|2 ≈0. By uniqueness of standard part, we see that y = z ∈ E.
 The next result is crucial in the study of Hilbert spaces. Theorem 11.27 (Existence of Orthogonal Projection). Suppose that E is a closed subspace of H. Then for each x ∈ H, there is a unique y ∈ E such that kx?yk≤kx?zk for all z ∈ E. Proof. The result is obvious if x ∈ E (take y = x). Thus, we may assume that x / ∈ E. Set α := inf{kx ? zk | z ∈ E}; note that α > 0 since E isclosed and x / ∈ E. Fix  ∈ μ>0. By transfer, there is z ∈ E? such thatα ≤kx?zk < α + ; in particular, kx?zk≈ α. Claim: z ∈ Ens. Proof of Claim: Suppose, towards a contradiction, z / ∈ Ens. Since H iscomplete and E is closed in H, we have that E is complete. Consequently, since z / ∈ Ens, we have that z / ∈ Epns, whence there is r ∈ R>0 such that kz ?wk≥ r for all w ∈ E. Since α <qα2 + r2 4 , we have w ∈ E such that kx?wk <qα2 + r2 4 . By the Parallelogram Identity, we have: k(x?w)+(x?z)k2 +kw?zk2 = 2(kx?wk2 +kx?zk2). Now k(x?w)+(x?z)k = 2kx? 1 2(w + z)k≥ 2α by transfer and the fact that 1 2(w+z)∈ E?. Since kx?zk≈ α, we have that 2kx?zk2 < 2α2 + r2 2 .
80 ISAAC GOLDBRING
Thus:
kw?zk2 = 2(kx?wk2 +kx?zk2)?k(x?w)+(x?z)k2 < 2(α2 + r2 4 )+2kx?zk2 ?4α2 < 2(α2 + r2 4 )+2α2 + r2 2 ?4α2 < r2. This contradicts the fact that kz?wk≥ r. Set y := st(z) ∈ E. Since x?z ≈ x?y, we see that kx?yk = α, whence kx?yk≤kx?zk for all z ∈ E. To prove uniqueness: suppose that y0 ∈ E also satis?es the conclusion of the theorem. In particular, kx?yk=kx?y0k= α. Then ky?y0k2 = 2kx?yk2 +2kx?y0k2 ?4kx? 1 2 (y + y0)k2 ≤4α2 ?4α2 = 0, whence y = y0.
 De?nition 11.28. If E is a closed subspace of H and x ∈ E, we let PE(x) denote the unique element of y ful?lling the conclusion of the previous theorem; we refer to PE(x) as the orthogonal projection of x onto E. De?nition 11.29. For E a closed subspace of H, we set E⊥ :={x ∈ H | x ⊥ z for all z ∈ E}. Until further notice, E denotes a closed subspace of H. Lemma 11.30. E⊥ is a closed subspace of H. Proof. We leave it to the reader to check that E⊥ is a subspace of H. To check that E⊥ is closed, suppose that x ∈ (E⊥)? and y ∈ H are such that x ≈ y; we need to show that y ∈ E⊥. Fix z ∈ E; we need hy,zi = 0. Well, by continuity of the inner product, hy,zi ≈ hx,zi = 0 by transfer. Since hy,zi∈R, it follows that hy,zi= 0.
 Much of what follows is easy and standard but will be needed in the next sections. We will thus omit many proofs. Lemma 11.31. For any x ∈ H, x?PE(x)∈ E⊥. Lemma 11.32. For x,y ∈ H, we have y = PE(x) if and only if y ∈ E and x?y ∈ E⊥. Thus, if x ∈ E⊥, then PE(x) = 0. Theorem 11.33 (Gram-Schmidt Process). Let (un | n ∈ I) be a sequence of linearly independent vectors in H, where I ={1,...,m} for some m ∈N or I = N. Then there is an orthonormal sequence (wn | n ∈ I) such that, for each k ∈ I, sp(u1,...,uk) = sp(t1,...,tk).
LECTURE NOTES ON NONSTANDARD ANALYSIS 81
Proof. Set w1 := u1 ku1k
. Inductively, suppose that w1,...,wk have been constructed. Set vk+1 := uk+1?PE(uk+1), where E := sp(w1,...,wk), a closed subspace of H by Lemma 11.26. Set wk+1 := vk+1 kvk+1k . Then wk+1 ∈ E⊥, whence {w1,...,wk+1} is orthonormal.
 Corollary 11.34. Any ?nite-dimensional subspace of H is closed. Proof. By the Gram-Schmidt process, any ?nite-dimensional subspace of H has an orthonormal basis that is also a Hamel basis; thus, the subspace is closed by Lemma 11.26.
 Exercise 11.35. Supposethat u1,...,uk areorthonormaland E = sp(u1,...,uk). Then, for all x ∈ H, we have PE(x) =Pk i=1hx,uiiui. Let us momentarily return to the discussion of the previous subsection. Suppose that H is separable and that (en | n ≥ 1) is an orthonormal basis for H. Set Pm : H → H as before, namely Pm(a) =Pm n=1 αnen, where a =P∞ n=1 αnen. Set Em := sp(e1,...,em), a closed subspace of H. Then, for a =P∞ n=1 αnen, we have: PEm(a) = m X n=1 ha,enien = m X n=1 hlim k→∞ ( k X j=1 αjej),enien = m X n=1 lim k→∞h k X j=1 αjej,enien = lim k→∞ m X n=1 k X j=1 αjhej,enien = m X j=1 αjej = Pm(a). Lemma 11.36. PE is a bounded linear operator. If E 6={0}, then kPEk= 1. Lemma 11.37. Suppose that F is also a closed subspace of H and E ⊥ F, that is, x ⊥ y for all x ∈ E and y ∈ F. Set G := E + F :={x + y | x ∈ E,y ∈ F}. Then G is a closed subspace of H and for all z ∈ G, there are unique x ∈ E and y ∈ F such that z = x + y. In the situation of the previous lemma, we write G = E ⊕F, the direct sum of E and F. Lemma 11.38. H = E ⊕E⊥.
82 ISAAC GOLDBRING
Lemma 11.39. (E⊥)⊥ = E. Lemma 11.40. Suppose that G = E ⊕F. Then PG = PE + PF. Consequently, I = PE + PE⊥. Now suppose that E1,E2,E3 are closed subspaces such that E1 ⊥ E2,E 2 ⊥ E3 and E1 ⊥ E3. Then E1 ⊥ (E2 ⊕ E3), (E1 ⊕ E2) ⊥ E3, andE 1 ⊕ (E2 ⊕ E3) = (E1 ⊕ E2) ⊕ E3. We may thus unambiguously writeE 1⊕E2⊕E3. Ditto for any ?nite number of mutually perpendicular closed subspaces E1,...,En of H; we often write the direct sum in the compact notationLn i=1 Ei. Corollary 11.41. If G =Ln i=1 Ei, then PG = PE1 +···+ PEn. Now suppose that we have countably many mutually perpendicular subspaces (En | n ≥ 1). How should we de?ne their direct sum? First, two lemmas, the second of which we give a short nonstandard proof. Lemma 11.42. Suppose that (Gn | n ≥1) is a sequence of subspaces of H with Gn ? Gn+1 for all n ≥1. Then G =Sn≥1 Gn is a subspace of H. Lemma 11.43. Suppose that G is a subspace of H. Then G is also a subspace of H. Proof. Suppose that x,y ∈ G; we show that x + y ∈ G. (The proof for closure under scalar multiplication is similar.) Since x ∈ G, there is x0 ∈ G? such that x ≈ x0. Similarly, there is y0 ∈ G? such that y ≈ y0. Thus, x + y ≈ x0 + y0 ∈ G? (by transfer), whence x + y ∈ G.
 Returning to the situation preceding the lemmas, suppose that (En | n ≥ 1) are mutually perpendicular closed subspaces of H. Set Gn :=Ln i=1 Ei, a closed subspace of H. We then de?neL∞ n=1 Ei :=Sn≥1 Gn, a closedsubspace of H by the previous two lemmas. Lemma 11.44. Suppose that (Gn | n ≥1) is a sequence of subspaces of H with Gn ? Gn+1 for all n ≥ 1 and G =Sn≥1 Gn. Then, for all x ∈ H, we have PGn(x)→ PG(x) as n →∞. Corollary 11.45. Suppose that E =L∞ i=1 Ei. Then, for all x ∈ H, wehave Pn i=1 PEi(x)→ PE(x) as n →∞. 11.4. Hyper?nite-dimensional subspaces. Once again, H denotes an arbitrary Hilbert space. LetE denote the set of ?nite-dimensional subspaces of H, whence E ? P(H). We will refer to elements of E? as hyper?nitedimensional subspaces of H?. We have a map P : E × H → H given by P(E,x) := PE(x). We thus get a nonstandard extension P :E?×H? → H?, whence it makes sense to speak of the orthogonal projection map PE : H? → H? for E ∈E?. Similary, we have a map dim :E →N, whence we get a map dim :E? →N?. If H is separable and (en | n ≥ 1) is an orthonormal basis for H, then by transfer, for N ∈ N?, we have HN := sp(e1,...,eN) ∈ E?, the internal
LECTURE NOTES ON NONSTANDARD ANALYSIS 83
subspace of H? spanned by e1,...,eN. Theelementsof HN areinternallinear combinations (with coe?cients inF?) of e1,...,eN. By transfer, dim(HN) = N. The following theorem is crucial in applications of nonstandard methods to the study of in?nite-dimensional linear algebra: Theorem 11.46. If H is an in?nite-dimensional Hilbert space, then there is E ∈E? such that H ? E. Proof. Exercise.
 Recall from Problem 9.5 the notion of the standard part of an internal set. Exercise 11.47. Suppose that E ∈E? and x ∈ H. Then x ∈ st(E) if and only if PEx ≈ x. Lemma 11.48. If E ∈E?, then st(E) is a closed linear subspace of H. Proof. st(E) is closed by Problem 9.5. It is straightforward to verify that st(E) is a subspace of H.
 11.5. Problems. Problem 11.1. Suppose (λn | n ≥ 1) is a sequence from C. Consider the function D : CN →CN given by D((xn)) := (λnxn). (1) Show that D ∈ B(`2) if and only if the sequence (λn) is bounded. (We are sort of abusing notation and letting D denote its restriction to `2.) (2) Show that D ∈ B?(`2) if and only if limn→∞λn = 0. Problem 11.2. Consider the function T : `2 → `2 given by T(x1,x2,x3,...) = (x2,x3,...). Show that T ∈ B(`2) and T / ∈ B?(`2). What is kT||? (T is called the leftshift operator .) Problem 11.3. Suppose that T is a compact operator on the separable Hilbert space H. Let  ∈ R>0. Show that there is a bounded ?nite-rank linear operator T0 on `2 such that kT ?T0k < . In fancier language, we are showing that the set of ?nite-rank linear operators on `2, B??(`2), is dense in the set of compact linear operators on `2, B?(`2). (Hint: The desired T0 will be of the form PkT for some k ∈N. Consider k > N and use under?ow.) Problem 11.4. Suppose that H is a separable Hilbert space and x ∈ Hns. Suppose that (en) is an orthonormal basis for `2 and x = Pn∈N? xnen. Further suppose that xn ≈0 for all n ∈N. Show that x ≈0. Problem 11.5. Suppose P : H → H is an idempotent bounded operator on a Hilbert space H. Show that P is compact if and only if P is a ?nite-rank operator.
84 ISAAC GOLDBRING
Problem 11.6. Suppose that E is any linear subspace of any unitary space U. Show that E⊥ is a linear subspace of U. We will need the following notation for the next problem. If w = a+bi ∈C , then Re(w) := a and Im(w) := b. Problem 11.7. Suppose that E is a closed linear subspace of the Hilbert space H. Suppose x / ∈ E. We aim to show that x ? PE(x) ∈ E⊥. Setα :=kx?PE(x)k > 0. Fix z ∈ E \{0}. (1) Fix λ ∈ R\{0}. Show that λ2kzk2 ?2λRe(hx ? PE(x),zi) > 0. (Hint: Start with α2 < kx?(PE(x)+ λz)k2.) (2) Considering λ := Re(hx?PE(x),zi) kzk2 , conclude that Re(hx?PE(x),zi) = 0. (3) Show that hx?PE(x),zi= 0, and thus x?PE(x)∈ E⊥. Problem 11.8. Suppose (e1,...,ek) is an orthonormal sequence of vectors in the Hilbert space H. Suppose E = span(e1,...,ek). Show that, for all v ∈ H, we have PE(x) = k X i=1 hv,eiiei. Problem 11.9. Suppose that (en) is an orthonormal sequence from the Hilbert space H. Fix v ∈ H. Prove Bessel’s inequality: ∞ X n=1 |hv,eni|2 ≤kvk2. (Hint: Use the last problem and the fact that a projection Pn has norm 1.) Problem 11.10. Suppose that (en) is an orthonormal sequence from the Hilbert space H. Show that the following are equivalent: (1) (en) is an orthonormal basis for `2; (2) For every v ∈ `2, if hv,eni= 0 for all n ≥1, then v = 0. (3) For every v ∈ `2, there is a sequence (αn) such that v = ∞ X n=1 αnen. Problem 11.11. Suppose that H is a ?nite-dimensional Hilbert space. Show that an orthonormal basis for H is also a Hamel basis. Problem 11.12. Show that the orthonormal basis (bn) for `2 de?ned in lecture is not a Hamel basis. It can be shown that any orthonormal basis for an in?nite dimensional Hilbert space is not a Hamel basis. We outline the proof of this here for `2. We ?rst need a de?nition. If X is a metric space and A ? X, we say that
LECTURE NOTES ON NONSTANDARD ANALYSIS 85 A is nowhere dense if (A)? = ?; in English, if the interior of the closure of A is empty. Problem 11.13. Suppose that H is a Hilbert space and (en | n ≥ 1) is a linearly independent set of vectors. For n ≥1, set En := span(e1,...,en). Show that each En is a nowhere dense subset of V . (Hint: We already know that each En is closed. (Why?) It remains to show that each En has empty interior. Use the nonstandard characterization of the interior to do this.) The Baire Category Theorem states that in a complete metric space, the union of a countable number of nowhere dense sets is nowhere dense. Problem 11.14. Use the Baire category theorem and the previous problem to show that a Hamel basis of an in?nite dimensional Hilbert space must be uncountable. Conclude that no orthonormal basis for `2 can be a Hamel basis. In working with Hilbert spaces, orthonormal bases are more useful than Hamel bases. One can show that any two orthonormal bases for a Hilbert space have the same cardinality, called the dimension of the Hilbert space. One can then show that two Hilbert spaces are isomorphic (that is, there is a bijective linear transformation between them preserving the inner product) if and only if they have the same dimension. This is not true if we use dimension to mean the cardinality of a Hamel basis (which is well-de?ned). Indeed, for s ∈ R, let us : R → C be de?ned by us(t) := eist. Let V be the vector space consisting of all ?nite linear combinations of the us. For f,g ∈ H, one can show that hf,gi:= lim N→∞ 1 2NZN ?N f(t)g(t)dt exists and de?nes an inner product on V . Let H denote the completion of V . Then H is naturally a Hilbert space. One can show that `2 and H both have Hamel dimension 2?0. However, (us | s ∈R) is an orthornormal basis for H, so H has dimension 2?0 and cannot be isomorphic to `2 as a Hilbert space.
12. Weekend Problem Set #2 Problem 12.1. Assume the nonstandard extension is ?1-saturated. Let A be an internal set and B a (not necessarily internal) subset of A. We say that B is Σ0 1 if there is a sequence (Ck | k ∈N) of internal subsets of A suchthat B =Sk Ck. We say that B is Π0 1 if there exists a sequence (Ck | k ∈N)of internal subsets of A such that B =Tk Ck.(1) Show that R?n is a Σ0 1 subset of R? and μ is a Π0 1 subset of R?. (This is why Σ0 1 sets are sometimes called galaxies and Π0 1 sets are sometimes called monads.)
86 ISAAC GOLDBRING (2) Suppose (Ck | k ∈N) is a sequence of internal subsets of an internal set A. Let B =Sk Ck. Suppose that B is internal. Show that there is n ∈ N such that B = C1 ∪···∪Cn. (Hint: Reduce to the case that Cn ? Cn+1 for all n ∈ N. Use the Countable Comprehension Principle and Under?ow.) (3) Suppose (Ck | k ∈N) is a sequence of internal subsets of an internal set A. Let B =Tk Ck. Suppose that B is internal. Show that there is n ∈N such that B = C1 ∩···∩Cn. (4) Suppose that B1 is a Σ0 1 subset of the internal set A and B2 is a Π0 1 subset of A. Suppose that B1 ? B2. Show that there is an internal subset E of A such that B1 ? E ? B2. Conclude that any subset of A which is both Σ0 1 and Π0 1 must be internal. (This is a handy way of showing that certain sets are internal.) We should remark that (2) from the previous exercise is the key observation behind the Loeb measure concept, which will be discussed later in these notes. This concept is one of the central ideas in applications of nonstandard analysis to probability theory, stochastic analysis, and mathematical ?nance (to name a few).
There is an ultrapower construction for our more general nonstandard framework. If U is a nonprincipal ultra?lter on N, then one can set X? := XU, where XU is de?ned just as RU. This construction has the usual advantage of being “concrete.” In particular, we can identify the internal sets in a concrete fashion as follows. Suppose that we have a family (Xn | n ∈N) of sets. Then we can de?netheir ultraproductQU Xn to beQn Xn/ ～U. (Thus, the ultrapower is the special case of the ultraproduct where all Xn’s are equal.) Problem 12.2. Prove that A ? XU is internal if and only if there are subsets An ? X for n ∈N such that A =QU An. (So the internal subsets of XU are the ones that are almost everywhere given coordinatewise by subsets of X.) Problem 12.3. Show that A ? XU is hyper?nite if and only if there are ?nite subsets An ? X such that A =QU An. Use this fact to explain how to de?ne the internal cardinality |A| of a hyper?nite subset A of XU. Problem 12.4. Prove that a nonstandard extension constructed using a nonprincipal ultra?lter U on N is automatically ?1-saturated. (Hint: this is essentially a diagonal argument.) Problem 12.5. (Assume as much saturation as you like) Suppose that G is a group. Then G is said to be nilpotent if there exists a ?nite sequence of subgroups G1,...,Gn of G such that {1}≤ G1 ≤ G2 ≤ ... ≤ Gn = G
LECTURE NOTES ON NONSTANDARD ANALYSIS 87 and such that for all i ∈ {1,...,n}, all g ∈ G, and all h ∈ Gi, we have ghg?1h?1 ∈ Gi?1. If n is the smallest length of such a sequence of subgroups for G, we call n the nilpotency class of G. (1) G is nilpotent of nilpotency class 1 if and only if G is nontrivial (i.e. G 6={1}) and abelian (i.e. xy = yx for all x,y ∈ G.) (2) Show that G? is a group, as is any subset of G? closed under the extension of the group operations. (3) Suppose A ? G. The subgroup of G generated by A, denoted hAi, is hAi:=\{H | H ≤ G and A ? H}.A subgroup H of G is called ?nitely generated if H = hAi for some?nite A ? G. Discuss how the nonstandard extension of the set of ?nitely generated subgroups of G is the set of hyper?nitely generated subgroups of G?. (4) Show that there is a hyper?nitely generated subgroup H of G? such that G ≤ H. (5) Supposethat G islocally nilpotent, thatis, supposethatevery?nitely generated subgroup of G is nilpotent. Further suppose that the nilpotency class of any ?nitely generated subgroup of G is less than or equal to n. Show that G is nilpotent of nilpotency class less than or equal to n. (You will have to use the fact that a subgroup of a nilpotent group of nilpotency class ≤ n is itself a nilpotent group of nilpotency class ≤ n. Try proving this fact!) (6) Why doesn’t your proof in (5) work if G is locally nilpotent with unbounded nilpotency class? (There are some di?cult open problems about locally nilpotent groups of unbounded nilpotency class that some group theorists hope might be solved by nonstandard methods.) Problem 12.6. (Assume ?1-saturation) Suppose that X is a normed space over F and E ? X? is an internal subspace, that is, E is internal, 0∈ E, E is closed under addition, and E is closed under multiplication by elements of F?. For example, E := X? is an internal subspace of X?. De?ne E?n :={x ∈ E |kxk∈F?n} and μE :={x ∈ E |kxk∈ μ(0)}. (1) Show that E?n is a vector space over F and that μE is a subspace of E?n. We set ? E := E?n/μE and call it the nonstandard hull of E. For x ∈ E?n, we often write ? x instead of x + μE. (2) For ? x ∈ ? E, de?ne k? xk := st(kxk). Show that this de?nition is independent of the coset representative and that k·k : ? E → R is anorm on ? E. (3) Show that ? E is a Banach space. (Notice as a consequence that even if X was incomplete, c X? is automatically complete.)
88 ISAAC GOLDBRING (4) Show that there is a map ι : ? E →c X? given by ι(x+μE) = x+μX?. Show that ι is a norm-preserving linear map whose image is closed in ? X?. (This exercise allows us to treat ? E as a Banach subspace of c X?.) The nonstandard hull construction is extremely useful in applications of nonstandard methods to functional analysis. Of particular interest is when E is a hyper?nite-dimensional subspace of X? containing X, for then one can often apply facts about ?nite-dimensional normed spaces to ? E and then have these facts “trickle down” to X.
13. The Spectral Theorem for compact hermitian operators In this section, H denotes an arbitrary Hilbert space over C. De?nition 13.1. If T : H → H is linear, then λ ∈C is called an eigenvalue for T if there is a nonzero x ∈ H such that Tx = λx; such an x will be called an eigenvector for T corresponding to λ. If λ isaneigenvaluefor T, then{x ∈ H |Tx = λx}iscalledtheeigenspaceof T corresponding to λ; as the name indicates, it is a subspace of H. It is also easy to verify that eigenspaces are closed in H. De?nition 13.2. T : H → H is Hermitian if hTx,yi = hx,Tyi for all x,y ∈ H. Exercise 13.3. Suppose that E is a closed subspace of H. Prove that PE is a Hermitian operator. The following theorem is standard fare for a ?rst undergraduate course in linear algebra: Theorem 13.4 (Spectral Theorem for Hermitian Operators on Finite-Dimensional Hilbert Spaces). Suppose T : H → H is a Hermitian operator and H is ?nite-dimensional. Then there is an orthonormal basis for H consisting of eigenvectors of T. Moreover, if λ1,...,λk ∈ C are the distinct eigenvalues of T with corresponding eigenspaces W1,...,Wk, then Wi ⊥ Wj for all i 6= j, H = W1⊕···⊕Wk, and T = λ1PW1+···+λkPWk, the so-called spectral resolution of T. Proof. (Sketch) Set n := dim(H). Step 1: Show that T has an eigenvalue λ1 with corresponding eigenvector x1; we may further assume kx1k = 1. (This part does not use the fact that T is Hermitian, but only that we are working over C so the characteristic polynomial of T splits.) Step 2: Let W := sp(x1). If H = W, we are done. Otherwise, W⊥ is a Hilbert space of dimension n?1. Furthermore, since T is Hermitian, one can easily verify that T(W⊥) ? W⊥, whence we can consider the Hermitian operator T|W⊥ : W⊥ → W⊥. By induction, W⊥ has
LECTURE NOTES ON NONSTANDARD ANALYSIS 89
an orthonormal basis x2,...,xn consiting of eigenvectors of T. Since W ⊥ W⊥, {x1,...,xn} is an orthonormal basis for H consisting of eigenvectors of T. Step 3: Show that each λi is a real number. We leave this as an exercise for the reader. Step 4: Show that Wi ⊥ Wj for i 6= j. Step 5: Since we have a basis of eigenvectors, H = W1 ⊕···⊕Wk. Step 6: Just compute T = TI = T(PW1 +···+PWk) = TPW1 +···+TPWk = λ1PW1 +···+λkPWk.
 What about Hermitian operators on in?nite-dimensional Hilbert spaces? We immediately run into problems: Exercise 13.5. Let H = C([0,1],C) with the inner product hf,gi:=Z1 0 f(t)g(t)dt. De?ne T : H → H by T(f) = t·f. Show that T is a bounded operator on H that is not compact and does not have any eigenvalues. In order to obtain eigenvalues, we will need to study compact Hermitian operators. Forsuchoperators, thereisasuitableversionoftheSpectralTheorem that is a rather straightforward generalization of the ?nite-dimensional case. In fact, we will use the method of hyper?nite approximation and the transferofthe?nite-dimensionalspectraltheoremtoobtainthespectraltheorem for compact Hermitian operators. We should mention that there are a plethora of spectral theorems for other sorts of operators on Hilbert spaces, but the functional analysis needed to study them (e.g. spectral measures) is beyond the scope of these notes. For the rest of this section, we assume that H is an in?nite-dimensional Hilbert space. Moreover, we ?x a hyper?nite-dimensional subspace E of H? (that is, E ∈ E?) such that H ? E; see Theorem 11.46. We let P denote PE. Lemma 13.6. If x ∈ Hns, then Px ≈ x. Proof. Write x = y +, where y ∈ H and  ≈0. Then Px = Py +P; since kPk= 1, P ≈0. Since y ∈ H ? E, Py = y. Thus, Px ≈ Py = y ≈ x.
 If T ∈B(H), we de?ne T0 : E → E by T0(x) = PT(x). It is straightforward to check that kT0k ≤ kTk and T0x = Tx for x ∈ H. A slightly less trivial observation is: Lemma 13.7. If T is Hermitian, so is T0. Proof. For x,y ∈ E, we calculate: hT0x,yi=hTx,Pyi=hTx,yi=hx,Tyi=hPx,Tyi=hx,PTyi=hx,T0yi.
90 ISAAC GOLDBRING Lemma 13.8. If x ∈ Hns, then T0Px ≈ Tx. Proof. By Lemma 13.6, Px ≈ x. Since T is continuous, we have TPx ≈ Tx. Since Tx ∈ Hns (again, by continuity of T), we have PTx ≈ Tx. Thus, T0Px = PTPx ≈ PTx ≈ Tx.
 For the rest of this section, we assume that T ∈ B(H) is a nonzero, compact Hermitian operator and T0 : E → E is de?ned as above. In this case, T0 is internally compact in the following precise sense: Lemma 13.9. If x ∈ E ∩H?n, then T0x ∈ Hns. Proof. Since T is compact, Tx ∈ Hns. By Lemma 13.6, T0x = PTx ≈ Tx, whence T0x ∈ Hns as well.
 Exercise 13.10. Suppose that λ ∈ C? is an eigenvalue of T0. Show that |λ|≤kT0k, whence λ ∈C?n. Lemma 13.11. Suppose that λ ∈C? is an eigenvalue of T0 with corresponding eigenvector x ∈ E of norm 1. Further suppose that λ 6≈0. Then x ∈ Hns and st(x) is an eigenvector of T of norm 1 corresponding to the eigenvalue st(λ). Proof. By the internal compactness of T0, we know that T0x ∈ Hns. But T0x = λx, so since 1 λ ∈ C?n, we have x = 1 λT0x ∈ Hns. Also, by Lemma13.8, we have T(st(x))≈ Tx ≈ T0Px = T0x = λx ≈st(λ)st(x). Consequently, T(st(x)) = st(λ)st(x). It remains to observe that st(x) has norm 1; however, this follows from the fact that x has norm 1 and kst(x)k is a real number.
 At this point, we apply the (transfer of the) ?nite-dimensional Spectral Theorem to T0; in particular, we get a hyper?nite sequence of eigenvalues λ1,...,λν (perhaps with repetitions), where ν := dim(E). Without loss of generality (by reordering if necessary), we may assume that |λ1|≥|λ2|≥···≥|λν|. We let {x1,...,xν} be an orthonormal basis for E, where xi is an eigenvalue for T0 corresponding to λi. We now worry about how many repetitions we might have amongst the eigenvalues. We show that a nonin?nitesimal eigenvalues can only be repeated a ?nite number of times. First, we need: Lemma 13.12. Suppose  ∈R>0 and |λk|≥ . Then k ∈N. Proof. By the Pythagorean Theorem, kxi ? xjk = √2 for i,j = 1,...,k. We de?ne the internal sequence (si : i ∈ N?) by si = xi for i = 1,...,k, while si = 0 for i > k. Suppose, towards a contradiction, that k > N. Then ksi?sjk=√2 for distinct i,j ∈N, whence, by Theorem 9.36, si = xi / ∈ Hnsfor some i ∈N?, contradicting Lemma 13.11.
LECTURE NOTES ON NONSTANDARD ANALYSIS 91 Corollary 13.13. Suppose that λl+1 = λl+2 =···= λl+k 6≈0. Then k ∈N. Proof. By the previous lemma, l + k ∈N, whence k ∈N.
 Wenowremoverepetitions: let κ1,...,κη enumerateallthedistincteigenvalues of T0, again ordered so that |κ1|≥|κ2|≥···≥|κη|. For i = 1,...,η, we let {xi 1,...,ximi} be an orthonormal basis for the eigenspace Wi cor-responding to κi. By the previous corollary, we know that mi ∈ N foreach i ∈ {1,...,η} with κi 6≈ 0. Moreover, we have E = W1 ⊕···⊕Wη,P = PW1 +···+ PWη, and T0 = κ1PW1 +···+ κηPWη. Which of the κi’s are nonin?nitesimal? To answer this question, we set X :={i ∈N? | 1≤ i ≤ η and κi 6≈0}. Lemma 13.14. X 6=?. Proof. Suppose, toward a contradiction, that X = ?. Fix b ∈ H such that Tb 6= 0, this is possible since T 6= 0. Write b = b1 +···+ bη, with bi ∈ Wi for each i. Then Tb = T0b = T0b1 +···+T0bη = κ1b1 +···+κηbη. However, by the Pythagorean Theorem, kκ1b1 +···+ κηbηk2 = η X i=1 |κi|2kbik2 ≤|κ1|2 η X i=1 kbik2 =|κ1|2kbk2 ≈0, a contradiction.
 Lemma 13.15. X ?N. Proof. Fix n ∈ X and choose > 0 such that |κn|≥ . Recall that κn = λm for some m ∈{1,...,ν}. By Lemma 13.12, m ∈ N. Since n ≤ m, we have n ∈N.
 We now know that one of the two situations occurs: either X = N>0 or X = {1,...,k} for some k ∈ N. Both situations are in fact possible and must be treated slightly di?erently. We set yj i := st(xj i) for j ∈ X and i ∈ {1,...,mj}. If i 6= i0, then by continuity of the inner product, we know that hyj i ,yj i0i ≈ hxj i,xj i0i = 0, whence the yj i’s are pairwise perpendicular. We set ? Wj := sp(yj 1,...,yj mj), so dim( ? Wj) = mj. In an analogous fashion, one shows that ? Wj ⊥ ? Wj0 for distinct j,j0 ∈ X. Lemma 13.16. For x ∈ H and j ∈ X, we have P ? Wj(x)≈ PWj(x). Proof.
P ? Wj(x) =
mj X i=1
hx,yj iiyj i ≈
mj X i=1
hx,xj iixj i = PWj(x).
We now set K :=Lj∈X ? Wj; this is either a ?nite or in?nite direct sum, depending on whether X is ?nite or in?nite. We set ? W0 := K⊥.
92 ISAAC GOLDBRING
For simplicity, set αj := st(κj). We can now state the Spectral Theorem in case W is ?nite. Theorem 13.17 (Spectral Theorem- Case 1). If X = {1,...,k} for some k ∈N, then the eigenvalues of T are 0,α1,...,αk and T = α1P ? W1 +···+ αkT ? Wk is the spectral resolution of T. Proof. Fix x ∈ H; then T(x) = T0(x). Consequently, T(x) = T0(x) η X i=1 κjPWj = k X j=1 κjPWj(x)+ η Xj =k+1 κjPWj(x) = (?)+(??). By the previous lemma, (?) ≈Pk j=1 αjP ? Wj(x) ∈ H. We need to show that (??) ≈ 0. This again follows from a Pythagorean Theorem calculation, as k(??)k2 ≤|κk+1|2kxk2 ≈ 0. This proves the Spectral Resolution part of the Theorem. We next show that 0 is an eigenvalue. First, since K is ?nitedimensional while H is in?nite-dimensional, we have ? W0 6={0}. If x ∈ ? W0\ {0}, then by the Spectral Resolution, we have T(x) =Pk j=1 αjPWj(x) = 0, whence x is an eigenvector of T corresponding to 0. It remains to show that {0,α1,...,αk}are all of the eigenvalues of T; this will again follow from the Spectral Resolution of T. To see this, suppose that α 6= 0 is an eigenvalue of T with corresponding eigenvector x. Then k X j=0 αP ? Wj(x) = αx = Tx = k X i=1 αiP ? Wi(x). Thus, αP ? W0(x) = 0 and αP ? Wj(x) = αjP ? Wj(x) for j = 1,...,k (since elements of ? W0, ? W1,..., ? Wk are pairwise perpendicular and thus linearly independent). Since x 6= 0, there is j ∈{1,...,k}such that P ? Wj(x)6= 0; for this j, we have α = αj.
 In order to deal with the case that X = N>0, we need one ?nal lemma. Lemma 13.18. If X = N>0, then limj→∞αj = 0. Proof. Since |αn| is nonincreasing and bounded below, it su?ces to prove that 0 is a limit point of |αn|. We consider the extension of the sequence (αn | n ∈ N>0) to a sequence (αn | n ∈ (N>0)?). By the In?nitesimal Prolongation Theorem, there is N ∈ N? \N, N ≤ η such that αN ≈ κN. But κN ≈ 0 since N / ∈ X. Thus, αN ≈ 0 and hence 0 is a limit point of( αn).
 We are now ready to state: Theorem 13.19 (Spectral Theorem-Case 2). If X = N>0, then the nonzero eigenvalues are α1,α2,... and T =P∞ j=1 αjP ? Wj is the spectral resolution of T, that is, T(x) =P∞ i=1 αjP ? Wj(x) for all x ∈ H.
LECTURE NOTES ON NONSTANDARD ANALYSIS 93 Proof. Fix x ∈ H. Set rn :=kT(x)?Pn j=1 αjP ? Wj(x)k; we need to show that rn →0 as n →∞. Again, we know thatPn j=1 αjP ? Wj(x)≈Pn j=1 κjPWj(x) and T(x) = T0(x) =Pη j=1 κjPWj(x). Thus, rn ≈ kPη j=n+1 κjPWj(x)k forall n ∈N. We play a Pythagorean game again: k η Xj =n+1 κjPWj(x)k2 = η Xj =n+1 |κj|2kPWj(x)k2 ≤|κn+1|2 η X j=1 kPWj(x)k2 =|κn+1|2kxk2. Thus rn ≤|αn+1|2kxk2 for all n ∈N. Since αn → 0 as n →∞, we see that rn → 0 as n → ∞. The claim about the nonzero eigenvalues of T being {α1,α2,...,} follows from the Spectral Resolution of T in a manner similar to Case 1 and is left as an exercise.
 13.1. Problems. Problem 13.1. Suppose that T is a Hermitian operator on a unitary space V . Show that every eigenvalue of T is a real number. Problem 13.2. Let V be the unitary space C([0,1],C) endowed with the inner product hf,gi:=Z1 0 f(t)g(t)dt. De?ne T : V → V by T(f) := tf, i.e. T(f)(t) := tf(t). (1) Show that T is a bounded Hermitian operator on V . (2) Show that T has no eigenvalues. (3) Show that T is not compact. (Don’t just say if it were compact, it would have eigenvalues by the Spectral Theorem. Show directly that T is not compact.) Problem 13.3. For each of the following bounded linear operators T given below, explain why they are compact and Hermitian. Then ?nd the eigenvalues, eigenspaces, and projections, yielding the spectral decomposition for T. (1) Let A be the matrix 3 ?4 ?4 3. De?ne T : C2 →C2 by T(x) = Ax. (2) De?ne T : `2 → `2 by T((xk | k ≥1)) = (xk k | k ≥1). There is a Spectral Theorem for Hermitian operators which need not be compact. The statement of the spectral theorem is more involved (and a little less satisfying), so we will not give it here. However, the results in the remaining problems are ingredients towards proving this more general Spectral Theorem. The interested reader can ?nd a complete discussion of this in Chapter 5, Section 5 of [1].
94 ISAAC GOLDBRING
We let H be a Hilbert space and T a (not necessarily compact) Hermitian operator on H. E, P, T0 and the sequence (λi | i ≤ ν) are de?ned exactly as they are in the notes. We also set J := [?kTk,kTk]. Problem 13.4. For n ≥ 0, show that (T0)n =Pν i=1 λn i Pi. Conclude that for any polynomial p(z)∈R?[z], we have p(T0) =Pi=1ν p(λi)Pi. For any internal function f : J? →R?, set f(T0) =Pν i=1 f(λi)Pi. Problem 13.5. For any internal f : J? →R?, show that f(T0) is Hermitian. Problem 13.6. Suppose f,g : J? →R? are internal. Show that: (1) (f + g)(T0) = f(T0)+ g(T0); (2) (f ·g)(T0) = f(T0)·g(T0); (3) (cf)(T) = cf(T) for any c ∈R?. These properties are often referred to as the Operational Calculus. Problem 13.7. Suppose that f,g : J? → R? are internal functions and f(c)≤ g(c) for all c ∈ J?. Show that f(T0)≤ g(T0). We call an internally bounded linear operator (what does this mean?) U on E nearstandard if for every x ∈ E ∩Hns, we have U(x)∈ Hns. Problem 13.8. Suppose that U is nearstandard. Show that kUk ∈ R?n. (Careful: This is not immediate from the de?nition) If U is nearstandard, de?ne st(U) : H → H by st(U)(x) = st(U(x)) forall x ∈ H. Problem 13.9. Suppose that U is nearstandard. Show that st(U) is a bounded linear operator on H and kst(U)k≤st(kUk). Problem 13.10. Showthat, forany n ∈N, (T0)n isnearstandard. Conclude that for any p(z)∈R[z], we have p(T0) is nearstandard. Problem 13.11. Suppose that f : J →R is continuous. (1) Show that f(T0) is nearstandard. (Hint: Suppose, towards a contradiction, that x ∈ E ∩Hns is such that f(T0)(x) / ∈ Hns. Thus, thereis r ∈R>0 such that kf(T0)(x)?bk > r for all b ∈ H. By the Weierstrauss Approximation Theorem, there is a polynomial p(z) ∈ R[z] such that |f(c)?p(c)| < r for all c ∈ J.) (2) Show that st((f(T0))) is Hermitian. (3) Suppose that f(c) ≥ 0 for all c ∈ J. Show that st(f(T0)) ≥ 0, that is, hst(f(T0))x,xi≥0 for all x ∈ H. 14. The Bernstein-Robinson Theorem Inthissection, wewillproveatheoremwhichwasthe?rstserioustheorem proven using nonstandard methods. Before we can state this theorem, we need some background. Throughout this section, all normed spaces are over C.
LECTURE NOTES ON NONSTANDARD ANALYSIS 95 De?nition 14.1. Suppose that X is a Banach space, T ∈B(X), and Y ? X is a subspace. We say that Y is T-invariant if T(Y )? Y . If X is a Banach space and T ∈ B(X), then clearly {0} and X are Tinvariant; these are said to be the trivial T-invariant subspaces. Clearly, if dim(X) = 1, then X has no nontrivial T-invariant subspaces. Theorem 14.2. If X is a ?nite-dimensional Banach space with dim(X)≥2 and T ∈B(X), then X has a nontrivial T-invariant subspace. Proof. Set n := dim(X) ≥ 2. Fix x ∈ X \{0}. Since {x,Tx,...,Tnx} has n + 1 vectors, it must be linearly dependent, whence we can ?nd scalars α0,...,αn ∈C, not all 0, such that α0x + α1Tx + ... + αnTnx = 0. Factor the polynomial α0+α1z+...+αnzn = α(z?λ1)···(z?λn), where α,λi ∈C. Then α(T ?λ1I)···(T ?λnI)x = 0. It follows that there is i ∈{1,...,n} such that ker(T?λiI)6={0}. Observe that ker(T?λiI) ={x ∈ X | T(x) = λix} is T-invariant. If ker(T ?λiI)6= X, then it is a nontrivial T-invariant subspace. Otherwise, Tx = λix for all x ∈ X, whence it follows that T = λiI. But then, every subspace is T-invariant, so any 1-dimensional subspace will be a nontrivial T-invariant subspace.
 Thus, for“small”Banachspaces, non-trivial T-invariantsubspacesalways exist. At the opposite extreme, if X is a non-separable Banach space, then for any x ∈ X\{0}, the closed linear span of {x,Tx,T2x,...} is a nontrival T-invariant subspace. What about separable, in?nite-dimensional Banach spaces? Well, itwas?rstshownbyEn?othattherearequiteexoticseparable Banach spaces that possess bounded linear operators without any nontrivial, closed invariant subspaces. But what about the least exotic Banach spaces: Hilbert spaces? Well, the following is still open:
The Invariant Subspace Problem: Suppose that H is a separable, in?nite-dimensional Hilbert space and T ∈B(H). Does H have a nontrivial, closed T-invariant subspace?
In the rest of this section, H will denote a separable, in?nite-dimensional Hilbert space. Theorem 14.3. If T ∈ B(H) is a compact, Hermitian operator, then H has a nontrivial, closed T-invariant subspace. Proof. By the Spectral Theorem, there is an eigenvalue λ for T. The associated eigenspace is a closed, T-invariant subspace that is not {0}. If the associated eigenspace were all of H, then T = λI and once again any 1-dimensional subspace is a nontrivial, closed T-invariant subspace.
 Notice that the proofs of the preceding theorems utilized eigenvalues in an essential way. Even so, the next example and exercises show that eigenvalues are not necessary for invariant subspaces.
96 ISAAC GOLDBRING Example 14.4. Let S : `2 → `2 be the “right-shift” operator, that is, S(x1,x2,...) = (0,x1,x2,...). Notice kSk = 1, so S ∈ B(`2). For n > 0, set Mn := {(x1,x2,...) ∈ `2 | xk = 0 for k = 1,2,...,n}. Then Mn is a nontrivial, closed S-invariant subspace. Exercise 14.5. For S as in the previous example, show that S is not compact and has no eigenvalues. Exercise 14.6. Let W : `2 → `2 be given by W(x1,x2,...) = (0,x1, 1 2x2, 1 3x3,...). Show that W is compact but does not have any eigenvalues. Once again, the various Mn are nontrivial W-invariant subspaces. Before nonstandard methods, the state-of-the-art result was the following strengthening of Theorem 14.3: Theorem 14.7 (von Neumann, 1930s). If T ∈ B(H) is compact, then H has a nontrivial, closed T-invariant subspace. De?nition 14.8. T ∈B(H) is said to be polynomially compact if there is a nonzero polynomial p(z)∈C[z] such that p(T) is compact. Our goal is to prove the following: Theorem 14.9 (Bernstein-Robinson 1966). If T ∈ B(H) is polynomially compact, then H has a nontrivial, closed T-invariant subspace. To be fair, we should say that after the Bernstein-Robinson theorem, a more general theorem was proven whose proof is much more elementary (modulo some standard facts from a ?rst graduate course in functional analysis): Theorem 14.10 (Lomonosov, 1973). If T ∈ B(H) is such that there is a nonzero K ∈B(H) such that K is compact and TK = KT, then H has a nontrivial, closed T-invariant subspace. (To see how Lomonosov implies Bernstein-Robinson, observe that T commutes with p(T).) The main idea behind the proof of the Bernstein-Robinson Theorem is fairly easy to explain. Once again, it is an instance of the method of Hyper?nite Approximation. Fix an orthonormal basis {e1,e2,...} for H and ?x ν ∈N?\N. Set Hν := sp(e1,...,eν). Let Pν : H? → Hν be the orthogonal projection onto Hν. Set Tν : H? → H? by Tν = PνTPν; observe that Tν(H?) ? Hν. We also set ? T := Tν|Hν = (PνT)|Hν, so ? T is an internally linear operator on Hν. Observe also that k? Tk≤kTνk=kPνTPνk≤kPνkkTkkPνk=kTk. We recall the following standard fact from linear algebra (whose proof we include for the sake of completeness).
LECTURE NOTES ON NONSTANDARD ANALYSIS 97
Theorem 14.11 (Existence of Upper Triangular Representations). Suppose that V is a ?nite-dimensional vector space of dimension m and T : V → V is linear. Then there is a chain {0} = V0 ? V1 ?···? Vm = V such that dim(Vi) = i and such that each Vi is T-invariant. Proof. We prove the theorem by induction on m, the case m = 0 being trivial. Assume now that m ≥ 1 and the theorem is true for vector spaces of dimension m?1. Suppose dim(V ) = m and T : V → V is linear. Since we are working over C, we can ?nd an eigenvector u of T. Consider a basis {u,w1,...,wm?1} of V . Set U = sp(u), W = sp(w1,...,wm?1) and P : V → W theprojectiononto W. De?ne S : W → W by S(w) = P(T(w)). By the induction hypothesis, we have a basis {z1,...,zm?1} for W such that, for each i ∈ {1,...,m ? 1}, S(sp(z1,...,zi)) ? sp(z1,...,zi). We leave it to the reader to check that T(sp(u,z1,...,zi))?sp(u,z1,...,zi) for each i ∈ {1,...,m ?1}. Set V1 := U and, for i = 1,...,m ?1, Vi+1 := sp(u,z1,...,zi).
 Wenowapplythe(transferofthe)previoustheoremto Hν and ? T, yielding a chain {0}= E0 ? E1 ?···? Eν = Hν, where each Ei ∈ E?, dim(Ei) = i, and each Ei is ? T-invariant. For appropriately chosen {e1,e2,...} and ν ∈ N? \ N, we will have that each st(Ei) is T-invariant. Since each st(Ei) is closed, it will remain to ?nd some i ∈{1,...,ν} such that st(Ei) is nontrivial. Let’s get started: ?x v ∈ H, kvk = 1. Let A = {v,Tv,T2v,...}. Let’s eliminate some trivial cases early on. First, suppose that A is linearly dependent. Then there are α0,α1,...,αk?1 ∈ C, not all 0, such that Tkv = α0v + α1Tv + ··· + αk?1Tk?1v. Set Y := sp(v,Tv,...,Tk?1v). Then Y is ?nite-dimensional (hence closed), nontrivial since v ∈ Y and H is in?nite-dimensional, and T-invariant. We may thus assume that A is linearly independent. Let F be the closed linear span of A. Suppose that F 6= H. We claim that F is T-invariant, whence F is a nontrivial T-invariant subspace of H. First, suppose that w ∈sp(A), so w = α0v +α1Tv +···+αkTkv for some α0,...,αk ∈C. But then Tw = α0Tv + α1T2v +···+ αkTk+1v ∈ sp(A). For the more general situation, w = limn→∞wn with each wn ∈ sp(A). But then, since T is continuous, Tw = limn→∞Twn ∈ F since Twn ∈sp(A) for each n. We may thus suppose F = H. In this case, we apply the Gram-Schmidt process to A to get an orthonormal basis{e1,e2,...}of H with the property that sp(x,Tx,...,Tn?1x) = sp(e1,e2,...,en) for each n ≥1. Let’s observe something interesting about the “matrix representation” of T with respect to the basis {e1,e2,...}. For k ∈ N>0, we have ek ∈ sp(x,Tx,...,Tk?1x), so T(ek) ∈ sp(Tx,T2x,...,Tkx) ? sp(e1,...,ek+1). Thus, if we write T(ek) =P∞ j=1 ajkek, we see that ajk = 0 for j > k + 1. We then say that the matrix [ajk] for T is almost superdiagonal.
98 ISAAC GOLDBRING It will prove desirable later on to know that T and ? T are “close.” More precisely, we will want to know that, for y ∈ Hν ∩H?n, T(y) ≈ ? T(y). We can achieve this goal by choosing ν appropriately, as we proceed to show now. First, we would like to know a predictable form for the matrix representation of Tn with respect to our basis {e1,e2,...}. Usually, this is not possible, but thankfully, [ajk] is almost superdiagonal. Recursively de?ne a(n) jk as follows: Set a(1) jk := ajk and a(n+1) jk :=P∞ i=1 a(n) ji aik =Pk+1 i=1 a(n) ji aik. Exercise 14.12. For n,j,k > 0, we have: (1) a(n) j+k,j = 0 if n < k, and (2) a(k) j+k,j =Qk?1 i=0 aj+i+1,j+i. For the rest of this section, ?x a polynomial p(z) = α0 +α1z+···+αkzk with coe?cients from C such that αk 6= 0 and p(T) is compact. We can now choose the “appropriate” ν ∈N?\N. Lemma 14.13. There is ν ∈N?\N such that aν+1,ν ≈0. Proof. Let [bjk] be the matrix for p(T). Then by the previous two exercises, bj+k,j = 0+ α1a(1) j+k,j + α2a(2) j+k,j +···+ αka(k) j+k,j = αka(k) j+k,j
= αk
k?1 Y i=0
aj+i+1,j+i. By Lemma 11.25, bN+k,N ≈0 for all N > N. Thus, there is i ∈{0,...,k?1} such that aN+i+1,N+i ≈0. Set ν = N + i for this i.
 For the remainder of this section, we ?x ν as in the previous lemma. Let us show how this ν has the promised property. Lemma 14.14. If y ∈ Hν ∩H?n, then T(y)≈ ? T(y). Proof. Write y = Pν k=1 αkek with each αk ∈ C?. By the PythagoreanTheorem, kyk2 =Pν k=1|αk|2 ≥ |αν|2, whence αν ∈ C?n since y ∈ H?n.Using that [ ajk] is almost superdiagonal, we have T(y) = ν X k=1 αkT(ek) = ν X k=1 αk k+1 X j=1 ajkej = ν X k=1 αk ν+1 X j=1 ajkej = ν+1 X j=1 ( ν X k=1 αkajk)ej.
LECTURE NOTES ON NONSTANDARD ANALYSIS 99
Thus, ? T(y) = PνT(y) =Pν j=1(Pν k=1 αkajk)ej, whence T(y) = PνT(y)+ ν X k=1 αkaν+1,keν+1 = PνT(y)+ ανaν+1,νeν+1 ≈ PνT(y), since aν+1,ν ≈0 and αν ∈C?n.
 Corollary 14.15. For any n ∈ N>0 and y ∈ Hν ∩H?n, we have Tn(y) ≈ ? Tn(y). Consequently, for any polynomial q(z) and any y ∈ Hν ∩ H?n, q(T)y ≈ q(? T)(y). Proof. The proof is by induction on n, the case n = 1 being the content of the previous lemma. For the induction step, assume that n > 1 and that the corollary holds for n?1. Since ? T is internally bounded and y ∈ H?n,we have that ? Tn?1(y)∈ H?n. Consequently, Tn(y) = T(Tn?1(y))≈ T(? Tn?1(y))≈ ? T(? Tn?1(y)) = ? Tn(y), where the ?rst≈holds by the continuity of T and the inductive assumption that Tn?1(y) ≈ ? Tn?1(y), while the second ≈ holds by the base case of theinduction applied to the vector ? Tn?1(y).
 Lemma 14.16. For i = 0,1,...,ν, we have T(st(Ei))?st(Ei). Proof. Fix i ∈ {0,1,...,ν} and set E := Ei. Fix x ∈ st(E); we need T(x) ∈ st(E). By Exercise 11.47, we have PE(x) ≈ x. Since T is continuous, TPE(x) ≈ Tx. Consequently, TPE(x) ∈ Hns. Thus, by Lemma 13.6, Pν(TPE(x)) ≈ TPE(x). Consequently, we have TνPE(x) = PνTPνPE(x) = PνTPE(x) ≈ TPE(x) ≈ Tx. Since Tν(E) = ? T(E) ? E, it follows thatT (x)∈st(E).
 It thus remains to ?nd some i such that st(Ei) is nontrivial. To achieve this goal, we de?ne the internal sequence r0,r1,...,rν of numbers from R? by rj := kp(Tν)(v)?p(Tν)PEj(v)k. (Recall that we have ?xed a vector v ∈ H of norm 1.) We ?rst show that r0 6≈ 0 while rν ≈ 0. To do this, we ?rst prove: Lemma 14.17. p(Tν) is S-continuous. Proof. Observe that
kp(Tν)k≤
k X i=0
|αi|kTνki ≤
k X i=0
|αi|kTki, whence kp(Tν)k ∈ R?n. Now suppose that x,y ∈ H? and x ≈ y. Then kp(Tν)x?p(Tν)yk≤kp(Tν)kkx?yk≈0.
 For simplicity, we write Pj instead of PEj.
100 ISAAC GOLDBRING Corollary 14.18. r0 6≈0 and rν ≈0. Proof. By Lemma 13.6, Pν(v)≈ v. Since p(T) is continuous, p(T)(Pν(v))≈ p(T)(v). However, since Pν(v)∈ Hν, we have p(T)(Pν(v))≈ p(? T)(Pν(v)) = p(Tν)(Pν(v))≈ p(Tν)(v). Thus, p(Tν)(v)≈ p(T)(v)6= 0 since{v,Tv,T2v,...}is linearly independent. Since E0 ={0}, r0 =kp(Tν(v))k6≈0. On the other hand, rν =kp(Tν)(v)?p(Tν)Pν(v)k≈0 since Pν(v)≈ v and p(Tν) is S-continuous.
 Observe that in the previous two results, we did not use the fact that p(T) is compact, that is, the previous two results are valid for any polynomial q(z). Choose r ∈ R>0 such that r < r0. Set η to be the least k ∈{0,1,...,ν} such that rk < 1 2r; since rν ≈ 0, rν < 1 2r, so 0 < η ≤ ν. We will now showthat either st( Eη?1) is nontrivial or st(Eη) is nontrivial. Lemma 14.19. v / ∈st(Eη?1) (whence st(Eη?1)6= H). Proof. Suppose that v ∈ st(Eη?1). Then by Exercise 11.47, v ≈ Pη?1v. But then, by Lemma 14.17, p(Tν)v ≈ p(Tν)Pη?1(v), whence rη?1 ≈ 0. But rη?1 ≥ 1 2r, a contradiction.
 Lemma 14.20. st(Eη)6={0}. Proof. Set y := p(Tν)Pη(v). Since Eη is ? T-invariant, it is also p(? T)-invariant, whence y ∈ Eη. By Lemma 14.15, y = p(Tν)Pη(v)≈ p(T)Pη(v). Since p(T) is compact and Pη(v) ∈ H?n, we have that p(T)Pη(v) ∈ Hns, whence y ∈ Hns. Let z := st(y) ∈ H, whence z ∈ st(Eη). If z = 0, then y ≈ 0, whence rη ≈kp(Tν)(v)k= r0 > r. This contradicts the fact that rη < 1 2r.
 Thus, the only way for both st(Eη?1) and st(Eη) to both be trivial is forst( Eη?1) ={0} and st(Eη) = H. We now show that this cannot happen for “dimension reasons.” Lemma 14.21. Suppose that E,F ∈E?, E ? F, and dim(F) = dim(E)+1. Then for any x,y ∈st(F), there is λ ∈C and z ∈st(E) such that x = λy+z or y = λx + z. Proof. Fix x0,y0 ∈ F such that x ≈ x0 and y ≈ y0. By the transfer principle, there is λ ∈ C? and z ∈ E such that either y0 = λx0 + z or x0 = λy0 + z. Without loss of generality, we assume y0 = λx0 + z. If λ ∈ C?n, then since z = y0 ? λx0 ∈ E, we have z ∈ Hns and st(z) ∈ st(E). If λ / ∈ C?n, then1 λy0 = x0 + 1 λz, reverting us back to the previous case.
 Suppose, towards a contradiction, that st(Eη?1) = {0} and st(Eη) = H. By the previous lemma, for any x,y ∈ H, there is λ ∈ C such that x = λy or y = λx, that is, dim(H) = 1, a serious contradiction.
LECTURE NOTES ON NONSTANDARD ANALYSIS 101
15. Measure Theory In this section, we will describe the Loeb measure construction. There is a lot to say here, but we will cover only enough to discuss the application to combinatorics in the ?nal section. 15.1. General measure theory. Fix a set X. A nonempty set ??P(X) is an algebra if it is closed under unions, intersections, and complements, that is, if A,B ∈?, then A∪B, A∩B, and X \A all belong to ?. If ? is an algebra of subsets of X, then ?,X ∈?. An algebra ? on X is said to be a σ-algebra if it is also closed under countable unions, that is, if A1,A2,... all belong to ?, then so doesS∞ n=1 An. A σ-algebra is then automatically closed under countable intersections. Exercise 15.1. Suppose that X is a set and O ? P(X) is an arbitrary collection of subsets of X. Prove that there is a smallest σ-algebra ? containing O. We call this σ-algebra the σ-algebra generated by O and denote it by σ(O). Remark. When trying to prove that every element of σ(O) has a certain property, one just needs to show that the set of elements having that property contains O and is a σ-algebra. Suppose that ? is an algebra on X. A pre-measure on ? is a function μ : ?→[0,+∞] satisfying the following two axioms: ? μ(?) = 0; ? (Countable Additivity) If A1,A2,..., all belong to ?, are pairwise disjoint, andS∞ n=1 An belongsto?, thenμ(S∞ n=1 An) =P∞ n=1 μ(An). If ? is a σ-algebra, then a pre-measure is called a measure. If μ is a measure on X and μ(X) = 1, then we call μ a probability measure on X. Example 15.2. Fix n ∈ N and suppose that X = {1,2,...,n}. Let ? := P(X). Then ? is an algebra of subsets of X that is actually a σ-algebra for trivial reasons. De?ne the function μ : ?→[0,1] by μ(A) = |A| n . Then μ is a probability measure on ?, called the normalized counting measure. Exercise 15.3. Suppose that μ : ?→[0,+∞] is a pre-measure. Prove that μ(A)≤ μ(B) for all A,B ∈? with A ? B. For subsets A,B of X, we de?ne the symmetric di?erence of A and B to be A4B := (A\B)∪(B\A). Exercise 15.4. Suppose that ? is an algebra and μ : σ(?) → [0,∞] is a measure. Prove that, for any A ∈ σ(?) with μ(A) < ∞ and any  ∈ R>0, there is B ∈? such that μ(A4B) < . Forourpurposes, itwillbeofvitalimportancetoknowthatapre-measure μ on an algebra ? can be extended to a measure on a σ-algebra ?0 extending ?. We brie?y outline how this is done; the interested reader can consult any good book on measure theory for all the glorious details.
102 ISAAC GOLDBRING
Fix an algebra ? of subsets of X and a pre-measure μ on ?. For arbitrary A ? X, we de?ne the outer measure of A to be μ+(A) := inf{X n∈N μ(Bn) | A ?[ n∈N Bn, each Bn ∈?}. Note that μ+(A) = μ(A) for all A ∈?. Nowalthough μ+ isde?nedonallofP(X)(whichiscertainlya σ-algebra), it need not be a measure. However, there is a canonical σ-sub-algebra ?m of P(X), the so-called μ+-measurable subsets of X, on which μ+ is a measure. (The precise de?nition of μ+-measurable is not important here; again, any standard measure theory text will have the details.) Let us collect the relevant facts here: Fact 15.5. Let X be a set, ? an algebra of subsets of X, and μ : ?→[0,∞] a pre-measure on ? with associated outer measure μ+ and σ-algebra of μ+measurable sets ?m. Further suppose that μ is σ-?nite, meaning that we can write X =Sn∈N Xn with each Xn ∈? and μ(Xn) < ∞. (1) σ(?)??m and μ+|? = μ. (2) (Uniqueness) If ?0 is another σ-algebra on X extending ? and μ0 : ?0 → [0,∞] is a measure on ?0 extending μ, then μ+ and μ0 agree on ?m ∩?0 (and, in particular, on σ(?)).(3) (Completeness) If A ? B ? X are such that B ∈ ?m and μ+(B) = 0, then A ∈?m and μ+(A) = 0.(4) (Approximation Results) (a) If A ∈ ?m, then there is B ∈ σ(?) containing A such that μ+(B\A) = 0. (So ?m is the completion of σ(?).)(b) If A ∈ ?m is such that μ+(A) < ∞, then for every  ∈ R>0, there is B ∈? such that μ(A4B) < .(c) Suppose that A ? X is such that, for every  ∈ R>0, there is B ∈? such that μ(A4B) < . Then A ∈?m. Example 15.6 (Lebesgue measure). Suppose that X = R and ? is the collection of elementary sets, namely the ?nite unions of intervals. De?ne μ : ?→[0,∞] by declaring μ(I) = length(I) and μ(I1 ∪···∪In) =Pn i=1 μ(Ij) whenever I1,...,In are pairwise disjoint. The above outer-measure procedure yields the σ-algebra ?m, which is known as the σ-algebra of Lebesgue measurable subsets of R and usually denoted by M. The measure μ+ is often denoted by λ and is referred to as Lebesgue measure. The σ-algebra σ(?) in this case is known as the σ-algebra of Borel subsets of R. It can also be seen to be the σ-algebra generated by the open intervals. 15.2. Loeb measure. How do we obtain pre-measures in the nonstandard context? Well, we obtain them by looking at normalized counting measures on hyper?nite sets. Suppose that X is a hyper?nite set. We set ? to be the set of internal subsets of X. Then ? is an algebra of subsets of X that is not (in general) a σ-algebra. For example, if X = {0,1,...,N} for some
LECTURE NOTES ON NONSTANDARD ANALYSIS 103 N > N, then for each n ∈N, An :={n} belongs to ?, butSn An = N does not belong to ? as N is not internal. If A ∈ ?, then A is also hyper?nite. We thus de?ne a function μ : ? → [0,1] by μ(A) := st(|A| |X| ). We claim that μ is a pre-measure. It is easily seen to be ?nitely additive, that is, μ(A1∪···∪An) =Pn i=1 μ(Ai) whenever A1,...,An ∈? are disjoint. But how do we verify countable additivity? Exercise 15.7. If A1,A2,... all belong to ? andS∞ n=1 An also belongs to ?, then there is k ∈N such thatS∞ n=1 An =Sk n=1 An. Thus, bytheexercise, countableadditivityisatrivialconsequenceof?nite additivity in this context. We may thus apply the outer measure procedure in the previous section to obtain a probability measure μ+ : ?m → [0,1] extending μ. μ+ is called the Loeb measure on X and is often denoted μL. The elements of ?m are referred to as the Loeb measurable subsets of X and this set is usually denoted by ?L. There are many interesting things to say about Loeb measure. It is crucial for applications of nonstandard analysis to many di?erent areas of mathematics. Let us just mention its connection to Lebesgue measure. We will prove the following theorem in the exercises. Theorem 15.8. Suppose that N > N and X = {0, 1 N , 2 N ,..., N N = 1}, ahyper?nite set. Consider st : X → [0,1]. De?ne a σ-algebra ? on [0,1] byA ∈? if and only if st?1(A)∈?L. For A ∈?, de?ne ν(A) := μL(st?1(A)). Then ? = M and ν = λ. (In other words, Lebesgue measure can be constructed nonstandardly from a hyper?nite normalized counting measure.)
15.3. Product measure. Suppose that (X,?X,μX) and (Y,?Y ,μY ) are two probability measure spaces. We can then form their product as follows: ?rst, set ? to be the set of ?nite unions of rectangles of the form A×B, where A ∈ ?X and B ∈ ?Y . It is an exercise to show that ? is an algebra of subsets of X ×Y and that every element of ? can be written as a ?nite union of disjoint such rectangles. We can then de?ne a pre-measure μ on ? by μ(Sn i=1(Ai×Bi)) :=Pn i=1(μX(Ai)·μY (Bi)). Applying the outer measureprocedure, we get a measure μX ?μY : ?m →[0,1] extending μ. We denote? m by ?X ??Y . The following situation will come up in the ?nal section: suppose that X and Y are hyper?nite sets and we construct the Loeb measure spaces (X,?X,L,μX,L) and (Y,?Y,L,μY,L). We are thus entitled to consider the product measure space (X×Y,?X,L??Y,L,μX,L?μY,L). However, X×Y is itself a hyper?nite set, whence we can consider its Loeb measure space (X ×Y,?X×Y,L,μX×Y,L). There is a connection: Exercise 15.9. Show that ?X,L ??Y,L is a sub-σ-algebra of ?X×Y,L and that μX×Y,L|(?X,L ??Y,L) = μX,L ?μY,L.
104 ISAAC GOLDBRING
15.4. Integration. Once one has a measure space (X,?,μ), one can integrate as follows. First, for a function f : X →R, we say that f is measurable if f?1(U)∈? for any open U ?R. Next, de?ne a simple function g : X → R to be a measurable function with ?nite range. Given a set A ? X, we de?ne 1A : X →R by 1A(x) = 1 if x ∈ A and0otherwise. If A ∈?, then1A ismeasurable. Anysimplefunction g can be written as g =Pn i=1 ri1Ai with ri ∈ R and Ai ∈ ?. For such asimple function g, we de?ne the integral of g to beRgdμ :=Pn i=1 riμ(Ai). For an arbitrary positive measurable function f : X → R, we de?ne the integral of f to beRfdμ := sup{Rgdμ | g ≤ f, g a simple function}. f is said to be integrable ifRfdμ < ∞. For an arbitrary function f, we set f+ := max(f,0) and f? := max(?f,0). We say that f is integrable if both f+ and f? are integrable, in which case we de?neRfdμ =Rf+dμ?Rf?dμ. If A ∈ ?, then we writeRA fdμ to indicateRf ·1Adμ and call this the integral of f on A. 15.5. Conditional expectation. Let (X,?,μ) be a measure space. We de?ne an inner-product space L2(X,?,μ) as follows: the set of vectors is the set of measurable functions f : X →R such thatR|f|2dμ < ∞. We add vectorsandmultiplybyscalarsintheusualway. Wede?netheinnerproduct to behf,gi:=Rfgdμ. Of course, one has to check that this integral is ?nite and this satis?es the requirements of an inner product, but this follows from the appropriate properties of the integral. (O.K. We are telling a bit of a lie. Technically speaking, we should be considering equivalence classes of measurable functions with respect to the equivalence relation f ≡ g if {x ∈ X | f(x) 6= g(x)} is contained in a set in ? of measure 0. We will ignore this important subtlety.) Theorem 15.10 (Riesz-Fisher Theorem). L2(X,?,μ) is a Hilbert space. The proof of the Riesz-Fisher Theorem requires some basic convergence theorems for integrals, but we will not get into this now. Now suppose that ?0 is a sub-σ-algebra of ?. We then get a subspace L2(X,?0,μ) of L2(X,?,μ) consisting of the ?0-measurable functions. Exercise 15.11. L2(X,?0,μ) is a closed subspace of L2(X,?,μ). We thus have the orthogonal projection P : L2(X,?,μ) → L2(X,?0,μ). Consider A ∈ ?0 with μ(A) < ∞, so 1A ∈ L2(X,?0,μ). Then for any g ∈ L2(X,?,μ), we have hg,1Ai=hP(g),1Ai, or, in integral notation: ZA gdμ =ZA P(g)dμ. In other words, P(g) is an ?0-measurable function which has the same integral as g over subsets of ?0. For probability reasons, P(g) is called the conditional expectation of g with respect to ?0 and is often denoted E[g|?0].
LECTURE NOTES ON NONSTANDARD ANALYSIS 105
15.6. Problems. We are aiming to prove the following: Theorem: Suppose that N > N and X ={0, 1 N , 2 N ,..., N N = 1}, a hyper?-nite set. Consider st : X → [0,1]. De?ne a σ-algebra ? on [0,1] by A ∈ ?if and only if st ?1(A) ∈ ?L. For A ∈ ?, de?ne ν(A) := μL(st?1(A)). Then? = M and ν = λ. We will do this in steps. Problem 15.1. Prove that ? is a σ-algebra and ν is a measure on ?. Problem 15.2. Fix a,b ∈[0,1] with a < b. (1) Prove that X ∩(a,b)? ∈?L and μL(X ∩(a,b)?) = b?a. (2) Prove that st?1((a,b)) =Sn∈N(X ∩(a + 1 n,b? 1 n)?). (3) Prove that (a,b)∈? and ν((a,b)) = b?a. Let B denote the σ-algebra of Borel subsets of [0,1]. We now use the factthat λ is the only measure on B satisfying λ(a,b) = b?a to conclude that B?? and ν|B = λ|B. Problem 15.3. Conclude that M ? ? and ν|M = λ|M. (Hint: Use Fact 15.5.) It remains to show that ? ? M. We will need the following fact, whose proof we will return to after we ?nish the Lebesgue measure business: Fact 15.12. If B ∈?X, then, for every  ∈R>0, there are internal subsets C,D of X such that C ? B ? D and μ(D\C) < . Now suppose that B ∈ ?. Fix  ∈ R>0. By the previous fact, there are internal C,D ? X such that C ? st?1(B) ? D and μ(D \ C) < . Set C0 := st(C) and D0 := [0,1]\st(X \D). Notice that C0 is closed and D0 is open (why?), whence C0,D0 ∈B??. Problem 15.4. Prove that C ?st?1(C0) and st?1(D0)? D. Conclude that B ∈ M. We now explain how to prove Fact 15.12. Recall that the outer measure procedure yields the following formula for μL: μL(B) = inf{X n∈N μ(An) | each An is internal and B ?[ n∈N An}. Problem 15.5. In this problem, we aim to prove, if B ∈?L, then μL(B) = inf{μL(A) | A is internal and B ? A}. The inequality ≤ is clear. Fix  ∈R>0; we need to ?nd internal A such that B ? A and μL(A) ≤ μL(B) + . Fix internal sets (An | n ∈ N) such that B ?Sn∈N An and μL(Sn∈N An) < μL(B) + . Without loss of generality, we may assume that An ? An+1 for all n. By countable comprehension, we extend this sequence to an internal sequence (An | n ∈N?).
106 ISAAC GOLDBRING (1) Prove that, for each k ∈N, we have (?n ∈N?)(n ≤ k →(An ? Ak and μ(An) < μL(B)+ )). (2) Prove that there is K > N such that μL(AK)≤ μL(B)+, ?nishing the proof. Problem 15.6. Prove a dual version of the previous problem, namely, if B ∈?L, then μL(B) = sup{μL(A) | A is internal and A ? B}. Problem 15.7. Use the previous two problems to prove Fact 15.12.
16. Szemer′edi Regularity Lemma A nice recent application of nonstandard methods is a slick proof of the celebrated Szemer′edi Regularity Lemma for graphs. To state this result, we need to introduce some terminology. Suppose that (V,E) is a ?nite graph. For two disjoint, nonempty subsets X, Y of V , we de?ne the density of arrows between X and Y to be the quantity δ(X,Y) := |E ∩(X ×Y )| |X||Y| . For example, if every element of X is connected to every element of Y by an edge, then δ(X,Y) = 1. Fix  ∈R>0. We say that X and Y as above are -pseudorandom if whenever A ? X and B ? Y are such that |A| ≥ |X| and |B|≥ |Y|, then |δ(A,B)?δ(X,Y)| < . In other words, as long as A and B contain at least an  proportion of the elements of X and Y , then δ(A,B) is essentially the same as δ(X,Y), so the edges between X and Y are distributed in a sort of random fashion. If X = {x} and Y = {y} are singletons, then clearly X and Y are pseudorandom for any . Thus, any ?nite graph can trivially be partitioned into a ?nite number of -pseudorandom pairs by partitioning the graph into singletons. Szemer′edi’s Regularity Lemma essentially says that one can do much better in the sense that there is a constant C() such that any ?nite graph has an “-pseudorandom partition” into at most C() pieces. Unfortunately, the previous sentence isn’t 100% accurate; there’s a bit of error that we need to account for. Suppose that V1,...,Vm is a partition of V into m pieces. Set R :={(i,j) | 1≤ i,j ≤ m, Vi and Vj are -pseudorandom}. We say that the partition is -regular ifP(i,j)∈R |Vi||Vj| |V|2 > (1?). This says that, in some sense, almost all of the pairs of points are in -pseudorandom pairs. We can now state Theorem 16.1 (Szemer′edi’s Regularity Lemma). For any  ∈ R>0, there is a constant C() such that any graph (V,E) admits an -regular partition into m ≤ C() pieces.
LECTURE NOTES ON NONSTANDARD ANALYSIS 107
Exercise 16.2. Prove that Szemer′edi’s Regularity Lemma is equivalent to the following statement: for any  ∈R>0 and any hyper?nite graph (V,E), there is a ?nite partition V1,...,Vm of V into internal sets and a subset R ?{1,...,m}2 such that: ? for (i,j) ∈ R, Vi and Vj are internally -pseudorandom: for all internal A ? Vi and B ? Vj with |A| ≥ |Vi| and |B| ≥ |Vj|, we have |δ(A,B)?δ(Vi,Vj)| < ; and ?P(i,j)∈R |Vi||Vj| |V|2 > (1?). We will thus prove the above nonstandard equivalent of the Szemer′edi Regularity Lemma. Fix  ∈R>0 and hyper?nite graph (V,E). We consider three di?erent probability spaces: ? The Loeb measure space (V,?V,L,μV,L); ? The product measure space (V ×V,?V,L ??V,L,μV,L ?μV,L); ? The Loeb measure space (V ×V,?V×V,L,μV×V,L). For ease of notation, we will write ?V for ?V,L, ?V×V for ?V×V,L, μV for μV,L, and μV×V for μV×V,L. As mentioned in the previous section, ?V ??V is a σ-subalgebra of ?V×Vand μV ?μV is the restriction of μV×V to ?V ??V . Since E ? V ×V , we canconsider f := E[1E|?V ??V ]. The following calculation will prove useful: Suppose that A,B ? V are internal and |A| |V| and |B| |V| are nonin?nitesimal. Then (?): ZA×B fd(μV ?μV ) =ZA×B 1EdμV×V by the de?nition of f = st(|E ∩(A×B)| |V|2 ) = st(|E ∩(A×B)| |A||B| )st(|A||B| |V|2 ) = st(δ(A,B))st(|A||B| |V|2 ). Fix η ∈R>0, to be determined later. Now, since f is μV ?μV -integrable, there is a μV ?μV -simple function g ≤ f such thatR(f?g)d(μV ?μV ) < η. Set C :={ω ∈ V ×V |f(ω)?g(ω)≥√η}∈?V ??V . Then (μV ?μV )(C) < √η, for otherwise Z(f?g)d(μV?μV )≥ZC(f?g)d(μV?μV )≥ZC √ηd(μV?μV )≥√η√η = η. By Fact 15.12, there is a set D ∈ ?V ??V that is a ?nite, disjoint union of rectangles of the form V0×V00, with V0,V00 ? V internal sets, such that C ? D and (μV ?μV )(D) < √η. In a similar way, we may assume that the level sets of g (that is, the sets on which g takes constant values) are ?nite disjoint unions of rectangles (Exercise). We now take a ?nite partition V1,...,Vm of V into internal sets such that g and 1D are constant on each
108 ISAAC GOLDBRING rectangle Vi×Vj. For ease of notation, set dij to be the constant value of g on Vi ×Vj. Claim: If μV (Vi),μV (Vj) 6= 0 and (Vi ×Vj)∩D = ?, then Vi and Vj are internally 2√η-pseudorandom. Proof of Claim: Since C ? D, we have that (Vi ×Vj)∩C =?, whence dij ≤ f(ω) < dij +√η for ω ∈ Vi ×Vj. (??). Now suppose that A ? Vi and B ? Vj are such that |A| ≥ 2√η|Vi| and |B| ≥ 2√η|Vj|. In particular, |A| |Vi| and |B| |Vj| are nonin?nitesimal. Since μV (Vi),μV (Vj) > 0, it follows that |A| |V| and |B| |V| are nonin?nitesimal and the calculation (?) applies. Integrating the inequalities (??) on A×B yields: dij st(|A||B| |V|2 )≤st(δ(A,B))st(|A||B| |V|2 ) < (dij +√η)st(|A||B| |V|2 ). We thus get: |δ(A,B)?δ(Vi,Vj)|≤|δ(A,B)?dij|+|δ(Vi,Vj)?dij| < 2√η.
By the Claim, we see that we should choose η < ( 2)2, so Vi and Vj are internally -pseudorandom when Vi and Vj are non-null and satisfy (Vi × Vj)∩D = ?. It remains to observe that the -pseudorandom pairs almost cover all pairs of vertices. Let R :={(i,j)| Vi and Vj are -pseudorandom}. Then st( X (i,j)∈R |Vi||Vj| |V|2 ) = μV×V ( [ (i,j)∈R (Vi ×Vj)) ≥ μV×V ((V ×V )\D) > 1?√η > 1?.
 16.1. Problems. The Szemer′edi Regularity Lemma proven above was integral in Szemer′edi’s 1975 proof of the following theorem (henceforth referred to as Szemer′edi’s Theorem), which was originally conjectured by Erd?os and Tur′an in 1936: Theorem 16.3. If A ?Z has positive upper Banach density (to be de?ned below), then A contains arbitrary long nontrivial arithmetric progressions, that is, for every k ∈ N>0, there is n,m ∈ Z with m > 0 such that n,n + m,...,n +(k?1)m ∈ A. In 1977, Furstenberg gave a di?erent proof of the Szemer′edi’s Theorem. Rather than using di?cult combinatorics a la Szemer′edi, Furstenberg translated the question into a question about ergodic theory (roughly de?ned as
LECTURE NOTES ON NONSTANDARD ANALYSIS 109
the study of measure preserving transformations of a probabilty space) and then proved the ergodic version of Szemerdi’s Theorem. This translation is now known as the Furstenberg Correspondence Principle. In these problems, we will outline a nonstandard proof of the Furtstenburg Correspondence Principle. First, some terminology: De?nition 16.4. If A ?Z, the upper Banach density of A is d(A) = limsup m?n→∞ |[n,m]∩A| m?n . De?nition 16.5. If (X,B,μ) is a probability space, we say that T : X → X is a measure-preserving transformation if, for all A ∈ B, both T(A) and T?1(A) belong to B and μ(T(A)) = μ(T?1(A)) = μ(A). Here is the theorem: Theorem 16.6 (Furstenburg Correspondence Principle). Suppose that A ? Z has positive upper Banach density. Then there is a probability space (X,B,μ), a measure-preserving transformation T : X → X, and a measurable set A0 ∈B such that μ(A0) = d(A) and such that, for any ?nite set U ?Z, we have: d(\ i∈U (A?i))≥ μ(\ i∈U T?i(A0)). Before proving the Furstenberg Correspondence Princple, let us mention the ergodic-theoretic fact that Furstenburg proved: Theorem 16.7. Suppose that T : X → X is a measure preserving transformation on the probability space X, μ(A) > 0, and k ∈N. Then there exists n ∈N such that μ(A∩T?n(A)∩T?2n(A)∩···∩T?(k?1)n(A)) > 0. Notice that the above theorem, coupled with the Furstenberg Correspondence Principle, yields a proof of the Szemer′edi Theorem. Problem 16.1. If A ?Z, prove that d(A) = max{st(|A?∩I| |I| ) | I ?Z? is an interval of hyper?nite length}. (Here, when we say “hyper?nite,” we mean “hyper?nite, but not ?nite”.) Problem 16.2. Fix A ?Z with positive upper Banach density. Fix I ?Z?, an interval of hyper?nite length such that |A?∩I| |I| ≈ d(A). Show that: ? the Loeb measure space (I,?I,μI), ? the map T : E → E given by T(x) = x +1(modI), and ? the set A0 := A?∩I satisfy the conclusion of the Furstenberg Correspondence Princple.
110 ISAAC GOLDBRING
References
[1] M. Davis, Applied nonstandard analysis, John Wiley and Sons Inc., 1977. [2] R. Goldblatt, Lectures on the hyperreals: an introduction to nonstandard analysis, volume 188 of Graduate Texts in Mathematics. Springer-Verglag, 1998 [3] C. W. Henson, Foundations of Nonstandard Analysis: A Gentle Introduction to Nonstandard Extensions; Nonstandard Analysis: Theory and Applications, L.O. Arkeryd, N.J. Cutland, and C.W. Henson, eds., NATO Science Series C; Springer 2001.
Department of Mathematics, Statistics, and Computer Science, University of Illinois at Chicago, Science and Engineering Offices M/C 249, 851 S. Morgan St., Chicago, IL, 60607-7045 E-mail address: isaac@math.uic.edu URL: http://www.math.uic.edu/~isaac
