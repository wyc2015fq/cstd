# 第4.6节  数值积分法 - 袁萌专栏 - CSDN博客
2013年07月14日 01:08:40[yuanmeng001](https://me.csdn.net/yuanmeng001)阅读数：1253
4.6 NUMERICAL  INTEGRATION
In numerical integration, one computes an approximate value for
 the definite integral rather than finding an exact value. In this section we shall present two methods of numerical integration, called the Trapezoidal Rule and Simpson’s
 Rule.
The Fundamental Theorem of Calculus gives us a method of computing
 the definite integral of a given continuous function *f* from
*a *ta*b*.The method is to find, by trial and error, an antiderivative
*F*of* f*and then to use the equation
______*f(t)dt*=*F(b) - F(a).*
When the method works, it provides an exact value for the integral.However, the method succeeds only if the
 antiderivative happens to bea function that can be described in a simple way. For many integralsone cannot find a formula for the antiderivative, and the methodfails. Such integrals can still be computed approximately usingnumerical integration.
TheTrapezoidal Rule and Simpson’sRule
 can always be applied and do not use the antiderivative. Theyare easy to carry out on a computer or hand calculator. We alreadydiscussed one method of approximating the definite integral inSection 4.1, the Riemann sum. The Trapezoidal Rule is a modified formof
 the Riemann sum, which gives a much closer approximation for agiven amount of effort. Simpson’sRule is a further modification that gives
 still betterapproximations.
Let*f*bea continuous function on an interval
*I*,and let a<b in*I*.By definition, for each positive infinitesimal
*dx*thedefinite integral
__________*f(x)dx*
isthe standard part of the infinite Riemann sum
_____*f(x) dx,*
____*f(x) dx*=*st*[__*f(x) dx*].
InSection 4.1, examples were worked out to show that the finite
 Riemannsums become very close to the definite integral when Δ*x*issmall; that is, the finite Riemann sums approximate the definiteintegral.
 In Section 4.2, we saw that the definite integral is thelimit of the finite Riemann sums as Δ*x*→0+:
____*f(x) dx*=________*f(x)*__*x.*
TheRiemann sum, which is a sum of areas of rectangles, is a ratherinefficient approximation of the definite
 integral. We can usuallyget a much closer approximation with the same amount of work byadding up areas of trapezoids instead of rectangles, forming theTrapezoidal Rule suggested by Figure 4.6.1. The Trapezoidal Rule alsoprovides a formula, called an error
 estimate, which tells us howclose the approximation is to the exact value of the definiteintegral.
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0058.png)![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0059.png)
Figure4.6.1
Choosea positive integer
*n*anddivide the interval [*a, b*]into
*n*subintervalsof equal length Δx= (*b - a*)/*n*.The
 partition points are *a*=*x0*,*x1*,*x2*…,*xn*=*b.*
Thetrapezoidal approximation is the area of the region under the brokenline connecting the points
(*x0*,*f*(*x0*)),(*x1*,*f*(*x1*)),…,
 (*xn*,*f*(*xn*)).
Sinceall of these points lie on the curve
*y= f(x)*,the broken line closely follows the curve. So one would expect thearea of the region under the broken line to closely approximate thearea under the curve.
Considera single subinterval [
*xm , xm+*1]of width Δx.The region under the line segment connecting the two points
(*xm*,*f*(*xm*)),    (*xm+1*,*f*(*xm+1*))
isa trapezoid and its area is
*F(xm)+ f(xm+*1*)*
_____________  Δ*x*.
2 
Thesum of the areas of the trapezoids is a modified Riemann sum
Wethus make the definition:
DEFINITION
*Let*Δ*x= (b-a)/ n evenly divide b-a. Then by the trapezoidalapproximation to the definite integral**__**f(x) dx we mean the sum*
TheTrapezoidal Approximation of an integral
__*f(x)dx*canbe computed very efficiently on most hand calculators. First computethe sum
Bycumulative addition. Then multiply this sum by Δ*x*toobtain the Trapezoidal Approximation.
THEOREM1
*Fora continuous function f on [a, b], the trapezoidal approximationapproaches the definite integral as*Δ*x*→
0*+,that is,*
PROOF  Comparing the formulas for the trapezoidal approximation and theRiemann
sum, wesee that
For*dx*positiveinfinitesimal, the extra term
isinfinitely small. It follows that
Froma practical standpoint, it is desirable to have a good estimate oferror. We shall first work an example
 and then state a theorem whichgives an error estimate for the trapezoidal approximation.
EXAMPLE1   Approximate the definite integral
Usethe trapezoidal approximation with Δx =
___.We first make a table
 of 
valuesof
______.The graph is drawn
 in Figure 4.6.2.
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0060.png)
Figure4.6.2
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0061.png)
Thus,__*f*(*x*0)+
*f*(*x*1)+*f*(*x*2)+
*f*(*x*3)+
*f*(*x*4)+
___*f*(*x*5)=
 5.7507. 
SinceΔ*x*=__,the
 trapezoidal approximation is 
( 5.7507)·_____=1.1501,
______dx~
 1.1501.
Thetrapezoidal approximation can be made as close to the definiteintegral
 as we want by taking Δ*x*small.From a practical standpoint, however, it is helpful to know how smallwe should take Δ*x*inorder to be sure of a given degree of accuracy. For instance, supposewe need to know the definite integral to three decimal places.
 Howsmall must we take Δ*x*inour trapezoidal approximation? The answer is given by the TrapezoidalRule, which gives an error estimate
 for the trapezoidalapproximation.
Theerror in the trapezoidal approximation is the absolute value of thedifference between the trapezoidal sum
 and the definite integral,
*Anerror estimate for the trapezoidal approximation is a function E(Δx).Which is known to be greater than or equal to the error.*
Thusif E(Δx)is an error estimate, the trapezoidal sum is within E(Δx)of the
 definite integral. If we want to be sure that the trapezoidalapproximation is accurate to three decimal places -i.e., the error isless than 0.0005 - we choose Δ*x*sothat E(Δx)≤0.0005.We are now ready to state the Trapezoidal Rule.
TRAPEZOIDAL RULE
*Letf be a function whose second derivative f '' exists and hasabsolute value at most M on a closed interval [ a, b],*
|*f ''(x)*|≤*M  for a*≤*x*≤*b*.
IfΔ*x*evenlydivides
*b-a*,then the trapezoidal approximation of the definite integral of
*f*hasthe error estimate
Thatis,
Theproof is omitted.
EXAMPLE1 (Concluded)  We let
*f(x)*=_______. Then
Therefore|*f'' (x)*|≤
1for all x in [0,1]. We take
*M*=1 and use the error
estimategiven by the Trapezoidal Rule,
Thusour approximation is within an accuracy of 1/300,
Thisshows that the integral is, at least, between 1.146 and 1.154.
Inthis particular example we can even conclude that the integral isbetween 1.146 and 1.150 (rounded off to three
 places). That is, theintegral is less than its trapezoidal approximation. This is becausethe second derivative*f '' (x) = (*1*+x²)*-3/2isalways greater than 0, whence the curve is concave upwards andtherefore
*y = f(x)*isalways less than or equal to the broken line used in the trapezoidalapproximation. Actually, the value to three places
 is 1.148. This canbe found by taking Δx=____.
EXAMPLE2  Consider the integral
Let                  *f(x)*=_____________
ByTheorem 1, we have
However,the Trapezoidal Rule fails to give an error estimate in this case
Because*f '(x)*isdiscontinuous at
*x *=__1.
Wenow turn to Simpson’sRule,
 for which the number of subintervals *n*mustbe even. As before, we divide the interval [*a, b*]into
*n*subintervalsof equal length Δx with the*n*+1 partition points
*a*=*x*0,*x*1,…*x*n=*b*.
Weshall use subintervals of length 2 Δxrather
 than Δx.On each of the*n*/2subintervals
[*x*0,*x*2],[
*x*2,*x*4],…[
*xn*-2,*xn*],
oflength 2 Δ*x*weapproximate
 the curve *y = f(x) *bya parabolic arc that meets the curve at both endpoints and themidpoint of the subinterval, as shown in Figures 4.6.3. We then addup the areas under
 each of the parabolic arcs to obtain anapproximation to the area under the curve, which is the definiteintegral. We begin with a lemma that gives a formula for the area ofthe region under one parabolic arc.
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0062.png)

Figure4.6.3
LEMMA
*Thearea of the region under the parabola through three points (u, r), (u+ h, s),*
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0063.png)*and(u+2h, t) (shown in Figure 4.6.4) is*
Figure4.6.4
____(*r+*4*s+t*).
Thelemma is proved at the end of this section. Using the lemma,
 we findthat the area of the region under one parabolic arc from *xk*to*xk+2*is
______[*f(xk*)+
 4*f*(*xk+1*)+
*f*(x*k+2*)].
Itfollows that the sum of the n/2 regions under the parabolic arcs is amodified Riemann sum,
Thismodified Riemann sum is Simpson’sapproximation
 to the definite integral. Note the sequence ofcoefficients,
1, 4,2, 4, 2…2, 4, 1.
Likethe trapezoidal approximation, it is easily computed on a computer orhand calculator.
THEOREM2
*Fora continuous function f on [ a, b] , Simpson*’*s approximationapproaches the definite integral as*Δ*x*→0*+,*
Simpson’sapproximation
 is almost as easy to calculate as the trapezoidalapproximation, but is much more accurate. Simpson’sRule is an error estimate that involves
 the forth derivative of thefunction and the fourth power of Δ*x*.
SIMPSON’S RULE
Supposethe function
*f*hasa fourth derivative on the interval [*a, b*]that
 has absolute value at most M,
|*f*(4)(*x*)|≤
*M for a *≤ *x *≤ *b.*
*If[a, b] is divided into an even number of subintervals of length Δx,then*
*Simpson*’*sapproximation to the definite integral has the error estimate*
EXAMPLE3UseSimpson’sRule with Δx = 0.25 to approximate the integral
andfind the error estimate.
Thecurve is the normal (bell- shaped ) curve used in statistics, shownin Figure 4.6.5.
Weare to divide the interval [ 0,1] into four subintervals of equallength
 Δx= 0.25. The following table shows the values of
*x*and*y*andthe coefficient to be used in Simpson’sapproximation for each
 partition point.
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0064.png)
Figure4.6.5  Example 3
![](http://netdisk0.mail.sina.com.cn/object/99/ce9964d0624a80cbeee0f99a0a7ecdb2.files/file0065.png)
Thesum used in the Simpson approximation is then
[1.000000 + 4·(0.969233) +2·(0.882496) + 4·(0.754840) + 0.606531]
=10.267816
Toget the Simpson approximation, we multiply this sum by Δx/3:
S =(10.267816) ·(0.25) /3 = 0.855651.
Tofind the error estimate we need the fourth derivative of
*y= e -x²/*2.
Thefourth derivative can be computed as usual and turns out to be
*y*(4)*=*(*x*4*-*6*x*2*+*3)*e -x²/*2.
Onthe interval [ 0, 1], 
*y*(4)isdecreasing because both 
*x*4*-*6*x*2*+*3and
 -*x*2/2are decreasing, and therefore
*y*(4)hasits maximum value at
*x*=0 and its minimum value at 
*x *=1,
maximum:     *y*(4)(0)=3
minimum:    *y*(4)(1)=
 -1.213061
Themaximum value of the absolute value |*y*(4)|isthus
*M*=3. The error estimate in Simpson’sRule
 is then
Thisshows that the integral is within 0.000065 of the approximation; thatis,
_______*e -x²/*2dx=0.855651___0.000065,
Orusing inequalities,
0.855586 ≤____*e-x²/*2*dx*≤
0.855716.
Forcomparison, a more accurate computation with a smaller Δ*x*showsthat the actual value to six places is
____*e-x²/*2*dx=*0.855624.
TheTrapezoidal Rule for this integral and the same value of Δ*x = *0.25give an approximate value of 0.85246 for the integral and an errorestimate of 0.00521.
*PROOFOF THE LEMMA*Thealgebra is simpler if the
*y*-axisis drawn through the second point, so that
*u+ h*=0, and the three points have coordinates
*(-h, r), (*0*,s), ( h, t).*
Supposethe parabola has the equation
*y = ax² + bx +c.*Thenthe area under the parabola is
*A*=__(*ax²+ bx + c*)*dx*
= ________
= ______*ah3*+2*ch*.
Whenwe substitute the coordinates of the three points ( -*h,r*),(0,
*s*),(*h, t*)
intothe equation for the parabola, we obtain the three equations
*r= ah² - bh + c.*
*s =c,*
*t =ah2 +bh +c.*
Addthe first and third equations and solve for a:
r +t
 = 2ah²+2c
a= ________
Finally,substitute the above expression for
*a*and*s*for*c*inthe equation for the area:
A =___*ah3*+2*ch*
=_________+2*ch*
*= *__________*·h*
=____(r
 + 4c + t).
= ____(r
 + 4s +t).
PROBLEMSFOR SECTION  4.6
Approximatethe integrals in Problems 1-20 using (a) the Trapezoidal
 Rule and (b)Simpson’sRule. When possible, find error estimates. If a hand calculator isavailable, do the problems again with Δx=
 0.1.
1___*xdx*, Δ*x =*0.5                  2
___*x*3*dx*,Δ*x*=0.5
5______*dx*, Δ*x =*0.25               4______*dx*, Δ*x = *0.5
7___________*dx*, Δ*x =*0.5           8_________*dx*, Δ*x =*____
9___________*dx*, Δ*x =*___ 10________*dx*, Δ*x = *0.5
11__________*dx*, Δ*x =*1             12_________*dx*, Δ*x = *2
13__________*dx*, Δ*x = *314__________*dx*, Δ*x = *1
15____________ 
16__________
17____ex*dx*,  Δ*x*=_____                 18 ____ex²*dx*,  Δ*x*=_____
19_____1n*x dx*,Δ*x*=_____                  20____1n*(1/x) dx*,Δ*x*=_____   
□21let
*f*becontinuous on the interval [*a,b*]and
 let Δ*x*=(*b-a*)/*n*where*n*isa positive integer. Prove that the trapezoidal sum is equal to theRiemann sum plus
__(f(b)- f(a)) Δx, that is ,
Showthat if f*(a) = f(b)*thenthe
 trapezoidal sum and Riemann sum are equal.
□22Prove that for a linear
 function *f(x) = kx+c*,the trapezoidal sum is exactly equal to the integral.
□23Show that if
*f(x)*isconcave downward, 
*f ''(x)*>0,then the trapezoidal sum is less than the definite integral of
*f(x)*.
□24Show that for a quadratic
 function *f(x)=ax2 +bx +c*,Simpson’sapproximation
 is equal to the definite integral. 
□25show that for a cubic
 function *f(x)=ax3 +bx2+cx +d*,Simpson’sapproximation
 is still equal to the definite integral. 
EXTRA PROBLEMS  FOR  CHAPTER 4
1Evaluate
_______Δ*x*,  Δ*x = *1/4
2Evaluate
_______Δ*x*,  Δ*x = 2*
3Evaluate
_______Δ*x*,  Δ*x = *1
4Evaluate_______Δ*x*,  Δ*x = *1/2
5If
*F *'(*x*)= 1/(2*x*-1)²forall
*x *≠1/2,find*F*(2)-*F*(1).
6If
*G *'(*t*)=
___________forall
*t *>-1/4,find*G*(2)-*G*(0).
7A particle moves with velocity
*v*=(3+2___)².How
 far does it move from times*t*0=1to*t*1=5?
8Aparticle moves with velocity
*v*=__________.Howfar
 does it move from times*t*0=1to*t*1=4?
9A particle moves with velocity
*v*=(*t*+1)(2*t*+3).If
 it has position *y*0=0at time
*t*=0,find its position at time
*t*=10.
10Aparticle moves with acceleration a = 1/*t*4.If
 it has velocity *v*0=4and position
*y*0=2at time
*t*=1,find its position at time*t*=3.
11Find the area of the region under the curve
*y*=1/___,1
 ≤ *x*≤ 4.
12Find the area of the region under the curve
*y*=____,0
 ≤ *x*≤ 1.
In Problems13-30, evaluate the integral.
13∫
(1*-x*)(2*+*3*x*)*dx                   *14 ∫
(2+____)(2-___)*dx*
15 ∫______*dx                    *16 ∫(4*x*+1)1/3*dx*
17 ∫(u/_____)*du                    *18 ∫*x*-2______*dx*
*19  *∫(_______)*dt                *20 ∫
_______*dx*
*21 *∫
*y*_______*dy                  *21 ∫
(1-___)-4*dx*
23 ∫
cos(__)*dx                  *24 ∫
___sin___*dx*
25 ∫
*e-tdt                       *26 ∫*_______**dt*
27 ________*dy                    *28____________*dx*
*29    **_____**e4xdx                           *30____*x*sin(*x*²)*dx*
31Differentiate___                       32Differentiate___(*t*²/*t*²-1))*dt*
*33     *Differentiate_______*dx                 *34Differentiate___(1/(x+_____))*dx*
*35   *Findthe function
*F*suchthat
*F'*(*x*)=
*x -*1forall
*x, *andthe minimum valueof*F*(x)is
*b*.
36   Find the function
*F*suchthat
*F''*(*x*)=
*x *forall
*x, F*(0)=1*, and F*(1)*=1*
37   Find the function
*F*suchthat
*F''*(*x*)= 6 for all
*x*,*F*(*x*)has
 a minimum at *x *=1,and the 
minimum valueis 2.
38   Find all functions
*F*suchthat
*F''*(*x*)= 1 +
*x*-3forall positive
*x*.
□39 Find the functions
*F*suchthat                                     
and*F*(0)=1.
□40 Find the value of
*b*suchthat the area of the region under the curve
*y=x(b-x)*,
0≤x≤
b,is1.
□41 Suppose
*f*isincreasing for
*a*≤ *x*≤
*b*,andΔ*x*=(*b-a*)/*n*where*n*isa positive integer.
Showthat
□42 Suppose
*f*iscontinuous for*a *≤*x *≤*b*.Showthat
□43 Find the area of the
 top half of the ellipse x²/a²+y²/b²=1using the formula
π=________*du.*
□44 Evaluate __ (1-x)3/2(1+x)1/2*dx*usingthe formula π=________*du.*
□45 Find
*dy/dx*if*y*=__*xf(t)dt*.
□46 Suppose
*f(t)*iscontinuous for all*t*andlet
*G(x) *=__(*x- t*)*f(t) dt*.
Prove that*G''(x) = f(x).*
□47 Prove that for any
 continuous functions *f *and*g*,
□48 Prove Schwartz'Inequality,
____*f(x) g(x) dx*≤________.
Hint: Usethe preceding problem.
□49 Suppose*f *iscontinuous and
*dx *ispositive infinitesimal. Show that
____f(x+__dx)dx
≈ ____*f(x)dx*.
Hint: foreach positive real c,
*F(x)- c*<*f*(*x*+__
*dx*)<*f*(*x*)+
*c*.
Use thisto show that
___*f(x)dx*-*c(b - a)*<___*f*(*x*+____*dx*)*dx*<__*f(x) dx *+*c(b-a)*.
□50 Suppose*f *iscontinuous,
*n*isan integer, and
*dx*ispositive infinitesimal. Prove that
____*f*(*x*+*ndx*)*dx*
 ≈___*f(x)dx*.


