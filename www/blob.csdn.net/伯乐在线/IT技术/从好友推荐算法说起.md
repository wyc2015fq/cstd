# 从好友推荐算法说起 - 文章 - 伯乐在线
原文出处： [kung](https://zhuanlan.zhihu.com/p/20533434)
社交网络中，好友推荐随处可见，这里探讨好友推荐是如何做的。
### 1、三元闭包理论
说到好友推荐，就不得不谈三元闭包理论。
三元闭包定义：在一个社交圈内，若两个人有一个共同好友，则这两个人在未来成为好友的可能性就会提高。
举例说明，若B、C有一个共同好友A，且B、C不认识，则B、C成为好友的几率会增加
这个理论直观自然，可以从机会、信任、动机上来解释：
- 1、B、C是A的朋友，那么B、C见面的机会会增加，如果A花时间和B、C相处，那么B、C可能会因此有机会认识
- 2、在友谊形成过程中，基于B、C都是A好友的事实，假定B、C都知道这点，这会为他们提供陌生人之间所缺乏的基本信任
- 3、A有将B、C撮合为好友的动机：如果B、C不是朋友，可能会为A和B、C的友谊造成潜在的压力两个人共同好友的多少决定这两个人关系的强弱，基于共同好友的多少，就可以进行好友推荐。
**1）共同好友数**
![1](http://jbcdn2.b0.upaiyun.com/2016/08/28c8edde3d61a0411511d3b1866f0636.png)
 其中，Neighbor(i)表示i的好友，也就是网络拓扑上的邻居节点
通过对共同好友数排序，即可产生一个好友推荐列表。
**2）对双方好友数加权**
为消除双方好友数差距，可以除以双方好友数进行加权，也就是杰卡德系数，计算公式如下：
![2](http://jbcdn2.b0.upaiyun.com/2016/08/665f644e43731ff9db3d341da5c827e1.png)
**3）对共同好友加权**
在1）2）中，相当于对每个共同好友一视同仁，都贡献1分，但是共同好友中，有些人好友多，有些好友少，当某个共同好友的好友数较少时，这个共同好友应该更加重要，所以可以通过除以每个共同好友的好友数进行加权。
![3](http://jbcdn2.b0.upaiyun.com/2016/08/38026ed22fc1a91d92b5d2ef93540f20.png)
上式中，通过除以每个共同好友的好友数进行加权，如果好友数相差过大，需要通过开方、对数等方式进行处理，如下：
![4](http://jbcdn2.b0.upaiyun.com/2016/08/011ecee7d295c066ae68d4396215c3d0.png)
![5](http://jbcdn2.b0.upaiyun.com/2016/08/4e44f1ac85cd60e3caa56bfd4afb675e.png)
下面是y=*x*，y= *x^0.5*，y=log2x 的曲线：
![6](http://jbcdn2.b0.upaiyun.com/2016/08/3d2f8900f2e49c02b481c2f717aa9020.png)
可以看出，使用开方、对数都可以有效消除差值过大的影响。
### 2、Facebook
Facebook的数据表明：好友关系建立中，拥有10个共同好友是只有1个共同好友的12倍。
![7](http://jbcdn2.b0.upaiyun.com/2016/08/cd7fd1517e323f26c6f1b0b6b96e3b3d.png)
Facebook在共同好友的基础上，加入了时间维度；
基于一个假设：用户对新添加的好友更感兴趣。如图：f1和f2是用户u的好友，相对于很久之前添加的好友f2，f1是近期添加，用户对f1近期添加的好友更感兴趣。
![8](http://jbcdn2.b0.upaiyun.com/2016/08/815e6212def15fe76ed27cec7a393d59.png)
基于这样的假设，Facebook出了一个经验公式，如下：
![9](http://jbcdn2.b0.upaiyun.com/2016/08/4c0d13d3ad6cc317017872e51d01b238.png)
从这个公式可以看到，对比对共同好友加权的公式，增加了时间特征：
![10](http://jbcdn2.b0.upaiyun.com/2016/08/8d8e353b98d5191d5ceea1aa3eb05d43.png)
时间相差越大，权重越小。其中，δ u,*fi* 为u与fi建立好友关系的时间， δ fi,fof 为fi与fof建立好友关系的时间，-0.3为惩罚因子，是Facebook的一个经验参数，需要根据具体情况进行调整。
下面是x^a的图，可以直观感受下衰减的程度：
![11](http://jbcdn2.b0.upaiyun.com/2016/08/7bfc85c0d74ff05806e0b5a0fa0c1df1.png)
根据这个经验公式能直接计算出好友推荐的得分，也可以作为一维特征与其他特征一起做回归。
### 3、其他
一般情况下，使用二度好友（好友的好友）作为推荐的候选集。
假设平均每人有150个好友，差不多有22500个二度好友，数据量基本满足推荐候选集的需求，并且数据表明，绝大部分（92%左右）的好友关系都建立在二度空间。
基于三元闭包理论进行好友推荐，推荐的用户至少有一个共同好友，也变相的确定使用二度好友进行推荐。
暂时先这样，有时间继续写关于推荐系统相关的内容。
