# 漫画：如何用脚本抢月饼？ - 文章 - 伯乐在线
本文作者： [伯乐在线](http://blog.jobbole.com) - [玻璃猫](http://www.jobbole.com/members/bjweimengshu) 。未经作者许可，禁止转载！
欢迎加入伯乐在线 [专栏作者](http://blog.jobbole.com/99322)。
中秋节前夕，公司为内部员工提供了在线抢月饼的活动……
![%e6%9c%88%e9%a5%bc](http://jbcdn2.b0.upaiyun.com/2016/10/acdbec7038b931615b4bbb0adabf5cb4.jpg)
公司里，恰好有一位调皮的程序员……
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%95](http://jbcdn2.b0.upaiyun.com/2016/10/c4169761b31b005cc8b2f53d08d6fef4.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%952](http://jbcdn2.b0.upaiyun.com/2016/10/716d7d8591ffd906f8034b0b28d8e9b5.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%953](http://jbcdn2.b0.upaiyun.com/2016/10/84b6623ca39dada822871cf7b0c9862d.jpg)
随后，这位调皮的员工埋头研究了一下下……
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%954](http://jbcdn2.b0.upaiyun.com/2016/10/9a16fd858c2d9ad92631360585ce9d01.jpg)
很快就到了抢月饼活动开始的时间，脚本的效果出人意料的好……
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%955](http://jbcdn2.b0.upaiyun.com/2016/10/403f6feae8afa99cd521daeaf67be964.jpg)
可是，事情已经没那么简单了。很快，员工被叫去约谈……
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%956](http://jbcdn2.b0.upaiyun.com/2016/10/467220befa880843f9631b71200dc926.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%957](http://jbcdn2.b0.upaiyun.com/2016/10/7a245cb7d57cd8ac74043c0ed78d978e.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e7%be%a1%e6%85%959](http://jbcdn2.b0.upaiyun.com/2016/10/3b97949cbe137582b8b86ccdd902d5fe.jpg)
这位调皮员工的经历被传到网上，引起了很多人的关注。小灰和同学之间也在饶有兴致地谈论这件事……
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%841](http://jbcdn2.b0.upaiyun.com/2016/10/7387a1536e5e60d3e3a5cb503052e512.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%842](http://jbcdn2.b0.upaiyun.com/2016/10/b06c4acd2a4a33224cf2c8a5e8a8b1c4.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%843](http://jbcdn2.b0.upaiyun.com/2016/10/eef0b7085d8ce677484607f036cae274.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%844](http://jbcdn2.b0.upaiyun.com/2016/10/470bc1788f645802b7d1057e91474603.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%845](http://jbcdn2.b0.upaiyun.com/2016/10/efde1ecca64ab8814c633230f8889f04.jpg)
首先，让我们来模拟一下当时的内部员工抢月饼活动页面。当然，真正的活动页面肯定不会这么简单，在此只是做个简化的示例：
![%e6%8a%a2%e6%9c%88%e9%a5%bc%e9%a1%b5%e9%9d%a2](http://jbcdn2.b0.upaiyun.com/2016/10/6a376b9472e70c44e98cc0cfdd74c06c.jpg)
页面的HTML代码如下：
![%e9%a1%b5%e9%9d%a2%e4%bb%a3%e7%a0%81](http://jbcdn2.b0.upaiyun.com/2016/10/d4eb76d48778c8b54df381a70fd9d62f.jpg)
如何每隔一段时间让抢购按钮自动被点击呢？很简单，原生Javascript当中有一个定时器函数 setInterval，该函数有两个参数，第一个参数是想要执行的回调函数（在这里就是触发按钮点击事件的语句），第二个参数是触发执行的间隔时间（单位毫秒）。
因此，抢月饼脚本简单的实现如下：
![%e8%84%9a%e6%9c%ac%e4%bb%a3%e7%a0%81](http://jbcdn2.b0.upaiyun.com/2016/10/7f1befa5281d4d8f411bb8ba3215526a.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%846](http://jbcdn2.b0.upaiyun.com/2016/10/f8599be414b8f397dc9ad82475d51115.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%847](http://jbcdn2.b0.upaiyun.com/2016/10/2fc7a9132420a5ff9e21934d79c5436c.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%848](http://jbcdn2.b0.upaiyun.com/2016/10/683ea9b83d6804a6441ab9e2b529aba4.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%849](http://jbcdn2.b0.upaiyun.com/2016/10/2702233bc0de376fa5064e9251248741.jpg)
如何在页面中嵌入自己写的Javascript脚本呢？下面分别介绍一下在Chrome和Firefox两种浏览器上的操作步骤：
**Chrome：**
1. 打开chrome扩展程序页 – chrome://extensions
2. 将刚才的自定义脚本保存为以user.js为后缀的 .js文件，例如test.user.js，拖入扩展程序页。
3. 重启浏览器。
4. 进入月饼抢购活动页面。此时脚本已自动执行。
![chrome](http://jbcdn2.b0.upaiyun.com/2016/10/5f55b25a074a7b97d16bd8e2669f1009.jpg)
**FireFox：**
1. 下载并安装用户脚本管理插件 **greasemonkey **（中文翻译成“油猴子”）。
2. 重启浏览器。
3. 将刚才的自定义脚本保存为 .js文件，例如test.user.js，拖入页面空白处。
4. 进入月饼抢购活动页面。此时脚本已自动执行。
![firefox](http://jbcdn2.b0.upaiyun.com/2016/10/ce452e0ccf937be381c503342e7db62b.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8410](http://jbcdn2.b0.upaiyun.com/2016/10/9679f7959d05667452e87f0b3787843c.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8411](http://jbcdn2.b0.upaiyun.com/2016/10/18816fef05d8ca4a978ed913a4251128.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8412](http://jbcdn2.b0.upaiyun.com/2016/10/1ee069215dac5c12b8bd2673ebdce7fd.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8413](http://jbcdn2.b0.upaiyun.com/2016/10/751de255bd514be213d3a5f1ff1334f8.jpg)
**关于验证码：**
在一般的网页中，为了防刷，都会在提交请求之前让用户输入动态的验证码：
![%e9%aa%8c%e8%af%81%e7%a0%81](http://jbcdn2.b0.upaiyun.com/2016/10/7bed6ea4f595d5195841e2f27845f927.jpg)
动态验证码有效防止了绝大多数JS脚本的自动提交行为。如果它的干扰线和扭曲效果实现得足够好，即使用OCR图像文字识别技术也很难破解。动态验证码的生成和验证流程如下：
![%e9%aa%8c%e8%af%81%e7%a0%81%e6%b5%81%e7%a8%8b1](http://jbcdn2.b0.upaiyun.com/2016/10/c910e3ce3b9f0d5d3c83d99901351762.jpg)
由于每次看到的抢购页面里的验证码都不相同，所以很难用自动化脚本攻克。可是，如果抢购页面的开发人员偷懒，只是在抢购页面里引用了固定不变的验证码图片，那么请求和验证流程就变成了下面的样子：
![%e9%aa%8c%e8%af%81%e7%a0%81%e6%b5%81%e7%a8%8b2](http://jbcdn2.b0.upaiyun.com/2016/10/749ee853ad71a7a8259871f5c0797c1d.jpg)
这样一来，只要知道静态的验证码是什么，脚本就可以轻松填写正确的验证码。
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8415](http://jbcdn2.b0.upaiyun.com/2016/10/2ca6510c1dc8925b404a07a8c6524d9c.jpg)
![%e5%b0%8f%e4%bb%93%e9%bc%a0%e5%af%92%e6%9a%8416](http://jbcdn2.b0.upaiyun.com/2016/10/33b4e33f2e7fb9856fbe3b7c40e91fcd.jpg)
> 
**打赏支持我写出更多好文章，谢谢！**
[打赏作者](#rewardbox)
#### 打赏支持我写出更多好文章，谢谢！
![](http://jbcdn2.b0.upaiyun.com/2016/10/2df4a3ede6e684f78858dfde0e7b118f.jpeg)
