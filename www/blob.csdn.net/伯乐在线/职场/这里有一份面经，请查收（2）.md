# 这里有一份面经，请查收（2） - 文章 - 伯乐在线
本文作者： [伯乐在线](http://blog.jobbole.com) - [朱小厮](http://www.jobbole.com/members/hidden) 。未经作者许可，禁止转载！
欢迎加入伯乐在线 [专栏作者](http://blog.jobbole.com/99322)。
这里讲述下第二家公司的面试，这是一家大型互联网公司，简称W，一般像博主这样的传统行业去跳到这种公司简直是要跪舔的节奏，所以从一开始就带着一份敬仰之情去面试。由于和博主不在一个城市，所以一面选择电面，二三面技术面去了公司face to face, 最后一面是HR面。这里HR面就略过，只讲述技术类相关的问题。
### **一面**
一面约好14:00，果然14:00就来电话了，这点可以看出管理上还是很厉害的。
1.linux下怎么查看文件内容？
如果看过前面一篇的小伙伴是不是已经知道答案了：cat tac more less head tail nl vi vim gvim
2.消息队列用什么作用？
博主只知道解耦，或者可以当数据冗余只用。后来查阅了一下，原来消息队列有这么多功效：解耦、容易、扩展性（增大消息入队和处理的频率是很容易的）、灵活性和峰值处理能力、排序、缓冲、送达保证（消息队列提供的冗余机制保证了消息能够被实际的处理，只要一个进程读取了该队列即可）；异步通讯。
3.设计模式：说说一些常用的设计模式。
设计模式23种，分为创建型、组合型、行为型。
说了一些常用的：单例，适配器，工厂，装饰等。然后被问了一个问题：Java中的IO包含了那些设计模式？博主记不清是不是这家公司的面试题，姑且就算作是吧。拒博主所知，Java中的IO用了两种设计模式，装饰模式和适配器模式，装饰模式比如BufferedInputStream, DataInputStream; 适配器的有InputStreamReader, OutputStreamWriter。
4.SpringMVC的分发过程？
具体指DispatcherServlet怎么运作的原理图，可以参考《[Spring知识点提炼](http://blog.csdn.net/u013256816/article/details/51386182#t34)》，包括二面也让我画了一个这个图。
5.Spring AOP和IOC的实现原理？ 分别是动态代理和反射
6.多线程的应用场景。这个就仁者见仁，智者见智随意聊咯。
7.对着简历问一下项目相关的知识点。在此就不表了。
### **二面和三面**
二面和三面是face2face的。二面问了写Java基础。
1.线程池
就是ThreadPoolExecuotr，里面的各个参数解释一遍，包括什么饱和策略。然后工具类Executors中有哪些方法，包括：newFixedThreadPool, newSingleThreadExecutor, new CachedThreadPool以及Scheduled系列。
2.简述下JVM。
这个是个开放性的问题，考验你对JVM整体的理解。从Javac讲述到GC：
首先通过IDE编写完java程序之后，就要javac来编译成class文件，分为：词法分析，语法分析，语义分析，代码生成是个阶段，在语义分析阶段又可以分为：填充符号表、标注检查、数据流分析和控制流分析。标注检查比如定义int a=1+2，在这个阶段就会被解析成int a=3; 又比如在控制流分析阶段又去除语法糖的动作，类似foreach的解语法糖等。
其次，编译生成class文件之后，就需要JVM加载。加载涉及到一个双亲委派模型，需要对双亲委派模型进行一下论述，以及为什么需要双亲委派模型（为了安全加载）。
类在加载之后就需要涉及验证-准备-解析-初始化的操作。
验证：目的是为了确保Class文件的字节流中包含的信息符合当前虚拟机的要求，并且不会危害虚拟机自身的安全。比如是否以魔数0xCAFEBABE开头。
准备：正式为类变量分配内存并设置类变量初始值的阶段。譬如public static int value=123;这时候赋值value为0.
解析：虚拟机将常量池内的符号引用转换为直接引用的过程。
初始化：这个阶段在上一篇讲过了，一定要突出这个知识点：虚拟机规范严格规定了有且只有5种情况（JDK7）必须对类进行初始化(执行类构造器()方法):
- 遇到new,getstatic,putstatic,invokestatic这失调字节码指令时，如果类没有进行过初始化，则需要先触发其初始化。生成这4条指令的最常见的Java代码场景是：使用new关键字实例化对象的时候、读取或设置一个类的静态字段（被final修饰、已在编译器把结果放入常量池的静态字段除外）的时候，以及调用一个类的静态方法的时候。
- 使用java.lang.reflect包的方法对类进行反射调用的时候，如果类没有进行过初始化，则需要先触发其初始化。
- 当初始化一个类的时候，如果发现其父类还没有进行过初始化，则需要先触发其父类的初始化。
- 当虚拟机启动时，用户需要指定一个要执行的主类（包含main()方法的那个类），虚拟机会先初始化这个主类。
- 当使用jdk1.7动态语言支持时，如果一个java.lang.invoke.MethodHandle实例最后的解析结果REF_getstatic,REF_putstatic,REF_invokeStatic的方法句柄，并且这个方法句柄所对应的类没有进行初始化，则需要先出触发其初始化。
初始化之后就可以使用了，加载的类信息存入了运行时数据区的方法区，也就是俗称的永久代。运行时数据区分为：java堆，java栈，本地方法栈，方法区，pc寄存器。然后简单叙述下这些概念。
new一个对象需要在java堆中开辟内存，使用完之后就需要垃圾回收操作了，接下去要将GC了。
以Hot spot为例，java堆分为年轻代和老年代。通过GC Roots标记不可达内存对象进行回收处理。GC算法有：Mark-Sweep, Copying, Mark-Compact, 分代。接下去就论述垃圾收集器了。年轻代有Serial, ParNew, Parallel Scavenge等都是采用复制算法。
老年代有Serial-Old, Parallel-Old, CMS。还有一个G1收集器。一般互联网公司喜欢采用CMS，然后就论述了一下CMS，CMS分为5个部分：初始标记，并发标记，重新标记，并发清除和并发重置，其中初始标记和重新标记是需要Stop the World的。CMS还有一个概念就是Concurrent Mode Failure，发生之后需要来一记Serial-Old的干活。
这个过程其实蛮长的，大概论述了将近20mins左右。
3.写出策略模式的UML图。
可以参考《[设计模式：适配器模式（Adapter）](http://blog.csdn.net/u013256816/article/details/51000290)》
4.你对Java集合了解的怎么样？
博主说Java集合的源码都看过，意思是随便问，然后被问了一个特别冷门的问题，这个问题在上一篇提及过，是Collections.sort()中使用了什么排序算法。幸亏博主看过，不要就要被活生生的打脸了。答案是：加强型归并排序，ComparableTimSort.（这里不只是有归并，还有其他算法，详细需要慢慢琢磨源码~）
这里还是强调一下冷知识的重要性，一般特别偏的知识都知道的话，其他的知识其实是默认掌握了的。博主这里在讲几个冷知识：
- ThreadLocal什么情况下会发生内存泄露？(一个朋友也是在这家公司被问过这个问题)（线程池）
- WeakHashMap会发生内存泄露嚒？（key==null）
- Doug Lea在写JUC的时候为什么喜欢使用for(;;)表示死循环而不是用while(true)？（情怀）
- JDK中除了IO使用了装饰模式，其他什么地方还使用了装饰模式？（Collections.synchonizedMap, unchecked系列以及unmodifiable系列）
> 
for(;;)和while(true)的区别大致有以下几种论述（仅供参考，博主更偏向于的说法是“情怀”）
1. 大多数时候开启优化两者之间性能没有什么区别。
2. while(true)比for(;;)编译后的指令多。
3. while(true)每次编译器都要判断一下true
4. for(;;)比while(true)敲的字符数更少
5.三面是部门领导，问了点项目相关的技术。这个具有特殊性所以就不表了。
### 总结
这份工作是猎头找我的，我看到W公司的名字欣然say: I wanna have a try. 但是后来一面完了之后，我也不知道我面的岗位是哪个。后来三面了才知道是做BI的，其是对这个工作不排斥也不喜欢。后来拿到offer也拒了，除了薪资低于预期之外，还有一个博主觉得很重要的一个东西，博主站在W公司门口，包括在W公司边上转了一圈，I feel a bit homeless, 毕竟在这个城市认识的人可以用一只手数的过来，而且都在城市的另一边。
感觉如果进了这家公司，每天只能像machine一样活着。毕竟这家公司出了名的996机制。W公司是博主面完的第一家公司，但是博主当时一共投了8家（有2家一面面完就不想去了。。。）一面都过了，让我去面试，所以在自信心上有所增强，觉得自己没有必要去跪舔了，有实力去find a better job，所以在收到offer之时就拒了。
更多链接请关注：
[这里有一份面经，请查收（1）](http://blog.jobbole.com/103105/)
[这里有一份面经，请查收（2）](http://blog.jobbole.com/103771/)
参考资料
1. [设计模式：开篇](http://blog.csdn.net/u013256816/article/details/50966823)
2. [Spring知识点提炼](http://blog.csdn.net/u013256816/article/details/51386182#t34)
3. [设计模式：适配器模式（Adapter）](http://blog.csdn.net/u013256816/article/details/51000290)
> 
**打赏支持我写出更多好文章，谢谢！**
[打赏作者](#rewardbox)
#### 打赏支持我写出更多好文章，谢谢！
任选一种支付方式
![](http://www.jobbole.com/wp-content/uploads/2016/04/79b4de7cf79777bf4af9e213ede350af1.jpg)![](http://www.jobbole.com/wp-content/uploads/2016/04/777a22cd1f6234a769d5edde0d0356c5.jpg)
