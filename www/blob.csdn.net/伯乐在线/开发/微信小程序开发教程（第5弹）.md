# 微信小程序开发教程（第5弹） - 文章 - 伯乐在线
本文作者： [伯乐在线](http://blog.jobbole.com) - [博卡君](http://www.jobbole.com/members/bokajun) 。未经作者许可，禁止转载！
欢迎加入伯乐在线 [专栏作者](http://blog.jobbole.com/99322)。
本系列：
- 《[微信小程序开发教程（第1弹）](http://blog.jobbole.com/106049/)》
- 《[微信小程序开发教程（第2弹）](http://blog.jobbole.com/106098/)》
- 《[微信小程序开发教程（第3弹）](http://blog.jobbole.com/106107/)》
- 《[微信小程序开发教程（第4弹）](http://blog.jobbole.com/106105/)》
博卡君今天继续更新，忙了一天，终于有时间开工写教程。不罗嗦了，今天我们来看看如何实现一些前端的功能和效果。
### 第八章：微信小程序分组开发与左滑功能实现
先来看看今天的整体思路：
进入分组管理页面–>点击新建分组新建
进入到未分组页面基本操作
进入到已建分组里面底部菜单栏操作–>从名片夹中添加进行操作。
![](http://jbcdn2.b0.upaiyun.com/2016/09/92da750c771c8292a906c442da6125a3.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/ccab8827d57d7323f3d7d5d231bc67a9.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/2bd7fee64bb382d520ad84efb4956939.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/3768cfb5afe94c5098308dc64923f76b.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/8d26d2dc02b9ab073322708acb8167ea.jpeg)
理清完基本流程我们开始开发。首先整个布局可以先看下，我再一步步讲。
![](http://jbcdn2.b0.upaiyun.com/2016/09/2616ddaa197026f9937c98b91338f917.jpeg)
静态布好局后，我们开始实现新增分组效果，
![](http://jbcdn2.b0.upaiyun.com/2016/09/7986f40dbfa9013873f0297843e89f12.jpeg)
当然触发它出现的是
![](http://jbcdn2.b0.upaiyun.com/2016/09/d2686e5907955be8119c1fb682708aff.jpeg)
显示窗口
![](http://jbcdn2.b0.upaiyun.com/2016/09/aa225bfb3a5a1978d67be0086b868c7e.jpeg)
点击取消消失
![](http://jbcdn2.b0.upaiyun.com/2016/09/3d0ba4d76e324f34856616315f82f875.jpeg)
当里面的输入框内容发生改变时 bindinput 事件，大家别使用 bindchange 事件，这里的 bindchange 事件只有当失去焦点时才会被触发。
![](http://jbcdn2.b0.upaiyun.com/2016/09/c8afe8f73109930f7f54d9364715f8ab.jpeg)
当输入框事件发生时，确定按钮会变成可以点击状态，为空时，addTeam
![](http://jbcdn2.b0.upaiyun.com/2016/09/7a4441cbb156721de7dd370d068c2517.jpeg)
样式数据绑定。
![](http://jbcdn2.b0.upaiyun.com/2016/09/56961f8e19d806110ff4f92dcad69bed.jpeg)
里面有表单就使用了 from。
![](http://jbcdn2.b0.upaiyun.com/2016/09/0491c49508be35d067cce66a27f21d3c.jpeg)
创建分组请求交互。
![](http://jbcdn2.b0.upaiyun.com/2016/09/307e1533840475e38b253fa84ab0cf35.jpeg)
创建分组完成，这里可能很多疑问，为什么不使用微信提供的模态框组件来实现，而是自己实现，其实我也很懒，非常想使用自带的模态框组件，但是发现在模态框里面提交表单好像有点麻烦，直接自定义了。
接下来创建好的分组支持左滑删除与重命名，今天重点谈下左滑删除的实现方式。
首先需要左滑的是被创建好的分组，未分组是写死的，故而不支持的。
左滑删除使用了两个事件 bindtouchstart 与 bindtouchmove，这里必须绑定它的 id，这个 id 都是不同的，我这使用的用户创建完成后在后台生成的一个 id 号，之后我再 block 出来使用在这里，这个 id 都是唯一的，不能是相同的 id。
![](http://jbcdn2.b0.upaiyun.com/2016/09/293eb91cc690efc46122ef8d388a02b5.jpeg)
样式布局，父元素是绝对定位，子元素删除是相对定位，鉴于动画效果，我这加了 css3 的动画效果，使滑动带点动画效果。
![](http://jbcdn2.b0.upaiyun.com/2016/09/af304813718ea7893954b691c41b45cb.jpeg)
现在我们来看事件构成：
Bindtap 点击之后直接是跳转页面。
![](http://jbcdn2.b0.upaiyun.com/2016/09/b41d3d2caf4bebcb208b209bff7329f7.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/5999fab3c07dc09b5eed150fa1bf05b8.jpeg)
左滑从触摸事件开始，当然需使用的参数在外面最好先定义一下：
![](http://jbcdn2.b0.upaiyun.com/2016/09/0eca2b6483b1af1460d70cfd6fb30dbb.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/61a83ded8009625e8678d50294ed8d76.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/df2ba30f09f031bcc171cd21b756d370.jpeg)
bindtouchStart 发生后，会执行 bindtouchmove 事件，在这里我们可以判断是否左右滑动：
![](http://jbcdn2.b0.upaiyun.com/2016/09/1da2e2ab0592d963942c40c18127e6bf.jpeg)
- Var dataId = e.currentTarget.id //获取到前面唯一的id；
- If(key){   //用户左滑距离很长时会发生多次左滑事件，这里定义一个开关发生第一次之后就关闭它；
- Touch是获取触摸点的一些数据，touches 是一个触摸点的数组，每个触摸点包括以下属性：
- pageX,pageY：距离文档左上角的距离，文档的左上角为原点 ，横向为 X 轴，纵向为 Y 轴；
- clientX,clientY：距离页面可显示区域（屏幕除去导航条）左上角距离，横向为X轴，纵向为Y轴；
- screenX,screenY：距离屏幕左上角的距离，屏幕左上角为原点，横向为X轴，纵向为Y轴；
这里使用 clientX,clientY 即可。
我们在 bindtouchstart 时记录到开始的点，在 bindtouchmove 记录到触摸结束的点，如果 X 轴滑动大于 Y 轴的，再如果结束点-开始点小于一个数值（这个数组可以自己设置，鉴于灵敏度，我这设置的很小），右滑也是同理。
![](http://jbcdn2.b0.upaiyun.com/2016/09/6e8ff265a76eb6e2680da3380f30c84d.jpeg)
判断到左滑与右滑事件后，我们就需要对当前组件绑定数据了，数据从那里来？可以看下我这数组一个来历，以及怎么被左滑事件里面获取到（我这数据是一个数组，需要在 wxml 里面 block 的）。
![](http://jbcdn2.b0.upaiyun.com/2016/09/54e1c1c24feae7cfb6478b33965e3ea1.jpeg)
这时候取到需要的数组，循环出来后，我进行对比，如果数据的 id== 当前被事件操作的 id，那么我给改数组再添加一个 right 向右偏移 15%，否则其他都不偏移，右滑同理，直接全部设置为 0。
![](http://jbcdn2.b0.upaiyun.com/2016/09/00673a61ddb4755d0f59e66fad3d61ea.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/c190cc2a5e6717cd36e692619b01f3fd.jpeg)
最后把数据到绑定到页面上来。
![](http://jbcdn2.b0.upaiyun.com/2016/09/5fd6b0b6af08aed3959316f0c5d5300a.jpeg)
OK，左滑效果实现。
![](http://jbcdn2.b0.upaiyun.com/2016/09/f99f752653cc0f167b8a6f62626fac50.jpeg)
如果出现全部被滚动了，记得在外层加上，X 轴关闭即可。
![](http://jbcdn2.b0.upaiyun.com/2016/09/252add602454c83c16a273e751682d35.jpeg)
这时候你点击左滑会出现点透效果，官方文档提供给我们一个 catch，不冒泡点击事件，即可完美解决。
![](http://jbcdn2.b0.upaiyun.com/2016/09/d6153486880008d8eea63f525fe53352.jpeg)
点击删除事件弹出模态框供用户确定是否删除。
![](http://jbcdn2.b0.upaiyun.com/2016/09/48adf72ba430d3e17b825547ab43fbd5.jpeg)
这里你点击取消时还要记得把左滑删除按钮去掉可能用户体验会好点。
![](http://jbcdn2.b0.upaiyun.com/2016/09/27c18ad3ff2558cadc4d1d6116d2bea5.jpeg)
一定记得在 data({
modalHidden:true
})
不然会出现一加载页面即出现了模态框。
![](http://jbcdn2.b0.upaiyun.com/2016/09/ac854239e3c597cd42248397c229bf38.jpeg)
点击未分组按钮进入到未分组名片列表页面。
![](http://jbcdn2.b0.upaiyun.com/2016/09/66214d8095cf18853f4f4d23f6a5236f.jpeg)
这个布局完全是 copy 首页过来的，后面只是数据接口有变而已，大家有兴趣可以回过去看下前面的。
点击多选，会出现多选框和下面的一些操作按钮。都是些数据绑定，显示与隐藏类的实现比较简单。
![](http://jbcdn2.b0.upaiyun.com/2016/09/aaf536e59fbb3f912a5705d219097aa5.jpeg)
多选我们直接给 checked 设置 Boole 开关。
![](http://jbcdn2.b0.upaiyun.com/2016/09/94dd8e25df59918a4de1bc203dac13dc.jpeg)
![](http://jbcdn2.b0.upaiyun.com/2016/09/d9905a7be35c8c649a04543d59045366.jpeg)
选择好名片后点击设置分组会弹出新建好的分组列表供用户确定设置到那个分组里面（这里由于后台接口方面还在完善，不继续往下写了）。
用户已建分组点击进去的是点击顶部菜单按钮出现下拉菜单栏，这里直接使用微信提供的组件。
![](http://jbcdn2.b0.upaiyun.com/2016/09/755de203dc39b8dad26e3f6a80ba9e21.jpeg)
最后点击从名片夹中添加进入到以下页面：
![](http://jbcdn2.b0.upaiyun.com/2016/09/4821a68adaac9229c309a3c6bc812a10.jpeg)
整个布局基本还是和首页面差不多，这里不再多讲，
![](http://jbcdn2.b0.upaiyun.com/2016/09/6bfa1e4b4fcdd593b96ec8c216544128.jpeg)
顶部菜单直接多选绑定数据即可。
![](http://jbcdn2.b0.upaiyun.com/2016/09/70ef9243cb942d537de4bd4602e879f9.jpeg)
牵扯到表单类的基本全都是 from 表单提交事件。除小部分接口方面欠缺外，写到这里其实分组前端方面效果基本实现。
好了，由于目前小程序开发工具图片上传还有点问题，拍照收纳无法实现，所以博卡君的微信小程序开发教程也先暂告一段落，等开发工具更新稳定后，我还会再追加教程的内容，有机会的话把成品也给大家看看。
