# 向函数中传递指针和传递指针的引用的区别 - DoubleLi - 博客园






如果是传递指针，那么会先复制该指针，在函数内部使用的是复制后的指针，这个指针与原来的指针指向相同的地址，如果在函数内部将复制后的指针指向了另外的新的对象，那么不会影响原有的指针；
但 是对于传递指针应用，如果将传递进来的指针指向了新的对象，那么原始的指针也就指向了新的对象，这样就会造成内存泄漏，因为原来指针指向的地方已经不能再 引用了，即使没有将传递进来的指针指向新的对象，而是在函数结束的时候释放了指针，那么在函数外部就不能再使用原有的指针了，因为原来的内存已经被释放了



看个例子:

#include <cstdlib>
#include <cstring>
#include <memory>
#include <iostream>

using namespace std;

void func2(char *str)
{
    str = (char *)malloc(10);
    strcpy(str, "hello");
}

void func3(char *&str)
{
    str = (char *)malloc(10);
    strcpy(str, "hello");
}
int main()
{
    char *str = "1234567890";

    func2(str);
    cout << str << endl;
    func3(str);
    cout << str << endl;
}

程序输出:

1234567890
hello



简单一点可以这么想，如果不用引用的话，被传递的参数本身是不能被修改的， 
即使你传递的是指针，也不过能修改指针指向的内容，不能修改指针本身。 
如果要修改当前被传递的参数的话，要么再加一级指针，要么用引用。

指针的引用类似于二级指针

传递指针的话，在函数体内你只能修改指针的内容，不能改变指针本身（非const type *类型，指针本身也能修改的，只是这个修改，不会影响到实参指针） 
传递指针的引用，在函数体内，你既可以修改指针的内容，也可以修改指针本身（实参）

有区别， 
无论你传值还是传指针，函数都会生成一个临时变量， 但传引用时，不会生成临时变量， 当你传值时，只可以引用值而不可以改变值，但传值引用时，可以改变值， 当你传指针时，只可以改变指针所指的内容，不可以改变指针本身，但传指针引用时，即可以改变指针所指的内容，又可以改变指针本身,但传引用主要是它不生成临时变量，不进行返回值copy等，速度快。







从概念上讲。指针从本质上讲就是存放变量地址的一个变量，在逻辑上是独立的，它可以被改变，包括其所指向的地址的改变和其指向的地址中所存放的数据的改变。

而引用是一个别名，它在逻辑上不是独立的，它的存在具有依附性，所以引用必须在一开始就被初始化，而且其引用的对象在其整个生命周期中是不能被改变的（自始至终只能依附于同一个变量）。

在C++中，指针和引用经常用于函数的参数传递，然而，指针传递参数和引用传递参数是有本质上的不同的：

指针传递参数本质上是值传递的方式，它所传递的是一个地址值。值传递过程中，被调函数的形式参数作为被调函数的局部变量处理，即在栈中开辟了内存空间以存放由主调函数放进来的实参的值，从而成为了实参的一个副本。值传递的特点是被调函数对形式参数的任何操作都是作为局部变量进行，不会影响主调函数的实参变量的值。

而在引用传递过程中，被调函数的形式参数虽然也作为局部变量在栈中开辟了内存空间，但是这时存放的是由主调函数放进来的实参变量的地址。被调函数对形参的任何操作都被处理成间接寻址，即通过栈中存放的地址访问主调函数中的实参变量。正因为如此，被调函数对形参做的任何操作都影响了主调函数中的实参变量。

引用传递和指针传递是不同的，虽然它们都是在被调函数栈空间上的一个局部变量，但是任何对于引用参数的处理都会通过一个间接寻址的方式操作到主调函数中的相关变量。而对于指针传递的参数，如果改变被调函数中的指针地址，它将影响不到主调函数的相关变量。如果想通过指针参数传递来改变主调函数中的相关变量，那就得使用指向指针的指针，或者指针引用。

为了进一步加深大家对指针和引用的区别，下面我从编译的角度来阐述它们之间的区别：

程序在编译时分别将指针和引用添加到符号表上，符号表上记录的是变量名及变量所对应地址。指针变量在符号表上对应的地址值为指针变量的地址值，而引用在符号表上对应的地址值为引用对象的地址值。符号表生成后就不会再改，因此指针可以改变其指向的对象（指针变量中的值可以改），而引用对象则不能修改。

最后，总结一下指针和引用的相同点和不同点：

★相同点：

●都是地址的概念；

指针指向一块内存，它的内容是所指内存的地址；而引用则是某块内存的别名。

★不同点：

●指针是一个实体，而引用仅是个别名；

●引用只能在定义时被初始化一次，之后不可变；指针可变；引用“从一而终”，指针可以“见异思迁”；

●引用没有const，指针有const，const的指针不可变；

●引用不能为空，指针可以为空；

●“sizeof 引用”得到的是所指向的变量(对象)的大小，而“sizeof 指针”得到的是指针本身的大小；

●指针和引用的自增(++)运算意义不一样；

●引用是类型安全的，而指针不是 (引用比指针多了类型检查









