# HTTP通信机制 - _天枢 - 博客园
## [HTTP通信机制](https://www.cnblogs.com/yhleng/p/8005311.html)
2017-12-08 14:46 by _天枢, ... 阅读, ... 评论, [收藏](#),  [编辑](https://i.cnblogs.com/EditPosts.aspx?postid=8005311)
HTTP通信机制是在一次完整的HTTP通信过程中，Web浏览器与Web服务器之间将完成下列7个步骤： 
1. 建立TCP连接
在HTTP工作开始之前，Web浏览器首先要通过网络与Web服务器建立连接，该连接是通过TCP来完成的，该协议与IP协议共同构建Internet，即著名的TCP/IP协议族，因此Internet又被称作是TCP/IP网络。HTTP是比TCP更高层次的应用层协议，根据规则，只有低层协议建立之后才能，才能进行更层协议的连接，因此，首先要建立TCP连接，一般TCP连接的端口号是80。
2. Web浏览器向Web服务器发送请求命令 
一旦建立了TCP连接，Web浏览器就会向Web服务器发送请求命令。例如：GET/sample/hello.jsp 
HTTP/1.1。
3. Web浏览器发送请求头信息 
浏览器发送其请求命令之后，还要以头信息的形式向Web服务器发送一些别的信息，之后浏览器发送了一空白行来通知服务器，它已经结束了该头信息的发送。 
4. Web服务器应答 
客户机向服务器发出请求后，服务器会客户机回送应答， HTTP/1.1 200 OK ，应答的第一部分是协议的版本号和应答状态码。
5. Web服务器发送应答头信息 
正如客户端会随同请求发送关于自身的信息一样，服务器也会随同应答向用户发送关于它自己的数据及被请求的文档。 
6. Web服务器向浏览器发送数据 
Web服务器向浏览器发送头信息后，它会发送一个空白行来表示头信息的发送到此为结束，接着，它就以Content-Type应答头信息所描述的格式发送用户所请求的实际数据。
7. Web服务器关闭TCP连接 
一般情况下，一旦Web服务器向浏览器发送了请求数据，它就要关闭TCP连接，然后如果浏览器或者服务器在其头信息加入了这行代码：
Connection:keep-alive 
TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了网络带宽。
浏览器从发送一个请求到最后显示的全过程。
1、浏览器从Web Server发送请求。一般情况下，该请求首先发送到DNS Server 把DNS名字解析成IP地址。解析的过程的时间就是DNS Resolution。这个度量时间可以确定DNS服务器或者DNS服务器的配置是否有问题。如果DNS Server运行情况比较好，该值会比较小。
2、解析出Web Server的IP地址后，请求被发送到了Web Server，然后浏览器和Web Server之间需要建立一个初始化连接，建立该连接的过程就是Connection。这个度量时间可以简单的判断网络情况，也可以判断Web Server是否能够响应这个请求。如果正常，该值会比较小。
3、建立连接后，从Web Server发出第一个数据包，经过网络传输到客户端，浏览器成功接收到第一字节的时间就是First Buffer。这个度量时间不仅可以表示Web Server的延迟时间，还可以表示出网络的反应时间。
4、从浏览器接收到一个字节起，直到成功收到最后一个字节，下载完成止，这段时间就是Receive。这个度量时间可以判断网络的质量（可以用size time比来计算接受速率）其他的时间还有SSL handshaking(SSL握手协议，用到该协议的页面比较少、Client Time(请求在客户端浏览器延迟的时间，可能是由于客户端浏览器的think time或者客户端其他方面引起的延迟）、Error Time（从发送了一个**HTTP请求**，到Web Server发送回一个HTTP错误信息，需要的时间）。浏览器向Web Server发送请求--->DNS Server解析域名成IP地址（解析过程为DNS Resolution）--->请求到达Web Server建立初始化连接（建立连接过程为Connection)--->Web Server发出第一个数据包，浏览器成功接收到第一字节（此过程为First Buffer)--->浏览器接收第一个字节起，直到成功收到最后一
个字节（此过程为Receive
