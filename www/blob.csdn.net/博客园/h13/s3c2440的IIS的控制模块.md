# s3c2440的IIS的控制模块 - h13 - 博客园
一、   S3c2440A的IIS总线接口可以连接外部8/16位立体声音频解码IC。支持IIS总线数据格式和MSB-justified数据格式。该接口对FIFO的访问采用了DMA模式，代替中断模式。可以同时传送和接收数据。 
   1.0。功能：总线接口，寄存器组和状态机（BRFC）：总线接口逻辑和FIFO访问由状态机控制。5位双预定标器、64位FIFO、主IISCLK发生器、通道发生器和状态机、15位移位寄存器。
  1.1。传输模式：分为正常传输模式和DMA传输模式。
 1.2。IIS总线格式：IIS总线有4根信号线，分别是串行数据输入（IISDI）、串行数据输出（IISDO）、左右通道选择（IISLRCK）和串行位时钟（IISCLK）。产生IISLRCK和IISCLK的是主设备。串行数据以2的补码且高位在先的方式发送（即偶数个数据发送和MSB先发）。这种数据格式使得数字音频设备的互联更加方便，而且不会造成数据错位。发送器发送的串行数据可以依据时钟信号的下降沿和上升沿同步 ，但是串行数据必须在上升沿锁存接收器。左右声道选择线决定了发送通道（左还是右），IISLRCk可以在串行时钟的下降沿或者上升沿处被改变，不一定是均匀的。在从设备端，信号在串行时钟的下降沿或者上升沿被锁存。IISLRCK信号线改变到MSB发送之间有一个时钟周期的时间。
1.3。Msb-Justified格式：Msb-Justified 总线格式个IIS格式有相同的格式。唯一不同的是Msb-Justified格式只要IISLRCK改变，MSB立即发送，没有一个时钟周期的间隔。
1.4。IIS采样频率和主设备时钟：IIS主设备时钟频率时由IIS分频器产生的（主设备时钟频率=PCLK/预分频器），故必须选择合适的预分频值和CODECLK的采样频率（256//384）。
1.5。IIS寄存器有：IISCON、IISMOD、IISPSR、IISFCON、IISFCON
1.6。用好IIS，就要把信号频率设置正确。IISSCLK为串行时钟，每一个时钟信号传送一位音频信号，因此IISSCLK的频率＝声道数×采样频率×采样位数，如采样频率fs为44.1kHz，采样的位数为16位，声道数2个（左、右两个声道），则IISSCLK的频率＝32fs＝1411.2kHz。
二、WAV为微软公司(Microsoft)开发的一种声音文件格式，它符合RIFF(Resource Interchange File Format)文件规范,用于保存Windows平台的音频信息资源，被Windows平台及其应用程序所广泛支持，该格式也支持MSADPCM，CCITT A LAW等多种压缩运算法，支持多种音频数字，取样频率和声道，标准格式化的WAV文件和CD格式一样，也是44.1K的取样频率，16位量化数字，因此在声音文件质量和CD相差无几！
2.0典型的wav文件结构如下：RIFF_header（8字节） 、data_type（4字节）、fmt_chunk（0x18字节）、Fact Chunk、data_chunk(真正存贮音频数据)。
