# [转贴]一个比较那个的代码！ - =朝晖= - 博客园
# [[转贴]一个比较那个的代码！](https://www.cnblogs.com/dhcn/archive/2006/07/04/442817.html)
      发到这儿来主要是原先的发布格式太乱，看起来不方便
      来源那个网页上也没有，作者看到本页面，可以和我联系，我加上你的大名。
      对了，代码是AxWebBrowser应用的完整例子，用于自动提交网页表单
![](https://www.cnblogs.com/Images/OutliningIndicators/None.gif)OptionExplicitOn
![](https://www.cnblogs.com/Images/OutliningIndicators/None.gif)Imports mshtml
![](https://www.cnblogs.com/Images/OutliningIndicators/None.gif)Imports System.DateTime
![](https://www.cnblogs.com/Images/OutliningIndicators/None.gif)Imports Microsoft.VisualBasic
PublicClass form1Class form1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Inherits System.Windows.Forms.Form
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)Windows 窗体设计器生成的代码#Region " Windows 窗体设计器生成的代码 "
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PublicSub New()SubNew()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)MyBase.New()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'该调用是 Windows 窗体设计器所必需的。
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)InitializeComponent()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'在 InitializeComponent() 调用之后添加任何初始化
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow.Navigate("http://www.netsh.com")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow.Navigate("h:\softuyou.htm")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow.Navigate("http://goal28.ziqu.com/bbs/250006/")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow.Navigate("http://www.netsh.net/subdomains/f_s_o.php?p=0&leibie=wenxue")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow.Navigate("http://my.clubhi.com/bbs/661134/")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Randomize()
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'窗体重写 dispose 以清理组件列表。
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)ProtectedOverloadsOverridesSub Dispose()Sub Dispose(ByVal disposing AsBoolean)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If disposing Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfNot (components IsNothing) Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)components.Dispose()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)MyBase.Dispose(disposing)
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Windows 窗体设计器所必需的
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Private components As System.ComponentModel.IContainer
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'注意: 以下过程是 Windows 窗体设计器所必需的
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'可以使用 Windows 窗体设计器修改此过程。
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'不要使用代码编辑器修改它。
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents txtAddress As System.Windows.Forms.TextBox
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents brow As AxSHDocVw.AxWebBrowser
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents lblStatus As System.Windows.Forms.Label
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents MainMenu1 As System.Windows.Forms.MainMenu
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents MenuItem1 As System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents mnuFill As System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents mnuNetsh As System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents lst1Url As System.Windows.Forms.ListBox
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FriendWithEvents mnuTest As System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)<System.Diagnostics.DebuggerStepThrough()>PrivateSub InitializeComponent()Sub InitializeComponent()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim resources As System.Resources.ResourceManager =New System.Resources.ResourceManager(GetType(form1))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress =New System.Windows.Forms.TextBox
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus =New System.Windows.Forms.Label
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow =New AxSHDocVw.AxWebBrowser
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.MainMenu1 =New System.Windows.Forms.MainMenu
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.MenuItem1 =New System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuFill =New System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuNetsh =New System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuTest =New System.Windows.Forms.MenuItem
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url =New System.Windows.Forms.ListBox
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)CType(Me.brow, System.ComponentModel.ISupportInitialize).BeginInit()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.SuspendLayout()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'txtAddress
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress.Location =New System.Drawing.Point(176, 8)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress.Name ="txtAddress"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress.Size =New System.Drawing.Size(568, 21)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress.TabIndex =0
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.txtAddress.Text =""
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'lblStatus
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus.Location =New System.Drawing.Point(8, 8)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus.Name ="lblStatus"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus.Size =New System.Drawing.Size(160, 16)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus.TabIndex =1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lblStatus.Text ="Status"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'brow
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow.Enabled =True
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow.Location =New System.Drawing.Point(8, 32)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow.OcxState =CType(resources.GetObject("brow.OcxState"), System.Windows.Forms.AxHost.State)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow.Size =New System.Drawing.Size(344, 520)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.brow.TabIndex =2
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MainMenu1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.MainMenu1.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.MenuItem1, Me.mnuFill, Me.mnuNetsh, Me.mnuTest})
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MenuItem1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.MenuItem1.Index =0
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.MenuItem1.Text ="&File"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'mnuFill
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuFill.Index =1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuFill.Text ="Fi&ll"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'mnuNetsh
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuNetsh.Index =2
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuNetsh.Text ="&Netsh"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'mnuTest
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuTest.Index =3
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.mnuTest.Text ="&Test"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'lst1Url
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.ItemHeight =12
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.Location =New System.Drawing.Point(352, 32)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.MultiColumn =True
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.Name ="lst1Url"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.Size =New System.Drawing.Size(432, 520)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.Sorted =True
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.lst1Url.TabIndex =3
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'form1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.AutoScaleBaseSize =New System.Drawing.Size(6, 14)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.AutoScroll =True
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.ClientSize =New System.Drawing.Size(792, 557)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Controls.Add(Me.lst1Url)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Controls.Add(Me.brow)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Controls.Add(Me.lblStatus)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Controls.Add(Me.txtAddress)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Menu =Me.MainMenu1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Name ="form1"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.Text ="浏览器（tuenhai)"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.WindowState = System.Windows.Forms.FormWindowState.Maximized
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)CType(Me.brow, System.ComponentModel.ISupportInitialize).EndInit()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Me.ResumeLayout(False)
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)netsh 注册和发言整体程序#Region "netsh 注册和发言整体程序"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub mnuNetsh_Click()Sub mnuNetsh_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mnuNetsh.Click
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)OnErrorResumeNext
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate("http://www.netsh.com/") '打开首页
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)SearchKey ="leibie="'重定义关键词为类别（leibie=)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call getUrls() '搜集分类网址到列表框
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(lst1Url.Items.Count, MsgBoxStyle.DefaultButton3, "lst1ur1的论坛数")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countLstNetsh AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim LstNetsh AsNew ListBox '新建一ListBox
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)LstNetsh.Items.AddRange(lst1Url.Items) '复制list1到lstNetsh
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countLstNetsh =0To LstNetsh.Items.Count -1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If brow.LocationURL <> LstNetsh.Items(countLstNetsh) Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(LstNetsh.Items(countLstNetsh)) '导航到lstNetsh中的第一个地址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT / 5)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(brow.LocationURL)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'**********************以下得到编程栏的网址类别目录列表***************
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim instrLeibie AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim LocUrl AsString= LstNetsh.Items(countLstNetsh)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)instrLeibie =InStr(LocUrl, SearchKey, CompareMethod.Text)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)SearchKey = Strings.Right(LocUrl, Len(LstNetsh.Items(countLstNetsh)) - instrLeibie +1) '得到搜索关键词leibie=biancheng
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)MsgBox(SearchKey, MsgBoxStyle.DefaultButton1, "newsearchkey")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear() '先清空列表框
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call getUrls() '搜索包含leibie=biancheng的网址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Add(brow.LocationURL) '再加上当前网址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim LstBianCheng AsNew ListBox '编程目录
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)LstBianCheng.Items.AddRange(lst1Url.Items) '把lst1Url中的网址传到LstBiancheng
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear() '清空lst1Url
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'**************************导航到biacheng目录中的第1页,并得到论坛网址目录
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countLstBianCheng AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countLstBianCheng =0To LstBianCheng.Items.Count -1'编程目录的页数
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If brow.LocationURL <> LstBianCheng.Items(countLstBianCheng) Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(LstBianCheng.Items(countLstBianCheng)) '导航到编程目录的第一页
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)' Delay(FromOADate(delayT / 5)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call GetForms()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim LstBianChengUrl AsNew ListBox '编程目录第1页的论坛列表
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)LstBianChengUrl.Items.AddRange(lst1Url.Items)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countLstBianchUrl AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countLstBianchUrl =0To LstBianChengUrl.Items.Count -1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(LstBianChengUrl.Items(countLstBianchUrl))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT / 5)) '延时1秒
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(brow.Document.all.tags("html").item(0).outerhtml, MsgBoxStyle.DefaultButton3, _
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)' "看看打开的论坛源代码中有没有FRAMESET,有就执行下面代码")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr(brow.Document.all.tags("html").item(0).outerhtml, "FRAMESET") Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr(brow.Document.frames(0).document.body.innerhtml, "发表新帖子") Then'如果网页中有"发表新帖子"就执行
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim bcUrl AsString= LstBianChengUrl.Items(countLstBianchUrl)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)MsgBox(bcUrl, MsgBoxStyle.DefaultButton3, "LstBianChengUrl.Items(countLstBianchUrl)")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim bookNum AsString= Strings.Right(bcUrl, Len(bcUrl) -InStrRev(bcUrl, "/", -1, CompareMethod.Text))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)MsgBox(bookNum)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim UrlAdd AsString= Strings.Left(bcUrl, InStr(8, bcUrl, "/", CompareMethod.Text)) &"fcgi-bin/addboard.fcgi?bookname="& bookNum
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(UrlAdd)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT / 5))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(UrlAdd, MsgBoxStyle.DefaultButton3, "urladd")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(brow.Document.body.innertext, MsgBoxStyle.DefaultButton2, "body中有没有第一次发言请注册")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr(brow.Document.body.innertext, "第一次发言请注册") Then'如果要求注册
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim urlSign AsString= Strings.Left(bcUrl, InStr(8, bcUrl, "/", CompareMethod.Text)) &"cgi-bin/signup.cgi?bookname="& bookNum
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(urlSign)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT / 5))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'MsgBox(urlSign, MsgBoxStyle.DefaultButton1, "urlsign")
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call mnufill_Click(sender, e) '呼叫注册程序
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate(UrlAdd)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call mnufill_Click(sender, e) '发表新帖子
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Delay(FromOADate(delayT *3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Else
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Call mnufill_Click(sender, e)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'Delay(FromOADate(delayT * 3))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countLstBianchUrl
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ExitFor
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countLstBianCheng
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ExitFor
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countLstNetsh
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)netsh注册和发言#Region "netsh注册和发言"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub mnufill_Click()Sub mnufill_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mnuFill.Click
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)OnErrorResumeNext
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim cardNum AsInteger=Int((9999*Rnd()) +1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countTag AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webDoc AsObject= brow.Document.all
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webTag AsObject
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim lengthTag AsShort= webDoc.length -1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countTag =0To lengthTag
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr(brow.LocationURL, "signup.cgi?bookname") Then'如果网址中包含signup，就执行下面代码
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfUCase(webDoc.item(countTag).tagname) ="IMG"Then'如果找到img标签，就写值
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webDoc.Item(countTag).src ="http://www.netsh.net/subdomains/put_img.php?str=492972"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfLCase(webDoc.item(countTag).tagname) ="input"OrLCase(webDoc.item(countTag).tagname) ="textarea"Then'找到input或textarea标签
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag = webDoc.item(countTag)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfNot webDoc("str") IsNothingThen
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webDoc("str").value = strStr '重写name为str的网页元素值
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfLCase(webTag.type) ="text"OrLCase(webTag.type) ="password"Then'找到text或password标签
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)SelectCase webTag.name
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"name", "userid"'用户名
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strName
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"passwd", "password", "confirm"'密码，确认密码
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strPass '
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"subject"'标题
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strSubject & cardNum
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"regid"'注册码
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strRegid
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"username"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = GetRndChar(6, 2) '真实姓名
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"cardnumber"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strCardNumber & cardNum '证件号
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Case"homephone"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strHomephone '电话号
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndSelect
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ElseIf webTag.name ="body"Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag.value = strBody
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Document.forms(0).submit()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)以SearchKey为关键词得到网址#Region "以SearchKey为关键词得到网址"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub getUrls()Sub getUrls()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)OnErrorResumeNext
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countTag AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webDoc AsObject= brow.Document.all
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webTag AsObject
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim lengthTag AsShort= webDoc.length -1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countTag =0To lengthTag
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfLCase(webDoc.item(countTag).tagname) ="a"Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag = webDoc.item(countTag).href
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr(webTag, SearchKey) Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Add(webTag)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countTag '以上代码得到网址列表
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim CountLst1 AsShort'以下代码去除重复地址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim Lst2Url() AsString
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim UBoundLst2 AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)With lst1Url
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ReDimPreserve Lst2Url(0)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Lst2Url(0) = .Items(0) '新数组的第一项和list的第一项相同
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For CountLst1 =1To .Items.Count -1'items.count得到list1中的项目数
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)UBoundLst2 =UBound(Lst2Url) 'curid为newlist中有项目数
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If .Items(CountLst1) <> Lst2Url(UBoundLst2) Then'如果旧表第二项不等于新表第一项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ReDimPreserve Lst2Url(UBoundLst2 +1) '定位到新表第二项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Lst2Url(UBoundLst2 +1) = .Items(CountLst1) '新表第二项等于旧表第二项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next CountLst1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif).Items.Clear() '删除旧表所有项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For CountLst1 =0ToUBound(Lst2Url) '把新表写入旧表
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif).Items.Add(Lst2Url(CountLst1))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next CountLst1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndWith
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)得到netsh网页中的论坛网址,并加入到lst1Url#Region "得到netsh网页中的论坛网址,并加入到lst1Url"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub GetForms()Sub GetForms()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)OnErrorResumeNext
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)DoWhile brow.Busy
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Loop
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countTag AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webDoc AsObject= brow.Document.all
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim webTag AsObject
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim lengthTag AsShort= webDoc.length -1
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Clear()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countTag =0To lengthTag
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfLCase(webDoc.item(countTag).tagname) ="a"Then'得到网址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)webTag = webDoc.item(countTag).href
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)IfInStr("1234567890", Strings.Right(webTag, 1)) Then'只选取末位是数字的网址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lst1Url.Items.Add(webTag)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countTag '以上代码得到网址列表
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim countForms AsShort'以下代码去除重复地址
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim lstForms() AsString
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim CurId AsShort
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)With lst1Url
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ReDimPreserve lstForms(0)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lstForms(0) = .Items(0) '新数组的第一项和list的第一项相同
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countForms =1To .Items.Count -1'items.count得到list1中的项目数
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)CurId =UBound(lstForms) 'curid为newlist中有项目数
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If .Items(countForms) <> lstForms(CurId) Then'如果旧表第二项不等于新表最大项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)ReDimPreserve lstForms(CurId +1) '定位到新表第二项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lstForms(CurId +1) = .Items(countForms) '新表第二项等于旧表第二项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countForms
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif).Items.Clear() '删除旧表所有项
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)For countForms =0ToUBound(lstForms) '把新表写入旧表
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif).Items.Add(lstForms(countForms))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Next countForms
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndWith
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)保存相关信息到文本文件#Region "保存相关信息到文本文件"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub SaveUser()Sub SaveUser()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim F AsInteger
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim FileName AsString
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim UserName AsString="testname"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim UserPassword AsString="testpass"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim strPath AsString
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)strPath = Application.StartupPath
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)F =FreeFile()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FileName = strPath &"\user.txt"
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FileOpen(F, FileName, OpenMode.Append)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)PrintLine(F, DateTime.Now & vbCrLf &"netsh"& vbCrLf &"name="& UserName)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'这里我们按emailclear的格式导出用户信息
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)FileClose(F)
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)Delay函数#Region "Delay函数"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PublicSub Delay()Sub Delay(ByRef HowLong AsDate)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim temptime AsObject
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)temptime =DateAdd(DateInterval.Second, HowLong.ToOADate, Now)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)While temptime > Now
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Application.DoEvents()
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndWhile
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)'System.Threading.Thread.CurrentThread.Sleep(1000)
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)浏览器基本功能#Region " 浏览器基本功能"
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub brow_BeforeNavigate2()Sub brow_BeforeNavigate2(ByVal sender AsObject, ByVal e As AxSHDocVw.DWebBrowserEvents2_BeforeNavigate2Event) Handles brow.BeforeNavigate2
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)txtAddress.Text = e.uRL
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub txtAddress_KeyPress()Sub txtAddress_KeyPress(ByVal sender AsObject, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles txtAddress.KeyPress
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)Dim KeyAscii AsShort=Asc(e.KeyChar)
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If KeyAscii =13Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)brow.Navigate((txtAddress.Text))
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)If KeyAscii =0Then
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)e.Handled =True
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)EndIf
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub brow_StatusTextChange()Sub brow_StatusTextChange(ByVal sender AsObject, ByVal e As AxSHDocVw.DWebBrowserEvents2_StatusTextChangeEvent) Handles brow.StatusTextChange
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)lblStatus.Text = e.text
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub brow_NewWindow2()Sub brow_NewWindow2(ByVal sender AsObject, ByVal e As AxSHDocVw.DWebBrowserEvents2_NewWindow2Event) Handles brow.NewWindow2
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)e.ppDisp = brow.Application
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)e.cancel =True
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)#End Region
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)PrivateSub mnuTest_Click()Sub mnuTest_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mnuTest.Click
![](https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)' On Error Resume Next
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)End Sub
![](https://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif)End Class

