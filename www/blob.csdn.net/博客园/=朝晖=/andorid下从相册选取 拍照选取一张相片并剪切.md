# andorid下从相册选取/拍照选取一张相片并剪切 - =朝晖= - 博客园
# [andorid下从相册选取/拍照选取一张相片并剪切](https://www.cnblogs.com/dhcn/p/7121321.html)
http://www.2cto.com/kf/201401/270144.html
在[Android](http://lib.csdn.net/base/android)编程中，从相册选取或是拍照选取一张照片然后对其进行剪切的需求非常的多
之前的一篇文章只说到如何从相册中获取一张照片，今天就跟大家说说如何将获取到的相片进行剪切
完整源码[下载](http://www.2cto.com/soft)
我们先说一下思路，在[android](http://lib.csdn.net/base/android)系统中就自带了图片剪切的应用，所以，我们只需要将我们获取到的相片传给图片剪切应用，再将剪切好的相片返回到我们自己的界面显示就ok了
第一步，我们可以先激活系统图片或是相机来获取相片，看代码
[?](http://www.2cto.com/kf/201401/270144.html#)
```
```java
/*
```
```java
```
```java
* 从相册获取
```
```java
```
```java
*/
```
```java
```
```java
public
```
```java
void
```
```java
gallery(View view) {
```
```java
```
```java
// 激活系统图库，选择一张图片
```
```java
```
```java
Intent intent =
```
```java
new
```
```java
Intent(Intent.ACTION_PICK);
```
```java
```
```java
intent.setType(
```
```java
"image/*"
```
```java
);
```
```java
```
```java
// 开启一个带有返回值的Activity，请求码为PHOTO_REQUEST_GALLERY
```
```java
```
```java
startActivityForResult(intent, PHOTO_REQUEST_GALLERY);
```
```java
```
```java
}
```
```java
```
```java
/*
```
```java
```
```java
* 从相机获取
```
```java
```
```java
*/
```
```java
```
```java
public
```
```java
void
```
```java
camera(View view) {
```
```java
```
```java
// 激活相机
```
```java
```
```java
Intent intent =
```
```java
new
```
```java
Intent(
```
```java
"android.media.action.IMAGE_CAPTURE"
```
```java
);
```
```java
```
```java
// 判断存储卡是否可以用，可用进行存储
```
```java
```
```java
if
```
```java
(hasSdcard()) {
```
```java
```
```java
tempFile =
```
```java
new
```
```java
File(Environment.getExternalStorageDirectory(),
```
```java
```
```java
PHOTO_FILE_NAME);
```
```java
```
```java
// 从文件中创建uri
```
```java
```
```java
Uri uri = Uri.fromFile(tempFile);
```
```java
```
```java
intent.putExtra(MediaStore.EXTRA_OUTPUT, uri);
```
```java
```
```java
}
```
```java
```
```java
// 开启一个带有返回值的Activity，请求码为PHOTO_REQUEST_CAREMA
```
```java
```
```java
startActivityForResult(intent, PHOTO_REQUEST_CAREMA);
```
```java
```
```java
}
```
```
第二步，通过startActivityForResult()方法我们可以在onActivityResult()中来获取到相应的返回值
[?](http://www.2cto.com/kf/201401/270144.html#)
```
```java
@Override
```
```java
```
```java
protected
```
```java
void
```
```java
onActivityResult(
```
```java
int
```
```java
requestCode,
```
```java
int
```
```java
resultCode, Intent data) {
```
```java
```
```java
if
```
```java
(requestCode == PHOTO_REQUEST_GALLERY) {
```
```java
```
```java
//
 从相册返回的数据
```
```java
```
```java
if
```
```java
(data !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
//
 得到图片的全路径
```
```java
```
```java
Uri
 uri = data.getData();
```
```java
```
```java
crop(uri);
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
else
```
```java
if
```
```java
(requestCode == PHOTO_REQUEST_CAREMA) {
```
```java
```
```java
//
 从相机返回的数据
```
```java
```
```java
if
```
```java
(hasSdcard()) {
```
```java
```
```java
crop(Uri.fromFile(tempFile));
```
```java
```
```java
}
```
```java
else
```
```java
{
```
```java
```
```java
Toast.makeText(MainActivity.
```
```java
this
```
```java
,
```
```java
"未找到存储卡，无法存储照片！"
```
```java
,
```
```java
0
```
```java
).show();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
else
```
```java
if
```
```java
(requestCode == PHOTO_REQUEST_CUT) {
```
```java
```
```java
//
 从剪切图片返回的数据
```
```java
```
```java
if
```
```java
(data !=
```
```java
null
```
```java
)
 {
```
```java
```
```java
Bitmap
 bitmap = data.getParcelableExtra(
```
```java
"data"
```
```java
);
```
```java
```
```java
this
```
```java
.iv_image.setImageBitmap(bitmap);
```
```java
```
```java
}
```
```java
```
```java
try
```
```java
{
```
```java
```
```java
//
 将临时文件删除
```
```java
```
```java
tempFile.delete();
```
```java
```
```java
}
```
```java
catch
```
```java
(Exception e) {
```
```java
```
```java
e.printStackTrace();
```
```java
```
```java
}
```
```java
```
```java
}
```
```java
```
```java
super
```
```java
.onActivityResult(requestCode,
 resultCode, data);
```
```java
```
```java
}
```
```
第三步，注意到里边有一个crop()方法，顾名思义，就是用于剪切图片的
[?](http://www.2cto.com/kf/201401/270144.html#)
```
```java
/*
```
```java
```
```java
*
 剪切图片
```
```java
```
```java
*/
```
```java
```
```java
private
```
```java
void
```
```java
crop(Uri uri) {
```
```java
```
```java
//
 裁剪图片意图
```
```java
```
```java
Intent
 intent =
```
```java
new
```
```java
Intent(
```
```java
"com.android.camera.action.CROP"
```
```java
);
```
```java
```
```java
intent.setDataAndType(uri,
```
```java
"image/*"
```
```java
);
```
```java
```
```java
intent.putExtra(
```
```java
"crop"
```
```java
,
```
```java
"true"
```
```java
);
```
```java
```
```java
//
 裁剪框的比例，1：1
```
```java
```
```java
intent.putExtra(
```
```java
"aspectX"
```
```java
,
```
```java
1
```
```java
);
```
```java
```
```java
intent.putExtra(
```
```java
"aspectY"
```
```java
,
```
```java
1
```
```java
);
```
```java
```
```java
//
 裁剪后输出图片的尺寸大小
```
```java
```
```java
intent.putExtra(
```
```java
"outputX"
```
```java
,
```
```java
250
```
```java
);
```
```java
```
```java
intent.putExtra(
```
```java
"outputY"
```
```java
,
```
```java
250
```
```java
);
```
```java
```
```java
intent.putExtra(
```
```java
"outputFormat"
```
```java
,
```
```java
"JPEG"
```
```java
);
```
```java
//
 图片格式
```
```java
```
```java
intent.putExtra(
```
```java
"noFaceDetection"
```
```java
,
```
```java
true
```
```java
);
```
```java
//
 取消人脸识别
```
```java
```
```java
intent.putExtra(
```
```java
"return-data"
```
```java
,
```
```java
true
```
```java
);
```
```java
```
```java
//
 开启一个带有返回值的Activity，请求码为PHOTO_REQUEST_CUT
```
```java
```
```java
startActivityForResult(intent,
 PHOTO_REQUEST_CUT);
```
```java
```
```java
}
```
```
第四步，在剪切完成图片后，切图应用就会将图片通过onActivityResult()返回给我们
通过Bitmap bitmap = data.getParcelableExtra("data");我们就拿到了我们想要的bitmap
接下来拿着这个bitmap你想干嘛就干嘛吧![大笑](http://www.2cto.com/uploadfile/Collfiles/20140104/20140104132933234.gif)
由于上边的代码涉及到读写sdcard，所以要记得在清单文件中授权
[?](http://www.2cto.com/kf/201401/270144.html#)
```
```java
<uses-permission
 android:name=
```
```java
"android.permission.WRITE_EXTERNAL_STORAGE"
```
```java
></uses-permission>
```
```
附上几张效果图
![\](http://www.2cto.com/uploadfile/Collfiles/20140104/20140104132933235.jpg)
![\](http://www.2cto.com/uploadfile/Collfiles/20140104/20140104132933236.jpg)
![\](http://www.2cto.com/uploadfile/Collfiles/20140104/20140104132933237.jpg)
![](http://www.2cto.com/uploadfile/Collfiles/20140104/20140104132934239.jpg)

