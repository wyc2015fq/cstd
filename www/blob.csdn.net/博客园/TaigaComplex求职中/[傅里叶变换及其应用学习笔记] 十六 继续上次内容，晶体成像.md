# [傅里叶变换及其应用学习笔记] 十六. 继续上次内容，晶体成像 - TaigaComplex求职中 - 博客园







# [[傅里叶变换及其应用学习笔记] 十六. 继续上次内容，晶体成像](https://www.cnblogs.com/TaigaCon/p/5074803.html)







# x射线晶体照像术

1) x射线是1895年由伦琴（Roentgen）发现的，其波长为$10^{-8}$厘米左右，常用的测量可见光波长的方法会由于其波长太小而无法测量。

2) 晶体（Crystals），晶体的原子结构符合一定规律——原子有序地排列成晶格。劳厄（Laue）在1912年做了一系列著名实验，其目的是利用x射线进行衍射实验来研究晶体的本质。



劳尔假设：

1) x射线是波，因此可以进行衍射

2) 晶体可以充当合适的衍射光栅，即晶体具有晶格原子（lattice atomic）——周期性的原子结构，原子间距可以和x射线的波长相比拟



在一维情况下，一维的晶体是由原子等间距排列形成的一条直线。



![image](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024202906-278271860.png)



该直线无限延长，直线上有无数个原子，实验需要研究的是晶体的电子密度分布——可理解为该晶体的x射线透过率。整个晶体的电子密度就是单个原子电子密度的周期排列形式。单个原子的密度记为$\rho$，将其周期化

![image](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024203484-1250791765.png)

整个一维晶体的原子密度为：

$\begin{align*}
\rho_p(x)
&=\sum_{k=-\infty}^{\infty}\rho(x-kp)\\
&=\sum_{k=-\infty}^{\infty} \rho(x)*\delta(x-kp) \qquad (shift \ property \ of \ \delta)\\
&=\rho(x)*\sum_{-\infty}^{\infty}\delta(x-kp)
\end{align*}$



根据我们上节课的结论，衍射条纹应该是有该式子的傅里叶变换$\mathcal{F}\rho_p$所决定的





# 新符号$Ш$（shah）

我们引入新符号$Ш$，令

$Ш_p(x) = \displaystyle{\sum_{k=-\infty}^{\infty}\delta(x-kp) }$



由于符号$Ш$与等间距的脉冲符号相似，因此引入这个符号，$Ш_p(x)$代表了无穷多个$\delta$，各个$\delta$的间距为$p$

![image](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024204343-902474364.png)

因此

$\rho_p(x)=\rho(x)*Ш_p(x)$

$\mathcal{F}\rho_p=\mathcal{F}(\rho(x)*Ш_p(x)) = (\mathcal{F}\rho)(\mathcal{F}Ш_p)$



式子中，$\rho$是由晶体性质确定的，我们需要研究的对象是$Ш_p$。那么，$Ш_p$是否有意义呢？

我们知道$\delta$作为分布式有意义的，$<\delta,\varphi>$代表了从$0$点处取测试函数的值$\varphi(0)$，那么$<Ш_p,\varphi>$则代表在各个时移$\delta$处取值。



当$p=1$时

$<Ш,\varphi> = \displaystyle{\sum_{k=-\infty}^{\infty}\varphi(k)}$



由于$\varphi$为速降函数，因此$\displaystyle{\sum_{k=-\infty}^{\infty}\varphi(k)}$是收敛的，即$<Ш,\varphi>$有意义，那么$<\mathcal{F}Ш,\varphi>$也是有意义的。

$<\mathcal{F}Ш,\varphi> = <Ш,\mathcal{F}\varphi> = \displaystyle{\sum_{k=-\infty}^{\infty}\mathcal{F}\varphi(k)}$



按照以往的求解方法我们可以写成

$\mathcal{F}Ш = \displaystyle{\sum_{k=-\infty}^{\infty} \mathcal{F}\delta_k = \sum_{k=-\infty}^{\infty}e^{-2\pi ikx} }$

但是这种形式，还不是我们最终要求的值，我们需要引入其他方法求解。



# 泊松求和公式（The Poisson Sum Formula）

注：由于课程内的泊松求和公式的推导有些不明了的地方，因此我们这里采用的是wiki上的推导方式

$Ш$是周期为$1$的脉冲函数，即有

$Ш(t) = \displaystyle{\sum_{k=-\infty}^{\infty}\delta(t-k)}$



把$Ш$分解为傅里叶级数的形式

$\begin{align*} 
Ш(t)
& = \sum_{k=-\infty}^{\infty}C_ke^{2\pi ikt}\\
& = \sum_{k=-\infty}^{\infty}\left(\int_0^1Ш(t)e^{-2\pi ikt}dt \right )e^{2\pi ikt}\\
& = \sum_{k=-\infty}^{\infty} \left( \int_{0}^1 \delta(t)e^{-2\pi ikt}dt \right )e^{2\pi ikt}\\
& = \sum_{k=-\infty}^{\infty}e^{-2\pi i0t}e^{2\pi ikt}\\
& = \sum_{k=-\infty}^{\infty}1\cdot e^{2\pi ikt}\\
& = \sum_{k=-\infty}^{\infty}e^{2\pi ikt}
\end{align*}$



因此

$\displaystyle{\sum_{k=-\infty}^{\infty}e^{2\pi ikt} = \sum_{k=-\infty}^{\infty}\delta(t-k)}$



根据这个条件，我们进行以下推导

$\begin{align*}
\sum_{k=-\infty}^{\infty}\mathcal{F}f(k)
&=\sum_{k=-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-2\pi ikx}dx \right )\\
&=\int_{-\infty}^{\infty}f(x)\left(\sum_{k=-\infty}^{\infty}e^{-2\pi ikx} \right )dx\\
&=\int_{-\infty}^{\infty}f(x)\left(\sum_{k=-\infty}^{\infty}e^{2\pi ikx} \right )dx \\
&=\int_{-\infty}^{\infty}f(x)\left(\sum_{k=-\infty}^{\infty}\delta(x-k) \right )dx\\
&=\sum_{k=-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)\delta(x-k)dx \right )\\
&=\sum_{k=-\infty}^{\infty}f(k)
\end{align*}$



即

$\displaystyle{\sum_{k=-\infty}^{\infty}\mathcal{F}f(k) = \sum_{k=-\infty}^{\infty}f(k) }$



这个等式就是泊松求和公式





# $Ш$的傅里叶变换

根据泊松求和公式，$\mathcal{F}Ш$求解过程如下

$\begin{align*}
<\mathcal{F}Ш,\varphi>
&=<A,\mathcal{F}\varphi>\\
&=\sum_{k=-\infty}^{\infty}\mathcal{F}\varphi(k)\\
&=\sum_{k=-\infty}^{\infty}\varphi(k) \qquad (The\ Poisson\ Sum\ Formula)\\
&=<Ш,\varphi>
\end{align*}$



因此，

$\mathcal{F}Ш = Ш$



![](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024607077-723794999.jpg)





# $Ш_p$的傅里叶变换

首先把$Ш_p$转换成$Ш$的形式

$\begin{align*}
Ш_p
&=\sum_{k=-\infty}^{\infty}\delta(x-kp)\\
&=\sum_{k=-\infty}^{\infty}\delta(p(\frac{x}{p}-k)\\
&=\sum_{k=-\infty}^{\infty}\frac{1}{p}\delta(\frac{x}{p}-k) \qquad(\delta\ scaling\ property)\\
&=\frac{1}{p}\sum_{k=-\infty}^{\infty}\delta(\frac{x}{p}-k)\\
&=\frac{1}{p}Ш(\frac{x}{p})
\end{align*}$



对$Ш_p$进行傅里叶变换

$\begin{align*}
\mathcal{F}Ш_p
&=\frac{1}{p}\mathcal{F}(Ш(\frac{x}{p}))\\
&=\frac{1}{p}\cdot p(\mathcal{F}Ш)(px) \qquad (Fourier\ Scaling\ Theorem)\\
&=Ш(px)\\
&=\sum_{k=-\infty}^{\infty}\delta(px-k)\\
&=\frac{1}{p}\sum_{k=-\infty}^{\infty}\delta(x-\frac{k}{p})\\
&=\frac{1}{p}Ш_{\frac{1}{p}}
\end{align*}$



因此

$\mathcal{F}Ш_p = \frac{1}{p}Ш_{\frac{1}{p}}$



![image](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024205499-1415171566.png)





# 晶体成像

我们前面已经知道一维晶体的原子密度为

$\rho_p(x) = \displaystyle{\rho(x)*\sum_{-\infty}^{\infty}\delta(x-kp) = \rho(x)* Ш_p}$



晶体的成像依赖于它的原子密度的傅里叶变换

$\begin{align*}
\mathcal{F}\rho_p
&=\mathcal{F}(\rho*Ш_p)\\
&=\mathcal{F}(\rho)\mathcal{F}(Ш_p)\\
&=\mathcal{F}(\rho)(\frac{1}{p}Ш_{\frac{1}{p}})\\
&=\mathcal{F}\rho(x)\left(\frac{1}{p}\sum_{k=-\infty}^{\infty}\delta(x-\frac{k}{p}) \right )\\
&=\frac{1}{p}\sum_{k=-\infty}^{\infty}\mathcal{F}\rho(x)\delta(x-\frac{k}{p})\\
&=\frac{1}{p}\sum_{k=-\infty}^{\infty}\mathcal{F}\rho(\frac{k}{p})\delta(x-\frac{k}{p}) \qquad (\delta\ sampling\ property)
\end{align*}$



我们能看到的成像为$\mathcal{F}\rho$在间距为$\frac{1}{p}$上的各个点的采样

![image](https://images2015.cnblogs.com/blog/421096/201512/421096-20151225024206499-2119773698.png)

晶体的原子间距为$p$，而它的成像后的间距为$\frac{1}{p}$，因此晶体的衍射成像间距和晶体的原子间距呈倒数关系。












